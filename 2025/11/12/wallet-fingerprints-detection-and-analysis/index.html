<!DOCTYPE html><html lang=zh-CN><head><meta charset=UTF-8><title>钱包的指纹：侦测与分析</title><meta name=keywords content="比特币, 中本聪, 比特币区块链, 闪电网络, 比特币 layer 2, 健全货币, 密码货币, 密码朋克, 学习比特币, BTC, BTC Study, Bitcoin, bitcoin, proof of work"><meta name=description content=比特币思想的中文集结地><meta name=viewport content="width=device-width,minimum-scale=1,maximum-scale=1,initial-scale=1"><link rel=icon href=/favicon.ico><link rel=stylesheet href="/style/common/bulma.css?v=1682773100887"><link rel=preload as=style onload='this.onload=null,this.rel="stylesheet"' href="/style/common/iconfont.css?v=1682773100887"><link rel=stylesheet href="/style/base.css?v=1682773100887"><link rel=stylesheet href="/style/common/helper.css?v=1682773100887"><link rel=stylesheet href="/style/themes/animation.css?v=1682773100887"><script>function ready(){var e=document.querySelector(".body-container"),t=localStorage.getItem("theme")||"light";["light","dark"].includes(t)||(t="light",localStorage.setItem("theme","light")),e.classList.remove("appearance-auto"),e.classList.add("appearance-"+t),quickInitialTheme()}function quickInitialTheme(){var e=localStorage.getItem("theme")||"light",t=document.querySelector(".logo-light"),o=document.querySelector(".logo-dark"),d=document.querySelector("#mobile-header-logo > .logo-light"),l=document.querySelector("#mobile-header-logo > .logo-dark"),a=document.getElementById("theme-btn"),i=document.querySelector(".slide-theme-light"),c=document.querySelector(".slide-theme-dark");document.body.classList.add(e),("dark"===e?(t.classList.add("hidden"),o.classList.remove("hidden"),d.classList.add("hidden"),l.classList.remove("hidden"),a.classList.remove("icon-icon_dark"),a.classList.add("icon-icon_light"),i):c).classList.remove("hidden")}document.addEventListener("DOMContentLoaded",ready)</script><script src="/js/common.js?v=1682773100887"></script><script src=/js/libs/zepto.min.js></script><link rel=stylesheet href="/style/post.css?v=1682773100887"><link rel=stylesheet href="/style/themes/highlight.css?v=1682773100887"><meta name=generator content="Hexo 6.3.0"><link rel=alternate href=/atom.xml title="BTC Study" type=application/atom+xml></head><body class="is-flex is-flex-direction-column" onload=initialTheme()><div class=clip></div><div class="body-container appearance-auto"><header class="header-widget is-hidden-mobile is-flex is-flex-shrink-0 is-align-items-center is-justify-content-center" id=header><div class="is-flex header-widget-container is-flex-shrink-0 is-align-items-center"><section class="is-hidden-mobile is-flex-shrink-0"><h1><a href=/ ><svg class=logo-light width=125px height=23px viewBox="0 0 125 23" version=1.1 xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink><title>BTCStudy</title><g id=页面-1 stroke=none stroke-width=1 fill=none fill-rule=evenodd><g id=首页-响应式 transform="translate(-249.000000, -23.000000)" fill-rule=nonzero><g id=BTCStudy transform="translate(249.680000, 23.192000)"><path d="M9.072,17.808 C11.312,17.808 13.024,17.408 14.208,16.608 C15.392,15.808 15.984,14.672 15.984,13.2 C15.984,12.192 15.712,11.332 15.168,10.62 C14.624,9.908 13.872,9.384 12.912,9.048 C13.632,8.68 14.188,8.18 14.58,7.548 C14.972,6.916 15.168,6.2 15.168,5.4 C15.168,4.056 14.608,2.988 13.488,2.196 C12.368,1.404 10.736,1.008 8.592,1.008 L8.592,1.008 L-5.68434189e-14,1.008 L-5.68434189e-14,17.808 L9.072,17.808 Z M7.968,7.68 L4.704,7.68 L4.704,4.44 L7.968,4.44 C9.568,4.44 10.368,4.976 10.368,6.048 C10.368,7.136 9.568,7.68 7.968,7.68 L7.968,7.68 Z M8.688,14.376 L4.704,14.376 L4.704,10.968 L8.688,10.968 C10.352,10.968 11.184,11.536 11.184,12.672 C11.184,13.808 10.352,14.376 8.688,14.376 L8.688,14.376 Z M26.544,17.808 L26.544,4.776 L31.68,4.776 L31.68,1.008 L16.632,1.008 L16.632,4.776 L21.792,4.776 L21.792,17.808 L26.544,17.808 Z M41.592,18.144 C43.128,18.144 44.512,17.872 45.744,17.328 C46.976,16.784 48,16 48.816,14.976 L48.816,14.976 L45.792,12.24 C44.704,13.552 43.384,14.208 41.832,14.208 C40.92,14.208 40.108,14.008 39.396,13.608 C38.684,13.208 38.132,12.644 37.74,11.916 C37.348,11.188 37.152,10.352 37.152,9.408 C37.152,8.464 37.348,7.628 37.74,6.9 C38.132,6.172 38.684,5.608 39.396,5.208 C40.108,4.808 40.92,4.608 41.832,4.608 C43.384,4.608 44.704,5.264 45.792,6.576 L45.792,6.576 L48.816,3.84 C48,2.816 46.976,2.032 45.744,1.488 C44.512,0.944 43.128,0.672 41.592,0.672 C39.832,0.672 38.252,1.044 36.852,1.788 C35.452,2.532 34.352,3.568 33.552,4.896 C32.752,6.224 32.352,7.728 32.352,9.408 C32.352,11.088 32.752,12.592 33.552,13.92 C34.352,15.248 35.452,16.284 36.852,17.028 C38.252,17.772 39.832,18.144 41.592,18.144 Z" id=BTC fill=#F2A900></path><path d="M56.64,18.144 C58.24,18.144 59.6,17.9 60.72,17.412 C61.84,16.924 62.68,16.272 63.24,15.456 C63.8,14.64 64.08,13.728 64.08,12.72 C64.08,11.552 63.772,10.628 63.156,9.948 C62.54,9.268 61.812,8.772 60.972,8.46 C60.132,8.148 59.072,7.856 57.792,7.584 C56.656,7.344 55.832,7.112 55.32,6.888 C54.808,6.664 54.552,6.328 54.552,5.88 C54.552,5.432 54.768,5.068 55.2,4.788 C55.632,4.508 56.32,4.368 57.264,4.368 C58.768,4.368 60.32,4.8 61.92,5.664 L61.92,5.664 L63.384,2.136 C62.568,1.656 61.624,1.292 60.552,1.044 C59.48,0.796 58.392,0.672 57.288,0.672 C55.672,0.672 54.308,0.912 53.196,1.392 C52.084,1.872 51.248,2.524 50.688,3.348 C50.128,4.172 49.848,5.096 49.848,6.12 C49.848,7.288 50.152,8.216 50.76,8.904 C51.368,9.592 52.096,10.092 52.944,10.404 C53.792,10.716 54.848,11.008 56.112,11.28 C57.264,11.536 58.1,11.78 58.62,12.012 C59.14,12.244 59.4,12.6 59.4,13.08 C59.4,13.992 58.488,14.448 56.664,14.448 C55.704,14.448 54.728,14.296 53.736,13.992 C52.744,13.688 51.872,13.288 51.12,12.792 L51.12,12.792 L49.56,16.296 C50.36,16.856 51.4,17.304 52.68,17.64 C53.96,17.976 55.28,18.144 56.64,18.144 Z M71.856,18.024 C72.48,18.024 73.068,17.96 73.62,17.832 C74.172,17.704 74.64,17.52 75.024,17.28 L75.024,17.28 L73.896,14.088 C73.496,14.36 73.032,14.496 72.504,14.496 C72.088,14.496 71.756,14.364 71.508,14.1 C71.26,13.836 71.136,13.472 71.136,13.008 L71.136,13.008 L71.136,8.688 L74.112,8.688 L74.112,5.28 L71.136,5.28 L71.136,1.896 L66.576,1.896 L66.576,5.28 L64.68,5.28 L64.68,8.688 L66.576,8.688 L66.576,13.056 C66.576,14.704 67.032,15.944 67.944,16.776 C68.856,17.608 70.16,18.024 71.856,18.024 Z M82.248,18.024 C83,18.024 83.712,17.888 84.384,17.616 C85.056,17.344 85.632,16.944 86.112,16.416 L86.112,16.416 L86.112,17.808 L90.456,17.808 L90.456,4.8 L85.896,4.8 L85.896,11.064 C85.896,12.104 85.668,12.876 85.212,13.38 C84.756,13.884 84.168,14.136 83.448,14.136 C82.744,14.136 82.208,13.912 81.84,13.464 C81.472,13.016 81.288,12.304 81.288,11.328 L81.288,11.328 L81.288,4.8 L76.728,4.8 L76.728,12.072 C76.728,14.056 77.228,15.544 78.228,16.536 C79.228,17.528 80.568,18.024 82.248,18.024 Z M99.048,18.024 C100.744,18.024 102.016,17.52 102.864,16.512 L102.864,16.512 L102.864,17.808 L107.208,17.808 L107.208,0 L102.648,0 L102.648,5.928 C101.8,5.032 100.6,4.584 99.048,4.584 C97.864,4.584 96.784,4.856 95.808,5.4 C94.832,5.944 94.06,6.724 93.492,7.74 C92.924,8.756 92.64,9.936 92.64,11.28 C92.64,12.624 92.924,13.808 93.492,14.832 C94.06,15.856 94.832,16.644 95.808,17.196 C96.784,17.748 97.864,18.024 99.048,18.024 Z M100.008,14.4 C99.208,14.4 98.552,14.124 98.04,13.572 C97.528,13.02 97.272,12.256 97.272,11.28 C97.272,10.32 97.528,9.568 98.04,9.024 C98.552,8.48 99.208,8.208 100.008,8.208 C100.808,8.208 101.46,8.48 101.964,9.024 C102.468,9.568 102.72,10.32 102.72,11.28 C102.72,12.256 102.464,13.02 101.952,13.572 C101.44,14.124 100.792,14.4 100.008,14.4 Z M112.368,22.68 C113.728,22.68 114.88,22.356 115.824,21.708 C116.768,21.06 117.568,19.936 118.224,18.336 L118.224,18.336 L123.84,4.8 L119.496,4.8 L116.28,12.744 L113.088,4.8 L108.408,4.8 L113.976,17.976 C113.784,18.36 113.548,18.64 113.268,18.816 C112.988,18.992 112.632,19.08 112.2,19.08 C111.832,19.08 111.468,19.012 111.108,18.876 C110.748,18.74 110.44,18.552 110.184,18.312 L110.184,18.312 L108.6,21.504 C109.032,21.856 109.596,22.14 110.292,22.356 C110.988,22.572 111.68,22.68 112.368,22.68 Z" id=Study fill-opacity=0.85 fill=#000000></path></g></g></g></svg><svg class="logo-dark hidden" width=125px height=23px viewBox="0 0 125 23" version=1.1 xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink><title>BTCStudy</title><g id=页面-1 stroke=none stroke-width=1 fill=none fill-rule=evenodd><g id=首页-响应式 transform="translate(-249.000000, -23.000000)" fill-rule=nonzero><g id=BTCStudy transform="translate(249.680000, 23.192000)"><path d="M9.072,17.808 C11.312,17.808 13.024,17.408 14.208,16.608 C15.392,15.808 15.984,14.672 15.984,13.2 C15.984,12.192 15.712,11.332 15.168,10.62 C14.624,9.908 13.872,9.384 12.912,9.048 C13.632,8.68 14.188,8.18 14.58,7.548 C14.972,6.916 15.168,6.2 15.168,5.4 C15.168,4.056 14.608,2.988 13.488,2.196 C12.368,1.404 10.736,1.008 8.592,1.008 L8.592,1.008 L-5.68434189e-14,1.008 L-5.68434189e-14,17.808 L9.072,17.808 Z M7.968,7.68 L4.704,7.68 L4.704,4.44 L7.968,4.44 C9.568,4.44 10.368,4.976 10.368,6.048 C10.368,7.136 9.568,7.68 7.968,7.68 L7.968,7.68 Z M8.688,14.376 L4.704,14.376 L4.704,10.968 L8.688,10.968 C10.352,10.968 11.184,11.536 11.184,12.672 C11.184,13.808 10.352,14.376 8.688,14.376 L8.688,14.376 Z M26.544,17.808 L26.544,4.776 L31.68,4.776 L31.68,1.008 L16.632,1.008 L16.632,4.776 L21.792,4.776 L21.792,17.808 L26.544,17.808 Z M41.592,18.144 C43.128,18.144 44.512,17.872 45.744,17.328 C46.976,16.784 48,16 48.816,14.976 L48.816,14.976 L45.792,12.24 C44.704,13.552 43.384,14.208 41.832,14.208 C40.92,14.208 40.108,14.008 39.396,13.608 C38.684,13.208 38.132,12.644 37.74,11.916 C37.348,11.188 37.152,10.352 37.152,9.408 C37.152,8.464 37.348,7.628 37.74,6.9 C38.132,6.172 38.684,5.608 39.396,5.208 C40.108,4.808 40.92,4.608 41.832,4.608 C43.384,4.608 44.704,5.264 45.792,6.576 L45.792,6.576 L48.816,3.84 C48,2.816 46.976,2.032 45.744,1.488 C44.512,0.944 43.128,0.672 41.592,0.672 C39.832,0.672 38.252,1.044 36.852,1.788 C35.452,2.532 34.352,3.568 33.552,4.896 C32.752,6.224 32.352,7.728 32.352,9.408 C32.352,11.088 32.752,12.592 33.552,13.92 C34.352,15.248 35.452,16.284 36.852,17.028 C38.252,17.772 39.832,18.144 41.592,18.144 Z" id=BTC fill=#F2A900></path><path d="M56.64,18.144 C58.24,18.144 59.6,17.9 60.72,17.412 C61.84,16.924 62.68,16.272 63.24,15.456 C63.8,14.64 64.08,13.728 64.08,12.72 C64.08,11.552 63.772,10.628 63.156,9.948 C62.54,9.268 61.812,8.772 60.972,8.46 C60.132,8.148 59.072,7.856 57.792,7.584 C56.656,7.344 55.832,7.112 55.32,6.888 C54.808,6.664 54.552,6.328 54.552,5.88 C54.552,5.432 54.768,5.068 55.2,4.788 C55.632,4.508 56.32,4.368 57.264,4.368 C58.768,4.368 60.32,4.8 61.92,5.664 L61.92,5.664 L63.384,2.136 C62.568,1.656 61.624,1.292 60.552,1.044 C59.48,0.796 58.392,0.672 57.288,0.672 C55.672,0.672 54.308,0.912 53.196,1.392 C52.084,1.872 51.248,2.524 50.688,3.348 C50.128,4.172 49.848,5.096 49.848,6.12 C49.848,7.288 50.152,8.216 50.76,8.904 C51.368,9.592 52.096,10.092 52.944,10.404 C53.792,10.716 54.848,11.008 56.112,11.28 C57.264,11.536 58.1,11.78 58.62,12.012 C59.14,12.244 59.4,12.6 59.4,13.08 C59.4,13.992 58.488,14.448 56.664,14.448 C55.704,14.448 54.728,14.296 53.736,13.992 C52.744,13.688 51.872,13.288 51.12,12.792 L51.12,12.792 L49.56,16.296 C50.36,16.856 51.4,17.304 52.68,17.64 C53.96,17.976 55.28,18.144 56.64,18.144 Z M71.856,18.024 C72.48,18.024 73.068,17.96 73.62,17.832 C74.172,17.704 74.64,17.52 75.024,17.28 L75.024,17.28 L73.896,14.088 C73.496,14.36 73.032,14.496 72.504,14.496 C72.088,14.496 71.756,14.364 71.508,14.1 C71.26,13.836 71.136,13.472 71.136,13.008 L71.136,13.008 L71.136,8.688 L74.112,8.688 L74.112,5.28 L71.136,5.28 L71.136,1.896 L66.576,1.896 L66.576,5.28 L64.68,5.28 L64.68,8.688 L66.576,8.688 L66.576,13.056 C66.576,14.704 67.032,15.944 67.944,16.776 C68.856,17.608 70.16,18.024 71.856,18.024 Z M82.248,18.024 C83,18.024 83.712,17.888 84.384,17.616 C85.056,17.344 85.632,16.944 86.112,16.416 L86.112,16.416 L86.112,17.808 L90.456,17.808 L90.456,4.8 L85.896,4.8 L85.896,11.064 C85.896,12.104 85.668,12.876 85.212,13.38 C84.756,13.884 84.168,14.136 83.448,14.136 C82.744,14.136 82.208,13.912 81.84,13.464 C81.472,13.016 81.288,12.304 81.288,11.328 L81.288,11.328 L81.288,4.8 L76.728,4.8 L76.728,12.072 C76.728,14.056 77.228,15.544 78.228,16.536 C79.228,17.528 80.568,18.024 82.248,18.024 Z M99.048,18.024 C100.744,18.024 102.016,17.52 102.864,16.512 L102.864,16.512 L102.864,17.808 L107.208,17.808 L107.208,0 L102.648,0 L102.648,5.928 C101.8,5.032 100.6,4.584 99.048,4.584 C97.864,4.584 96.784,4.856 95.808,5.4 C94.832,5.944 94.06,6.724 93.492,7.74 C92.924,8.756 92.64,9.936 92.64,11.28 C92.64,12.624 92.924,13.808 93.492,14.832 C94.06,15.856 94.832,16.644 95.808,17.196 C96.784,17.748 97.864,18.024 99.048,18.024 Z M100.008,14.4 C99.208,14.4 98.552,14.124 98.04,13.572 C97.528,13.02 97.272,12.256 97.272,11.28 C97.272,10.32 97.528,9.568 98.04,9.024 C98.552,8.48 99.208,8.208 100.008,8.208 C100.808,8.208 101.46,8.48 101.964,9.024 C102.468,9.568 102.72,10.32 102.72,11.28 C102.72,12.256 102.464,13.02 101.952,13.572 C101.44,14.124 100.792,14.4 100.008,14.4 Z M112.368,22.68 C113.728,22.68 114.88,22.356 115.824,21.708 C116.768,21.06 117.568,19.936 118.224,18.336 L118.224,18.336 L123.84,4.8 L119.496,4.8 L116.28,12.744 L113.088,4.8 L108.408,4.8 L113.976,17.976 C113.784,18.36 113.548,18.64 113.268,18.816 C112.988,18.992 112.632,19.08 112.2,19.08 C111.832,19.08 111.468,19.012 111.108,18.876 C110.748,18.74 110.44,18.552 110.184,18.312 L110.184,18.312 L108.6,21.504 C109.032,21.856 109.596,22.14 110.292,22.356 C110.988,22.572 111.68,22.68 112.368,22.68 Z" id=Study fill-opacity=0.85 fill=#FFFFFF></path></g></g></g></svg></a></h1></section><div class="is-flex is-flex-direction-column header-menu-wrap"><aside class="is-flex-shrink-0 is-flex is-flex-direction-row is-align-items-center" id=header-menu><a class="is-inline-block header-activity mr-4" href=/ >首页</a><a class="is-inline-block mr-4" href=/archives>全站目录</a><a class="is-inline-block mr-4" href=/tags>标签</a><a class="is-inline-block mr-4" href=/maps>地图</a><a class="is-inline-block mr-4" href=/tools>工具</a><a class="is-inline-block mr-4" target=_blank rel=noopener href=https://123btc.org/ >123btc</a><div class="right-content is-flex is-flex-direction-row is-align-items-center"><div class="size-wrap mr-1"><i class="iconfont icon-a-bianzu5" id=change-size-btn></i><div class=size-input-wrap><div class=input-wrap><input id=size-change-input type=range min=12 max=32 step=2></div></div></div><i class="iconfont icon-icon_dark mr-1" id=theme-btn></i><div class=search-wrap><input class=pl-3 id=search-input placeholder=请输入搜索关键词><i class="iconfont icon-icon_search" id=search-input-btn></i></div></div></aside><div class="header-title is-hidden-mobile is-full-height is-flex is-align-items-center is-flex-shrink-0"><div class="is-full-height hidden" id=postTopic><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">钱包的指纹：侦测与分析</p><div class="size-wrap mr-1"><i class="iconfont icon-a-bianzu5" id=change-size-btn2></i><div class=size-input-wrap><div class=input-wrap><input id=size-change-input2 type=range min=12 max=32 step=2></div></div></div></div></div></div></div></header><header class="is-flex header-widget is-flex-shrink-0 is-align-items-center is-justify-content-space-between is-hidden-tablet" id=mobile-header><div class="is-flex is-flex-direction-row is-align-items-center"><i class="iconfont icon-icon_bar mobile-header-menu"></i><div id=mobile-header-logo><svg class=logo-light width=125px height=23px viewBox="0 0 125 23" version=1.1 xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink><title>BTCStudy</title><g id=页面-1 stroke=none stroke-width=1 fill=none fill-rule=evenodd><g id=首页-响应式 transform="translate(-249.000000, -23.000000)" fill-rule=nonzero><g id=BTCStudy transform="translate(249.680000, 23.192000)"><path d="M9.072,17.808 C11.312,17.808 13.024,17.408 14.208,16.608 C15.392,15.808 15.984,14.672 15.984,13.2 C15.984,12.192 15.712,11.332 15.168,10.62 C14.624,9.908 13.872,9.384 12.912,9.048 C13.632,8.68 14.188,8.18 14.58,7.548 C14.972,6.916 15.168,6.2 15.168,5.4 C15.168,4.056 14.608,2.988 13.488,2.196 C12.368,1.404 10.736,1.008 8.592,1.008 L8.592,1.008 L-5.68434189e-14,1.008 L-5.68434189e-14,17.808 L9.072,17.808 Z M7.968,7.68 L4.704,7.68 L4.704,4.44 L7.968,4.44 C9.568,4.44 10.368,4.976 10.368,6.048 C10.368,7.136 9.568,7.68 7.968,7.68 L7.968,7.68 Z M8.688,14.376 L4.704,14.376 L4.704,10.968 L8.688,10.968 C10.352,10.968 11.184,11.536 11.184,12.672 C11.184,13.808 10.352,14.376 8.688,14.376 L8.688,14.376 Z M26.544,17.808 L26.544,4.776 L31.68,4.776 L31.68,1.008 L16.632,1.008 L16.632,4.776 L21.792,4.776 L21.792,17.808 L26.544,17.808 Z M41.592,18.144 C43.128,18.144 44.512,17.872 45.744,17.328 C46.976,16.784 48,16 48.816,14.976 L48.816,14.976 L45.792,12.24 C44.704,13.552 43.384,14.208 41.832,14.208 C40.92,14.208 40.108,14.008 39.396,13.608 C38.684,13.208 38.132,12.644 37.74,11.916 C37.348,11.188 37.152,10.352 37.152,9.408 C37.152,8.464 37.348,7.628 37.74,6.9 C38.132,6.172 38.684,5.608 39.396,5.208 C40.108,4.808 40.92,4.608 41.832,4.608 C43.384,4.608 44.704,5.264 45.792,6.576 L45.792,6.576 L48.816,3.84 C48,2.816 46.976,2.032 45.744,1.488 C44.512,0.944 43.128,0.672 41.592,0.672 C39.832,0.672 38.252,1.044 36.852,1.788 C35.452,2.532 34.352,3.568 33.552,4.896 C32.752,6.224 32.352,7.728 32.352,9.408 C32.352,11.088 32.752,12.592 33.552,13.92 C34.352,15.248 35.452,16.284 36.852,17.028 C38.252,17.772 39.832,18.144 41.592,18.144 Z" id=BTC fill=#F2A900></path><path d="M56.64,18.144 C58.24,18.144 59.6,17.9 60.72,17.412 C61.84,16.924 62.68,16.272 63.24,15.456 C63.8,14.64 64.08,13.728 64.08,12.72 C64.08,11.552 63.772,10.628 63.156,9.948 C62.54,9.268 61.812,8.772 60.972,8.46 C60.132,8.148 59.072,7.856 57.792,7.584 C56.656,7.344 55.832,7.112 55.32,6.888 C54.808,6.664 54.552,6.328 54.552,5.88 C54.552,5.432 54.768,5.068 55.2,4.788 C55.632,4.508 56.32,4.368 57.264,4.368 C58.768,4.368 60.32,4.8 61.92,5.664 L61.92,5.664 L63.384,2.136 C62.568,1.656 61.624,1.292 60.552,1.044 C59.48,0.796 58.392,0.672 57.288,0.672 C55.672,0.672 54.308,0.912 53.196,1.392 C52.084,1.872 51.248,2.524 50.688,3.348 C50.128,4.172 49.848,5.096 49.848,6.12 C49.848,7.288 50.152,8.216 50.76,8.904 C51.368,9.592 52.096,10.092 52.944,10.404 C53.792,10.716 54.848,11.008 56.112,11.28 C57.264,11.536 58.1,11.78 58.62,12.012 C59.14,12.244 59.4,12.6 59.4,13.08 C59.4,13.992 58.488,14.448 56.664,14.448 C55.704,14.448 54.728,14.296 53.736,13.992 C52.744,13.688 51.872,13.288 51.12,12.792 L51.12,12.792 L49.56,16.296 C50.36,16.856 51.4,17.304 52.68,17.64 C53.96,17.976 55.28,18.144 56.64,18.144 Z M71.856,18.024 C72.48,18.024 73.068,17.96 73.62,17.832 C74.172,17.704 74.64,17.52 75.024,17.28 L75.024,17.28 L73.896,14.088 C73.496,14.36 73.032,14.496 72.504,14.496 C72.088,14.496 71.756,14.364 71.508,14.1 C71.26,13.836 71.136,13.472 71.136,13.008 L71.136,13.008 L71.136,8.688 L74.112,8.688 L74.112,5.28 L71.136,5.28 L71.136,1.896 L66.576,1.896 L66.576,5.28 L64.68,5.28 L64.68,8.688 L66.576,8.688 L66.576,13.056 C66.576,14.704 67.032,15.944 67.944,16.776 C68.856,17.608 70.16,18.024 71.856,18.024 Z M82.248,18.024 C83,18.024 83.712,17.888 84.384,17.616 C85.056,17.344 85.632,16.944 86.112,16.416 L86.112,16.416 L86.112,17.808 L90.456,17.808 L90.456,4.8 L85.896,4.8 L85.896,11.064 C85.896,12.104 85.668,12.876 85.212,13.38 C84.756,13.884 84.168,14.136 83.448,14.136 C82.744,14.136 82.208,13.912 81.84,13.464 C81.472,13.016 81.288,12.304 81.288,11.328 L81.288,11.328 L81.288,4.8 L76.728,4.8 L76.728,12.072 C76.728,14.056 77.228,15.544 78.228,16.536 C79.228,17.528 80.568,18.024 82.248,18.024 Z M99.048,18.024 C100.744,18.024 102.016,17.52 102.864,16.512 L102.864,16.512 L102.864,17.808 L107.208,17.808 L107.208,0 L102.648,0 L102.648,5.928 C101.8,5.032 100.6,4.584 99.048,4.584 C97.864,4.584 96.784,4.856 95.808,5.4 C94.832,5.944 94.06,6.724 93.492,7.74 C92.924,8.756 92.64,9.936 92.64,11.28 C92.64,12.624 92.924,13.808 93.492,14.832 C94.06,15.856 94.832,16.644 95.808,17.196 C96.784,17.748 97.864,18.024 99.048,18.024 Z M100.008,14.4 C99.208,14.4 98.552,14.124 98.04,13.572 C97.528,13.02 97.272,12.256 97.272,11.28 C97.272,10.32 97.528,9.568 98.04,9.024 C98.552,8.48 99.208,8.208 100.008,8.208 C100.808,8.208 101.46,8.48 101.964,9.024 C102.468,9.568 102.72,10.32 102.72,11.28 C102.72,12.256 102.464,13.02 101.952,13.572 C101.44,14.124 100.792,14.4 100.008,14.4 Z M112.368,22.68 C113.728,22.68 114.88,22.356 115.824,21.708 C116.768,21.06 117.568,19.936 118.224,18.336 L118.224,18.336 L123.84,4.8 L119.496,4.8 L116.28,12.744 L113.088,4.8 L108.408,4.8 L113.976,17.976 C113.784,18.36 113.548,18.64 113.268,18.816 C112.988,18.992 112.632,19.08 112.2,19.08 C111.832,19.08 111.468,19.012 111.108,18.876 C110.748,18.74 110.44,18.552 110.184,18.312 L110.184,18.312 L108.6,21.504 C109.032,21.856 109.596,22.14 110.292,22.356 C110.988,22.572 111.68,22.68 112.368,22.68 Z" id=Study fill-opacity=0.85 fill=#000000></path></g></g></g></svg><svg class="logo-dark hidden" width=125px height=23px viewBox="0 0 125 23" version=1.1 xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink><title>BTCStudy</title><g id=页面-1 stroke=none stroke-width=1 fill=none fill-rule=evenodd><g id=首页-响应式 transform="translate(-249.000000, -23.000000)" fill-rule=nonzero><g id=BTCStudy transform="translate(249.680000, 23.192000)"><path d="M9.072,17.808 C11.312,17.808 13.024,17.408 14.208,16.608 C15.392,15.808 15.984,14.672 15.984,13.2 C15.984,12.192 15.712,11.332 15.168,10.62 C14.624,9.908 13.872,9.384 12.912,9.048 C13.632,8.68 14.188,8.18 14.58,7.548 C14.972,6.916 15.168,6.2 15.168,5.4 C15.168,4.056 14.608,2.988 13.488,2.196 C12.368,1.404 10.736,1.008 8.592,1.008 L8.592,1.008 L-5.68434189e-14,1.008 L-5.68434189e-14,17.808 L9.072,17.808 Z M7.968,7.68 L4.704,7.68 L4.704,4.44 L7.968,4.44 C9.568,4.44 10.368,4.976 10.368,6.048 C10.368,7.136 9.568,7.68 7.968,7.68 L7.968,7.68 Z M8.688,14.376 L4.704,14.376 L4.704,10.968 L8.688,10.968 C10.352,10.968 11.184,11.536 11.184,12.672 C11.184,13.808 10.352,14.376 8.688,14.376 L8.688,14.376 Z M26.544,17.808 L26.544,4.776 L31.68,4.776 L31.68,1.008 L16.632,1.008 L16.632,4.776 L21.792,4.776 L21.792,17.808 L26.544,17.808 Z M41.592,18.144 C43.128,18.144 44.512,17.872 45.744,17.328 C46.976,16.784 48,16 48.816,14.976 L48.816,14.976 L45.792,12.24 C44.704,13.552 43.384,14.208 41.832,14.208 C40.92,14.208 40.108,14.008 39.396,13.608 C38.684,13.208 38.132,12.644 37.74,11.916 C37.348,11.188 37.152,10.352 37.152,9.408 C37.152,8.464 37.348,7.628 37.74,6.9 C38.132,6.172 38.684,5.608 39.396,5.208 C40.108,4.808 40.92,4.608 41.832,4.608 C43.384,4.608 44.704,5.264 45.792,6.576 L45.792,6.576 L48.816,3.84 C48,2.816 46.976,2.032 45.744,1.488 C44.512,0.944 43.128,0.672 41.592,0.672 C39.832,0.672 38.252,1.044 36.852,1.788 C35.452,2.532 34.352,3.568 33.552,4.896 C32.752,6.224 32.352,7.728 32.352,9.408 C32.352,11.088 32.752,12.592 33.552,13.92 C34.352,15.248 35.452,16.284 36.852,17.028 C38.252,17.772 39.832,18.144 41.592,18.144 Z" id=BTC fill=#F2A900></path><path d="M56.64,18.144 C58.24,18.144 59.6,17.9 60.72,17.412 C61.84,16.924 62.68,16.272 63.24,15.456 C63.8,14.64 64.08,13.728 64.08,12.72 C64.08,11.552 63.772,10.628 63.156,9.948 C62.54,9.268 61.812,8.772 60.972,8.46 C60.132,8.148 59.072,7.856 57.792,7.584 C56.656,7.344 55.832,7.112 55.32,6.888 C54.808,6.664 54.552,6.328 54.552,5.88 C54.552,5.432 54.768,5.068 55.2,4.788 C55.632,4.508 56.32,4.368 57.264,4.368 C58.768,4.368 60.32,4.8 61.92,5.664 L61.92,5.664 L63.384,2.136 C62.568,1.656 61.624,1.292 60.552,1.044 C59.48,0.796 58.392,0.672 57.288,0.672 C55.672,0.672 54.308,0.912 53.196,1.392 C52.084,1.872 51.248,2.524 50.688,3.348 C50.128,4.172 49.848,5.096 49.848,6.12 C49.848,7.288 50.152,8.216 50.76,8.904 C51.368,9.592 52.096,10.092 52.944,10.404 C53.792,10.716 54.848,11.008 56.112,11.28 C57.264,11.536 58.1,11.78 58.62,12.012 C59.14,12.244 59.4,12.6 59.4,13.08 C59.4,13.992 58.488,14.448 56.664,14.448 C55.704,14.448 54.728,14.296 53.736,13.992 C52.744,13.688 51.872,13.288 51.12,12.792 L51.12,12.792 L49.56,16.296 C50.36,16.856 51.4,17.304 52.68,17.64 C53.96,17.976 55.28,18.144 56.64,18.144 Z M71.856,18.024 C72.48,18.024 73.068,17.96 73.62,17.832 C74.172,17.704 74.64,17.52 75.024,17.28 L75.024,17.28 L73.896,14.088 C73.496,14.36 73.032,14.496 72.504,14.496 C72.088,14.496 71.756,14.364 71.508,14.1 C71.26,13.836 71.136,13.472 71.136,13.008 L71.136,13.008 L71.136,8.688 L74.112,8.688 L74.112,5.28 L71.136,5.28 L71.136,1.896 L66.576,1.896 L66.576,5.28 L64.68,5.28 L64.68,8.688 L66.576,8.688 L66.576,13.056 C66.576,14.704 67.032,15.944 67.944,16.776 C68.856,17.608 70.16,18.024 71.856,18.024 Z M82.248,18.024 C83,18.024 83.712,17.888 84.384,17.616 C85.056,17.344 85.632,16.944 86.112,16.416 L86.112,16.416 L86.112,17.808 L90.456,17.808 L90.456,4.8 L85.896,4.8 L85.896,11.064 C85.896,12.104 85.668,12.876 85.212,13.38 C84.756,13.884 84.168,14.136 83.448,14.136 C82.744,14.136 82.208,13.912 81.84,13.464 C81.472,13.016 81.288,12.304 81.288,11.328 L81.288,11.328 L81.288,4.8 L76.728,4.8 L76.728,12.072 C76.728,14.056 77.228,15.544 78.228,16.536 C79.228,17.528 80.568,18.024 82.248,18.024 Z M99.048,18.024 C100.744,18.024 102.016,17.52 102.864,16.512 L102.864,16.512 L102.864,17.808 L107.208,17.808 L107.208,0 L102.648,0 L102.648,5.928 C101.8,5.032 100.6,4.584 99.048,4.584 C97.864,4.584 96.784,4.856 95.808,5.4 C94.832,5.944 94.06,6.724 93.492,7.74 C92.924,8.756 92.64,9.936 92.64,11.28 C92.64,12.624 92.924,13.808 93.492,14.832 C94.06,15.856 94.832,16.644 95.808,17.196 C96.784,17.748 97.864,18.024 99.048,18.024 Z M100.008,14.4 C99.208,14.4 98.552,14.124 98.04,13.572 C97.528,13.02 97.272,12.256 97.272,11.28 C97.272,10.32 97.528,9.568 98.04,9.024 C98.552,8.48 99.208,8.208 100.008,8.208 C100.808,8.208 101.46,8.48 101.964,9.024 C102.468,9.568 102.72,10.32 102.72,11.28 C102.72,12.256 102.464,13.02 101.952,13.572 C101.44,14.124 100.792,14.4 100.008,14.4 Z M112.368,22.68 C113.728,22.68 114.88,22.356 115.824,21.708 C116.768,21.06 117.568,19.936 118.224,18.336 L118.224,18.336 L123.84,4.8 L119.496,4.8 L116.28,12.744 L113.088,4.8 L108.408,4.8 L113.976,17.976 C113.784,18.36 113.548,18.64 113.268,18.816 C112.988,18.992 112.632,19.08 112.2,19.08 C111.832,19.08 111.468,19.012 111.108,18.876 C110.748,18.74 110.44,18.552 110.184,18.312 L110.184,18.312 L108.6,21.504 C109.032,21.856 109.596,22.14 110.292,22.356 C110.988,22.572 111.68,22.68 112.368,22.68 Z" id=Study fill-opacity=0.85 fill=#FFFFFF></path></g></g></g></svg></div><div class="mobile-header-title is-full-height is-flex is-align-items-center is-flex-shrink-0"><div class="is-full-height hidden" id=postTopicMobile><p class=is-full-height>钱包的指纹：侦测与分析</p></div></div></div><i class="iconfont icon-icon_search mobile-header-searchIcon"></i><div class=mobile-search-wrap><div class=search-input><input class=pl-3 id=mobile-search-input placeholder=请输入搜索关键词><i class="iconfont icon-icon_search mobile-search-input-btn"></i><button class=mobile-search-input-btn>搜 索</button></div></div></header><div class=mobile-slide-menu><a class=header-activity href=/ >首页</a><a href=/archives>全站目录</a><a href=/tags>标签</a><a href=/maps>地图</a><a href=/tools>工具</a><a target=_blank rel=noopener href=https://123btc.org/ >123btc</a><div><p class="slide-menu-theme is-flex is-flex-direction-row is-justify-content-space-between is-align-items-center"><span>主题设置</span><span><i class="iconfont icon-icon_light slide-theme-light hidden"></i><i class="iconfont icon-icon_dark slide-theme-dark hidden"></i></span></p><p class=slide-menu-fontsize><span>字体设置</span><span><i class="iconfont icon-bianzubeifen"></i><i class="iconfont icon-bianzu"></i></span></p></div></div><div class="search-mask hidden"><script src="/js/header.js?v=1682773100887"></script></div><main><main class="container is-max-widescreen content section post-page pt-4"><div class="columns is-flex-desktop is-justify-content-center"><div class="column is-3 silde-bar is-hidden-mobile"><ol class=toc><li class="toc-item toc-level-2"><a class=toc-link href=#%E8%83%8C%E6%99%AF><span class=toc-text>背景</span></a><ol class=toc-child><li class="toc-item toc-level-3"><a class=toc-link href=#%E6%9C%89%E6%95%88%E9%92%B1%E5%8C%85%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB%E7%9A%84%E7%BB%93%E6%9E%9C><span class=toc-text>有效钱包指纹识别的结果</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E9%92%B1%E5%8C%85%E6%8C%87%E7%BA%B9%E7%9A%84%E7%B1%BB%E5%9E%8B><span class=toc-text>钱包指纹的类型</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E4%BB%A5%E5%BE%80%E7%9A%84%E9%92%B1%E5%8C%85%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB%E7%A0%94%E7%A9%B6><span class=toc-text>以往的钱包指纹识别研究</span></a></li></ol></li><li class="toc-item toc-level-2"><a class=toc-link href=#%E6%96%B9%E6%B3%95%E8%AE%BA><span class=toc-text>方法论</span></a><ol class=toc-child><li class="toc-item toc-level-3"><a class=toc-link href=#%E5%81%87%E8%AE%BE><span class=toc-text>假设</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E8%A7%82%E5%AF%9F%E5%A4%9A%E6%AC%BE%E9%92%B1%E5%8C%85%E8%BD%AF%E4%BB%B6><span class=toc-text>观察多款钱包软件</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E8%AF%86%E5%88%AB%E6%8C%87%E7%BA%B9><span class=toc-text>识别指纹</span></a></li></ol></li><li class="toc-item toc-level-2"><a class=toc-link href=#%E7%BB%93%E6%9E%9C><span class=toc-text>结果</span></a><ol class=toc-child><li class="toc-item toc-level-3"><a class=toc-link href=#%E5%8F%91%E7%8E%B0><span class=toc-text>发现</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E8%87%AA%E5%8A%A8%E5%8C%96%E5%AF%B9%E4%BA%A4%E6%98%93%E6%8C%87%E7%BA%B9%E7%9A%84%E4%BE%A6%E6%B5%8B><span class=toc-text>自动化对交易指纹的侦测</span></a></li></ol></li><li class="toc-item toc-level-2"><a class=toc-link href=#%E7%BB%93%E8%AE%BA><span class=toc-text>结论</span></a></li><li class="toc-item toc-level-2"><a class=toc-link href=#%E8%87%B4%E8%B0%A2><span class=toc-text>致谢</span></a></li><li class="toc-item toc-level-2"><a class=toc-link href=#%E9%99%84%E5%BD%95A><span class=toc-text>附录A</span></a><ol class=toc-child><li class="toc-item toc-level-3"><a class=toc-link href=#%E7%8B%AC%E7%AB%8B%E5%9E%8B%E6%8C%87%E7%BA%B9><span class=toc-text>独立型指纹</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E6%A6%82%E7%8E%87%E5%9E%8B%E6%8C%87%E7%BA%B9><span class=toc-text>概率型指纹</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E4%BE%9D%E8%B5%96%E5%9E%8B%E6%8C%87%E7%BA%B9><span class=toc-text>依赖型指纹</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E4%B8%B4%E6%97%B6%E5%9E%8B%E6%8C%87%E7%BA%B9><span class=toc-text>临时型指纹</span></a></li></ol></li><li class="toc-item toc-level-2"><a class=toc-link href=#%E9%99%84%E5%BD%95-B><span class=toc-text>附录 B</span></a></li></ol></div><div class="column is-9 post-container"><h1 class="mt-0 mb-2" id=postTitle>钱包的指纹：侦测与分析</h1><div class=page-author><div class="is-flex is-flex-direction-row page-data mr-6"><img class=mr-1 src=/images/default_avatar.png alt="Ishaana Misra"><div class=page-author-info><strong>Ishaana Misra</strong><time class=has-text-grey datetime=2025-11-12T07:08:59.000Z>2025-11-12</time></div></div><div class=is-flex><a href=/tags/%E9%9A%90%E7%A7%81%E6%80%A7><i class="page-tag mr-1 px-1">隐私性</i></a></div></div><article class="mt-4 post-content"><blockquote><p><em>作者：Ishaana Misra</em></p><p><em>来源：<a target=_blank rel=noopener href=https://ishaana.com/blog/wallet_fingerprinting/ >https://ishaana.com/blog/wallet_fingerprinting/</a></em></p></blockquote><p>这个夏天，我一直在识别比特币交易的 “指纹”，并自动化这个侦测过程。实现了几个启发式分析之后，我能够猜测出 50% 的近期出现的交易最初是用哪个钱包 软件&#x2F;硬件 来发起的。所谓 “钱包指纹”，是指广播出来的比特币交易的一些表象，它可以帮助识别用来创建这笔交易的钱包 软件&#x2F;硬件。而识别出创建一笔交易的钱包 软件&#x2F;硬件，可能最终会导致获知该交易创建者的隐私信息。比如说，如果某人使用的是 Trezor 签名器，那么，该人相比只是使用 “热钱包” 的人更有可能拥有大量比特币，从而是一个更吸引人的攻击目标。</p><p>比特币的 “准匿名性（pseudo-anonymity）”，很大程度上意味着，敌手无法了解到关于这笔交易的主人的额外信息，而只能知道他们的公钥。但是，钱包指纹的存在，打破了这种隐私性。在本文中，我辨识了多种钱包软件的多项特征，并且使用它们来证明钱包指纹识别可以有效实现的程度。一旦钱包指纹被识别出来，自动化其侦测就是小事一桩，而且很容易收集到这样的信息：</p><p><img src=/images/wallet-fingerprints-detection-and-analysis/9_graph.png alt="Transaction by Wallet in Block 807929"></p><h2 id=背景><a href=#背景 class=headerlink title=背景></a>背景</h2><h3 id=有效钱包指纹识别的结果><a href=#有效钱包指纹识别的结果 class=headerlink title=有效钱包指纹识别的结果></a>有效钱包指纹识别的结果</h3><p>通过观察一个用户使用的钱包软件，你能了解到很多信息。比如说，如果某人正在使用 <code>Bitcoin Core</code>，TA 更有可能对比特币有更深的了解（相比于只是使用带有更少特性的主流钱包软件的其他人）。此外，如果某人使用的是一个硬件签名器，就暗示了此人可能拥有更多比特币（相比只是使用手机钱包软件的人）。此外，任何给你发送比特币的人（比如你的雇主或客户），都能了解到这些信息；你要给 TA 发送比特币的人，也都能知道。如果一个攻击者能够识别出你正在使用的钱包，那么确定你是不是一个适合下手的目标、爆破该软件已知的漏洞，就变得容易很多；这绝非只存在于理论之中（on a practical level）。</p><p>当交易很容易被识别出指纹时，还会给隐私措施带来问题。比如，有时候，用户会在一笔 coinjoin 交易的两边（译者注：应指在创建该 coinjoin 交易和花费该 coinjoin 交易的输出时）使用相同的钱包软件。那么，如果一笔 coinjoin 交易的某一个输入使用了某款软件的某一个具体版本，而该交易的某一个输入也使用了完全相同的软件，那就表明，该输入和该输出属于同一个用户。这不仅让 coinjoin 对他们自己失效，还降低了参与同一笔 coinjoin 交易的其他用户的机密性。因为知道某人在使用某款钱包是一种隐私泄露，这让其它隐私保护技术在总体上的效果也变差了。</p><h3 id=钱包指纹的类型><a href=#钱包指纹的类型 class=headerlink title=钱包指纹的类型></a>钱包指纹的类型</h3><p>我已经分辨除了多种指纹，将它们组合起来就能识别出创建给定一笔交易的钱包。我将这些指纹分成四种主要类型：独立型、概率型、依赖型和暂时型。这些群组的边界并不是完全清晰的，而且来自一些群组的指纹可以显现出另一个群组的一些特征。这些群组也展示了识别一笔交易的一个指纹有多困难，以及在辨识创建它的钱包时，该指纹应被赋予多少权重。</p><p>“独立型指纹” 可以在交易的表象中直接看到，而且独立于交易的其它表象。这是最容易侦测到的指纹类型。这些指纹总体上比较简单，包括：交易的版本号、发送中的输出的类型。</p><p>至于 “概率型指纹”，几乎每一款钱包都会偶然产生显示出这种指纹的交易。一笔交易表现出的特定动作越多，我们就越确信，制作这些交易的钱包是有意为之的。一个有用的例子是交易的输入和输出的排序。一些钱包会按照 BIP-69，以字典顺序为输入排序、 按金额由小到大为输出排序。虽然实现了 BIP-69 的钱包总会这样排序输入和输出然后创建交易，但没有实现 BIP-69 的钱包也偶尔会符合这种规则。</p><p>“依赖型指纹” 依赖于其它基于启发式分析的信息已经被正确推理出，比如，能够正确低侦测出找零输出。使用少量的<a target=_blank rel=noopener href=https://en.bitcoin.it/wiki/Privacy#Change_address_detection>简单启发式分析</a>，确定找零输出可能非常容易，但依然有可能猜测错误，所以，通常，这种指纹识别手段不会给人那么强的信息。</p><p>最少见的指纹是 “临时型指纹”。它们要么需要交易池数据才能侦测出来，要么需要考虑特定交易的区块高度。这让它们更难识别。临时型指纹通常来说跟一些 手续费追加方法 以及&#x2F;或者 未确认的输入 有关。</p><h3 id=以往的钱包指纹识别研究><a href=#以往的钱包指纹识别研究 class=headerlink title=以往的钱包指纹识别研究></a>以往的钱包指纹识别研究</h3><p>钱包指纹识别在比特币社区中并不是一个无人问津的概念。对它的讨论通常是理论上的，也通常被认为是应该避免的事情。到目前为止，已经完成的指纹识别研究，通常关注仅仅一个指纹，或者只涉及少量钱包软件。这样的例子包括 achow101 的《<a target=_blank rel=noopener href=https://github.com/achow101/wallet-fingerprinting/blob/main/fingerprints.md>Bitcoin Core 和 Electrum 指纹清单</a>》以及 0xb10c 的《<a target=_blank rel=noopener href=https://b10c.me/observations/03-blockchaincom-recommendations/ >使用费率来识别 blockchain.com 上的交易</a>》。在本文中，我志在得出对钱包指纹识别技术及其可应用程度的更广泛理解。</p><h2 id=方法论><a href=#方法论 class=headerlink title=方法论></a>方法论</h2><h3 id=假设><a href=#假设 class=headerlink title=假设></a>假设</h3><p>因为识别所有可用钱包软件的所有版本是不可行的，所以，在查看下列方法论和结果时，有一些事项需要注意。首先，当我点名某一款钱包时，我仅仅指的是我列出的那一个版本。这些指纹在该软件的其它版本也可能存在，但我并未去验证。其次，哪怕是我说的版本，如果并非以默认设置运行，可能也不会出现指纹。最后，也许还有许多我没有观察到的钱包软件，也带有我这里观察到的相同指纹，所以，这里讨论的任何一种指纹组合，都不应理解成专属于某一款钱包软件。</p><h3 id=观察多款钱包软件><a href=#观察多款钱包软件 class=headerlink title=观察多款钱包软件></a>观察多款钱包软件</h3><p>为了代表不同类型的比特币软件，我决定研究八款钱包软件，它们的安全模式和目标用户都有所不同：</p><ul><li>Bitcoin Core (v. 25.0)</li><li>Electrum (v. 4.4.5)</li><li>Blue Wallet (v. 6.4.6 iOS)</li><li>Exodus (v. 23.7.2 iOS)</li><li>Trust Wallet (v. 9. 0 iOS)</li><li>Coinbase Wallet (v. 28.53 iOS)</li><li>Trezor Suite (v. 23.7.2)</li><li>Ledger Live (v. 2.64.2)</li></ul><h3 id=识别指纹><a href=#识别指纹 class=headerlink title=识别指纹></a>识别指纹</h3><p><strong>观察软件实现</strong></p><p>我研究的大部分钱包都是开源的（Bitcoin Core、Electrum、Blue Wallet、Trezor、Ledger）。这使我不仅能够观察代码并从中确定指纹，还能回溯代码拉取请求（PR）和问题报告（Issue），以了解已经被解决的指纹和被报告和讨论的指纹。不过，要遍历这五种开源钱包的代码和 GitHub 代码库历史需要花太多太多时间。我会将代码库作为备份，用于确认我观察到的指纹，并检查是否有人已经报告了它们。</p><p>一个更快的发现指纹的办法是浏览钱包软件的界面和选项，以及使用它来创建一些交易。</p><p><strong>浏览钱包界面</strong></p><p>许多简单的指纹，都只需观察钱包软件所提供的选项就可以识别出来。包括：可以花费的地址类型、是否允许同时花费多种输出类型、单笔交易是否可以发送给多于 1 个收款方。</p><p><strong>创建交易</strong></p><p>在寻找指纹时，并不是所有交易都一样有用。为寻找指纹而创建的交易应该包含尽可能多的信息。比如说，一笔只有一个输入和一个输出交易就没法告诉我们太多东西；它既不能告诉我们这款钱包软件的通常找零输出索引（译者注：应指找零输出在输出序列中的位置），也不能告诉我们它如何给输入和输出排序，更不能告诉我们它是否会复用输入地址作为找零地址，等等。</p><p>有了这些背景知识之后，我使用这些钱包创建了许多笔交易，然后从中寻找指纹。最终，我为更难以找出指纹的钱包创建了更多的交易（详见 “附录 B ”）。在创建了第一笔交易之后，我就开始寻找独立型指纹。然后，我开始寻找所有可以识别出来的模式，比如跟输入排序和找零索引。然后，我创建更多的交易，以尝试在该钱包所创建的所有交易中确认或证否这些模式。找出这些指纹之后，我再编写 Python 程序来验证它们。</p><h2 id=结果><a href=#结果 class=headerlink title=结果></a>结果</h2><h3 id=发现><a href=#发现 class=headerlink title=发现></a>发现</h3><p>这里是我的研究结果，它是格钱包软件的可能指纹的表格。关于每一个指纹的完整解释，可以在 “附录 A ” 找到。</p><p><img src=/../images/wallet-fingerprints-detection-and-analysis/s_final.png alt="Wallet Fingerprints by Wallet"></p><p>以下是我认为尤为值得注意的东西：</p><ul><li><code>Ledger</code> 钱包软件在执行 “钱币挑选” 流程之后，似乎不会混洗这些输入（即改变这些输入的排序）。而 Ledger 钱包软件的默认钱币挑选算法是历史性的（最老的 UTXO 最先花掉）。</li><li>我用 <code>Trezor</code> 钱包软件创建的所有交易都遵循 BIP-69 。</li><li><code>Exodus</code>钱包软件只提供一个地址，而且，会在找零输出中复用这个地址，但如果你进入钱包设置中，有一个选项可以使用多个地址。这真有趣 —— 多个地址居然不是默认配置。</li><li>总的来说，似乎也保管山寨币的钱包（比如 <code>Exodus</code> 钱包和 <code>Trust</code> 钱包）就会只使用一个地址。可能是因为许多山寨币的钱包实现都这样做（在一个钱包中只包含一个地址）。</li><li>简单的指纹也可以是非常有用的。比如，支持花费多种 UTXO 类型以及支付给多个收款人，是很容易侦测出来的，但在不同钱包软件中差别非常大。<code>Bitcoin Core</code> 是少数允许花费多种 UTXO 类型以及发送到超过两个输出中的钱包软件。<code>Ledger</code> 则相反，这两种选项都不允许。</li></ul><h3 id=自动化对交易指纹的侦测><a href=#自动化对交易指纹的侦测 class=headerlink title=自动化对交易指纹的侦测></a>自动化对交易指纹的侦测</h3><p>使用上面发现的指纹，剩下的事情就简单了 —— 编写一系列的函数来：（A）侦测交易中的指纹；（B）通过这些指纹的 存在 或 缺失 来 排除 或者 证实 可能创建这笔交易的钱包；（C）对一大群交易作广泛的调查，比如一个区块中的所有交易，或者某一瞬间交易池中的所有交易。我成功用 Pyhton 编程语言编写了这些函数，可以在这个 GitHub <a target=_blank rel=noopener href=https://github.com/ishaanam/wallet-fingerprinting>代码库</a>中找到。它们可以本地运行（详见代码库中的指令），也可以在 <a target=_blank rel=noopener href="https://colab.research.google.com/drive/1hWVe9U-r5np_QiGNtM6qaapXq8YwQ1FX?usp=sharing">Google Colab</a> 上运行。</p><p>交易和区块是使用 <a target=_blank rel=noopener href=https://bitcoincore.org/ >Bitcoin Core</a> 或者 <a target=_blank rel=noopener href=https://mempool.space/docs/api/rest>Mempool Space REST API</a> 拉取得到的。一部分函数会取得一笔解序列化的交易、检查是否存在一个或多个指纹（比如说，很容易一次性检查输出的类型和排序，而不必分别检查）。有一个 <code>detect_wallet(tx_hash)</code> 函数会使用这些函数来识别指纹，然后使用这些指纹来确定创建这笔交易的钱包。</p><p>基于特定指纹的存在来确定可能的创建者，这似乎比较符合直觉。但是，因为概率型指纹的存在 —— 即使一款钱包软件并不会有意产生某种指纹，这种指纹在其创建的交易中依然有可能存在 —— 基于指纹的缺失来排除可能的创建者，实际上是更加高效的。比如说，如果一笔交易实施了 “抵抗手续费狙击”（这是一种独立型指纹），但并不遵循 BIP-69（这是一种概率性指纹），那就有可能是由 <code>Bitcoin Core</code> 创建的。可能性可以通过指纹的缺失来排除。如果只剩一种可能性，那就有可能是这款钱包软件创建了这笔交易。如果没有剩下任何可能性，那就意味着这笔交易可能不是由上述八款之一创建的。如果还剩下多种可能性，则表明没有足够的信息来确定创建者。</p><p><code>detect_wallet</code> 函数可以应用于一个区块中的所有交易，产生出下面这样的结果，它提供了多少交易可能由某一种钱包创建的细分数据。</p><p><img src=/../images/wallet-fingerprints-detection-and-analysis/utput_0.png alt="Output of using python to find the wallets which created the transactions in Block 807929"></p><p>注意，“ Other ” 的数据表示不可能由上述八款钱包创建的交易的数量 —— 因为它们拥有完全不同的指纹组合。而 “Unclear” 的数据表明可能由上述八款中的某几款创建、没有足够多的信息来进一步排除可能性的交易的数量。</p><h2 id=结论><a href=#结论 class=headerlink title=结论></a>结论</h2><p>关于钱包指纹识别技术，还有许多方面可以进一步研究。有时候，一笔交易中出现的指纹不足以使我们有把握地认定创建它的钱包。为了发现更多的指纹，钱包聚类算法可以用来发现属于同一个钱包的其它地址。这是有用的，因为所有相关的交易都可以用来搜索指纹。拥有多笔相关的交易，在侦测概率型指纹上尤其有用，因为积累了特定动作的更多案例。总的来说，去匿名化技术，越是集团作战，就越是高效。</p><p>没有显然的方案可以解决这里讨论的问题。虽然一些指纹很容易消除，但很难完全消除指纹。这仅仅是因为，我们把一个东西当作指纹，并不天然意味着钱包软件不应该这么实现。比如说，如果一款钱包所创建的所有交易都有特定的输入排序或者找零索引，那当然应该改变；但是，抵抗手续费狙击和允许花费 taproot UTXO 这样的特性，则依然应该保留。</p><h2 id=致谢><a href=#致谢 class=headerlink title=致谢></a>致谢</h2><p>感谢 Clara Shikhelman 和 Mark Erhardt 跟我讨论这个项目以及审核我的工作。感谢 Andrew Chow 给了我一些备用的硬件签名器来寻找指纹。任何错误和观点，都仅属于我自己。</p><h2 id=附录A><a href=#附录A class=headerlink title=附录A></a>附录A</h2><h3 id=独立型指纹><a href=#独立型指纹 class=headerlink title=独立型指纹></a>独立型指纹</h3><ul><li><p><a target=_blank rel=noopener href=https://bitcoinops.org/en/topics/fee-sniping/ ><strong>抵抗手续费狙击</strong></a>：一种反激励区块链重组的机制；包括将交易的 <code>nLockTime</code>（生效时间）设置为当前的区块高度，从而该区块无法被更早的区块挖掘，尝试通过重组区块链、在历史高度重新挖出区块（通过打包后来才出现的高手续费交易）来夺取手续费的矿工自然就无利可图。将交易锁定到即将到来的区块保证了这些手续费只能被挖出下一个区块（乃至以后的区块）的矿工得到。</p></li><li><p><strong>输入的类型</strong>：一些钱包软件只创建特定类型的地址。</p><ul><li><strong>多种类型的输入</strong>：一些钱包软件允许在一笔交易中花费多种类型的输入。</li></ul></li><li><p><strong>输出类型</strong>：一些钱包软件只支持发送到特性类型的 地址&#x2F;脚本公钥 。</p></li><li><p><strong>输出的数量</strong>：某些钱包软件（在一笔花费交易中）只支持发送给一个收款方（外加一个找零）。一些钱包软件可尝试创建无找零的交易。</p></li><li><p><strong>可选的 RBF 信号</strong>：某些钱包软件默认创建带有可选 RBF 信号的交易；有一些则并非默认如此，但提供了选项。</p></li><li><p><strong>压缩的&#x2F;未压缩的 ECDSA 公钥</strong>：未压缩的 ECDSA 现在在所有输出类型中都是非标准的，但以往，P2PKH 和 P2SH 输出类型是可以使用它们的（详见 Bitcoin Core 的 <a target=_blank rel=noopener href=https://github.com/bitcoin/bitcoin/pull/8499>#8499</a> 拉取请求）。这种指纹在老旧交易上更加有用。</p></li><li><p><strong>交易版本化</strong>：交易的 <code>nVersion</code> 字段只有数值 1 和数值 2 是标准的。使用特定的操作码会要求将 <code>nVersion</code> 设为 2 。一些钱包软件普遍使用数值 2，而另一些还在使用版本 1 。</p></li></ul><h3 id=概率型指纹><a href=#概率型指纹 class=headerlink title=概率型指纹></a>概率型指纹</h3><ul><li><p><a target=_blank rel=noopener href=https://github.com/bitcoin/bips/blob/master/bip-0069.mediawiki><strong>BIP 69</strong></a>：输入和输出的字典排序是由 BIP-69 规定的。虽然这个 BIP 是为了缓解钱包实现中（对输入和输出的排序）的隐私泄露而制定的，但它自身最终也成了一个指纹。如果只有少量钱包实现了一种反指纹措施，那么这种措施自身就会成为一种指纹。这是概率型指纹，因为钱包软件可能意外产生符合字典排序的交易。</p></li><li><p><strong>低 R 研磨</strong>：在 ECDSA 签名中，r 值是秘密 nonce 值得 x 坐标值。一个 低-r 签名就是其 r 值可以用 32 字节（而非 33 字节）来编码的签名。少量钱包实现会一直生成签名，直到产生一个 低-r 签名，这样交易的整体体积会更小，可以节约手续费并简化手续费估计。这也是概率型指纹，因为钱包总是可能无意中生成一笔全部输入都带有低 r 签名的交易。另一方面，高-r 签名可以用来排除所有实现了 “低-r 研磨” 的钱包。</p></li><li><p><strong>输入排序</strong>：输入排序指纹可能是钱包软件在执行<a target=_blank rel=noopener href=https://bitcoinops.org/en/topics/coin-selection/ >钱币挑选</a>之后不混洗输入的结果。这是概率型指纹，因为它可能像是钱包软件在按特定的方式排序输入，实际上是混洗之后恰好得到这样的结果。常见的情形有：</p><ul><li>小额 UTXO 优先（按 UTXO 的价值）</li><li>大额 UTXO 优先（按 UTXO 的价值）</li><li>老 UTXO 优先（按 UTXO 的产生时间）</li></ul></li><li><p><strong>手动输入 手续费&#x2F;费率</strong>：这种指纹的一些信号包括：</p><ul><li><p>随机的美元数额</p></li><li><p>随机的聪数额</p><p>这是概率型指纹，因为软件的费率建议也可产生随机的美元或聪数额。</p></li></ul></li></ul><h3 id=依赖型指纹><a href=#依赖型指纹 class=headerlink title=依赖型指纹></a>依赖型指纹</h3><ul><li><strong>找零输出在输出序列中的位置</strong>：某些钱包总是让找零处在交易输出中的特定位置（通常是第一个或者最后一个）。其它钱包则会让随机化找零的索引。</li><li><strong>找零输出类型</strong>：<ul><li>找零的类型是否跟其中一个输出的类型一致？</li><li>反过来，找零的类型是否跟其中一个输入的类型一致？</li></ul></li></ul><h3 id=临时型指纹><a href=#临时型指纹 class=headerlink title=临时型指纹></a>临时型指纹</h3><ul><li><strong>花费未确认的输出</strong>：<ul><li>是否曾经花费过未确认的找零输出？</li><li>所有类型的未确认输出都被花费过吗？</li></ul></li><li><strong>提交替代交易</strong>：这跟前面说的 “直接开启选择性 RBF ” 不应混淆。这里说的是用户为开启了选择性 RBF 的交易实际提交一笔替代交易。有一些钱包在创建交易时会开启选择性 RBF ，但实际上并不允许为自己的交易追加手续费。</li><li><strong>费率建议</strong>：钱包软件是否使用了手续费建议？如果有，这些建议是从哪里获得的？如果一笔交易的手续费跟特定钱包的手续费建议相同、并且该手续费建议一定程度上是独一无二的，那就暗示着该交易是使用这个钱包软件创建的。</li></ul><h2 id=附录-B><a href=#附录-B class=headerlink title="附录 B"></a>附录 B</h2><p>以下是表明存在上述部分指纹的交易。</p><p>Blue Wallet:</p><p>2fd284ed739a59ac6d6bd7f94fa2a244dd0cf88981551272b96708aebf260a57</p><p>702903c9818ac7847c9a2d9f948c9ee1ab25236821836170ef6919cd12c9e04c</p><p>1bf659e17568e48d6f47bb5470bc8df567cfe89d79c6e38cafbe798f43d5da22</p><p>Electrum:</p><p>5d857401648a667303cde43295bce1326e6329353eac3dddf15b151e701405e7</p><p>Trezor:</p><p>C1ba2810ac35c2d17503792ee728a3df9c41c658f5442d9326eb69580bcb7dd6</p><p>bc8c701594207360a409d64a9c797a46dd11a2d468948e8bb98e865249ca17e3</p><p>999b46e55df4e57a2a8ba0de28ae9547ce9bf2dbc8cceaddf0fb13a7af8923e7</p><p>Ledger:</p><p>C1094c70a9b23ca5d755234cffefca69f639d7a938f745dfd1190cc9c9d8b5ad</p><p>1c2dbae13f1762aae0b427107babfb013849c6e3262bb302b264ef4f93f76e3d</p><p>b2863a85081cd113094d50878153fab5c3160999e5fd2e044782b851c4dc72e1</p><p>Ffa8a398325ec1a4e39ca5dea0383bbdc2b01528c5ceb215e821d41d435b5d09</p><p>Exodus:</p><p>6f8c37db6ed88bfd0fd483963ebf06c5557326f8d2a3617af5ceba878442e1ad</p><p>Coinbase Wallet:</p><p>Bd4a846c05c37029caf7f6cef453112eef362ca511bd6a52f9082d85b7b2f207</p><p>60849af6e56c2ad0facd601cc5014398210898a7e6d5b9280b54f6395349663a</p><p>9aa3a7086730aadc3fc0a7494b6f8fb27e6a862e707917af96662d145950dbd6</p><p>96beaefd8df5b25d95e4fbc1fd3c5949f9a61f59d763629fa768b555426e90c8</p><p>Trust:</p><p>43f901163b8c27567d365f56bb804bd74904bd78d58017905f3c36cac971d9b6</p></article></div></div></main><script src="/js/post.js?v=1682773100887"></script><script src="/js/highlight.min.js?v=1682773100887"></script><script>var containerEl=document.querySelector(".post-container"),postFontSize=localStorage.getItem("post-font-size")||"16",inputEl=document.querySelector("#size-change-input"),inputEl2=document.querySelector("#size-change-input2");inputEl.value=postFontSize,inputEl2.value=postFontSize,containerEl.style.fontSize=postFontSize+"px",$(function(){function e(t){$(".post-container").css("font-size",t+"px"),localStorage.setItem("post-font-size",t),$("#size-change-input").val(t),$("#size-change-input2").val(t)}$("#size-change-input").on("input propertychange",function(t){e(t.target.value)}),$("#size-change-input2").on("input propertychange",function(t){e(t.target.value)})})</script><script>hljs.initHighlightingOnLoad()</script></main></div><footer class="is-flex is-flex-direction-column is-align-items-center is-flex-shrink-0"><section class=sns-container><a title=nostr target=_blank rel="noopener nofollow" href=https://iris.to/npub1g2qs0ca5kpwlrcfug2em4jelmh65clk3yccwjxrs6hvdpd9qj80q022j4m>Nostr</a><a title=rss target=_blank rel="noopener nofollow" href=/atom.xml>rss</a><a title=telegram target=_blank rel="noopener nofollow" href=//t.me/btcstudyorg>Telegram</a></section></footer><script async src="/js/buttons.js?v=1682773100887"></script><script async src="/js/index.js?v=1682773100887"></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-JVCJ9XXG1Z"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-JVCJ9XXG1Z")</script><script>var _hmt=_hmt||[];(()=>{var e=document.createElement("script"),t=(e.src="https://hm.baidu.com/hm.js?c92c073c85be5be8d9b1b76f62a7e306",e.async=!0,e.defer=!0,document.getElementsByTagName("script")[0]);t.parentNode.insertBefore(e,t)})()</script></body></html>