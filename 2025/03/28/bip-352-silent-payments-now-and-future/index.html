<!DOCTYPE html><html lang=zh-CN><head><meta charset=UTF-8><title>BIP352：静默支付的现在和未来</title><meta name=keywords content="比特币, 中本聪, 比特币区块链, 闪电网络, 比特币 layer 2, 健全货币, 密码货币, 密码朋克, 学习比特币, BTC, BTC Study, Bitcoin, bitcoin, proof of work"><meta name=description content=比特币思想的中文集结地><meta name=viewport content="width=device-width,minimum-scale=1,maximum-scale=1,initial-scale=1"><link rel=icon href=/favicon.ico><link rel=stylesheet href="/style/common/bulma.css?v=1682773100887"><link rel=preload as=style onload='this.onload=null,this.rel="stylesheet"' href="/style/common/iconfont.css?v=1682773100887"><link rel=stylesheet href="/style/base.css?v=1682773100887"><link rel=stylesheet href="/style/common/helper.css?v=1682773100887"><link rel=stylesheet href="/style/themes/animation.css?v=1682773100887"><script>function ready(){var e=document.querySelector(".body-container"),t=localStorage.getItem("theme")||"light";["light","dark"].includes(t)||(t="light",localStorage.setItem("theme","light")),e.classList.remove("appearance-auto"),e.classList.add("appearance-"+t),quickInitialTheme()}function quickInitialTheme(){var e=localStorage.getItem("theme")||"light",t=document.querySelector(".logo-light"),o=document.querySelector(".logo-dark"),d=document.querySelector("#mobile-header-logo > .logo-light"),l=document.querySelector("#mobile-header-logo > .logo-dark"),a=document.getElementById("theme-btn"),i=document.querySelector(".slide-theme-light"),c=document.querySelector(".slide-theme-dark");document.body.classList.add(e),("dark"===e?(t.classList.add("hidden"),o.classList.remove("hidden"),d.classList.add("hidden"),l.classList.remove("hidden"),a.classList.remove("icon-icon_dark"),a.classList.add("icon-icon_light"),i):c).classList.remove("hidden")}document.addEventListener("DOMContentLoaded",ready)</script><script src="/js/common.js?v=1682773100887"></script><script src=/js/libs/zepto.min.js></script><link rel=stylesheet href="/style/post.css?v=1682773100887"><link rel=stylesheet href="/style/themes/highlight.css?v=1682773100887"><meta name=generator content="Hexo 6.3.0"><link rel=alternate href=/atom.xml title="BTC Study" type=application/atom+xml></head><body class="is-flex is-flex-direction-column" onload=initialTheme()><div class=clip></div><div class="body-container appearance-auto"><header class="header-widget is-hidden-mobile is-flex is-flex-shrink-0 is-align-items-center is-justify-content-center" id=header><div class="is-flex header-widget-container is-flex-shrink-0 is-align-items-center"><section class="is-hidden-mobile is-flex-shrink-0"><h1><a href=/ ><svg class=logo-light width=125px height=23px viewBox="0 0 125 23" version=1.1 xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink><title>BTCStudy</title><g id=页面-1 stroke=none stroke-width=1 fill=none fill-rule=evenodd><g id=首页-响应式 transform="translate(-249.000000, -23.000000)" fill-rule=nonzero><g id=BTCStudy transform="translate(249.680000, 23.192000)"><path d="M9.072,17.808 C11.312,17.808 13.024,17.408 14.208,16.608 C15.392,15.808 15.984,14.672 15.984,13.2 C15.984,12.192 15.712,11.332 15.168,10.62 C14.624,9.908 13.872,9.384 12.912,9.048 C13.632,8.68 14.188,8.18 14.58,7.548 C14.972,6.916 15.168,6.2 15.168,5.4 C15.168,4.056 14.608,2.988 13.488,2.196 C12.368,1.404 10.736,1.008 8.592,1.008 L8.592,1.008 L-5.68434189e-14,1.008 L-5.68434189e-14,17.808 L9.072,17.808 Z M7.968,7.68 L4.704,7.68 L4.704,4.44 L7.968,4.44 C9.568,4.44 10.368,4.976 10.368,6.048 C10.368,7.136 9.568,7.68 7.968,7.68 L7.968,7.68 Z M8.688,14.376 L4.704,14.376 L4.704,10.968 L8.688,10.968 C10.352,10.968 11.184,11.536 11.184,12.672 C11.184,13.808 10.352,14.376 8.688,14.376 L8.688,14.376 Z M26.544,17.808 L26.544,4.776 L31.68,4.776 L31.68,1.008 L16.632,1.008 L16.632,4.776 L21.792,4.776 L21.792,17.808 L26.544,17.808 Z M41.592,18.144 C43.128,18.144 44.512,17.872 45.744,17.328 C46.976,16.784 48,16 48.816,14.976 L48.816,14.976 L45.792,12.24 C44.704,13.552 43.384,14.208 41.832,14.208 C40.92,14.208 40.108,14.008 39.396,13.608 C38.684,13.208 38.132,12.644 37.74,11.916 C37.348,11.188 37.152,10.352 37.152,9.408 C37.152,8.464 37.348,7.628 37.74,6.9 C38.132,6.172 38.684,5.608 39.396,5.208 C40.108,4.808 40.92,4.608 41.832,4.608 C43.384,4.608 44.704,5.264 45.792,6.576 L45.792,6.576 L48.816,3.84 C48,2.816 46.976,2.032 45.744,1.488 C44.512,0.944 43.128,0.672 41.592,0.672 C39.832,0.672 38.252,1.044 36.852,1.788 C35.452,2.532 34.352,3.568 33.552,4.896 C32.752,6.224 32.352,7.728 32.352,9.408 C32.352,11.088 32.752,12.592 33.552,13.92 C34.352,15.248 35.452,16.284 36.852,17.028 C38.252,17.772 39.832,18.144 41.592,18.144 Z" id=BTC fill=#F2A900></path><path d="M56.64,18.144 C58.24,18.144 59.6,17.9 60.72,17.412 C61.84,16.924 62.68,16.272 63.24,15.456 C63.8,14.64 64.08,13.728 64.08,12.72 C64.08,11.552 63.772,10.628 63.156,9.948 C62.54,9.268 61.812,8.772 60.972,8.46 C60.132,8.148 59.072,7.856 57.792,7.584 C56.656,7.344 55.832,7.112 55.32,6.888 C54.808,6.664 54.552,6.328 54.552,5.88 C54.552,5.432 54.768,5.068 55.2,4.788 C55.632,4.508 56.32,4.368 57.264,4.368 C58.768,4.368 60.32,4.8 61.92,5.664 L61.92,5.664 L63.384,2.136 C62.568,1.656 61.624,1.292 60.552,1.044 C59.48,0.796 58.392,0.672 57.288,0.672 C55.672,0.672 54.308,0.912 53.196,1.392 C52.084,1.872 51.248,2.524 50.688,3.348 C50.128,4.172 49.848,5.096 49.848,6.12 C49.848,7.288 50.152,8.216 50.76,8.904 C51.368,9.592 52.096,10.092 52.944,10.404 C53.792,10.716 54.848,11.008 56.112,11.28 C57.264,11.536 58.1,11.78 58.62,12.012 C59.14,12.244 59.4,12.6 59.4,13.08 C59.4,13.992 58.488,14.448 56.664,14.448 C55.704,14.448 54.728,14.296 53.736,13.992 C52.744,13.688 51.872,13.288 51.12,12.792 L51.12,12.792 L49.56,16.296 C50.36,16.856 51.4,17.304 52.68,17.64 C53.96,17.976 55.28,18.144 56.64,18.144 Z M71.856,18.024 C72.48,18.024 73.068,17.96 73.62,17.832 C74.172,17.704 74.64,17.52 75.024,17.28 L75.024,17.28 L73.896,14.088 C73.496,14.36 73.032,14.496 72.504,14.496 C72.088,14.496 71.756,14.364 71.508,14.1 C71.26,13.836 71.136,13.472 71.136,13.008 L71.136,13.008 L71.136,8.688 L74.112,8.688 L74.112,5.28 L71.136,5.28 L71.136,1.896 L66.576,1.896 L66.576,5.28 L64.68,5.28 L64.68,8.688 L66.576,8.688 L66.576,13.056 C66.576,14.704 67.032,15.944 67.944,16.776 C68.856,17.608 70.16,18.024 71.856,18.024 Z M82.248,18.024 C83,18.024 83.712,17.888 84.384,17.616 C85.056,17.344 85.632,16.944 86.112,16.416 L86.112,16.416 L86.112,17.808 L90.456,17.808 L90.456,4.8 L85.896,4.8 L85.896,11.064 C85.896,12.104 85.668,12.876 85.212,13.38 C84.756,13.884 84.168,14.136 83.448,14.136 C82.744,14.136 82.208,13.912 81.84,13.464 C81.472,13.016 81.288,12.304 81.288,11.328 L81.288,11.328 L81.288,4.8 L76.728,4.8 L76.728,12.072 C76.728,14.056 77.228,15.544 78.228,16.536 C79.228,17.528 80.568,18.024 82.248,18.024 Z M99.048,18.024 C100.744,18.024 102.016,17.52 102.864,16.512 L102.864,16.512 L102.864,17.808 L107.208,17.808 L107.208,0 L102.648,0 L102.648,5.928 C101.8,5.032 100.6,4.584 99.048,4.584 C97.864,4.584 96.784,4.856 95.808,5.4 C94.832,5.944 94.06,6.724 93.492,7.74 C92.924,8.756 92.64,9.936 92.64,11.28 C92.64,12.624 92.924,13.808 93.492,14.832 C94.06,15.856 94.832,16.644 95.808,17.196 C96.784,17.748 97.864,18.024 99.048,18.024 Z M100.008,14.4 C99.208,14.4 98.552,14.124 98.04,13.572 C97.528,13.02 97.272,12.256 97.272,11.28 C97.272,10.32 97.528,9.568 98.04,9.024 C98.552,8.48 99.208,8.208 100.008,8.208 C100.808,8.208 101.46,8.48 101.964,9.024 C102.468,9.568 102.72,10.32 102.72,11.28 C102.72,12.256 102.464,13.02 101.952,13.572 C101.44,14.124 100.792,14.4 100.008,14.4 Z M112.368,22.68 C113.728,22.68 114.88,22.356 115.824,21.708 C116.768,21.06 117.568,19.936 118.224,18.336 L118.224,18.336 L123.84,4.8 L119.496,4.8 L116.28,12.744 L113.088,4.8 L108.408,4.8 L113.976,17.976 C113.784,18.36 113.548,18.64 113.268,18.816 C112.988,18.992 112.632,19.08 112.2,19.08 C111.832,19.08 111.468,19.012 111.108,18.876 C110.748,18.74 110.44,18.552 110.184,18.312 L110.184,18.312 L108.6,21.504 C109.032,21.856 109.596,22.14 110.292,22.356 C110.988,22.572 111.68,22.68 112.368,22.68 Z" id=Study fill-opacity=0.85 fill=#000000></path></g></g></g></svg><svg class="logo-dark hidden" width=125px height=23px viewBox="0 0 125 23" version=1.1 xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink><title>BTCStudy</title><g id=页面-1 stroke=none stroke-width=1 fill=none fill-rule=evenodd><g id=首页-响应式 transform="translate(-249.000000, -23.000000)" fill-rule=nonzero><g id=BTCStudy transform="translate(249.680000, 23.192000)"><path d="M9.072,17.808 C11.312,17.808 13.024,17.408 14.208,16.608 C15.392,15.808 15.984,14.672 15.984,13.2 C15.984,12.192 15.712,11.332 15.168,10.62 C14.624,9.908 13.872,9.384 12.912,9.048 C13.632,8.68 14.188,8.18 14.58,7.548 C14.972,6.916 15.168,6.2 15.168,5.4 C15.168,4.056 14.608,2.988 13.488,2.196 C12.368,1.404 10.736,1.008 8.592,1.008 L8.592,1.008 L-5.68434189e-14,1.008 L-5.68434189e-14,17.808 L9.072,17.808 Z M7.968,7.68 L4.704,7.68 L4.704,4.44 L7.968,4.44 C9.568,4.44 10.368,4.976 10.368,6.048 C10.368,7.136 9.568,7.68 7.968,7.68 L7.968,7.68 Z M8.688,14.376 L4.704,14.376 L4.704,10.968 L8.688,10.968 C10.352,10.968 11.184,11.536 11.184,12.672 C11.184,13.808 10.352,14.376 8.688,14.376 L8.688,14.376 Z M26.544,17.808 L26.544,4.776 L31.68,4.776 L31.68,1.008 L16.632,1.008 L16.632,4.776 L21.792,4.776 L21.792,17.808 L26.544,17.808 Z M41.592,18.144 C43.128,18.144 44.512,17.872 45.744,17.328 C46.976,16.784 48,16 48.816,14.976 L48.816,14.976 L45.792,12.24 C44.704,13.552 43.384,14.208 41.832,14.208 C40.92,14.208 40.108,14.008 39.396,13.608 C38.684,13.208 38.132,12.644 37.74,11.916 C37.348,11.188 37.152,10.352 37.152,9.408 C37.152,8.464 37.348,7.628 37.74,6.9 C38.132,6.172 38.684,5.608 39.396,5.208 C40.108,4.808 40.92,4.608 41.832,4.608 C43.384,4.608 44.704,5.264 45.792,6.576 L45.792,6.576 L48.816,3.84 C48,2.816 46.976,2.032 45.744,1.488 C44.512,0.944 43.128,0.672 41.592,0.672 C39.832,0.672 38.252,1.044 36.852,1.788 C35.452,2.532 34.352,3.568 33.552,4.896 C32.752,6.224 32.352,7.728 32.352,9.408 C32.352,11.088 32.752,12.592 33.552,13.92 C34.352,15.248 35.452,16.284 36.852,17.028 C38.252,17.772 39.832,18.144 41.592,18.144 Z" id=BTC fill=#F2A900></path><path d="M56.64,18.144 C58.24,18.144 59.6,17.9 60.72,17.412 C61.84,16.924 62.68,16.272 63.24,15.456 C63.8,14.64 64.08,13.728 64.08,12.72 C64.08,11.552 63.772,10.628 63.156,9.948 C62.54,9.268 61.812,8.772 60.972,8.46 C60.132,8.148 59.072,7.856 57.792,7.584 C56.656,7.344 55.832,7.112 55.32,6.888 C54.808,6.664 54.552,6.328 54.552,5.88 C54.552,5.432 54.768,5.068 55.2,4.788 C55.632,4.508 56.32,4.368 57.264,4.368 C58.768,4.368 60.32,4.8 61.92,5.664 L61.92,5.664 L63.384,2.136 C62.568,1.656 61.624,1.292 60.552,1.044 C59.48,0.796 58.392,0.672 57.288,0.672 C55.672,0.672 54.308,0.912 53.196,1.392 C52.084,1.872 51.248,2.524 50.688,3.348 C50.128,4.172 49.848,5.096 49.848,6.12 C49.848,7.288 50.152,8.216 50.76,8.904 C51.368,9.592 52.096,10.092 52.944,10.404 C53.792,10.716 54.848,11.008 56.112,11.28 C57.264,11.536 58.1,11.78 58.62,12.012 C59.14,12.244 59.4,12.6 59.4,13.08 C59.4,13.992 58.488,14.448 56.664,14.448 C55.704,14.448 54.728,14.296 53.736,13.992 C52.744,13.688 51.872,13.288 51.12,12.792 L51.12,12.792 L49.56,16.296 C50.36,16.856 51.4,17.304 52.68,17.64 C53.96,17.976 55.28,18.144 56.64,18.144 Z M71.856,18.024 C72.48,18.024 73.068,17.96 73.62,17.832 C74.172,17.704 74.64,17.52 75.024,17.28 L75.024,17.28 L73.896,14.088 C73.496,14.36 73.032,14.496 72.504,14.496 C72.088,14.496 71.756,14.364 71.508,14.1 C71.26,13.836 71.136,13.472 71.136,13.008 L71.136,13.008 L71.136,8.688 L74.112,8.688 L74.112,5.28 L71.136,5.28 L71.136,1.896 L66.576,1.896 L66.576,5.28 L64.68,5.28 L64.68,8.688 L66.576,8.688 L66.576,13.056 C66.576,14.704 67.032,15.944 67.944,16.776 C68.856,17.608 70.16,18.024 71.856,18.024 Z M82.248,18.024 C83,18.024 83.712,17.888 84.384,17.616 C85.056,17.344 85.632,16.944 86.112,16.416 L86.112,16.416 L86.112,17.808 L90.456,17.808 L90.456,4.8 L85.896,4.8 L85.896,11.064 C85.896,12.104 85.668,12.876 85.212,13.38 C84.756,13.884 84.168,14.136 83.448,14.136 C82.744,14.136 82.208,13.912 81.84,13.464 C81.472,13.016 81.288,12.304 81.288,11.328 L81.288,11.328 L81.288,4.8 L76.728,4.8 L76.728,12.072 C76.728,14.056 77.228,15.544 78.228,16.536 C79.228,17.528 80.568,18.024 82.248,18.024 Z M99.048,18.024 C100.744,18.024 102.016,17.52 102.864,16.512 L102.864,16.512 L102.864,17.808 L107.208,17.808 L107.208,0 L102.648,0 L102.648,5.928 C101.8,5.032 100.6,4.584 99.048,4.584 C97.864,4.584 96.784,4.856 95.808,5.4 C94.832,5.944 94.06,6.724 93.492,7.74 C92.924,8.756 92.64,9.936 92.64,11.28 C92.64,12.624 92.924,13.808 93.492,14.832 C94.06,15.856 94.832,16.644 95.808,17.196 C96.784,17.748 97.864,18.024 99.048,18.024 Z M100.008,14.4 C99.208,14.4 98.552,14.124 98.04,13.572 C97.528,13.02 97.272,12.256 97.272,11.28 C97.272,10.32 97.528,9.568 98.04,9.024 C98.552,8.48 99.208,8.208 100.008,8.208 C100.808,8.208 101.46,8.48 101.964,9.024 C102.468,9.568 102.72,10.32 102.72,11.28 C102.72,12.256 102.464,13.02 101.952,13.572 C101.44,14.124 100.792,14.4 100.008,14.4 Z M112.368,22.68 C113.728,22.68 114.88,22.356 115.824,21.708 C116.768,21.06 117.568,19.936 118.224,18.336 L118.224,18.336 L123.84,4.8 L119.496,4.8 L116.28,12.744 L113.088,4.8 L108.408,4.8 L113.976,17.976 C113.784,18.36 113.548,18.64 113.268,18.816 C112.988,18.992 112.632,19.08 112.2,19.08 C111.832,19.08 111.468,19.012 111.108,18.876 C110.748,18.74 110.44,18.552 110.184,18.312 L110.184,18.312 L108.6,21.504 C109.032,21.856 109.596,22.14 110.292,22.356 C110.988,22.572 111.68,22.68 112.368,22.68 Z" id=Study fill-opacity=0.85 fill=#FFFFFF></path></g></g></g></svg></a></h1></section><div class="is-flex is-flex-direction-column header-menu-wrap"><aside class="is-flex-shrink-0 is-flex is-flex-direction-row is-align-items-center" id=header-menu><a class="is-inline-block header-activity mr-4" href=/ >首页</a><a class="is-inline-block mr-4" href=/archives>全站目录</a><a class="is-inline-block mr-4" href=/tags>标签</a><a class="is-inline-block mr-4" href=/maps>地图</a><a class="is-inline-block mr-4" href=/mempool>mempool</a><a class="is-inline-block mr-4" target=_blank rel=noopener href=https://123btc.org/ >123btc</a><div class="right-content is-flex is-flex-direction-row is-align-items-center"><div class="size-wrap mr-1"><i class="iconfont icon-a-bianzu5" id=change-size-btn></i><div class=size-input-wrap><div class=input-wrap><input id=size-change-input type=range min=12 max=32 step=2></div></div></div><i class="iconfont icon-icon_dark mr-1" id=theme-btn></i><div class=search-wrap><input class=pl-3 id=search-input placeholder=请输入搜索关键词><i class="iconfont icon-icon_search" id=search-input-btn></i></div></div></aside><div class="header-title is-hidden-mobile is-full-height is-flex is-align-items-center is-flex-shrink-0"><div class="is-full-height hidden" id=postTopic><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">BIP352：静默支付的现在和未来</p><div class="size-wrap mr-1"><i class="iconfont icon-a-bianzu5" id=change-size-btn2></i><div class=size-input-wrap><div class=input-wrap><input id=size-change-input2 type=range min=12 max=32 step=2></div></div></div></div></div></div></div></header><header class="is-flex header-widget is-flex-shrink-0 is-align-items-center is-justify-content-space-between is-hidden-tablet" id=mobile-header><div class="is-flex is-flex-direction-row is-align-items-center"><i class="iconfont icon-icon_bar mobile-header-menu"></i><div id=mobile-header-logo><svg class=logo-light width=125px height=23px viewBox="0 0 125 23" version=1.1 xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink><title>BTCStudy</title><g id=页面-1 stroke=none stroke-width=1 fill=none fill-rule=evenodd><g id=首页-响应式 transform="translate(-249.000000, -23.000000)" fill-rule=nonzero><g id=BTCStudy transform="translate(249.680000, 23.192000)"><path d="M9.072,17.808 C11.312,17.808 13.024,17.408 14.208,16.608 C15.392,15.808 15.984,14.672 15.984,13.2 C15.984,12.192 15.712,11.332 15.168,10.62 C14.624,9.908 13.872,9.384 12.912,9.048 C13.632,8.68 14.188,8.18 14.58,7.548 C14.972,6.916 15.168,6.2 15.168,5.4 C15.168,4.056 14.608,2.988 13.488,2.196 C12.368,1.404 10.736,1.008 8.592,1.008 L8.592,1.008 L-5.68434189e-14,1.008 L-5.68434189e-14,17.808 L9.072,17.808 Z M7.968,7.68 L4.704,7.68 L4.704,4.44 L7.968,4.44 C9.568,4.44 10.368,4.976 10.368,6.048 C10.368,7.136 9.568,7.68 7.968,7.68 L7.968,7.68 Z M8.688,14.376 L4.704,14.376 L4.704,10.968 L8.688,10.968 C10.352,10.968 11.184,11.536 11.184,12.672 C11.184,13.808 10.352,14.376 8.688,14.376 L8.688,14.376 Z M26.544,17.808 L26.544,4.776 L31.68,4.776 L31.68,1.008 L16.632,1.008 L16.632,4.776 L21.792,4.776 L21.792,17.808 L26.544,17.808 Z M41.592,18.144 C43.128,18.144 44.512,17.872 45.744,17.328 C46.976,16.784 48,16 48.816,14.976 L48.816,14.976 L45.792,12.24 C44.704,13.552 43.384,14.208 41.832,14.208 C40.92,14.208 40.108,14.008 39.396,13.608 C38.684,13.208 38.132,12.644 37.74,11.916 C37.348,11.188 37.152,10.352 37.152,9.408 C37.152,8.464 37.348,7.628 37.74,6.9 C38.132,6.172 38.684,5.608 39.396,5.208 C40.108,4.808 40.92,4.608 41.832,4.608 C43.384,4.608 44.704,5.264 45.792,6.576 L45.792,6.576 L48.816,3.84 C48,2.816 46.976,2.032 45.744,1.488 C44.512,0.944 43.128,0.672 41.592,0.672 C39.832,0.672 38.252,1.044 36.852,1.788 C35.452,2.532 34.352,3.568 33.552,4.896 C32.752,6.224 32.352,7.728 32.352,9.408 C32.352,11.088 32.752,12.592 33.552,13.92 C34.352,15.248 35.452,16.284 36.852,17.028 C38.252,17.772 39.832,18.144 41.592,18.144 Z" id=BTC fill=#F2A900></path><path d="M56.64,18.144 C58.24,18.144 59.6,17.9 60.72,17.412 C61.84,16.924 62.68,16.272 63.24,15.456 C63.8,14.64 64.08,13.728 64.08,12.72 C64.08,11.552 63.772,10.628 63.156,9.948 C62.54,9.268 61.812,8.772 60.972,8.46 C60.132,8.148 59.072,7.856 57.792,7.584 C56.656,7.344 55.832,7.112 55.32,6.888 C54.808,6.664 54.552,6.328 54.552,5.88 C54.552,5.432 54.768,5.068 55.2,4.788 C55.632,4.508 56.32,4.368 57.264,4.368 C58.768,4.368 60.32,4.8 61.92,5.664 L61.92,5.664 L63.384,2.136 C62.568,1.656 61.624,1.292 60.552,1.044 C59.48,0.796 58.392,0.672 57.288,0.672 C55.672,0.672 54.308,0.912 53.196,1.392 C52.084,1.872 51.248,2.524 50.688,3.348 C50.128,4.172 49.848,5.096 49.848,6.12 C49.848,7.288 50.152,8.216 50.76,8.904 C51.368,9.592 52.096,10.092 52.944,10.404 C53.792,10.716 54.848,11.008 56.112,11.28 C57.264,11.536 58.1,11.78 58.62,12.012 C59.14,12.244 59.4,12.6 59.4,13.08 C59.4,13.992 58.488,14.448 56.664,14.448 C55.704,14.448 54.728,14.296 53.736,13.992 C52.744,13.688 51.872,13.288 51.12,12.792 L51.12,12.792 L49.56,16.296 C50.36,16.856 51.4,17.304 52.68,17.64 C53.96,17.976 55.28,18.144 56.64,18.144 Z M71.856,18.024 C72.48,18.024 73.068,17.96 73.62,17.832 C74.172,17.704 74.64,17.52 75.024,17.28 L75.024,17.28 L73.896,14.088 C73.496,14.36 73.032,14.496 72.504,14.496 C72.088,14.496 71.756,14.364 71.508,14.1 C71.26,13.836 71.136,13.472 71.136,13.008 L71.136,13.008 L71.136,8.688 L74.112,8.688 L74.112,5.28 L71.136,5.28 L71.136,1.896 L66.576,1.896 L66.576,5.28 L64.68,5.28 L64.68,8.688 L66.576,8.688 L66.576,13.056 C66.576,14.704 67.032,15.944 67.944,16.776 C68.856,17.608 70.16,18.024 71.856,18.024 Z M82.248,18.024 C83,18.024 83.712,17.888 84.384,17.616 C85.056,17.344 85.632,16.944 86.112,16.416 L86.112,16.416 L86.112,17.808 L90.456,17.808 L90.456,4.8 L85.896,4.8 L85.896,11.064 C85.896,12.104 85.668,12.876 85.212,13.38 C84.756,13.884 84.168,14.136 83.448,14.136 C82.744,14.136 82.208,13.912 81.84,13.464 C81.472,13.016 81.288,12.304 81.288,11.328 L81.288,11.328 L81.288,4.8 L76.728,4.8 L76.728,12.072 C76.728,14.056 77.228,15.544 78.228,16.536 C79.228,17.528 80.568,18.024 82.248,18.024 Z M99.048,18.024 C100.744,18.024 102.016,17.52 102.864,16.512 L102.864,16.512 L102.864,17.808 L107.208,17.808 L107.208,0 L102.648,0 L102.648,5.928 C101.8,5.032 100.6,4.584 99.048,4.584 C97.864,4.584 96.784,4.856 95.808,5.4 C94.832,5.944 94.06,6.724 93.492,7.74 C92.924,8.756 92.64,9.936 92.64,11.28 C92.64,12.624 92.924,13.808 93.492,14.832 C94.06,15.856 94.832,16.644 95.808,17.196 C96.784,17.748 97.864,18.024 99.048,18.024 Z M100.008,14.4 C99.208,14.4 98.552,14.124 98.04,13.572 C97.528,13.02 97.272,12.256 97.272,11.28 C97.272,10.32 97.528,9.568 98.04,9.024 C98.552,8.48 99.208,8.208 100.008,8.208 C100.808,8.208 101.46,8.48 101.964,9.024 C102.468,9.568 102.72,10.32 102.72,11.28 C102.72,12.256 102.464,13.02 101.952,13.572 C101.44,14.124 100.792,14.4 100.008,14.4 Z M112.368,22.68 C113.728,22.68 114.88,22.356 115.824,21.708 C116.768,21.06 117.568,19.936 118.224,18.336 L118.224,18.336 L123.84,4.8 L119.496,4.8 L116.28,12.744 L113.088,4.8 L108.408,4.8 L113.976,17.976 C113.784,18.36 113.548,18.64 113.268,18.816 C112.988,18.992 112.632,19.08 112.2,19.08 C111.832,19.08 111.468,19.012 111.108,18.876 C110.748,18.74 110.44,18.552 110.184,18.312 L110.184,18.312 L108.6,21.504 C109.032,21.856 109.596,22.14 110.292,22.356 C110.988,22.572 111.68,22.68 112.368,22.68 Z" id=Study fill-opacity=0.85 fill=#000000></path></g></g></g></svg><svg class="logo-dark hidden" width=125px height=23px viewBox="0 0 125 23" version=1.1 xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink><title>BTCStudy</title><g id=页面-1 stroke=none stroke-width=1 fill=none fill-rule=evenodd><g id=首页-响应式 transform="translate(-249.000000, -23.000000)" fill-rule=nonzero><g id=BTCStudy transform="translate(249.680000, 23.192000)"><path d="M9.072,17.808 C11.312,17.808 13.024,17.408 14.208,16.608 C15.392,15.808 15.984,14.672 15.984,13.2 C15.984,12.192 15.712,11.332 15.168,10.62 C14.624,9.908 13.872,9.384 12.912,9.048 C13.632,8.68 14.188,8.18 14.58,7.548 C14.972,6.916 15.168,6.2 15.168,5.4 C15.168,4.056 14.608,2.988 13.488,2.196 C12.368,1.404 10.736,1.008 8.592,1.008 L8.592,1.008 L-5.68434189e-14,1.008 L-5.68434189e-14,17.808 L9.072,17.808 Z M7.968,7.68 L4.704,7.68 L4.704,4.44 L7.968,4.44 C9.568,4.44 10.368,4.976 10.368,6.048 C10.368,7.136 9.568,7.68 7.968,7.68 L7.968,7.68 Z M8.688,14.376 L4.704,14.376 L4.704,10.968 L8.688,10.968 C10.352,10.968 11.184,11.536 11.184,12.672 C11.184,13.808 10.352,14.376 8.688,14.376 L8.688,14.376 Z M26.544,17.808 L26.544,4.776 L31.68,4.776 L31.68,1.008 L16.632,1.008 L16.632,4.776 L21.792,4.776 L21.792,17.808 L26.544,17.808 Z M41.592,18.144 C43.128,18.144 44.512,17.872 45.744,17.328 C46.976,16.784 48,16 48.816,14.976 L48.816,14.976 L45.792,12.24 C44.704,13.552 43.384,14.208 41.832,14.208 C40.92,14.208 40.108,14.008 39.396,13.608 C38.684,13.208 38.132,12.644 37.74,11.916 C37.348,11.188 37.152,10.352 37.152,9.408 C37.152,8.464 37.348,7.628 37.74,6.9 C38.132,6.172 38.684,5.608 39.396,5.208 C40.108,4.808 40.92,4.608 41.832,4.608 C43.384,4.608 44.704,5.264 45.792,6.576 L45.792,6.576 L48.816,3.84 C48,2.816 46.976,2.032 45.744,1.488 C44.512,0.944 43.128,0.672 41.592,0.672 C39.832,0.672 38.252,1.044 36.852,1.788 C35.452,2.532 34.352,3.568 33.552,4.896 C32.752,6.224 32.352,7.728 32.352,9.408 C32.352,11.088 32.752,12.592 33.552,13.92 C34.352,15.248 35.452,16.284 36.852,17.028 C38.252,17.772 39.832,18.144 41.592,18.144 Z" id=BTC fill=#F2A900></path><path d="M56.64,18.144 C58.24,18.144 59.6,17.9 60.72,17.412 C61.84,16.924 62.68,16.272 63.24,15.456 C63.8,14.64 64.08,13.728 64.08,12.72 C64.08,11.552 63.772,10.628 63.156,9.948 C62.54,9.268 61.812,8.772 60.972,8.46 C60.132,8.148 59.072,7.856 57.792,7.584 C56.656,7.344 55.832,7.112 55.32,6.888 C54.808,6.664 54.552,6.328 54.552,5.88 C54.552,5.432 54.768,5.068 55.2,4.788 C55.632,4.508 56.32,4.368 57.264,4.368 C58.768,4.368 60.32,4.8 61.92,5.664 L61.92,5.664 L63.384,2.136 C62.568,1.656 61.624,1.292 60.552,1.044 C59.48,0.796 58.392,0.672 57.288,0.672 C55.672,0.672 54.308,0.912 53.196,1.392 C52.084,1.872 51.248,2.524 50.688,3.348 C50.128,4.172 49.848,5.096 49.848,6.12 C49.848,7.288 50.152,8.216 50.76,8.904 C51.368,9.592 52.096,10.092 52.944,10.404 C53.792,10.716 54.848,11.008 56.112,11.28 C57.264,11.536 58.1,11.78 58.62,12.012 C59.14,12.244 59.4,12.6 59.4,13.08 C59.4,13.992 58.488,14.448 56.664,14.448 C55.704,14.448 54.728,14.296 53.736,13.992 C52.744,13.688 51.872,13.288 51.12,12.792 L51.12,12.792 L49.56,16.296 C50.36,16.856 51.4,17.304 52.68,17.64 C53.96,17.976 55.28,18.144 56.64,18.144 Z M71.856,18.024 C72.48,18.024 73.068,17.96 73.62,17.832 C74.172,17.704 74.64,17.52 75.024,17.28 L75.024,17.28 L73.896,14.088 C73.496,14.36 73.032,14.496 72.504,14.496 C72.088,14.496 71.756,14.364 71.508,14.1 C71.26,13.836 71.136,13.472 71.136,13.008 L71.136,13.008 L71.136,8.688 L74.112,8.688 L74.112,5.28 L71.136,5.28 L71.136,1.896 L66.576,1.896 L66.576,5.28 L64.68,5.28 L64.68,8.688 L66.576,8.688 L66.576,13.056 C66.576,14.704 67.032,15.944 67.944,16.776 C68.856,17.608 70.16,18.024 71.856,18.024 Z M82.248,18.024 C83,18.024 83.712,17.888 84.384,17.616 C85.056,17.344 85.632,16.944 86.112,16.416 L86.112,16.416 L86.112,17.808 L90.456,17.808 L90.456,4.8 L85.896,4.8 L85.896,11.064 C85.896,12.104 85.668,12.876 85.212,13.38 C84.756,13.884 84.168,14.136 83.448,14.136 C82.744,14.136 82.208,13.912 81.84,13.464 C81.472,13.016 81.288,12.304 81.288,11.328 L81.288,11.328 L81.288,4.8 L76.728,4.8 L76.728,12.072 C76.728,14.056 77.228,15.544 78.228,16.536 C79.228,17.528 80.568,18.024 82.248,18.024 Z M99.048,18.024 C100.744,18.024 102.016,17.52 102.864,16.512 L102.864,16.512 L102.864,17.808 L107.208,17.808 L107.208,0 L102.648,0 L102.648,5.928 C101.8,5.032 100.6,4.584 99.048,4.584 C97.864,4.584 96.784,4.856 95.808,5.4 C94.832,5.944 94.06,6.724 93.492,7.74 C92.924,8.756 92.64,9.936 92.64,11.28 C92.64,12.624 92.924,13.808 93.492,14.832 C94.06,15.856 94.832,16.644 95.808,17.196 C96.784,17.748 97.864,18.024 99.048,18.024 Z M100.008,14.4 C99.208,14.4 98.552,14.124 98.04,13.572 C97.528,13.02 97.272,12.256 97.272,11.28 C97.272,10.32 97.528,9.568 98.04,9.024 C98.552,8.48 99.208,8.208 100.008,8.208 C100.808,8.208 101.46,8.48 101.964,9.024 C102.468,9.568 102.72,10.32 102.72,11.28 C102.72,12.256 102.464,13.02 101.952,13.572 C101.44,14.124 100.792,14.4 100.008,14.4 Z M112.368,22.68 C113.728,22.68 114.88,22.356 115.824,21.708 C116.768,21.06 117.568,19.936 118.224,18.336 L118.224,18.336 L123.84,4.8 L119.496,4.8 L116.28,12.744 L113.088,4.8 L108.408,4.8 L113.976,17.976 C113.784,18.36 113.548,18.64 113.268,18.816 C112.988,18.992 112.632,19.08 112.2,19.08 C111.832,19.08 111.468,19.012 111.108,18.876 C110.748,18.74 110.44,18.552 110.184,18.312 L110.184,18.312 L108.6,21.504 C109.032,21.856 109.596,22.14 110.292,22.356 C110.988,22.572 111.68,22.68 112.368,22.68 Z" id=Study fill-opacity=0.85 fill=#FFFFFF></path></g></g></g></svg></div><div class="mobile-header-title is-full-height is-flex is-align-items-center is-flex-shrink-0"><div class="is-full-height hidden" id=postTopicMobile><p class=is-full-height>BIP352：静默支付的现在和未来</p></div></div></div><i class="iconfont icon-icon_search mobile-header-searchIcon"></i><div class=mobile-search-wrap><div class=search-input><input class=pl-3 id=mobile-search-input placeholder=请输入搜索关键词><i class="iconfont icon-icon_search mobile-search-input-btn"></i><button class=mobile-search-input-btn>搜 索</button></div></div></header><div class=mobile-slide-menu><a class=header-activity href=/ >首页</a><a href=/archives>全站目录</a><a href=/tags>标签</a><a href=/maps>地图</a><a href=/mempool>mempool</a><a target=_blank rel=noopener href=https://123btc.org/ >123btc</a><div><p class="slide-menu-theme is-flex is-flex-direction-row is-justify-content-space-between is-align-items-center"><span>主题设置</span><span><i class="iconfont icon-icon_light slide-theme-light hidden"></i><i class="iconfont icon-icon_dark slide-theme-dark hidden"></i></span></p><p class=slide-menu-fontsize><span>字体设置</span><span><i class="iconfont icon-bianzubeifen"></i><i class="iconfont icon-bianzu"></i></span></p></div></div><div class="search-mask hidden"><script src="/js/header.js?v=1682773100887"></script></div><main><main class="container is-max-widescreen content section post-page pt-4"><div class="columns is-flex-desktop is-justify-content-center"><div class="column is-3 silde-bar is-hidden-mobile"><ol class=toc><li class="toc-item toc-level-2"><a class=toc-link href=#%E9%9D%99%E9%BB%98%E6%94%AF%E4%BB%98%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5><span class=toc-text>静默支付的基本概念</span></a></li><li class="toc-item toc-level-2"><a class=toc-link href=#BIP352%EF%BC%9A%E7%AC%AC%E4%B8%80%E4%B8%AA%E9%9D%99%E9%BB%98%E6%94%AF%E4%BB%98-BIP><span class=toc-text>BIP352：第一个静默支付 BIP</span></a></li><li class="toc-item toc-level-2"><a class=toc-link href=#%E4%B8%A4%E7%A7%8D%E5%B7%A5%E4%BD%9C%E6%A8%A1%E5%BC%8F%E5%92%8C%E6%89%AB%E6%8F%8F%E8%B4%9F%E6%8B%85><span class=toc-text>两种工作模式和扫描负担</span></a></li><li class="toc-item toc-level-2"><a class=toc-link href=#%E9%9D%99%E9%BB%98%E6%94%AF%E4%BB%98%E7%9A%84%E7%8E%B0%E5%9C%A8%E5%92%8C%E6%9C%AA%E6%9D%A5><span class=toc-text>静默支付的现在和未来</span></a></li><li class="toc-item toc-level-2"><a class=toc-link href=#%E8%84%9A%E6%B3%A8><span class=toc-text>脚注</span></a></li></ol></div><div class="column is-9 post-container"><h1 class="mt-0 mb-2" id=postTitle>BIP352：静默支付的现在和未来</h1><div class=page-author><div class="is-flex is-flex-direction-row page-data mr-6"><img class=mr-1 src=/images/default_avatar.png alt=Anony><div class=page-author-info><strong>Anony</strong><time class=has-text-grey datetime=2025-03-28T12:39:33.000Z>2025-03-28</time></div></div><div class=is-flex><a href=/tags/%E9%9D%99%E9%BB%98%E6%94%AF%E4%BB%98><i class="page-tag mr-1 px-1">静默支付</i></a></div></div><article class="mt-4 post-content"><blockquote><p><em>作者：Anony</em></p></blockquote><p>“静默支付（Silent Payments）” 是一种为实现静态收款标识符同时兼顾隐私性要求而提出的解决方案。使用它，支付接收者只需公开一个稳定不变的标识符（可以视为一种特殊的地址），发送者将在支付发送过程中为接收者创造出不重复的新比特币地址。</p><p>本文尝试解释其基本概念、第一个关于静默支付的比特币强化提议 BIP352 <sup><a href=#note5 id=jump-5>[5]</a></sup>，并基于 BIP352 的规范展望静默支付的采用方式。</p><h2 id=静默支付的基本概念><a href=#静默支付的基本概念 class=headerlink title=静默支付的基本概念></a>静默支付的基本概念</h2><p>为理解静默支付的概念，我们先来回顾 “链上” 比特币（也即以区块链为交易确认方式）的支付过程：</p><ol><li>Alice 尝试给 Bob 支付，于是向 Bob 请求一个 Bob 能够使用的比特币脚本（地址是这样的脚本的一种紧凑、防止错误的表现形式 <sup><a href=#note1 id=jump-1>[1]</a></sup>）；</li><li>Bob 给 Alice 回复一个地址；</li><li>Alice 将该地址复制到自己的比特币钱包软件中，补充完其它交易细节后广播交易、让交易获得区块链确认；</li><li>Bob 的软件在收到新的区块中，根据 Bob 存储的信息（比如地址）扫描匹配的交易；如果命中，则存储交易的信息，并将相关的交易输出标记为自身可以使用的资金。</li></ol><p>此过程跟以下几点有关联：</p><ol><li>隐私性。如果 Bob 给出的是一个已经使用过的地址，那就会增加该地址被 “去匿名化（deanonymization）” —— 被第三方侦测出该地址的真实主人 —— 的风险。这种损害隐私性的习惯称作 “地址复用”，复用得越多，去匿名化的风险也就越严重。</li><li>交互性。在上述过程中，Bob 会跟 Alice 交互，给 Alice 提供地址。可以看出，这种交互一定程度上是一种麻烦，但考虑到隐私性，其价值又是显而易见的：Bob 可以借由这种交互的机会，给出新的地址、避免地址复用。</li><li>备份便利性。只要 Bob 不是在收到支付后立即花掉，就会让比特币在自己的地址中停留，这就产生了备份该地址的密钥信息的需要。考虑到隐私性，Bob 应该为每一笔新支付生成一个新地址，但是如何便利地备份呢？</li></ol><p>在当前的比特币保管方案中，BIP-32 分层确定性钱包方案，解决了上述隐私性与备份便利性的矛盾 <sup><a href=#note2 id=jump-2>[2]</a></sup>：Bob 使用的密钥都从同一个种子经过确定的步骤派生出来；由于这些密钥都有同一个源头，因此 Bob 只需备份这个种子即可（最多需要额外备份极少量的派生步骤信息）；而由于派生的步骤具有单向性，第三方无法从这些密钥的公钥中推断出他们属于同一个源头，也很好地保证了隐私性。</p><p>唯一尚不如人意的地方是，交互需求依然存在。每一个支付者都必须先跟 Bob 建立通信、获得一个新地址，然后才能发起支付。有没有能够实现静态的收款标识符（地址）、又不牺牲隐私性的办法呢？</p><p>静默支付概念的提出者 Ruben Somsen 曾在一场演讲中集中地讨论可能的解决方案 <sup><a href=#note3 id=jump-3>[3]</a></sup>，静默支付也属于其中之一，而且显示了一种特殊的（可以说有些激进的）取舍：通过增加接收者 Bob 的扫描负担（即上述支付过程第 4 个步骤的复杂性），来消除交互需要。</p><p>静默支付运用了一个叫做 “迪菲-赫尔曼 密钥交互（Diffie–Hellman key exchange）” 的概念（它跟 “公钥密码学” 的概念同龄！ <sup><a href=#note4 id=jump-4>[4]</a></sup>）：如果 Alice 和 Bob 各有一对公私密钥对，那么他们只需知晓对方的公钥，凭借一个简单的操作，就可以获得一个只有他们彼此知晓的共享秘密信息：以己方的私钥乘以对方的公钥。</p><blockquote><p>由于私钥与公钥间的数学关系，当 Alice 拿自己的私钥乘以 Bob 的公钥时，得到的数值会跟 Bob 以自己的私钥乘以 Alice 的公钥得出的结果相同。</p><p>我们以基于椭圆曲线的公私钥为例，Alice 的公钥 A 是私钥 a 与椭圆曲线点 G 运行点乘法得到的；Bob 的密钥对类同。那么：<code>a.B = a*b.G = b*a.G = b.A</code>。这叫做 “ECDH（椭圆曲线上的 DH 密钥交换）”。</p><p>根据定义，只有知晓其中一个私钥的人才能获得这个秘密值，所以其他人都不知道，只有他们彼此知道。</p></blockquote><p>设想一下，如果 Bob 提前公开了自己的一个公钥，那么 Alice 无需再与他交互，就可以凭借自己的私钥，得出一个新的秘密值，然后凭此秘密值派生出一个新的公钥（再派生出相应的地址）。比如说，这个新公钥是 Bob 的公钥加上共享秘密值的哈希值的椭圆曲线点：<code>New PK = B + H(a.B).G</code>；这个公钥背后的私钥是：<code>New sk = b + H(b.A)</code>。显然，只有 Alice 和 Bob 才能知道这个公钥是如何构造出来的，因为其中用到了只有他们知晓的共享秘密值；而且，只有 Bob 才能花费这个地址里的资金（因为其私钥 b 只有他知道，Alice 也不知道）。</p><p>这种办法满足了上述三个要求：（1）只要 Alice 不复用私钥，就不会得到相同的地址；（2）Alice 不再需要跟 Bob 交互，可以直接构造出只有 Bob 能够花费的地址；（3）Bob 也不需要为每一个新地址备份密钥材料，因为从一定意义上来说，它们也都是从同一个种子（密钥对）中派生出来的。</p><p>然而，问题是，Alice 怎么告诉 Bob 自己用到了哪一对密钥呢？如果 Bob 不知道 Alice 的公钥，这一套把戏不就没法玩下去了吗？</p><p>这就是静默支付与以往的类似概念更激进的地方：它要求 Alice 使用交易输入中用到的公钥，而不用其它手段传达这些信息（比如额外的 OP_RETURN 交易输出），从而，运用了上述密钥交换技巧的交易在外观上跟不使用这类技巧的交易看起来毫无分别！这就最大限度地满足了隐私性的要求，而发掘隐秘信息的任务就完全交给了 Bob。</p><p>以上就是静默支付的基本概念。接下来，我们看看 BIP352 如何为上述静默支付的骨架增加血肉、使之成为一种可用的技术，其各项规范又如何影响支付接收者 Bob 的扫描负担。</p><h2 id=BIP352：第一个静默支付-BIP><a href=#BIP352：第一个静默支付-BIP class=headerlink title="BIP352：第一个静默支付 BIP"></a>BIP352：第一个静默支付 BIP</h2><p>BIP352 编写得很好，在概述部分遵循了逐步推进的流程，详述部分也相当严谨。为平衡介绍其中内容的需要和本文的目的，将其主要设计目的和抉择重述如下：</p><ul><li>生态兼容性<ul><li>BIP352 使用 Bech32m 编码法 <sup><a href=#note6 id=jump-6>[6]</a></sup> 来编码静默支付的收款地址。<ul><li>这一设计使得支持 P2TR 输出的比特币软件无需额外实现新的编解码方法，只需微调就可以从静默支付地址解码出所需的信息。</li><li>这一设计同样使我们可以定义多种版本的静默支付协议。BIP352 就被定义为 “v0 的静默支付协议”。</li></ul></li></ul></li><li>保管安全性<ul><li>在 BIP352 静默支付地址中包含的不是一个公钥，而是两个公钥，分别称作 “扫描公钥” 和 “花费公钥”。扫描与自己有关的支付需要知晓 “扫描私钥”，但不需要知道 “花费私钥”。<ul><li>因此使用者可以将花费私钥存储在更安全的设备（比如设计良好的签名器）中。</li></ul></li></ul></li><li>隐私性<ul><li>将交易输入的 “输出点（outpoint）” 也加入共享秘密值的推导。输出点是一个 UTXO 的唯一标识符，由创造该 UTXO 的交易的 id 以及该 UTXO 在交易输出间的序号组成。<ul><li>这一设计避免了 Alice（支付发起方）复用 地址&#x2F;公钥 给 Bob（支付接收方）带来的影响。只要交易 ID 不重合 <sup><a href=#note7 id=jump-7>[7]</a></sup>，各 UTXO 的输出点就都是唯一的，即使使用了相同的公钥，派生出来的共享秘密值也将不同，从而不会给 Bob 生成相同的地址。</li></ul></li><li>全部输入都参与共享秘密值的推导。取得所有交易输入的输出点中最小的那一个，来推导共享秘密值。并且，Alice 也使用所有符合要求的输入所用的私钥，来推导共享秘密值。<ul><li>这一设计也有助于避免 Bob 辨识出哪个输入来自 Alice。</li></ul></li><li>兼容尽可能多的输入类型。BIP352 将 “P2PKH”、“P2WPKH”、“P2SH-P2WPKH” 和 “P2TR” 都定义为符合要求的输入，也即支付者可以拿这些地址类型上的资金来发起静默支付。<ul><li>了解比特币输入类型的读者可以看出，这几乎囊括了所有单公钥控制的标准化脚本。对输入类型的要求越少，也就意味着可能发起静默支付的用户群体规模越大，同时也意味着它跟常规支付的差异越小、越不可能被辨识出来。</li><li>同时，因为上一点的要求，支付者在构造静默支付的交易时，必须确保自己能让每一个符合要求的交易输入的私钥都能参与共享秘密值的推导。</li></ul></li><li>在接收者比特币地址的派生中使用额外的序号，允许支付者在一笔交易中将真实的支付额分散在多个不同的地址中。<ul><li>这可以用来对付基于资金数额的猜测。</li></ul></li></ul></li><li>扫描便利性&#x2F;管理便利性<ul><li>上述 “使用全部输入” 的设计也便于 Bob 扫描支付。</li><li>仅允许为 Bob 安排 P2TR 输出。</li><li>允许 Bob 使用同一组扫描密钥和花费密钥生成多个静默支付地址，办法是通过额外的标签生成多个花费公钥。<ul><li>Bob 无需额外的备份，就可以生成多个静默支付地址、为不同的 支付方&#x2F;支付目的 安排不同的地址。</li></ul></li></ul></li></ul><p>以上即是 BIP352 的大致内容。</p><p>基于上述设计，支付接收者 Bob 在区块链上扫描与自己有关的静默支付交易时的流程大致如下：</p><ol><li>首先，Bob 要先找出一个区块中潜在的静默支付交易（在 BIP352 中被称为 “eligible transaction”）；<ul><li>潜在交易的判断标准有三个：（1）具备 P2TR 输出；（2）包含至少一个上述允许使用类型的输入；（3）不得包含比隔离见证 v1 更高版本的输入。在这里，只有第一个标准的应用仅需交易本身的信息；后面两个标准都要求我们获得输入的前序输出的脚本公钥，才能执行判断，而这种信息是隐式的，并不会在交易中体现出来。</li></ul></li><li>而后，Bob 需要遍历一笔潜在交易的所有输入，一方面要找出最小的输出点，另一方面要从上述可使用类型的输入中提取出公钥并加总起来；<ul><li>这一过程会得出共享秘密值推导所需的两个关键信息，一个是包含了最小输出点信息的哈希值，在 BIP352 中叫做 “input_hash”；另一个则是所有合格输入的公钥之和，在 BIP352 中记作 “A”。</li></ul></li><li>最后，Bob 要运用 input_hash、A 和自己的扫描私钥派生出共享秘密值，再根据自己的花费公钥派生出一个公钥和对应的 P2TR 脚本；然后检查该交易的输出中存不存在这样的 P2TR 输出，如果有，则将这样的交易和输出保存下来，标记为自己可以花费的资金，如果没有，则表明该交易与自己不相关。</li></ol><p>敏锐的读者可以发现，上述 1 和 2 两个步骤，正是BIP352 在 “静默支付” 的基础概念上做出的两个关键设计的直接后果：（1）在派生支付发送方和接收方的共享秘密值时，使用全部交易输入的信息；（2）尽可能支持多种输入类型。这样的扫描负担，显然会影响静默支付的采用（或者说，这种成本会限制其应用场景）。</p><p>接下来，我们讨论 BIP352 静默支付钱包可能的工作模式，并使用比较法来理解其扫描负担。</p><h2 id=两种工作模式和扫描负担><a href=#两种工作模式和扫描负担 class=headerlink title=两种工作模式和扫描负担></a>两种工作模式和扫描负担</h2><p>分析上述接收者扫描流程可以发现：不论扫描者是 Bob 还是 Carol，他们都要运行扫描的前两个步骤，并且在两个步骤结束时得到的结果是相同的。也就是说，因为 BIP352 静默支付 “使用所有输入”，所以，一笔交易是否是潜在静默支付交易，以及（如果是）其 input_hash 和 A，是一种对所有静默支付接收者都同样有用的信息，一种可以复用的信息（实际上，接收者只需要获得这两者的乘积）。由此，可以想象的一种工作模式是 “服务端-客户端 模式” ：由服务端运行扫描的前两个步骤，并给客户端提供得到的结果；客户端仅根据本地的密钥信息运行最后一个步骤。这种模式就类似于常规钱包中的 “全节点-轻节点” 模式，可以大大减少客户端的工作量。</p><p>与之相对的是 “集成模式”，即不分拆工作量，三个步骤都由同一台计算机完成。</p><p>然而，更细致地考虑上述扫描步骤，并联系起全节点的工作模式，你会有更进一步的发现：</p><p>扫描步骤 1 和 2 需要获得一笔交易的所有输入的脚本公钥，用于判断输入的脚本类型，并根据脚本的类型执行相应的公钥提取步骤，仅凭暴露在交易中的信息，包括 “脚本签名（ScriptSig）” 和 “见证（txinwitness）”，是不够的。然而，全节点在验证新到达的区块中的交易时，本身也要求这些信息，并且，获得这些信息仅需要在 UTXO 集中搜索，不需要访问历史区块和历史交易（不触发较深的硬盘读取）。</p><p>也就是说，如果在验证新区块内交易的同时执行上述扫描步骤，那就是顺带的，额外开销完全来自于计算（输入输出的类型检查、公钥提取、共享秘密值推导、ECDH，等），客观来说这些计算量也不会太大；然而，如果我们使用一个单独的进程来运行扫描，则不仅要付出额外的计算开销，还需要额外的、较深的硬盘读取，因为新区块一旦验证完成，其中的交易的输入的脚本公钥就不再能从 UTXO 集中获得，只能通过访问历史交易来获得（并且，这里还多一项存储空间开销：为区块链上的所有交易编制索引，如果这样的索引不存在，则实际上无法读取历史交易，而同步 验证-扫描 模式并不需要为历史交易编制索引）。</p><p>由于这种显著的开销区别 <sup><a href=#note8 id=jump-8>[8]</a></sup>，我们补充 “集成模式” 的定义：扫描步骤作为区块验证的附属步骤，与区块验证同步完成。</p><p>请注意，补充完定义之后，“集成模式” 和 “服务端-客户端 模式” 的合集就不构成全集：有一种可能是，不分拆扫描的工作量，但扫描工作依然在一个独立的进程中完成。</p><p>构造这两种模式的定义仅仅是为了便于我们通过比较来理解 BIP352 静默支付接收者的扫描负担：由于定义的准确性，他们都有合适的比较对象，集成模式可以跟基于全节点的常规钱包作比较；服务端-客户端 模式可以跟基于 BIP158 区块过滤器 <sup><a href=#note9 id=jump-9>[9]</a></sup> 的轻节点的常规钱包作比较。</p><p>为此，我们对网络中出现的交易的数量与比例，以及钱包所控制的地址的数量，作出以下假设：</p><ul><li>平均每个区块包含 <code>n</code> 笔交易，它们总共有 <code>m</code> 个交易输入和 <code>o</code> 个交易输出；</li><li>至少包含一个 P2TR 输出的交易占比为 <code>p</code>，而 P2TR 输出占单区块内所有输出的比例为 <code>q</code>；</li><li>静默支付钱包仅公开 <code>1</code> 个静默支付地址；</li><li>常规钱包包含 <code>20</code> 个 P2TR 地址；</li><li>仅考虑交易输出中出现本钱包地址的情形（接收支付的情形）。</li></ul><p>在上述假设下，基于全节点的常规钱包的扫描负担是：<code>20 * o * q</code>，也即对区块中每一个 P2TR 输出运行 20 次地址匹配检查。而集成模式中的静默支付钱包的扫描负担是：<code>n * p * I + o * q * 1</code>，第一项是静默支付扫描的前两个步骤带来的开销，它是以交易为单位的，这里的 <code>I</code> 是对一笔交易执行类型检查、公钥提取、ECDH 等操作所需的计算量，这里假设是一个常数；第二项则是对这些潜在交易的每一个 P2TR 输出执行地址匹配检查所需的计算量，给定钱包主人只公开过 <code>1</code>个静默支付地址，就只需要执行 <code>1</code> 次。</p><p>至于基于轻节点的常规钱包，我们知道其工作模式是先验证区块过滤器；如果过滤器显示区块内没有自己关心的输入和输出，则不再下载完整的区块；如果区块过滤器显示有（这里存在一个极小的误判可能），则下载并检查地址匹配。我们把验证区块过滤器的负担当成一个常数（这不影响比较），则其扫描负担是：<code>1/x * 20 * o * q</code>，这里的 <code>1/x</code> 就是过滤器命中的概率，该值必定大于 BIP158 区块过滤器的误判概率，但实际大小取决于本钱包收取的交易在区块间的分布。</p><p>而基于 服务端-客户端 模式的静默支付钱包，其扫描负担是：<code>n * p * I_1 + o * q * 1</code>。这个式子之所以跟集成模式这么相似，是因为：服务端仅仅只是完成了一部分扫描工作，而对每一笔可能的交易，客户端都仍需执行一部分工作（具体来说是 ECDH）（它只是 <code>I</code> 的一部分，因此记为 <code>I_1</code>），而对 P2TR 输出的地址匹配检查，则完全无法从服务端的工作中受益，因此保持原样。</p><p>总结上面的分析：</p><ol><li>常规钱包的扫描负担很大程度上是由同类型输出的数量决定的，但静默支付钱包的扫描负担则有一部分（甚至是主要的部分）跟合格交易的数量有关，两者不便于直接对比；但从计算复杂性的角度看，静默支付的扫描负担绝大概率是更大的。具体来说，这种负担跟包含 P2TR 输出的交易的占比有关；占比越大，静默支付钱包的扫描负担越大；</li><li>常规钱包和静默支付钱包都可以从转向 轻节点&#x2F;客户端 模式获得显著的好处；</li><li>静默支付钱包与常规钱包的扫描负担的差异在客户端模式下会更大，也即更容易让用户感受出性能差异。静默支付钱包可能更适合稳定的桌面端，而非日常使用的移动端。</li></ol><h2 id=静默支付的现在和未来><a href=#静默支付的现在和未来 class=headerlink title=静默支付的现在和未来></a>静默支付的现在和未来</h2><p>性能&#x2F;成本 毫无疑问会影响一项技术的采用。从上述分析中我们可以知道，不论在哪一种工作模式下，静默支付钱包都要付出相对常规钱包更大的代价。可以说这也在我们的意料之中，因为这是 “静默支付” 的先天特性。至少，在人们设想的应用场景（接受捐赠、以机构身份接受支付）中，静态收款方式的好处应该能盖过其额外开销。而且，给定 服务端-客户端 的可能性，一部分工作量是可以复用的。</p><p>当前，多个项目在尝试实现 BIP352 静默支付钱包，比如：</p><ul><li>在 Bitcoin Core 中实现 BIP352：<a target=_blank rel=noopener href=https://github.com/bitcoin/bitcoin/issues/28536>https://github.com/bitcoin/bitcoin/issues/28536</a></li><li>Dana Wallet 移动端静默支付钱包：<a target=_blank rel=noopener href=https://github.com/cygnet3/danawallet>https://github.com/cygnet3/danawallet</a></li></ul><p>此外，开发者们也正在为了让静默支付能够兼容 coinjoin 交易而增加多种规范。在 coinjoin 交易中，多个参与者会各自为交易提供输入并指定输出；根据 BIP352，为了让这样的交易承载静默支付，支付者必须让每一个合格输入的私钥都参与共享秘密值的推导；同时，这不能造成真实私钥的泄露；此外，还需要工具能够在各方之间传递被构造的交易的信息（接收者的脚本必须在每一个参与者都参与计算之后才能得出）。与此相关的规范有：</p><ul><li>BIP374 离散对数等式证据：<a target=_blank rel=noopener href=https://github.com/bitcoin/bips/pull/1689>https://github.com/bitcoin/bips/pull/1689</a><ul><li>离散对数等式证据可以让私钥持有者证明自己知道一个私钥而不暴露这个私钥是什么。</li></ul></li><li>BIP375 使用 PSBT 发送静默支付：<a target=_blank rel=noopener href=https://github.com/bitcoin/bips/blob/master/bip-0375.mediawiki>https://github.com/bitcoin/bips/blob/master/bip-0375.mediawiki</a><ul><li>定义可在多方签名的静默支付交易协作中传递信息的 “PSBT（待签名的比特币交易）” 数据格式。</li></ul></li></ul><p>人们还在探索与静默支付有关的协议设计空间。</p><p>（完）</p><h2 id=脚注><a href=#脚注 class=headerlink title=脚注></a>脚注</h2><p>1.<a id=note1> </a><a href=https://www.btcstudy.org/2024/11/22/bitcoin-address-types-its-essentials-and-its-economics/ >https://www.btcstudy.org/2024/11/22/bitcoin-address-types-its-essentials-and-its-economics/</a> <a href=#jump-1>↩</a></p><p>2.<a id=note2> </a><a href=https://www.btcstudy.org/2023/10/25/a-guide-for-recovering-your-bitcoin-wallets/ >https://www.btcstudy.org/2023/10/25/a-guide-for-recovering-your-bitcoin-wallets/</a> <a href=#jump-2>↩</a></p><p>3.<a id=note3> </a><a href=https://www.btcstudy.org/2022/10/19/on-various-non-interactive-payments/ >https://www.btcstudy.org/2022/10/19/on-various-non-interactive-payments/</a> <a href=#jump-3>↩</a></p><p>4.<a id=note4> </a><a target=_blank rel=noopener href=https://en.wikipedia.org/wiki/Diffie%E2%80%93Hellman_key_exchange>https://en.wikipedia.org/wiki/Diffie%E2%80%93Hellman_key_exchange</a> <a href=#jump-4>↩</a></p><p>5.<a id=note5> </a><a target=_blank rel=noopener href=https://github.com/bitcoin/bips/blob/master/bip-0352.mediawiki>https://github.com/bitcoin/bips/blob/master/bip-0352.mediawiki</a> <a href=#jump-5>↩</a></p><p>6.<a id=note6> </a><a href=https://www.btcstudy.org/2024/11/22/bitcoin-address-types-its-essentials-and-its-economics/#Bech32m>https://www.btcstudy.org/2024/11/22/bitcoin-address-types-its-essentials-and-its-economics/#Bech32m</a> <a href=#jump-6>↩</a></p><p>7.<a id=note7> </a><a href=https://www.btcstudy.org/2024/04/17/transaction-security-improvement-from-soft-forks/#BIP30%EF%BC%9A%E7%A6%81%E6%AD%A2%E5%87%BA%E7%8E%B0%E7%9B%B8%E5%90%8C%E7%9A%84%E4%BA%A4%E6%98%93-ID>https://www.btcstudy.org/2024/04/17/transaction-security-improvement-from-soft-forks/#BIP30%EF%BC%9A%E7%A6%81%E6%AD%A2%E5%87%BA%E7%8E%B0%E7%9B%B8%E5%90%8C%E7%9A%84%E4%BA%A4%E6%98%93-ID</a> <a href=#jump-7>↩</a></p><p>8.<a id=note8> </a>这种显著的开销差异可能解释了为何一些开发者决心在 Bitcoin Core 中实现 BIP352。见：<a target=_blank rel=noopener href=https://github.com/bitcoin/bitcoin/issues/28536>https://github.com/bitcoin/bitcoin/issues/28536</a> <a href=#jump-8>↩</a></p><p>9.<a id=note9> </a><a href=https://www.btcstudy.org/2022/04/18/how-neutrino-works-by-Suredbits/ >https://www.btcstudy.org/2022/04/18/how-neutrino-works-by-Suredbits/</a> <a href=#jump-9>↩</a></p></article></div></div></main><script src="/js/post.js?v=1682773100887"></script><script src="/js/highlight.min.js?v=1682773100887"></script><script>var containerEl=document.querySelector(".post-container"),postFontSize=localStorage.getItem("post-font-size")||"16",inputEl=document.querySelector("#size-change-input"),inputEl2=document.querySelector("#size-change-input2");inputEl.value=postFontSize,inputEl2.value=postFontSize,containerEl.style.fontSize=postFontSize+"px",$(function(){function e(t){$(".post-container").css("font-size",t+"px"),localStorage.setItem("post-font-size",t),$("#size-change-input").val(t),$("#size-change-input2").val(t)}$("#size-change-input").on("input propertychange",function(t){e(t.target.value)}),$("#size-change-input2").on("input propertychange",function(t){e(t.target.value)})})</script><script>hljs.initHighlightingOnLoad()</script></main></div><footer class="is-flex is-flex-direction-column is-align-items-center is-flex-shrink-0"><section class=sns-container><a title=nostr target=_blank rel="noopener nofollow" href=https://iris.to/npub1g2qs0ca5kpwlrcfug2em4jelmh65clk3yccwjxrs6hvdpd9qj80q022j4m>Nostr</a><a title=rss target=_blank rel="noopener nofollow" href=/atom.xml>rss</a><a title=telegram target=_blank rel="noopener nofollow" href=//t.me/btcstudyorg>Telegram</a></section></footer><script async src="/js/buttons.js?v=1682773100887"></script><script async src="/js/index.js?v=1682773100887"></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-JVCJ9XXG1Z"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-JVCJ9XXG1Z")</script><script>var _hmt=_hmt||[];(()=>{var e=document.createElement("script"),t=(e.src="https://hm.baidu.com/hm.js?c92c073c85be5be8d9b1b76f62a7e306",e.async=!0,e.defer=!0,document.getElementsByTagName("script")[0]);t.parentNode.insertBefore(e,t)})()</script></body></html>