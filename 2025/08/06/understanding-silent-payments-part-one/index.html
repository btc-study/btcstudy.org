<!DOCTYPE html><html lang=zh-CN><head><meta charset=UTF-8><title>理解静默支付（一）</title><meta name=keywords content="比特币, 中本聪, 比特币区块链, 闪电网络, 比特币 layer 2, 健全货币, 密码货币, 密码朋克, 学习比特币, BTC, BTC Study, Bitcoin, bitcoin, proof of work"><meta name=description content=比特币思想的中文集结地><meta name=viewport content="width=device-width,minimum-scale=1,maximum-scale=1,initial-scale=1"><link rel=icon href=/favicon.ico><link rel=stylesheet href="/style/common/bulma.css?v=1682773100887"><link rel=preload as=style onload='this.onload=null,this.rel="stylesheet"' href="/style/common/iconfont.css?v=1682773100887"><link rel=stylesheet href="/style/base.css?v=1682773100887"><link rel=stylesheet href="/style/common/helper.css?v=1682773100887"><link rel=stylesheet href="/style/themes/animation.css?v=1682773100887"><script>function ready(){var e=document.querySelector(".body-container"),t=localStorage.getItem("theme")||"light";["light","dark"].includes(t)||(t="light",localStorage.setItem("theme","light")),e.classList.remove("appearance-auto"),e.classList.add("appearance-"+t),quickInitialTheme()}function quickInitialTheme(){var e=localStorage.getItem("theme")||"light",t=document.querySelector(".logo-light"),o=document.querySelector(".logo-dark"),d=document.querySelector("#mobile-header-logo > .logo-light"),l=document.querySelector("#mobile-header-logo > .logo-dark"),a=document.getElementById("theme-btn"),i=document.querySelector(".slide-theme-light"),c=document.querySelector(".slide-theme-dark");document.body.classList.add(e),("dark"===e?(t.classList.add("hidden"),o.classList.remove("hidden"),d.classList.add("hidden"),l.classList.remove("hidden"),a.classList.remove("icon-icon_dark"),a.classList.add("icon-icon_light"),i):c).classList.remove("hidden")}document.addEventListener("DOMContentLoaded",ready)</script><script src="/js/common.js?v=1682773100887"></script><script src=/js/libs/zepto.min.js></script><link rel=stylesheet href="/style/post.css?v=1682773100887"><link rel=stylesheet href="/style/themes/highlight.css?v=1682773100887"><meta name=generator content="Hexo 6.3.0"><link rel=alternate href=/atom.xml title="BTC Study" type=application/atom+xml></head><body class="is-flex is-flex-direction-column" onload=initialTheme()><div class=clip></div><div class="body-container appearance-auto"><header class="header-widget is-hidden-mobile is-flex is-flex-shrink-0 is-align-items-center is-justify-content-center" id=header><div class="is-flex header-widget-container is-flex-shrink-0 is-align-items-center"><section class="is-hidden-mobile is-flex-shrink-0"><h1><a href=/ ><svg class=logo-light width=125px height=23px viewBox="0 0 125 23" version=1.1 xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink><title>BTCStudy</title><g id=页面-1 stroke=none stroke-width=1 fill=none fill-rule=evenodd><g id=首页-响应式 transform="translate(-249.000000, -23.000000)" fill-rule=nonzero><g id=BTCStudy transform="translate(249.680000, 23.192000)"><path d="M9.072,17.808 C11.312,17.808 13.024,17.408 14.208,16.608 C15.392,15.808 15.984,14.672 15.984,13.2 C15.984,12.192 15.712,11.332 15.168,10.62 C14.624,9.908 13.872,9.384 12.912,9.048 C13.632,8.68 14.188,8.18 14.58,7.548 C14.972,6.916 15.168,6.2 15.168,5.4 C15.168,4.056 14.608,2.988 13.488,2.196 C12.368,1.404 10.736,1.008 8.592,1.008 L8.592,1.008 L-5.68434189e-14,1.008 L-5.68434189e-14,17.808 L9.072,17.808 Z M7.968,7.68 L4.704,7.68 L4.704,4.44 L7.968,4.44 C9.568,4.44 10.368,4.976 10.368,6.048 C10.368,7.136 9.568,7.68 7.968,7.68 L7.968,7.68 Z M8.688,14.376 L4.704,14.376 L4.704,10.968 L8.688,10.968 C10.352,10.968 11.184,11.536 11.184,12.672 C11.184,13.808 10.352,14.376 8.688,14.376 L8.688,14.376 Z M26.544,17.808 L26.544,4.776 L31.68,4.776 L31.68,1.008 L16.632,1.008 L16.632,4.776 L21.792,4.776 L21.792,17.808 L26.544,17.808 Z M41.592,18.144 C43.128,18.144 44.512,17.872 45.744,17.328 C46.976,16.784 48,16 48.816,14.976 L48.816,14.976 L45.792,12.24 C44.704,13.552 43.384,14.208 41.832,14.208 C40.92,14.208 40.108,14.008 39.396,13.608 C38.684,13.208 38.132,12.644 37.74,11.916 C37.348,11.188 37.152,10.352 37.152,9.408 C37.152,8.464 37.348,7.628 37.74,6.9 C38.132,6.172 38.684,5.608 39.396,5.208 C40.108,4.808 40.92,4.608 41.832,4.608 C43.384,4.608 44.704,5.264 45.792,6.576 L45.792,6.576 L48.816,3.84 C48,2.816 46.976,2.032 45.744,1.488 C44.512,0.944 43.128,0.672 41.592,0.672 C39.832,0.672 38.252,1.044 36.852,1.788 C35.452,2.532 34.352,3.568 33.552,4.896 C32.752,6.224 32.352,7.728 32.352,9.408 C32.352,11.088 32.752,12.592 33.552,13.92 C34.352,15.248 35.452,16.284 36.852,17.028 C38.252,17.772 39.832,18.144 41.592,18.144 Z" id=BTC fill=#F2A900></path><path d="M56.64,18.144 C58.24,18.144 59.6,17.9 60.72,17.412 C61.84,16.924 62.68,16.272 63.24,15.456 C63.8,14.64 64.08,13.728 64.08,12.72 C64.08,11.552 63.772,10.628 63.156,9.948 C62.54,9.268 61.812,8.772 60.972,8.46 C60.132,8.148 59.072,7.856 57.792,7.584 C56.656,7.344 55.832,7.112 55.32,6.888 C54.808,6.664 54.552,6.328 54.552,5.88 C54.552,5.432 54.768,5.068 55.2,4.788 C55.632,4.508 56.32,4.368 57.264,4.368 C58.768,4.368 60.32,4.8 61.92,5.664 L61.92,5.664 L63.384,2.136 C62.568,1.656 61.624,1.292 60.552,1.044 C59.48,0.796 58.392,0.672 57.288,0.672 C55.672,0.672 54.308,0.912 53.196,1.392 C52.084,1.872 51.248,2.524 50.688,3.348 C50.128,4.172 49.848,5.096 49.848,6.12 C49.848,7.288 50.152,8.216 50.76,8.904 C51.368,9.592 52.096,10.092 52.944,10.404 C53.792,10.716 54.848,11.008 56.112,11.28 C57.264,11.536 58.1,11.78 58.62,12.012 C59.14,12.244 59.4,12.6 59.4,13.08 C59.4,13.992 58.488,14.448 56.664,14.448 C55.704,14.448 54.728,14.296 53.736,13.992 C52.744,13.688 51.872,13.288 51.12,12.792 L51.12,12.792 L49.56,16.296 C50.36,16.856 51.4,17.304 52.68,17.64 C53.96,17.976 55.28,18.144 56.64,18.144 Z M71.856,18.024 C72.48,18.024 73.068,17.96 73.62,17.832 C74.172,17.704 74.64,17.52 75.024,17.28 L75.024,17.28 L73.896,14.088 C73.496,14.36 73.032,14.496 72.504,14.496 C72.088,14.496 71.756,14.364 71.508,14.1 C71.26,13.836 71.136,13.472 71.136,13.008 L71.136,13.008 L71.136,8.688 L74.112,8.688 L74.112,5.28 L71.136,5.28 L71.136,1.896 L66.576,1.896 L66.576,5.28 L64.68,5.28 L64.68,8.688 L66.576,8.688 L66.576,13.056 C66.576,14.704 67.032,15.944 67.944,16.776 C68.856,17.608 70.16,18.024 71.856,18.024 Z M82.248,18.024 C83,18.024 83.712,17.888 84.384,17.616 C85.056,17.344 85.632,16.944 86.112,16.416 L86.112,16.416 L86.112,17.808 L90.456,17.808 L90.456,4.8 L85.896,4.8 L85.896,11.064 C85.896,12.104 85.668,12.876 85.212,13.38 C84.756,13.884 84.168,14.136 83.448,14.136 C82.744,14.136 82.208,13.912 81.84,13.464 C81.472,13.016 81.288,12.304 81.288,11.328 L81.288,11.328 L81.288,4.8 L76.728,4.8 L76.728,12.072 C76.728,14.056 77.228,15.544 78.228,16.536 C79.228,17.528 80.568,18.024 82.248,18.024 Z M99.048,18.024 C100.744,18.024 102.016,17.52 102.864,16.512 L102.864,16.512 L102.864,17.808 L107.208,17.808 L107.208,0 L102.648,0 L102.648,5.928 C101.8,5.032 100.6,4.584 99.048,4.584 C97.864,4.584 96.784,4.856 95.808,5.4 C94.832,5.944 94.06,6.724 93.492,7.74 C92.924,8.756 92.64,9.936 92.64,11.28 C92.64,12.624 92.924,13.808 93.492,14.832 C94.06,15.856 94.832,16.644 95.808,17.196 C96.784,17.748 97.864,18.024 99.048,18.024 Z M100.008,14.4 C99.208,14.4 98.552,14.124 98.04,13.572 C97.528,13.02 97.272,12.256 97.272,11.28 C97.272,10.32 97.528,9.568 98.04,9.024 C98.552,8.48 99.208,8.208 100.008,8.208 C100.808,8.208 101.46,8.48 101.964,9.024 C102.468,9.568 102.72,10.32 102.72,11.28 C102.72,12.256 102.464,13.02 101.952,13.572 C101.44,14.124 100.792,14.4 100.008,14.4 Z M112.368,22.68 C113.728,22.68 114.88,22.356 115.824,21.708 C116.768,21.06 117.568,19.936 118.224,18.336 L118.224,18.336 L123.84,4.8 L119.496,4.8 L116.28,12.744 L113.088,4.8 L108.408,4.8 L113.976,17.976 C113.784,18.36 113.548,18.64 113.268,18.816 C112.988,18.992 112.632,19.08 112.2,19.08 C111.832,19.08 111.468,19.012 111.108,18.876 C110.748,18.74 110.44,18.552 110.184,18.312 L110.184,18.312 L108.6,21.504 C109.032,21.856 109.596,22.14 110.292,22.356 C110.988,22.572 111.68,22.68 112.368,22.68 Z" id=Study fill-opacity=0.85 fill=#000000></path></g></g></g></svg><svg class="logo-dark hidden" width=125px height=23px viewBox="0 0 125 23" version=1.1 xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink><title>BTCStudy</title><g id=页面-1 stroke=none stroke-width=1 fill=none fill-rule=evenodd><g id=首页-响应式 transform="translate(-249.000000, -23.000000)" fill-rule=nonzero><g id=BTCStudy transform="translate(249.680000, 23.192000)"><path d="M9.072,17.808 C11.312,17.808 13.024,17.408 14.208,16.608 C15.392,15.808 15.984,14.672 15.984,13.2 C15.984,12.192 15.712,11.332 15.168,10.62 C14.624,9.908 13.872,9.384 12.912,9.048 C13.632,8.68 14.188,8.18 14.58,7.548 C14.972,6.916 15.168,6.2 15.168,5.4 C15.168,4.056 14.608,2.988 13.488,2.196 C12.368,1.404 10.736,1.008 8.592,1.008 L8.592,1.008 L-5.68434189e-14,1.008 L-5.68434189e-14,17.808 L9.072,17.808 Z M7.968,7.68 L4.704,7.68 L4.704,4.44 L7.968,4.44 C9.568,4.44 10.368,4.976 10.368,6.048 C10.368,7.136 9.568,7.68 7.968,7.68 L7.968,7.68 Z M8.688,14.376 L4.704,14.376 L4.704,10.968 L8.688,10.968 C10.352,10.968 11.184,11.536 11.184,12.672 C11.184,13.808 10.352,14.376 8.688,14.376 L8.688,14.376 Z M26.544,17.808 L26.544,4.776 L31.68,4.776 L31.68,1.008 L16.632,1.008 L16.632,4.776 L21.792,4.776 L21.792,17.808 L26.544,17.808 Z M41.592,18.144 C43.128,18.144 44.512,17.872 45.744,17.328 C46.976,16.784 48,16 48.816,14.976 L48.816,14.976 L45.792,12.24 C44.704,13.552 43.384,14.208 41.832,14.208 C40.92,14.208 40.108,14.008 39.396,13.608 C38.684,13.208 38.132,12.644 37.74,11.916 C37.348,11.188 37.152,10.352 37.152,9.408 C37.152,8.464 37.348,7.628 37.74,6.9 C38.132,6.172 38.684,5.608 39.396,5.208 C40.108,4.808 40.92,4.608 41.832,4.608 C43.384,4.608 44.704,5.264 45.792,6.576 L45.792,6.576 L48.816,3.84 C48,2.816 46.976,2.032 45.744,1.488 C44.512,0.944 43.128,0.672 41.592,0.672 C39.832,0.672 38.252,1.044 36.852,1.788 C35.452,2.532 34.352,3.568 33.552,4.896 C32.752,6.224 32.352,7.728 32.352,9.408 C32.352,11.088 32.752,12.592 33.552,13.92 C34.352,15.248 35.452,16.284 36.852,17.028 C38.252,17.772 39.832,18.144 41.592,18.144 Z" id=BTC fill=#F2A900></path><path d="M56.64,18.144 C58.24,18.144 59.6,17.9 60.72,17.412 C61.84,16.924 62.68,16.272 63.24,15.456 C63.8,14.64 64.08,13.728 64.08,12.72 C64.08,11.552 63.772,10.628 63.156,9.948 C62.54,9.268 61.812,8.772 60.972,8.46 C60.132,8.148 59.072,7.856 57.792,7.584 C56.656,7.344 55.832,7.112 55.32,6.888 C54.808,6.664 54.552,6.328 54.552,5.88 C54.552,5.432 54.768,5.068 55.2,4.788 C55.632,4.508 56.32,4.368 57.264,4.368 C58.768,4.368 60.32,4.8 61.92,5.664 L61.92,5.664 L63.384,2.136 C62.568,1.656 61.624,1.292 60.552,1.044 C59.48,0.796 58.392,0.672 57.288,0.672 C55.672,0.672 54.308,0.912 53.196,1.392 C52.084,1.872 51.248,2.524 50.688,3.348 C50.128,4.172 49.848,5.096 49.848,6.12 C49.848,7.288 50.152,8.216 50.76,8.904 C51.368,9.592 52.096,10.092 52.944,10.404 C53.792,10.716 54.848,11.008 56.112,11.28 C57.264,11.536 58.1,11.78 58.62,12.012 C59.14,12.244 59.4,12.6 59.4,13.08 C59.4,13.992 58.488,14.448 56.664,14.448 C55.704,14.448 54.728,14.296 53.736,13.992 C52.744,13.688 51.872,13.288 51.12,12.792 L51.12,12.792 L49.56,16.296 C50.36,16.856 51.4,17.304 52.68,17.64 C53.96,17.976 55.28,18.144 56.64,18.144 Z M71.856,18.024 C72.48,18.024 73.068,17.96 73.62,17.832 C74.172,17.704 74.64,17.52 75.024,17.28 L75.024,17.28 L73.896,14.088 C73.496,14.36 73.032,14.496 72.504,14.496 C72.088,14.496 71.756,14.364 71.508,14.1 C71.26,13.836 71.136,13.472 71.136,13.008 L71.136,13.008 L71.136,8.688 L74.112,8.688 L74.112,5.28 L71.136,5.28 L71.136,1.896 L66.576,1.896 L66.576,5.28 L64.68,5.28 L64.68,8.688 L66.576,8.688 L66.576,13.056 C66.576,14.704 67.032,15.944 67.944,16.776 C68.856,17.608 70.16,18.024 71.856,18.024 Z M82.248,18.024 C83,18.024 83.712,17.888 84.384,17.616 C85.056,17.344 85.632,16.944 86.112,16.416 L86.112,16.416 L86.112,17.808 L90.456,17.808 L90.456,4.8 L85.896,4.8 L85.896,11.064 C85.896,12.104 85.668,12.876 85.212,13.38 C84.756,13.884 84.168,14.136 83.448,14.136 C82.744,14.136 82.208,13.912 81.84,13.464 C81.472,13.016 81.288,12.304 81.288,11.328 L81.288,11.328 L81.288,4.8 L76.728,4.8 L76.728,12.072 C76.728,14.056 77.228,15.544 78.228,16.536 C79.228,17.528 80.568,18.024 82.248,18.024 Z M99.048,18.024 C100.744,18.024 102.016,17.52 102.864,16.512 L102.864,16.512 L102.864,17.808 L107.208,17.808 L107.208,0 L102.648,0 L102.648,5.928 C101.8,5.032 100.6,4.584 99.048,4.584 C97.864,4.584 96.784,4.856 95.808,5.4 C94.832,5.944 94.06,6.724 93.492,7.74 C92.924,8.756 92.64,9.936 92.64,11.28 C92.64,12.624 92.924,13.808 93.492,14.832 C94.06,15.856 94.832,16.644 95.808,17.196 C96.784,17.748 97.864,18.024 99.048,18.024 Z M100.008,14.4 C99.208,14.4 98.552,14.124 98.04,13.572 C97.528,13.02 97.272,12.256 97.272,11.28 C97.272,10.32 97.528,9.568 98.04,9.024 C98.552,8.48 99.208,8.208 100.008,8.208 C100.808,8.208 101.46,8.48 101.964,9.024 C102.468,9.568 102.72,10.32 102.72,11.28 C102.72,12.256 102.464,13.02 101.952,13.572 C101.44,14.124 100.792,14.4 100.008,14.4 Z M112.368,22.68 C113.728,22.68 114.88,22.356 115.824,21.708 C116.768,21.06 117.568,19.936 118.224,18.336 L118.224,18.336 L123.84,4.8 L119.496,4.8 L116.28,12.744 L113.088,4.8 L108.408,4.8 L113.976,17.976 C113.784,18.36 113.548,18.64 113.268,18.816 C112.988,18.992 112.632,19.08 112.2,19.08 C111.832,19.08 111.468,19.012 111.108,18.876 C110.748,18.74 110.44,18.552 110.184,18.312 L110.184,18.312 L108.6,21.504 C109.032,21.856 109.596,22.14 110.292,22.356 C110.988,22.572 111.68,22.68 112.368,22.68 Z" id=Study fill-opacity=0.85 fill=#FFFFFF></path></g></g></g></svg></a></h1></section><div class="is-flex is-flex-direction-column header-menu-wrap"><aside class="is-flex-shrink-0 is-flex is-flex-direction-row is-align-items-center" id=header-menu><a class="is-inline-block header-activity mr-4" href=/ >首页</a><a class="is-inline-block mr-4" href=/archives>全站目录</a><a class="is-inline-block mr-4" href=/tags>标签</a><a class="is-inline-block mr-4" href=/maps>地图</a><a class="is-inline-block mr-4" href=/mempool>mempool</a><a class="is-inline-block mr-4" target=_blank rel=noopener href=https://123btc.org/ >123btc</a><div class="right-content is-flex is-flex-direction-row is-align-items-center"><div class="size-wrap mr-1"><i class="iconfont icon-a-bianzu5" id=change-size-btn></i><div class=size-input-wrap><div class=input-wrap><input id=size-change-input type=range min=12 max=32 step=2></div></div></div><i class="iconfont icon-icon_dark mr-1" id=theme-btn></i><div class=search-wrap><input class=pl-3 id=search-input placeholder=请输入搜索关键词><i class="iconfont icon-icon_search" id=search-input-btn></i></div></div></aside><div class="header-title is-hidden-mobile is-full-height is-flex is-align-items-center is-flex-shrink-0"><div class="is-full-height hidden" id=postTopic><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">理解静默支付（一）</p><div class="size-wrap mr-1"><i class="iconfont icon-a-bianzu5" id=change-size-btn2></i><div class=size-input-wrap><div class=input-wrap><input id=size-change-input2 type=range min=12 max=32 step=2></div></div></div></div></div></div></div></header><header class="is-flex header-widget is-flex-shrink-0 is-align-items-center is-justify-content-space-between is-hidden-tablet" id=mobile-header><div class="is-flex is-flex-direction-row is-align-items-center"><i class="iconfont icon-icon_bar mobile-header-menu"></i><div id=mobile-header-logo><svg class=logo-light width=125px height=23px viewBox="0 0 125 23" version=1.1 xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink><title>BTCStudy</title><g id=页面-1 stroke=none stroke-width=1 fill=none fill-rule=evenodd><g id=首页-响应式 transform="translate(-249.000000, -23.000000)" fill-rule=nonzero><g id=BTCStudy transform="translate(249.680000, 23.192000)"><path d="M9.072,17.808 C11.312,17.808 13.024,17.408 14.208,16.608 C15.392,15.808 15.984,14.672 15.984,13.2 C15.984,12.192 15.712,11.332 15.168,10.62 C14.624,9.908 13.872,9.384 12.912,9.048 C13.632,8.68 14.188,8.18 14.58,7.548 C14.972,6.916 15.168,6.2 15.168,5.4 C15.168,4.056 14.608,2.988 13.488,2.196 C12.368,1.404 10.736,1.008 8.592,1.008 L8.592,1.008 L-5.68434189e-14,1.008 L-5.68434189e-14,17.808 L9.072,17.808 Z M7.968,7.68 L4.704,7.68 L4.704,4.44 L7.968,4.44 C9.568,4.44 10.368,4.976 10.368,6.048 C10.368,7.136 9.568,7.68 7.968,7.68 L7.968,7.68 Z M8.688,14.376 L4.704,14.376 L4.704,10.968 L8.688,10.968 C10.352,10.968 11.184,11.536 11.184,12.672 C11.184,13.808 10.352,14.376 8.688,14.376 L8.688,14.376 Z M26.544,17.808 L26.544,4.776 L31.68,4.776 L31.68,1.008 L16.632,1.008 L16.632,4.776 L21.792,4.776 L21.792,17.808 L26.544,17.808 Z M41.592,18.144 C43.128,18.144 44.512,17.872 45.744,17.328 C46.976,16.784 48,16 48.816,14.976 L48.816,14.976 L45.792,12.24 C44.704,13.552 43.384,14.208 41.832,14.208 C40.92,14.208 40.108,14.008 39.396,13.608 C38.684,13.208 38.132,12.644 37.74,11.916 C37.348,11.188 37.152,10.352 37.152,9.408 C37.152,8.464 37.348,7.628 37.74,6.9 C38.132,6.172 38.684,5.608 39.396,5.208 C40.108,4.808 40.92,4.608 41.832,4.608 C43.384,4.608 44.704,5.264 45.792,6.576 L45.792,6.576 L48.816,3.84 C48,2.816 46.976,2.032 45.744,1.488 C44.512,0.944 43.128,0.672 41.592,0.672 C39.832,0.672 38.252,1.044 36.852,1.788 C35.452,2.532 34.352,3.568 33.552,4.896 C32.752,6.224 32.352,7.728 32.352,9.408 C32.352,11.088 32.752,12.592 33.552,13.92 C34.352,15.248 35.452,16.284 36.852,17.028 C38.252,17.772 39.832,18.144 41.592,18.144 Z" id=BTC fill=#F2A900></path><path d="M56.64,18.144 C58.24,18.144 59.6,17.9 60.72,17.412 C61.84,16.924 62.68,16.272 63.24,15.456 C63.8,14.64 64.08,13.728 64.08,12.72 C64.08,11.552 63.772,10.628 63.156,9.948 C62.54,9.268 61.812,8.772 60.972,8.46 C60.132,8.148 59.072,7.856 57.792,7.584 C56.656,7.344 55.832,7.112 55.32,6.888 C54.808,6.664 54.552,6.328 54.552,5.88 C54.552,5.432 54.768,5.068 55.2,4.788 C55.632,4.508 56.32,4.368 57.264,4.368 C58.768,4.368 60.32,4.8 61.92,5.664 L61.92,5.664 L63.384,2.136 C62.568,1.656 61.624,1.292 60.552,1.044 C59.48,0.796 58.392,0.672 57.288,0.672 C55.672,0.672 54.308,0.912 53.196,1.392 C52.084,1.872 51.248,2.524 50.688,3.348 C50.128,4.172 49.848,5.096 49.848,6.12 C49.848,7.288 50.152,8.216 50.76,8.904 C51.368,9.592 52.096,10.092 52.944,10.404 C53.792,10.716 54.848,11.008 56.112,11.28 C57.264,11.536 58.1,11.78 58.62,12.012 C59.14,12.244 59.4,12.6 59.4,13.08 C59.4,13.992 58.488,14.448 56.664,14.448 C55.704,14.448 54.728,14.296 53.736,13.992 C52.744,13.688 51.872,13.288 51.12,12.792 L51.12,12.792 L49.56,16.296 C50.36,16.856 51.4,17.304 52.68,17.64 C53.96,17.976 55.28,18.144 56.64,18.144 Z M71.856,18.024 C72.48,18.024 73.068,17.96 73.62,17.832 C74.172,17.704 74.64,17.52 75.024,17.28 L75.024,17.28 L73.896,14.088 C73.496,14.36 73.032,14.496 72.504,14.496 C72.088,14.496 71.756,14.364 71.508,14.1 C71.26,13.836 71.136,13.472 71.136,13.008 L71.136,13.008 L71.136,8.688 L74.112,8.688 L74.112,5.28 L71.136,5.28 L71.136,1.896 L66.576,1.896 L66.576,5.28 L64.68,5.28 L64.68,8.688 L66.576,8.688 L66.576,13.056 C66.576,14.704 67.032,15.944 67.944,16.776 C68.856,17.608 70.16,18.024 71.856,18.024 Z M82.248,18.024 C83,18.024 83.712,17.888 84.384,17.616 C85.056,17.344 85.632,16.944 86.112,16.416 L86.112,16.416 L86.112,17.808 L90.456,17.808 L90.456,4.8 L85.896,4.8 L85.896,11.064 C85.896,12.104 85.668,12.876 85.212,13.38 C84.756,13.884 84.168,14.136 83.448,14.136 C82.744,14.136 82.208,13.912 81.84,13.464 C81.472,13.016 81.288,12.304 81.288,11.328 L81.288,11.328 L81.288,4.8 L76.728,4.8 L76.728,12.072 C76.728,14.056 77.228,15.544 78.228,16.536 C79.228,17.528 80.568,18.024 82.248,18.024 Z M99.048,18.024 C100.744,18.024 102.016,17.52 102.864,16.512 L102.864,16.512 L102.864,17.808 L107.208,17.808 L107.208,0 L102.648,0 L102.648,5.928 C101.8,5.032 100.6,4.584 99.048,4.584 C97.864,4.584 96.784,4.856 95.808,5.4 C94.832,5.944 94.06,6.724 93.492,7.74 C92.924,8.756 92.64,9.936 92.64,11.28 C92.64,12.624 92.924,13.808 93.492,14.832 C94.06,15.856 94.832,16.644 95.808,17.196 C96.784,17.748 97.864,18.024 99.048,18.024 Z M100.008,14.4 C99.208,14.4 98.552,14.124 98.04,13.572 C97.528,13.02 97.272,12.256 97.272,11.28 C97.272,10.32 97.528,9.568 98.04,9.024 C98.552,8.48 99.208,8.208 100.008,8.208 C100.808,8.208 101.46,8.48 101.964,9.024 C102.468,9.568 102.72,10.32 102.72,11.28 C102.72,12.256 102.464,13.02 101.952,13.572 C101.44,14.124 100.792,14.4 100.008,14.4 Z M112.368,22.68 C113.728,22.68 114.88,22.356 115.824,21.708 C116.768,21.06 117.568,19.936 118.224,18.336 L118.224,18.336 L123.84,4.8 L119.496,4.8 L116.28,12.744 L113.088,4.8 L108.408,4.8 L113.976,17.976 C113.784,18.36 113.548,18.64 113.268,18.816 C112.988,18.992 112.632,19.08 112.2,19.08 C111.832,19.08 111.468,19.012 111.108,18.876 C110.748,18.74 110.44,18.552 110.184,18.312 L110.184,18.312 L108.6,21.504 C109.032,21.856 109.596,22.14 110.292,22.356 C110.988,22.572 111.68,22.68 112.368,22.68 Z" id=Study fill-opacity=0.85 fill=#000000></path></g></g></g></svg><svg class="logo-dark hidden" width=125px height=23px viewBox="0 0 125 23" version=1.1 xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink><title>BTCStudy</title><g id=页面-1 stroke=none stroke-width=1 fill=none fill-rule=evenodd><g id=首页-响应式 transform="translate(-249.000000, -23.000000)" fill-rule=nonzero><g id=BTCStudy transform="translate(249.680000, 23.192000)"><path d="M9.072,17.808 C11.312,17.808 13.024,17.408 14.208,16.608 C15.392,15.808 15.984,14.672 15.984,13.2 C15.984,12.192 15.712,11.332 15.168,10.62 C14.624,9.908 13.872,9.384 12.912,9.048 C13.632,8.68 14.188,8.18 14.58,7.548 C14.972,6.916 15.168,6.2 15.168,5.4 C15.168,4.056 14.608,2.988 13.488,2.196 C12.368,1.404 10.736,1.008 8.592,1.008 L8.592,1.008 L-5.68434189e-14,1.008 L-5.68434189e-14,17.808 L9.072,17.808 Z M7.968,7.68 L4.704,7.68 L4.704,4.44 L7.968,4.44 C9.568,4.44 10.368,4.976 10.368,6.048 C10.368,7.136 9.568,7.68 7.968,7.68 L7.968,7.68 Z M8.688,14.376 L4.704,14.376 L4.704,10.968 L8.688,10.968 C10.352,10.968 11.184,11.536 11.184,12.672 C11.184,13.808 10.352,14.376 8.688,14.376 L8.688,14.376 Z M26.544,17.808 L26.544,4.776 L31.68,4.776 L31.68,1.008 L16.632,1.008 L16.632,4.776 L21.792,4.776 L21.792,17.808 L26.544,17.808 Z M41.592,18.144 C43.128,18.144 44.512,17.872 45.744,17.328 C46.976,16.784 48,16 48.816,14.976 L48.816,14.976 L45.792,12.24 C44.704,13.552 43.384,14.208 41.832,14.208 C40.92,14.208 40.108,14.008 39.396,13.608 C38.684,13.208 38.132,12.644 37.74,11.916 C37.348,11.188 37.152,10.352 37.152,9.408 C37.152,8.464 37.348,7.628 37.74,6.9 C38.132,6.172 38.684,5.608 39.396,5.208 C40.108,4.808 40.92,4.608 41.832,4.608 C43.384,4.608 44.704,5.264 45.792,6.576 L45.792,6.576 L48.816,3.84 C48,2.816 46.976,2.032 45.744,1.488 C44.512,0.944 43.128,0.672 41.592,0.672 C39.832,0.672 38.252,1.044 36.852,1.788 C35.452,2.532 34.352,3.568 33.552,4.896 C32.752,6.224 32.352,7.728 32.352,9.408 C32.352,11.088 32.752,12.592 33.552,13.92 C34.352,15.248 35.452,16.284 36.852,17.028 C38.252,17.772 39.832,18.144 41.592,18.144 Z" id=BTC fill=#F2A900></path><path d="M56.64,18.144 C58.24,18.144 59.6,17.9 60.72,17.412 C61.84,16.924 62.68,16.272 63.24,15.456 C63.8,14.64 64.08,13.728 64.08,12.72 C64.08,11.552 63.772,10.628 63.156,9.948 C62.54,9.268 61.812,8.772 60.972,8.46 C60.132,8.148 59.072,7.856 57.792,7.584 C56.656,7.344 55.832,7.112 55.32,6.888 C54.808,6.664 54.552,6.328 54.552,5.88 C54.552,5.432 54.768,5.068 55.2,4.788 C55.632,4.508 56.32,4.368 57.264,4.368 C58.768,4.368 60.32,4.8 61.92,5.664 L61.92,5.664 L63.384,2.136 C62.568,1.656 61.624,1.292 60.552,1.044 C59.48,0.796 58.392,0.672 57.288,0.672 C55.672,0.672 54.308,0.912 53.196,1.392 C52.084,1.872 51.248,2.524 50.688,3.348 C50.128,4.172 49.848,5.096 49.848,6.12 C49.848,7.288 50.152,8.216 50.76,8.904 C51.368,9.592 52.096,10.092 52.944,10.404 C53.792,10.716 54.848,11.008 56.112,11.28 C57.264,11.536 58.1,11.78 58.62,12.012 C59.14,12.244 59.4,12.6 59.4,13.08 C59.4,13.992 58.488,14.448 56.664,14.448 C55.704,14.448 54.728,14.296 53.736,13.992 C52.744,13.688 51.872,13.288 51.12,12.792 L51.12,12.792 L49.56,16.296 C50.36,16.856 51.4,17.304 52.68,17.64 C53.96,17.976 55.28,18.144 56.64,18.144 Z M71.856,18.024 C72.48,18.024 73.068,17.96 73.62,17.832 C74.172,17.704 74.64,17.52 75.024,17.28 L75.024,17.28 L73.896,14.088 C73.496,14.36 73.032,14.496 72.504,14.496 C72.088,14.496 71.756,14.364 71.508,14.1 C71.26,13.836 71.136,13.472 71.136,13.008 L71.136,13.008 L71.136,8.688 L74.112,8.688 L74.112,5.28 L71.136,5.28 L71.136,1.896 L66.576,1.896 L66.576,5.28 L64.68,5.28 L64.68,8.688 L66.576,8.688 L66.576,13.056 C66.576,14.704 67.032,15.944 67.944,16.776 C68.856,17.608 70.16,18.024 71.856,18.024 Z M82.248,18.024 C83,18.024 83.712,17.888 84.384,17.616 C85.056,17.344 85.632,16.944 86.112,16.416 L86.112,16.416 L86.112,17.808 L90.456,17.808 L90.456,4.8 L85.896,4.8 L85.896,11.064 C85.896,12.104 85.668,12.876 85.212,13.38 C84.756,13.884 84.168,14.136 83.448,14.136 C82.744,14.136 82.208,13.912 81.84,13.464 C81.472,13.016 81.288,12.304 81.288,11.328 L81.288,11.328 L81.288,4.8 L76.728,4.8 L76.728,12.072 C76.728,14.056 77.228,15.544 78.228,16.536 C79.228,17.528 80.568,18.024 82.248,18.024 Z M99.048,18.024 C100.744,18.024 102.016,17.52 102.864,16.512 L102.864,16.512 L102.864,17.808 L107.208,17.808 L107.208,0 L102.648,0 L102.648,5.928 C101.8,5.032 100.6,4.584 99.048,4.584 C97.864,4.584 96.784,4.856 95.808,5.4 C94.832,5.944 94.06,6.724 93.492,7.74 C92.924,8.756 92.64,9.936 92.64,11.28 C92.64,12.624 92.924,13.808 93.492,14.832 C94.06,15.856 94.832,16.644 95.808,17.196 C96.784,17.748 97.864,18.024 99.048,18.024 Z M100.008,14.4 C99.208,14.4 98.552,14.124 98.04,13.572 C97.528,13.02 97.272,12.256 97.272,11.28 C97.272,10.32 97.528,9.568 98.04,9.024 C98.552,8.48 99.208,8.208 100.008,8.208 C100.808,8.208 101.46,8.48 101.964,9.024 C102.468,9.568 102.72,10.32 102.72,11.28 C102.72,12.256 102.464,13.02 101.952,13.572 C101.44,14.124 100.792,14.4 100.008,14.4 Z M112.368,22.68 C113.728,22.68 114.88,22.356 115.824,21.708 C116.768,21.06 117.568,19.936 118.224,18.336 L118.224,18.336 L123.84,4.8 L119.496,4.8 L116.28,12.744 L113.088,4.8 L108.408,4.8 L113.976,17.976 C113.784,18.36 113.548,18.64 113.268,18.816 C112.988,18.992 112.632,19.08 112.2,19.08 C111.832,19.08 111.468,19.012 111.108,18.876 C110.748,18.74 110.44,18.552 110.184,18.312 L110.184,18.312 L108.6,21.504 C109.032,21.856 109.596,22.14 110.292,22.356 C110.988,22.572 111.68,22.68 112.368,22.68 Z" id=Study fill-opacity=0.85 fill=#FFFFFF></path></g></g></g></svg></div><div class="mobile-header-title is-full-height is-flex is-align-items-center is-flex-shrink-0"><div class="is-full-height hidden" id=postTopicMobile><p class=is-full-height>理解静默支付（一）</p></div></div></div><i class="iconfont icon-icon_search mobile-header-searchIcon"></i><div class=mobile-search-wrap><div class=search-input><input class=pl-3 id=mobile-search-input placeholder=请输入搜索关键词><i class="iconfont icon-icon_search mobile-search-input-btn"></i><button class=mobile-search-input-btn>搜 索</button></div></div></header><div class=mobile-slide-menu><a class=header-activity href=/ >首页</a><a href=/archives>全站目录</a><a href=/tags>标签</a><a href=/maps>地图</a><a href=/mempool>mempool</a><a target=_blank rel=noopener href=https://123btc.org/ >123btc</a><div><p class="slide-menu-theme is-flex is-flex-direction-row is-justify-content-space-between is-align-items-center"><span>主题设置</span><span><i class="iconfont icon-icon_light slide-theme-light hidden"></i><i class="iconfont icon-icon_dark slide-theme-dark hidden"></i></span></p><p class=slide-menu-fontsize><span>字体设置</span><span><i class="iconfont icon-bianzubeifen"></i><i class="iconfont icon-bianzu"></i></span></p></div></div><div class="search-mask hidden"><script src="/js/header.js?v=1682773100887"></script></div><main><main class="container is-max-widescreen content section post-page pt-4"><div class="columns is-flex-desktop is-justify-content-center"><div class="column is-3 silde-bar is-hidden-mobile"><ol class=toc><li class="toc-item toc-level-2"><a class=toc-link href=#%E6%AF%94%E7%89%B9%E5%B8%81%E4%BA%A4%E6%98%93><span class=toc-text>比特币交易</span></a></li><li class="toc-item toc-level-2"><a class=toc-link href=#%E8%BF%B7%E4%BD%A0%E5%85%A5%E9%97%A8%E8%AF%BE%EF%BC%9A%E7%A7%81%E9%92%A5%E5%92%8C%E5%85%AC%E9%92%A5><span class=toc-text>迷你入门课：私钥和公钥</span></a></li><li class="toc-item toc-level-2"><a class=toc-link href=#%E6%A4%AD%E5%9C%86%E6%9B%B2%E7%BA%BF%E4%B8%8A%E7%9A%84-Diffie-Hellman-%E5%AF%86%E9%92%A5%E4%BA%A4%E6%8D%A2><span class=toc-text>椭圆曲线上的 Diffie-Hellman 密钥交换</span></a></li><li class="toc-item toc-level-2"><a class=toc-link href=#%E9%9D%99%E9%BB%98%E6%94%AF%E4%BB%98><span class=toc-text>静默支付</span></a></li><li class="toc-item toc-level-2"><a class=toc-link href=#%E9%82%A3%E4%B9%88-Alice-%E5%88%B0%E5%BA%95%E4%BD%BF%E7%94%A8%E5%93%AA%E4%B8%AA%E7%A7%81%E9%92%A5%E5%91%A2%EF%BC%9FBob-%E6%80%8E%E4%B9%88%E7%9F%A5%E9%81%93%E8%BF%99%E4%B8%AA%E7%A7%81%E9%92%A5%E6%89%80%E5%AF%B9%E5%BA%94%E7%9A%84%E5%85%AC%E9%92%A5%EF%BC%9F><span class=toc-text>那么 Alice 到底使用哪个私钥呢？Bob 怎么知道这个私钥所对应的公钥？</span></a></li><li class="toc-item toc-level-2"><a class=toc-link href=#%E7%A1%AE%E4%BF%9D%E5%9C%B0%E5%9D%80%E4%B8%8D%E4%BC%9A%E5%A4%8D%E7%94%A8><span class=toc-text>确保地址不会复用</span></a></li><li class="toc-item toc-level-2"><a class=toc-link href=#%E6%80%BB%E7%BB%93><span class=toc-text>总结</span></a></li></ol></div><div class="column is-9 post-container"><h1 class="mt-0 mb-2" id=postTitle>理解静默支付（一）</h1><div class=page-author><div class="is-flex is-flex-direction-row page-data mr-6"><img class=mr-1 src=/images/default_avatar.png alt="benma &amp; Sebastian"><div class=page-author-info><strong>benma &amp; Sebastian</strong><time class=has-text-grey datetime=2025-08-06T09:01:32.000Z>2025-08-06</time></div></div><div class=is-flex><a href=/tags/%E9%9D%99%E9%BB%98%E6%94%AF%E4%BB%98><i class="page-tag mr-1 px-1">静默支付</i></a></div></div><article class="mt-4 post-content"><blockquote><p><em>作者：benma &amp; Sebastian</em></p><p><em>来源：<a target=_blank rel=noopener href=https://blog.bitbox.swiss/en/understanding-silent-payments-part-one/ >https://blog.bitbox.swiss/en/understanding-silent-payments-part-one/</a></em></p></blockquote><p><img src=/images/understanding-silent-payments-part-one/silentpayments-1.png alt=silentpayments-1></p><p>我们骄傲地宣布， BitBox02 是第一款能够安全地执行比特币 “静默支付” 的硬件签名器。在这个系列博客中，我们希望展示静默支付的工作原理，以及在表象之下，BitBox02 做了什么，来让这些支付能够安全地执行。</p><p>发送到静默支付地址的支持将在未来的更新中提供给所有 BitBox02 用户。</p><ul><li>第一篇将解释静默支付的工作原理</li><li>第二篇将展示为安全地支持静默支付，BitBox02 在背后都做了什么</li></ul><p><a target=_blank rel=noopener href=https://github.com/bitcoin/bips/blob/master/bip-0352.mediawiki>静默支付</a>是一个提议新的比特币地址格式的 BIP（比特币优化提议）。它的主要好处是能产生一种静态的地址。它消除了管理多个地址的需要，同时还能保护隐私性。如果你想了解更多基础概念，可以看看<a target=_blank rel=noopener href=https://blog.bitbox.swiss/en/reusable-payment-codes-exchanging-bitcoin-addresses-privately/ >我们上一篇关于可复用支付码的文章</a>。</p><p>当前，为了保护隐私，链上支付的收款方必须在每一次收取支付时，给支付方提供一个新的地址。者导致了糟糕的用户体验，以及使用困难。</p><p>举个例子：</p><ul><li>从交易所取款：在每一次取款的时候，你都要从 BitBoxApp 中找出一个新的、还没用过的地址，在 BitBox 和第二台设备中验证这是正确的地址，最后到交易所登记这个地址。</li><li>向交易所存款：每一次存款，你都要在交易所创建一个新的存款地址，并在发送资金之前在第二台设备和 BitBox 上验证它是一个有效地址。</li><li>接收捐款：你需要建立和运营一个服务器（比如 BTCPay Server），以为每一次捐赠生成一个新的地址。</li></ul><p>许多比特币服务端和用户都不想处理这样的复杂性，所以他们直接重复使用同一个地址，这就牺牲了他们的隐私性，因为他们所有的交易都会关联到同一个地址，很容易被识别和分析。</p><p>静默支付的目标是解决上述挑战。其地址的设计目标是可以复用（静态），但发送到静默支付地址的交易将只有发送者和接收者（地址的主人）才能识别出来。所以慈善机构可以在网页中公开一个稳定不变的捐款地址，而不让任何人知道谁捐了钱、捐了多少。交易所也可以为你所有的取款登记一个静默支付地址。</p><h2 id=比特币交易><a href=#比特币交易 class=headerlink title=比特币交易></a>比特币交易</h2><p>比特币的交易由输入和输出组成。</p><p><img src=/../images/understanding-silent-payments-part-one/input-and-output.png alt=input-and-output></p><p>输出会产生新的 UTXO（未花费的交易输出），而输入则是花费现有的 UTXO 。如果关于 “UTXO” 你想了解更多，可以看看我们<a target=_blank rel=noopener href=https://blog.bitbox.swiss/en/whats-a-utxo/ >关于这个主题的文章</a>。</p><p>最常见的情况是，一个 UTXO 是用一个<strong>公钥</strong>来锁定的，而要花费它的时候，需要提供一个由该公钥背后的<strong>私钥</strong>所生成的签名。当你为比特币交易填入一个地址的时候，通常，这个地址就编码了一个公钥（或者一个公钥的哈希值）。</p><p>静默支付使用了一些有趣的密码学技术，为发送给一个静默支付地址的每一笔交易都派生一个新的、没有用过的公钥。现在，让我们来了解一下这背后的知识和直觉。下文是对静默支付工作原理的简化的、概要的描述。想要了解所有的细节，还是得看<a target=_blank rel=noopener href=https://github.com/bitcoin/bips/blob/master/bip-0352.mediawiki>它的 BIP 本身</a>。</p><h2 id=迷你入门课：私钥和公钥><a href=#迷你入门课：私钥和公钥 class=headerlink title=迷你入门课：私钥和公钥></a>迷你入门课：私钥和公钥</h2><p>私钥就是一个很大的数字，长到无法猜测出来，比如说：</p><p>$92193805913277071008055984303319191614197341949664602874511898854633635443214$</p><p>每一个私钥都能生成一个对应的公钥。公钥不会暴露其背后的私钥的任何信息。</p><p>从技术上来说，公钥属于一个数学上特殊的 “群”，它有自己专门的假发。如果你想了解更多，《 <em><a target=_blank rel=noopener href=https://andrea.corbellini.name/2015/05/17/elliptic-curve-cryptography-a-gentle-introduction/ >椭圆曲线密码学：通俗介绍</a></em> 》这个系列博客是非常好的材料。</p><p>从私钥生成公钥的公式是：</p><p>$公钥 &#x3D; 私钥 \times G$</p><p>这里的 $G$ 是预定义的值，称为 “生成元”。生成元是一个特殊的公钥。所有其它的公钥，都是通过生成元和加法，生成出来的。</p><p>比如说，如果你的私钥是 $2$ ，那么，你的公钥就是 $2 \times G &#x3D; G + G$ 。如果你的私钥是 $3$ ，那你的公钥就是 $3 \times G &#x3D; G + G + G$ ，依此类推。 当然，在实际用途中，你的私钥会是一个非常大的、怎么猜也猜不到的数字，就像上面那个例子。</p><p><img src=/../images/understanding-silent-payments-part-one/privkey-and-pubkey.png alt=privkey-and-pubkey></p><p>除了不能反向计算，大部分常用的数学，在公钥所在的群里也是一样的。比如大家熟悉的 “结合律”，依然成立：</p><p>$(a + b) \times G &#x3D; a \times G + b \times G$</p><p><strong>在本文剩余的章节中，我们用小写字母来表示私钥，用大写字母来表示公钥。例如：</strong>$a \times G &#x3D; A$ 。</p><h2 id=椭圆曲线上的-Diffie-Hellman-密钥交换><a href=#椭圆曲线上的-Diffie-Hellman-密钥交换 class=headerlink title="椭圆曲线上的 Diffie-Hellman 密钥交换"></a>椭圆曲线上的 Diffie-Hellman 密钥交换</h2><p>“椭圆曲线上的 Diffie-Hellman 密钥交换（<a target=_blank rel=noopener href=https://en.wikipedia.org/wiki/Elliptic-curve_Diffie%E2%80%93Hellman>ECDH</a>）” 是一套简单的协议，为两个参与者 Alice 和 Bob 创建一个他们共享的秘密值。</p><p>我们假设 Alice 要给 Bob 发送一笔交易。</p><ul><li>Alice 的公私钥对：$a \times G &#x3D; A$</li><li>Bob 的公私钥对：$b \times G &#x3D; B$</li></ul><p>只需要把自己的公钥交给对方，他们就可以创建一个只有他们俩知道的秘密值。</p><ul><li>Alice 计算共享秘密值： $S &#x3D; a \times B$</li><li>Bob 计算共享秘密值：$S &#x3D; b \times A$</li></ul><p><img src=/../images/understanding-silent-payments-part-one/ECDH.png alt=ECDH></p><p>你可以看出，两个数值是一样的：<br>$$<br>S &#x3D; a \times B &#x3D; a \times (b \times G) &#x3D; a \times b \times G &#x3D; b \times a \times G &#x3D; b \times (a \times G) &#x3D; b \times A<br>$$<br>技术上来说，$S$ 是私钥 $a \times b$ 所对应的公钥，可以用在交易的输出中，作为锁定输出的公钥，但是，需要让 Alice 和 Bob 的私钥结合起来，才能花费它。</p><p>为了避免分享私钥，我们可以通过哈希算法，将它转化为一个新的私钥：$s &#x3D; hash(S)$ 。从而，我们可以用这样的公钥来锁定输出：<br>$$<br>P &#x3D; hash(S) \times G &#x3D; hash(a \times B) \times G &#x3D; hash(b \times A) \times G<br>$$<br>被这个公钥锁定的资金，可以被发送者和接收者任何一方（使用自己的私钥）花费。那怎么做到让它只能被 Bob 花费呢？接着往下看。</p><h2 id=静默支付><a href=#静默支付 class=headerlink title=静默支付></a>静默支付</h2><p>静默支付地址的前缀为 <code>sp1</code>（而不是我们熟悉的 <code>bc1</code>），而且，它看起来是这样的：<br>$$<br>sp1qqgste7k9hx0qftg6qmwlkqtwuy6cycyavzmzj85c6qdfhjdpdjtdgqjuexzk6murw56suy3e0rd2cgqvycxttddwsvgxe2usfpxumr70xc9pkqwv<br>$$<br>非常长对吧？因为它编码了接收者的<strong>两个</strong>公钥：一个用于扫描的公钥 $B_{scan}$，一个用于花费的公钥 $B_{spend}$ 。额外的公钥，是为了让只有 Bob 才能花费。</p><p>在发送交易的时候，Alice 为 Bob 安排的输出所用的公钥不是 $P &#x3D; hash(S) \times G$，而是<strong>加入</strong>了 Bob 的第二个公钥的调整版本：$P &#x3D; B_{spend} + hash(S) \times G$ 。至于 $S$ ，Alice 用 Bob 的扫描公钥和自己的私钥计算出来：$S &#x3D; a \times B_{scan}$ 。</p><p>Alice 能计算出公钥 $P$，是因为她从 Bob 的静默支付地址中知道了 $B_{scan}$ 和 $B_{spend}$ ，而且她知道自己的私钥 $a$ 。</p><p>最终的公钥 $P$ 会用来锁定添加到交易的一个 Taproot 输出。</p><p>只有 Bob ，才能够用自己的两个私钥 $b_{spend}$ 和 $b_{scan}$ 来花费这个输出中的资金，因为只有他才知道 $P$ 背后的私钥：<br>$$<br>P &#x3D; B_{spend} + hash(S) \times G &#x3D; b_{spend} \times G + hash(b_{scan} \times A) \times G &#x3D; (b_{spend} + hash(b_{scan} \times A)) \times G<br>$$<br>所以，Bob 最后用来花费这个输出的私钥就是：$p &#x3D; b_{spend} + hash(b_{scan} \times A)$ 。</p><p>Bob 使用自己的扫描私钥计算出共享秘密值的哈希值 $hash(S) &#x3D; hash(b_{scan} \times A)$ ，再加入自己的花费私钥，就可以计算出最终的私钥。</p><p><img src=/../images/understanding-silent-payments-part-one/Bob-calculation.png alt=Bob-calculation></p><h2 id=那么-Alice-到底使用哪个私钥呢？Bob-怎么知道这个私钥所对应的公钥？><a href=#那么-Alice-到底使用哪个私钥呢？Bob-怎么知道这个私钥所对应的公钥？ class=headerlink title="那么 Alice 到底使用哪个私钥呢？Bob 怎么知道这个私钥所对应的公钥？"></a>那么 Alice 到底使用哪个私钥呢？Bob 怎么知道这个私钥所对应的公钥？</h2><p>Alice 想给 Bob 支付，她知道 Bob 的公钥，因为 Bob 所公开的静默支付地址里面有。</p><p>那么 Alice 的密钥呢？Bob 怎么知道 Alice 所用的公钥？不知道 Alice 的公钥，不就没办法重新创建出共享秘密值、也无法探测出发给他的静默支付交易、更没法花费资金了嘛？要是接收者还需要跟每个支付者沟通、获得对方的公钥，那就很不方便。</p><p>解决方案非常优雅：所有附加到交易本身的有关密钥！</p><p>Alice 花费自己的 UTXO、制作发送给 Bob 的交易；这些 UTXO 本身分别被一个 公私钥对 锁定。她需要自己的私钥来花费自己的资金，那何不直接使用这些私钥来创建共享秘密值呢？</p><p>所以，Alice 拿自己用作交易输入的所有 UTXO 的私钥，来创建用在静默支付中的共享秘密值。</p><p>Bob 可以通过所有交易输入的公钥，计算出共享秘密值。</p><p>一笔交易可能有多个输入，所以 Alice 要使用一个结合私钥，就是所有输入的私钥之和：</p><p>$a &#x3D; a_1 + a_2 + …$</p><p>Bob 也要使用交易的结合公钥，也就是所有交易输入的公钥之和：</p><p>$A &#x3D; A_1 + A_2 + …$</p><p><img src=/../images/understanding-silent-payments-part-one/Alice-pubkey.png alt=Alice-pubkey></p><p>根据<strong>结合律</strong>，这些私钥的和正是公钥的和所对应的私钥：<br>$$<br>A &#x3D; (a_1 + a_2 + …) \times G &#x3D; a_1 \times G + a_2 \times G + … &#x3D; A_1 + A_2 + …<br>$$<br>为了实现上述效果，每一个输入都必须有且仅有一个相关的公钥。因此，静默支付仅允许使用<a target=_blank rel=noopener href=https://github.com/bitcoin/bips/blob/master/bip-0352.mediawiki#inputs-for-shared-secret-derivation>下列脚本类型</a>的输入：P2TR（且要求是密钥花费）、P2WPKH、P2WPKH-P2SH、P2PKH；换句话说，之允许使用单签名的脚本类型，这也是当前最常见的类型。不幸的是，如果 Alice 用的是一个原生的多签名脚本（而不是 MuSig2 或其它能够聚合成单个公钥的聚合签名方案），或者是其它高级脚本，就无法发起静默支付。我认为这是静默支付的一个很大的缺点，也是阻止其得到采用的巨大障碍。</p><h2 id=确保地址不会复用><a href=#确保地址不会复用 class=headerlink title=确保地址不会复用></a>确保地址不会复用</h2><p>静默支付的主要目标是避免 地址&#x2F;公钥 复用。根据上述方案，接收者的公钥是从 Alice 在交易输入中的公钥和 Bob 的静默支付地址中动态创建出来的。然而，如果 Alice 一直使用同一个地址，那么她发送给 Bob 的静默支付地址的多笔交易，会因为使用相同的输入公钥而产生相同的输出公钥。</p><p>为了解决这个问题，静默支付提议规定，输出公钥并不像上文那样计算（$P &#x3D; B_{spend} + hash(S) \times G$）；而要这么计算：</p><p>$P &#x3D; B_{spend} + hash(input_{hash} \times S) \times G$</p><p>这里的 $input_{hash} &#x3D; hash(outpoint || A)$ ，也就是交易的其中一个输入的输出点与公钥的字节拼接的哈希值。输入的 “输出点” 是一个交易 ID 和一个输出索引号，是 UTXO 的唯一标识符。因为 UTXO 在比特币区块链上无法重复花费，那么 UTXO 的唯一标识符的哈希值就保证了独一无二的输出公钥，因为没有两个 UTXO 会有同样的标识符。出于 BIP 所说的一个<a target=_blank rel=noopener href=https://github.com/bitcoin/bips/blob/master/bip-0352.mediawiki#cite_note-why_include_A_3>技术理由</a>，$A$ 也放在哈希函数中。</p><p><img src=/../images/understanding-silent-payments-part-one/input-hash.png alt=input-hash></p><p>在提议的最初草案中，input_hash 是根据所有交易输入（在运行字典排序后）计算出来的。在我的评审意见中，我<a target=_blank rel=noopener href=https://github.com/bitcoin/bips/pull/1458#pullrequestreview-1645164067>指出</a>这对硬件签名器是个挑战（点击页面中的 “Show resolved” 来展开帖子：</p><blockquote><p>这对硬件签名器是个挑战。硬件签名器的内存有限，也许无法加载所有的输出点并加以排序。因此，将不得不限制交易为在签名时刻已经有排好序的输入，这是不理想的，而且会产生兼容性问题。</p><p>与其使用排好序的输出点的哈希值，也许我们可以使用 ……</p></blockquote><p>在许多人参与讨论之后，能够满足要求、也适合硬件签名器的解决方案出现了：仅哈希一个输入，在字典排序中最小的哪个输入。这产生了该 BIP 的最终版本，并让 BitBox02 可以无摩擦地实现对静默支付的支持。</p><h2 id=总结><a href=#总结 class=headerlink title=总结></a>总结</h2><p>我们介绍了静默支付的概念；作为一个比特币优化提议，它提出了一种新的地址格式，让用户可以重复使用一个静态地址，同时保护隐私性。我们介绍了私钥和公钥的基本概念，讨论了使用 ECDH 来创建共享秘密值的过，以及这种技术如何用来锁定资金、保证只有接收者才能花费它们。</p><p>在下一篇文章中，我们将了解静默支付如何改变了硬件签名器的角色，以及为了安全地支持静默支付 ，硬件签名器要做哪些事情。</p><blockquote><p><em><a href=https://www.btcstudy.org/2025/08/12/understanding-silent-payments-part-two/ >续篇见此处</a></em></p></blockquote></article></div></div></main><script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.8/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><script>MathJax.Hub.Config({tex2jax:{inlineMath:[["$","$"],["\\(","\\)"]],processEscapes:!0,skipTags:["script","noscript","style","textarea","pre","code"]}}),MathJax.Hub.Queue(function(){for(var a=MathJax.Hub.getAllJax(),e=0;e<a.length;e+=1)a[e].SourceElement().parentNode.className+=" has-jax"})</script><script src="/js/post.js?v=1682773100887"></script><script src="/js/highlight.min.js?v=1682773100887"></script><script>var containerEl=document.querySelector(".post-container"),postFontSize=localStorage.getItem("post-font-size")||"16",inputEl=document.querySelector("#size-change-input"),inputEl2=document.querySelector("#size-change-input2");inputEl.value=postFontSize,inputEl2.value=postFontSize,containerEl.style.fontSize=postFontSize+"px",$(function(){function e(t){$(".post-container").css("font-size",t+"px"),localStorage.setItem("post-font-size",t),$("#size-change-input").val(t),$("#size-change-input2").val(t)}$("#size-change-input").on("input propertychange",function(t){e(t.target.value)}),$("#size-change-input2").on("input propertychange",function(t){e(t.target.value)})})</script><script>hljs.initHighlightingOnLoad()</script></main></div><footer class="is-flex is-flex-direction-column is-align-items-center is-flex-shrink-0"><section class=sns-container><a title=nostr target=_blank rel="noopener nofollow" href=https://iris.to/npub1g2qs0ca5kpwlrcfug2em4jelmh65clk3yccwjxrs6hvdpd9qj80q022j4m>Nostr</a><a title=rss target=_blank rel="noopener nofollow" href=/atom.xml>rss</a><a title=telegram target=_blank rel="noopener nofollow" href=//t.me/btcstudyorg>Telegram</a></section></footer><script async src="/js/buttons.js?v=1682773100887"></script><script async src="/js/index.js?v=1682773100887"></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-JVCJ9XXG1Z"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-JVCJ9XXG1Z")</script><script>var _hmt=_hmt||[];(()=>{var e=document.createElement("script"),t=(e.src="https://hm.baidu.com/hm.js?c92c073c85be5be8d9b1b76f62a7e306",e.async=!0,e.defer=!0,document.getElementsByTagName("script")[0]);t.parentNode.insertBefore(e,t)})()</script></body></html>