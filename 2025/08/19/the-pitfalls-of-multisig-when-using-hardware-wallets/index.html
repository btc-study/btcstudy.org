<!DOCTYPE html><html lang=zh-CN><head><meta charset=UTF-8><title>硬件签名器多签的潜在陷阱</title><meta name=keywords content="比特币, 中本聪, 比特币区块链, 闪电网络, 比特币 layer 2, 健全货币, 密码货币, 密码朋克, 学习比特币, BTC, BTC Study, Bitcoin, bitcoin, proof of work"><meta name=description content=比特币思想的中文集结地><meta name=viewport content="width=device-width,minimum-scale=1,maximum-scale=1,initial-scale=1"><link rel=icon href=/favicon.ico><link rel=stylesheet href="/style/common/bulma.css?v=1682773100887"><link rel=preload as=style onload='this.onload=null,this.rel="stylesheet"' href="/style/common/iconfont.css?v=1682773100887"><link rel=stylesheet href="/style/base.css?v=1682773100887"><link rel=stylesheet href="/style/common/helper.css?v=1682773100887"><link rel=stylesheet href="/style/themes/animation.css?v=1682773100887"><script>function ready(){var e=document.querySelector(".body-container"),t=localStorage.getItem("theme")||"light";["light","dark"].includes(t)||(t="light",localStorage.setItem("theme","light")),e.classList.remove("appearance-auto"),e.classList.add("appearance-"+t),quickInitialTheme()}function quickInitialTheme(){var e=localStorage.getItem("theme")||"light",t=document.querySelector(".logo-light"),o=document.querySelector(".logo-dark"),d=document.querySelector("#mobile-header-logo > .logo-light"),l=document.querySelector("#mobile-header-logo > .logo-dark"),a=document.getElementById("theme-btn"),i=document.querySelector(".slide-theme-light"),c=document.querySelector(".slide-theme-dark");document.body.classList.add(e),("dark"===e?(t.classList.add("hidden"),o.classList.remove("hidden"),d.classList.add("hidden"),l.classList.remove("hidden"),a.classList.remove("icon-icon_dark"),a.classList.add("icon-icon_light"),i):c).classList.remove("hidden")}document.addEventListener("DOMContentLoaded",ready)</script><script src="/js/common.js?v=1682773100887"></script><script src=/js/libs/zepto.min.js></script><link rel=stylesheet href="/style/post.css?v=1682773100887"><link rel=stylesheet href="/style/themes/highlight.css?v=1682773100887"><meta name=generator content="Hexo 6.3.0"><link rel=alternate href=/atom.xml title="BTC Study" type=application/atom+xml></head><body class="is-flex is-flex-direction-column" onload=initialTheme()><div class=clip></div><div class="body-container appearance-auto"><header class="header-widget is-hidden-mobile is-flex is-flex-shrink-0 is-align-items-center is-justify-content-center" id=header><div class="is-flex header-widget-container is-flex-shrink-0 is-align-items-center"><section class="is-hidden-mobile is-flex-shrink-0"><h1><a href=/ ><svg class=logo-light width=125px height=23px viewBox="0 0 125 23" version=1.1 xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink><title>BTCStudy</title><g id=页面-1 stroke=none stroke-width=1 fill=none fill-rule=evenodd><g id=首页-响应式 transform="translate(-249.000000, -23.000000)" fill-rule=nonzero><g id=BTCStudy transform="translate(249.680000, 23.192000)"><path d="M9.072,17.808 C11.312,17.808 13.024,17.408 14.208,16.608 C15.392,15.808 15.984,14.672 15.984,13.2 C15.984,12.192 15.712,11.332 15.168,10.62 C14.624,9.908 13.872,9.384 12.912,9.048 C13.632,8.68 14.188,8.18 14.58,7.548 C14.972,6.916 15.168,6.2 15.168,5.4 C15.168,4.056 14.608,2.988 13.488,2.196 C12.368,1.404 10.736,1.008 8.592,1.008 L8.592,1.008 L-5.68434189e-14,1.008 L-5.68434189e-14,17.808 L9.072,17.808 Z M7.968,7.68 L4.704,7.68 L4.704,4.44 L7.968,4.44 C9.568,4.44 10.368,4.976 10.368,6.048 C10.368,7.136 9.568,7.68 7.968,7.68 L7.968,7.68 Z M8.688,14.376 L4.704,14.376 L4.704,10.968 L8.688,10.968 C10.352,10.968 11.184,11.536 11.184,12.672 C11.184,13.808 10.352,14.376 8.688,14.376 L8.688,14.376 Z M26.544,17.808 L26.544,4.776 L31.68,4.776 L31.68,1.008 L16.632,1.008 L16.632,4.776 L21.792,4.776 L21.792,17.808 L26.544,17.808 Z M41.592,18.144 C43.128,18.144 44.512,17.872 45.744,17.328 C46.976,16.784 48,16 48.816,14.976 L48.816,14.976 L45.792,12.24 C44.704,13.552 43.384,14.208 41.832,14.208 C40.92,14.208 40.108,14.008 39.396,13.608 C38.684,13.208 38.132,12.644 37.74,11.916 C37.348,11.188 37.152,10.352 37.152,9.408 C37.152,8.464 37.348,7.628 37.74,6.9 C38.132,6.172 38.684,5.608 39.396,5.208 C40.108,4.808 40.92,4.608 41.832,4.608 C43.384,4.608 44.704,5.264 45.792,6.576 L45.792,6.576 L48.816,3.84 C48,2.816 46.976,2.032 45.744,1.488 C44.512,0.944 43.128,0.672 41.592,0.672 C39.832,0.672 38.252,1.044 36.852,1.788 C35.452,2.532 34.352,3.568 33.552,4.896 C32.752,6.224 32.352,7.728 32.352,9.408 C32.352,11.088 32.752,12.592 33.552,13.92 C34.352,15.248 35.452,16.284 36.852,17.028 C38.252,17.772 39.832,18.144 41.592,18.144 Z" id=BTC fill=#F2A900></path><path d="M56.64,18.144 C58.24,18.144 59.6,17.9 60.72,17.412 C61.84,16.924 62.68,16.272 63.24,15.456 C63.8,14.64 64.08,13.728 64.08,12.72 C64.08,11.552 63.772,10.628 63.156,9.948 C62.54,9.268 61.812,8.772 60.972,8.46 C60.132,8.148 59.072,7.856 57.792,7.584 C56.656,7.344 55.832,7.112 55.32,6.888 C54.808,6.664 54.552,6.328 54.552,5.88 C54.552,5.432 54.768,5.068 55.2,4.788 C55.632,4.508 56.32,4.368 57.264,4.368 C58.768,4.368 60.32,4.8 61.92,5.664 L61.92,5.664 L63.384,2.136 C62.568,1.656 61.624,1.292 60.552,1.044 C59.48,0.796 58.392,0.672 57.288,0.672 C55.672,0.672 54.308,0.912 53.196,1.392 C52.084,1.872 51.248,2.524 50.688,3.348 C50.128,4.172 49.848,5.096 49.848,6.12 C49.848,7.288 50.152,8.216 50.76,8.904 C51.368,9.592 52.096,10.092 52.944,10.404 C53.792,10.716 54.848,11.008 56.112,11.28 C57.264,11.536 58.1,11.78 58.62,12.012 C59.14,12.244 59.4,12.6 59.4,13.08 C59.4,13.992 58.488,14.448 56.664,14.448 C55.704,14.448 54.728,14.296 53.736,13.992 C52.744,13.688 51.872,13.288 51.12,12.792 L51.12,12.792 L49.56,16.296 C50.36,16.856 51.4,17.304 52.68,17.64 C53.96,17.976 55.28,18.144 56.64,18.144 Z M71.856,18.024 C72.48,18.024 73.068,17.96 73.62,17.832 C74.172,17.704 74.64,17.52 75.024,17.28 L75.024,17.28 L73.896,14.088 C73.496,14.36 73.032,14.496 72.504,14.496 C72.088,14.496 71.756,14.364 71.508,14.1 C71.26,13.836 71.136,13.472 71.136,13.008 L71.136,13.008 L71.136,8.688 L74.112,8.688 L74.112,5.28 L71.136,5.28 L71.136,1.896 L66.576,1.896 L66.576,5.28 L64.68,5.28 L64.68,8.688 L66.576,8.688 L66.576,13.056 C66.576,14.704 67.032,15.944 67.944,16.776 C68.856,17.608 70.16,18.024 71.856,18.024 Z M82.248,18.024 C83,18.024 83.712,17.888 84.384,17.616 C85.056,17.344 85.632,16.944 86.112,16.416 L86.112,16.416 L86.112,17.808 L90.456,17.808 L90.456,4.8 L85.896,4.8 L85.896,11.064 C85.896,12.104 85.668,12.876 85.212,13.38 C84.756,13.884 84.168,14.136 83.448,14.136 C82.744,14.136 82.208,13.912 81.84,13.464 C81.472,13.016 81.288,12.304 81.288,11.328 L81.288,11.328 L81.288,4.8 L76.728,4.8 L76.728,12.072 C76.728,14.056 77.228,15.544 78.228,16.536 C79.228,17.528 80.568,18.024 82.248,18.024 Z M99.048,18.024 C100.744,18.024 102.016,17.52 102.864,16.512 L102.864,16.512 L102.864,17.808 L107.208,17.808 L107.208,0 L102.648,0 L102.648,5.928 C101.8,5.032 100.6,4.584 99.048,4.584 C97.864,4.584 96.784,4.856 95.808,5.4 C94.832,5.944 94.06,6.724 93.492,7.74 C92.924,8.756 92.64,9.936 92.64,11.28 C92.64,12.624 92.924,13.808 93.492,14.832 C94.06,15.856 94.832,16.644 95.808,17.196 C96.784,17.748 97.864,18.024 99.048,18.024 Z M100.008,14.4 C99.208,14.4 98.552,14.124 98.04,13.572 C97.528,13.02 97.272,12.256 97.272,11.28 C97.272,10.32 97.528,9.568 98.04,9.024 C98.552,8.48 99.208,8.208 100.008,8.208 C100.808,8.208 101.46,8.48 101.964,9.024 C102.468,9.568 102.72,10.32 102.72,11.28 C102.72,12.256 102.464,13.02 101.952,13.572 C101.44,14.124 100.792,14.4 100.008,14.4 Z M112.368,22.68 C113.728,22.68 114.88,22.356 115.824,21.708 C116.768,21.06 117.568,19.936 118.224,18.336 L118.224,18.336 L123.84,4.8 L119.496,4.8 L116.28,12.744 L113.088,4.8 L108.408,4.8 L113.976,17.976 C113.784,18.36 113.548,18.64 113.268,18.816 C112.988,18.992 112.632,19.08 112.2,19.08 C111.832,19.08 111.468,19.012 111.108,18.876 C110.748,18.74 110.44,18.552 110.184,18.312 L110.184,18.312 L108.6,21.504 C109.032,21.856 109.596,22.14 110.292,22.356 C110.988,22.572 111.68,22.68 112.368,22.68 Z" id=Study fill-opacity=0.85 fill=#000000></path></g></g></g></svg><svg class="logo-dark hidden" width=125px height=23px viewBox="0 0 125 23" version=1.1 xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink><title>BTCStudy</title><g id=页面-1 stroke=none stroke-width=1 fill=none fill-rule=evenodd><g id=首页-响应式 transform="translate(-249.000000, -23.000000)" fill-rule=nonzero><g id=BTCStudy transform="translate(249.680000, 23.192000)"><path d="M9.072,17.808 C11.312,17.808 13.024,17.408 14.208,16.608 C15.392,15.808 15.984,14.672 15.984,13.2 C15.984,12.192 15.712,11.332 15.168,10.62 C14.624,9.908 13.872,9.384 12.912,9.048 C13.632,8.68 14.188,8.18 14.58,7.548 C14.972,6.916 15.168,6.2 15.168,5.4 C15.168,4.056 14.608,2.988 13.488,2.196 C12.368,1.404 10.736,1.008 8.592,1.008 L8.592,1.008 L-5.68434189e-14,1.008 L-5.68434189e-14,17.808 L9.072,17.808 Z M7.968,7.68 L4.704,7.68 L4.704,4.44 L7.968,4.44 C9.568,4.44 10.368,4.976 10.368,6.048 C10.368,7.136 9.568,7.68 7.968,7.68 L7.968,7.68 Z M8.688,14.376 L4.704,14.376 L4.704,10.968 L8.688,10.968 C10.352,10.968 11.184,11.536 11.184,12.672 C11.184,13.808 10.352,14.376 8.688,14.376 L8.688,14.376 Z M26.544,17.808 L26.544,4.776 L31.68,4.776 L31.68,1.008 L16.632,1.008 L16.632,4.776 L21.792,4.776 L21.792,17.808 L26.544,17.808 Z M41.592,18.144 C43.128,18.144 44.512,17.872 45.744,17.328 C46.976,16.784 48,16 48.816,14.976 L48.816,14.976 L45.792,12.24 C44.704,13.552 43.384,14.208 41.832,14.208 C40.92,14.208 40.108,14.008 39.396,13.608 C38.684,13.208 38.132,12.644 37.74,11.916 C37.348,11.188 37.152,10.352 37.152,9.408 C37.152,8.464 37.348,7.628 37.74,6.9 C38.132,6.172 38.684,5.608 39.396,5.208 C40.108,4.808 40.92,4.608 41.832,4.608 C43.384,4.608 44.704,5.264 45.792,6.576 L45.792,6.576 L48.816,3.84 C48,2.816 46.976,2.032 45.744,1.488 C44.512,0.944 43.128,0.672 41.592,0.672 C39.832,0.672 38.252,1.044 36.852,1.788 C35.452,2.532 34.352,3.568 33.552,4.896 C32.752,6.224 32.352,7.728 32.352,9.408 C32.352,11.088 32.752,12.592 33.552,13.92 C34.352,15.248 35.452,16.284 36.852,17.028 C38.252,17.772 39.832,18.144 41.592,18.144 Z" id=BTC fill=#F2A900></path><path d="M56.64,18.144 C58.24,18.144 59.6,17.9 60.72,17.412 C61.84,16.924 62.68,16.272 63.24,15.456 C63.8,14.64 64.08,13.728 64.08,12.72 C64.08,11.552 63.772,10.628 63.156,9.948 C62.54,9.268 61.812,8.772 60.972,8.46 C60.132,8.148 59.072,7.856 57.792,7.584 C56.656,7.344 55.832,7.112 55.32,6.888 C54.808,6.664 54.552,6.328 54.552,5.88 C54.552,5.432 54.768,5.068 55.2,4.788 C55.632,4.508 56.32,4.368 57.264,4.368 C58.768,4.368 60.32,4.8 61.92,5.664 L61.92,5.664 L63.384,2.136 C62.568,1.656 61.624,1.292 60.552,1.044 C59.48,0.796 58.392,0.672 57.288,0.672 C55.672,0.672 54.308,0.912 53.196,1.392 C52.084,1.872 51.248,2.524 50.688,3.348 C50.128,4.172 49.848,5.096 49.848,6.12 C49.848,7.288 50.152,8.216 50.76,8.904 C51.368,9.592 52.096,10.092 52.944,10.404 C53.792,10.716 54.848,11.008 56.112,11.28 C57.264,11.536 58.1,11.78 58.62,12.012 C59.14,12.244 59.4,12.6 59.4,13.08 C59.4,13.992 58.488,14.448 56.664,14.448 C55.704,14.448 54.728,14.296 53.736,13.992 C52.744,13.688 51.872,13.288 51.12,12.792 L51.12,12.792 L49.56,16.296 C50.36,16.856 51.4,17.304 52.68,17.64 C53.96,17.976 55.28,18.144 56.64,18.144 Z M71.856,18.024 C72.48,18.024 73.068,17.96 73.62,17.832 C74.172,17.704 74.64,17.52 75.024,17.28 L75.024,17.28 L73.896,14.088 C73.496,14.36 73.032,14.496 72.504,14.496 C72.088,14.496 71.756,14.364 71.508,14.1 C71.26,13.836 71.136,13.472 71.136,13.008 L71.136,13.008 L71.136,8.688 L74.112,8.688 L74.112,5.28 L71.136,5.28 L71.136,1.896 L66.576,1.896 L66.576,5.28 L64.68,5.28 L64.68,8.688 L66.576,8.688 L66.576,13.056 C66.576,14.704 67.032,15.944 67.944,16.776 C68.856,17.608 70.16,18.024 71.856,18.024 Z M82.248,18.024 C83,18.024 83.712,17.888 84.384,17.616 C85.056,17.344 85.632,16.944 86.112,16.416 L86.112,16.416 L86.112,17.808 L90.456,17.808 L90.456,4.8 L85.896,4.8 L85.896,11.064 C85.896,12.104 85.668,12.876 85.212,13.38 C84.756,13.884 84.168,14.136 83.448,14.136 C82.744,14.136 82.208,13.912 81.84,13.464 C81.472,13.016 81.288,12.304 81.288,11.328 L81.288,11.328 L81.288,4.8 L76.728,4.8 L76.728,12.072 C76.728,14.056 77.228,15.544 78.228,16.536 C79.228,17.528 80.568,18.024 82.248,18.024 Z M99.048,18.024 C100.744,18.024 102.016,17.52 102.864,16.512 L102.864,16.512 L102.864,17.808 L107.208,17.808 L107.208,0 L102.648,0 L102.648,5.928 C101.8,5.032 100.6,4.584 99.048,4.584 C97.864,4.584 96.784,4.856 95.808,5.4 C94.832,5.944 94.06,6.724 93.492,7.74 C92.924,8.756 92.64,9.936 92.64,11.28 C92.64,12.624 92.924,13.808 93.492,14.832 C94.06,15.856 94.832,16.644 95.808,17.196 C96.784,17.748 97.864,18.024 99.048,18.024 Z M100.008,14.4 C99.208,14.4 98.552,14.124 98.04,13.572 C97.528,13.02 97.272,12.256 97.272,11.28 C97.272,10.32 97.528,9.568 98.04,9.024 C98.552,8.48 99.208,8.208 100.008,8.208 C100.808,8.208 101.46,8.48 101.964,9.024 C102.468,9.568 102.72,10.32 102.72,11.28 C102.72,12.256 102.464,13.02 101.952,13.572 C101.44,14.124 100.792,14.4 100.008,14.4 Z M112.368,22.68 C113.728,22.68 114.88,22.356 115.824,21.708 C116.768,21.06 117.568,19.936 118.224,18.336 L118.224,18.336 L123.84,4.8 L119.496,4.8 L116.28,12.744 L113.088,4.8 L108.408,4.8 L113.976,17.976 C113.784,18.36 113.548,18.64 113.268,18.816 C112.988,18.992 112.632,19.08 112.2,19.08 C111.832,19.08 111.468,19.012 111.108,18.876 C110.748,18.74 110.44,18.552 110.184,18.312 L110.184,18.312 L108.6,21.504 C109.032,21.856 109.596,22.14 110.292,22.356 C110.988,22.572 111.68,22.68 112.368,22.68 Z" id=Study fill-opacity=0.85 fill=#FFFFFF></path></g></g></g></svg></a></h1></section><div class="is-flex is-flex-direction-column header-menu-wrap"><aside class="is-flex-shrink-0 is-flex is-flex-direction-row is-align-items-center" id=header-menu><a class="is-inline-block header-activity mr-4" href=/ >首页</a><a class="is-inline-block mr-4" href=/archives>全站目录</a><a class="is-inline-block mr-4" href=/tags>标签</a><a class="is-inline-block mr-4" href=/maps>地图</a><a class="is-inline-block mr-4" href=/mempool>mempool</a><a class="is-inline-block mr-4" target=_blank rel=noopener href=https://123btc.org/ >123btc</a><div class="right-content is-flex is-flex-direction-row is-align-items-center"><div class="size-wrap mr-1"><i class="iconfont icon-a-bianzu5" id=change-size-btn></i><div class=size-input-wrap><div class=input-wrap><input id=size-change-input type=range min=12 max=32 step=2></div></div></div><i class="iconfont icon-icon_dark mr-1" id=theme-btn></i><div class=search-wrap><input class=pl-3 id=search-input placeholder=请输入搜索关键词><i class="iconfont icon-icon_search" id=search-input-btn></i></div></div></aside><div class="header-title is-hidden-mobile is-full-height is-flex is-align-items-center is-flex-shrink-0"><div class="is-full-height hidden" id=postTopic><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">硬件签名器多签的潜在陷阱</p><div class="size-wrap mr-1"><i class="iconfont icon-a-bianzu5" id=change-size-btn2></i><div class=size-input-wrap><div class=input-wrap><input id=size-change-input2 type=range min=12 max=32 step=2></div></div></div></div></div></div></div></header><header class="is-flex header-widget is-flex-shrink-0 is-align-items-center is-justify-content-space-between is-hidden-tablet" id=mobile-header><div class="is-flex is-flex-direction-row is-align-items-center"><i class="iconfont icon-icon_bar mobile-header-menu"></i><div id=mobile-header-logo><svg class=logo-light width=125px height=23px viewBox="0 0 125 23" version=1.1 xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink><title>BTCStudy</title><g id=页面-1 stroke=none stroke-width=1 fill=none fill-rule=evenodd><g id=首页-响应式 transform="translate(-249.000000, -23.000000)" fill-rule=nonzero><g id=BTCStudy transform="translate(249.680000, 23.192000)"><path d="M9.072,17.808 C11.312,17.808 13.024,17.408 14.208,16.608 C15.392,15.808 15.984,14.672 15.984,13.2 C15.984,12.192 15.712,11.332 15.168,10.62 C14.624,9.908 13.872,9.384 12.912,9.048 C13.632,8.68 14.188,8.18 14.58,7.548 C14.972,6.916 15.168,6.2 15.168,5.4 C15.168,4.056 14.608,2.988 13.488,2.196 C12.368,1.404 10.736,1.008 8.592,1.008 L8.592,1.008 L-5.68434189e-14,1.008 L-5.68434189e-14,17.808 L9.072,17.808 Z M7.968,7.68 L4.704,7.68 L4.704,4.44 L7.968,4.44 C9.568,4.44 10.368,4.976 10.368,6.048 C10.368,7.136 9.568,7.68 7.968,7.68 L7.968,7.68 Z M8.688,14.376 L4.704,14.376 L4.704,10.968 L8.688,10.968 C10.352,10.968 11.184,11.536 11.184,12.672 C11.184,13.808 10.352,14.376 8.688,14.376 L8.688,14.376 Z M26.544,17.808 L26.544,4.776 L31.68,4.776 L31.68,1.008 L16.632,1.008 L16.632,4.776 L21.792,4.776 L21.792,17.808 L26.544,17.808 Z M41.592,18.144 C43.128,18.144 44.512,17.872 45.744,17.328 C46.976,16.784 48,16 48.816,14.976 L48.816,14.976 L45.792,12.24 C44.704,13.552 43.384,14.208 41.832,14.208 C40.92,14.208 40.108,14.008 39.396,13.608 C38.684,13.208 38.132,12.644 37.74,11.916 C37.348,11.188 37.152,10.352 37.152,9.408 C37.152,8.464 37.348,7.628 37.74,6.9 C38.132,6.172 38.684,5.608 39.396,5.208 C40.108,4.808 40.92,4.608 41.832,4.608 C43.384,4.608 44.704,5.264 45.792,6.576 L45.792,6.576 L48.816,3.84 C48,2.816 46.976,2.032 45.744,1.488 C44.512,0.944 43.128,0.672 41.592,0.672 C39.832,0.672 38.252,1.044 36.852,1.788 C35.452,2.532 34.352,3.568 33.552,4.896 C32.752,6.224 32.352,7.728 32.352,9.408 C32.352,11.088 32.752,12.592 33.552,13.92 C34.352,15.248 35.452,16.284 36.852,17.028 C38.252,17.772 39.832,18.144 41.592,18.144 Z" id=BTC fill=#F2A900></path><path d="M56.64,18.144 C58.24,18.144 59.6,17.9 60.72,17.412 C61.84,16.924 62.68,16.272 63.24,15.456 C63.8,14.64 64.08,13.728 64.08,12.72 C64.08,11.552 63.772,10.628 63.156,9.948 C62.54,9.268 61.812,8.772 60.972,8.46 C60.132,8.148 59.072,7.856 57.792,7.584 C56.656,7.344 55.832,7.112 55.32,6.888 C54.808,6.664 54.552,6.328 54.552,5.88 C54.552,5.432 54.768,5.068 55.2,4.788 C55.632,4.508 56.32,4.368 57.264,4.368 C58.768,4.368 60.32,4.8 61.92,5.664 L61.92,5.664 L63.384,2.136 C62.568,1.656 61.624,1.292 60.552,1.044 C59.48,0.796 58.392,0.672 57.288,0.672 C55.672,0.672 54.308,0.912 53.196,1.392 C52.084,1.872 51.248,2.524 50.688,3.348 C50.128,4.172 49.848,5.096 49.848,6.12 C49.848,7.288 50.152,8.216 50.76,8.904 C51.368,9.592 52.096,10.092 52.944,10.404 C53.792,10.716 54.848,11.008 56.112,11.28 C57.264,11.536 58.1,11.78 58.62,12.012 C59.14,12.244 59.4,12.6 59.4,13.08 C59.4,13.992 58.488,14.448 56.664,14.448 C55.704,14.448 54.728,14.296 53.736,13.992 C52.744,13.688 51.872,13.288 51.12,12.792 L51.12,12.792 L49.56,16.296 C50.36,16.856 51.4,17.304 52.68,17.64 C53.96,17.976 55.28,18.144 56.64,18.144 Z M71.856,18.024 C72.48,18.024 73.068,17.96 73.62,17.832 C74.172,17.704 74.64,17.52 75.024,17.28 L75.024,17.28 L73.896,14.088 C73.496,14.36 73.032,14.496 72.504,14.496 C72.088,14.496 71.756,14.364 71.508,14.1 C71.26,13.836 71.136,13.472 71.136,13.008 L71.136,13.008 L71.136,8.688 L74.112,8.688 L74.112,5.28 L71.136,5.28 L71.136,1.896 L66.576,1.896 L66.576,5.28 L64.68,5.28 L64.68,8.688 L66.576,8.688 L66.576,13.056 C66.576,14.704 67.032,15.944 67.944,16.776 C68.856,17.608 70.16,18.024 71.856,18.024 Z M82.248,18.024 C83,18.024 83.712,17.888 84.384,17.616 C85.056,17.344 85.632,16.944 86.112,16.416 L86.112,16.416 L86.112,17.808 L90.456,17.808 L90.456,4.8 L85.896,4.8 L85.896,11.064 C85.896,12.104 85.668,12.876 85.212,13.38 C84.756,13.884 84.168,14.136 83.448,14.136 C82.744,14.136 82.208,13.912 81.84,13.464 C81.472,13.016 81.288,12.304 81.288,11.328 L81.288,11.328 L81.288,4.8 L76.728,4.8 L76.728,12.072 C76.728,14.056 77.228,15.544 78.228,16.536 C79.228,17.528 80.568,18.024 82.248,18.024 Z M99.048,18.024 C100.744,18.024 102.016,17.52 102.864,16.512 L102.864,16.512 L102.864,17.808 L107.208,17.808 L107.208,0 L102.648,0 L102.648,5.928 C101.8,5.032 100.6,4.584 99.048,4.584 C97.864,4.584 96.784,4.856 95.808,5.4 C94.832,5.944 94.06,6.724 93.492,7.74 C92.924,8.756 92.64,9.936 92.64,11.28 C92.64,12.624 92.924,13.808 93.492,14.832 C94.06,15.856 94.832,16.644 95.808,17.196 C96.784,17.748 97.864,18.024 99.048,18.024 Z M100.008,14.4 C99.208,14.4 98.552,14.124 98.04,13.572 C97.528,13.02 97.272,12.256 97.272,11.28 C97.272,10.32 97.528,9.568 98.04,9.024 C98.552,8.48 99.208,8.208 100.008,8.208 C100.808,8.208 101.46,8.48 101.964,9.024 C102.468,9.568 102.72,10.32 102.72,11.28 C102.72,12.256 102.464,13.02 101.952,13.572 C101.44,14.124 100.792,14.4 100.008,14.4 Z M112.368,22.68 C113.728,22.68 114.88,22.356 115.824,21.708 C116.768,21.06 117.568,19.936 118.224,18.336 L118.224,18.336 L123.84,4.8 L119.496,4.8 L116.28,12.744 L113.088,4.8 L108.408,4.8 L113.976,17.976 C113.784,18.36 113.548,18.64 113.268,18.816 C112.988,18.992 112.632,19.08 112.2,19.08 C111.832,19.08 111.468,19.012 111.108,18.876 C110.748,18.74 110.44,18.552 110.184,18.312 L110.184,18.312 L108.6,21.504 C109.032,21.856 109.596,22.14 110.292,22.356 C110.988,22.572 111.68,22.68 112.368,22.68 Z" id=Study fill-opacity=0.85 fill=#000000></path></g></g></g></svg><svg class="logo-dark hidden" width=125px height=23px viewBox="0 0 125 23" version=1.1 xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink><title>BTCStudy</title><g id=页面-1 stroke=none stroke-width=1 fill=none fill-rule=evenodd><g id=首页-响应式 transform="translate(-249.000000, -23.000000)" fill-rule=nonzero><g id=BTCStudy transform="translate(249.680000, 23.192000)"><path d="M9.072,17.808 C11.312,17.808 13.024,17.408 14.208,16.608 C15.392,15.808 15.984,14.672 15.984,13.2 C15.984,12.192 15.712,11.332 15.168,10.62 C14.624,9.908 13.872,9.384 12.912,9.048 C13.632,8.68 14.188,8.18 14.58,7.548 C14.972,6.916 15.168,6.2 15.168,5.4 C15.168,4.056 14.608,2.988 13.488,2.196 C12.368,1.404 10.736,1.008 8.592,1.008 L8.592,1.008 L-5.68434189e-14,1.008 L-5.68434189e-14,17.808 L9.072,17.808 Z M7.968,7.68 L4.704,7.68 L4.704,4.44 L7.968,4.44 C9.568,4.44 10.368,4.976 10.368,6.048 C10.368,7.136 9.568,7.68 7.968,7.68 L7.968,7.68 Z M8.688,14.376 L4.704,14.376 L4.704,10.968 L8.688,10.968 C10.352,10.968 11.184,11.536 11.184,12.672 C11.184,13.808 10.352,14.376 8.688,14.376 L8.688,14.376 Z M26.544,17.808 L26.544,4.776 L31.68,4.776 L31.68,1.008 L16.632,1.008 L16.632,4.776 L21.792,4.776 L21.792,17.808 L26.544,17.808 Z M41.592,18.144 C43.128,18.144 44.512,17.872 45.744,17.328 C46.976,16.784 48,16 48.816,14.976 L48.816,14.976 L45.792,12.24 C44.704,13.552 43.384,14.208 41.832,14.208 C40.92,14.208 40.108,14.008 39.396,13.608 C38.684,13.208 38.132,12.644 37.74,11.916 C37.348,11.188 37.152,10.352 37.152,9.408 C37.152,8.464 37.348,7.628 37.74,6.9 C38.132,6.172 38.684,5.608 39.396,5.208 C40.108,4.808 40.92,4.608 41.832,4.608 C43.384,4.608 44.704,5.264 45.792,6.576 L45.792,6.576 L48.816,3.84 C48,2.816 46.976,2.032 45.744,1.488 C44.512,0.944 43.128,0.672 41.592,0.672 C39.832,0.672 38.252,1.044 36.852,1.788 C35.452,2.532 34.352,3.568 33.552,4.896 C32.752,6.224 32.352,7.728 32.352,9.408 C32.352,11.088 32.752,12.592 33.552,13.92 C34.352,15.248 35.452,16.284 36.852,17.028 C38.252,17.772 39.832,18.144 41.592,18.144 Z" id=BTC fill=#F2A900></path><path d="M56.64,18.144 C58.24,18.144 59.6,17.9 60.72,17.412 C61.84,16.924 62.68,16.272 63.24,15.456 C63.8,14.64 64.08,13.728 64.08,12.72 C64.08,11.552 63.772,10.628 63.156,9.948 C62.54,9.268 61.812,8.772 60.972,8.46 C60.132,8.148 59.072,7.856 57.792,7.584 C56.656,7.344 55.832,7.112 55.32,6.888 C54.808,6.664 54.552,6.328 54.552,5.88 C54.552,5.432 54.768,5.068 55.2,4.788 C55.632,4.508 56.32,4.368 57.264,4.368 C58.768,4.368 60.32,4.8 61.92,5.664 L61.92,5.664 L63.384,2.136 C62.568,1.656 61.624,1.292 60.552,1.044 C59.48,0.796 58.392,0.672 57.288,0.672 C55.672,0.672 54.308,0.912 53.196,1.392 C52.084,1.872 51.248,2.524 50.688,3.348 C50.128,4.172 49.848,5.096 49.848,6.12 C49.848,7.288 50.152,8.216 50.76,8.904 C51.368,9.592 52.096,10.092 52.944,10.404 C53.792,10.716 54.848,11.008 56.112,11.28 C57.264,11.536 58.1,11.78 58.62,12.012 C59.14,12.244 59.4,12.6 59.4,13.08 C59.4,13.992 58.488,14.448 56.664,14.448 C55.704,14.448 54.728,14.296 53.736,13.992 C52.744,13.688 51.872,13.288 51.12,12.792 L51.12,12.792 L49.56,16.296 C50.36,16.856 51.4,17.304 52.68,17.64 C53.96,17.976 55.28,18.144 56.64,18.144 Z M71.856,18.024 C72.48,18.024 73.068,17.96 73.62,17.832 C74.172,17.704 74.64,17.52 75.024,17.28 L75.024,17.28 L73.896,14.088 C73.496,14.36 73.032,14.496 72.504,14.496 C72.088,14.496 71.756,14.364 71.508,14.1 C71.26,13.836 71.136,13.472 71.136,13.008 L71.136,13.008 L71.136,8.688 L74.112,8.688 L74.112,5.28 L71.136,5.28 L71.136,1.896 L66.576,1.896 L66.576,5.28 L64.68,5.28 L64.68,8.688 L66.576,8.688 L66.576,13.056 C66.576,14.704 67.032,15.944 67.944,16.776 C68.856,17.608 70.16,18.024 71.856,18.024 Z M82.248,18.024 C83,18.024 83.712,17.888 84.384,17.616 C85.056,17.344 85.632,16.944 86.112,16.416 L86.112,16.416 L86.112,17.808 L90.456,17.808 L90.456,4.8 L85.896,4.8 L85.896,11.064 C85.896,12.104 85.668,12.876 85.212,13.38 C84.756,13.884 84.168,14.136 83.448,14.136 C82.744,14.136 82.208,13.912 81.84,13.464 C81.472,13.016 81.288,12.304 81.288,11.328 L81.288,11.328 L81.288,4.8 L76.728,4.8 L76.728,12.072 C76.728,14.056 77.228,15.544 78.228,16.536 C79.228,17.528 80.568,18.024 82.248,18.024 Z M99.048,18.024 C100.744,18.024 102.016,17.52 102.864,16.512 L102.864,16.512 L102.864,17.808 L107.208,17.808 L107.208,0 L102.648,0 L102.648,5.928 C101.8,5.032 100.6,4.584 99.048,4.584 C97.864,4.584 96.784,4.856 95.808,5.4 C94.832,5.944 94.06,6.724 93.492,7.74 C92.924,8.756 92.64,9.936 92.64,11.28 C92.64,12.624 92.924,13.808 93.492,14.832 C94.06,15.856 94.832,16.644 95.808,17.196 C96.784,17.748 97.864,18.024 99.048,18.024 Z M100.008,14.4 C99.208,14.4 98.552,14.124 98.04,13.572 C97.528,13.02 97.272,12.256 97.272,11.28 C97.272,10.32 97.528,9.568 98.04,9.024 C98.552,8.48 99.208,8.208 100.008,8.208 C100.808,8.208 101.46,8.48 101.964,9.024 C102.468,9.568 102.72,10.32 102.72,11.28 C102.72,12.256 102.464,13.02 101.952,13.572 C101.44,14.124 100.792,14.4 100.008,14.4 Z M112.368,22.68 C113.728,22.68 114.88,22.356 115.824,21.708 C116.768,21.06 117.568,19.936 118.224,18.336 L118.224,18.336 L123.84,4.8 L119.496,4.8 L116.28,12.744 L113.088,4.8 L108.408,4.8 L113.976,17.976 C113.784,18.36 113.548,18.64 113.268,18.816 C112.988,18.992 112.632,19.08 112.2,19.08 C111.832,19.08 111.468,19.012 111.108,18.876 C110.748,18.74 110.44,18.552 110.184,18.312 L110.184,18.312 L108.6,21.504 C109.032,21.856 109.596,22.14 110.292,22.356 C110.988,22.572 111.68,22.68 112.368,22.68 Z" id=Study fill-opacity=0.85 fill=#FFFFFF></path></g></g></g></svg></div><div class="mobile-header-title is-full-height is-flex is-align-items-center is-flex-shrink-0"><div class="is-full-height hidden" id=postTopicMobile><p class=is-full-height>硬件签名器多签的潜在陷阱</p></div></div></div><i class="iconfont icon-icon_search mobile-header-searchIcon"></i><div class=mobile-search-wrap><div class=search-input><input class=pl-3 id=mobile-search-input placeholder=请输入搜索关键词><i class="iconfont icon-icon_search mobile-search-input-btn"></i><button class=mobile-search-input-btn>搜 索</button></div></div></header><div class=mobile-slide-menu><a class=header-activity href=/ >首页</a><a href=/archives>全站目录</a><a href=/tags>标签</a><a href=/maps>地图</a><a href=/mempool>mempool</a><a target=_blank rel=noopener href=https://123btc.org/ >123btc</a><div><p class="slide-menu-theme is-flex is-flex-direction-row is-justify-content-space-between is-align-items-center"><span>主题设置</span><span><i class="iconfont icon-icon_light slide-theme-light hidden"></i><i class="iconfont icon-icon_dark slide-theme-dark hidden"></i></span></p><p class=slide-menu-fontsize><span>字体设置</span><span><i class="iconfont icon-bianzubeifen"></i><i class="iconfont icon-bianzu"></i></span></p></div></div><div class="search-mask hidden"><script src="/js/header.js?v=1682773100887"></script></div><main><main class="container is-max-widescreen content section post-page pt-4"><div class="columns is-flex-desktop is-justify-content-center"><div class="column is-3 silde-bar is-hidden-mobile"><ol class=toc><li class="toc-item toc-level-2"><a class=toc-link href=#%E4%B8%BA%E4%BB%80%E4%B9%88%E6%88%91%E4%BB%AC%E8%A6%81%E8%B0%83%E6%9F%A5%E7%AB%9E%E4%BA%89%E5%AF%B9%E6%89%8B%EF%BC%9F><span class=toc-text>为什么我们要调查竞争对手？</span></a></li><li class="toc-item toc-level-2"><a class=toc-link href=#%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E4%BD%BF%E7%94%A8%E7%A1%AC%E4%BB%B6%E7%AD%BE%E5%90%8D%E5%99%A8%EF%BC%9F><span class=toc-text>为什么要使用硬件签名器？</span></a></li><li class="toc-item toc-level-2"><a class=toc-link href=#%E4%BD%BF%E7%94%A8%E5%A4%9A%E7%AD%BE%E7%9A%84%E5%8A%A8%E6%9C%BA%E4%BD%95%E5%9C%A8%EF%BC%9F><span class=toc-text>使用多签的动机何在？</span></a></li><li class="toc-item toc-level-2"><a class=toc-link href=#%E5%A6%82%E4%BD%95%E5%AE%89%E5%85%A8%E5%9C%B0%E5%A4%87%E4%BB%BD%E5%A4%9A%E7%AD%BE%E8%AE%BE%E7%BD%AE%EF%BC%9F><span class=toc-text>如何安全地备份多签设置？</span></a></li><li class="toc-item toc-level-2"><a class=toc-link href=#%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8%E5%A4%9A%E7%AD%BE%E5%AE%89%E5%85%A8%E5%9C%B0%E6%8E%A5%E6%94%B6%E6%AF%94%E7%89%B9%E5%B8%81%EF%BC%9F><span class=toc-text>如何使用多签安全地接收比特币？</span></a></li><li class="toc-item toc-level-2"><a class=toc-link href=#%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8%E5%A4%9A%E7%AD%BE%E5%AE%89%E5%85%A8%E5%9C%B0%E8%8A%B1%E8%B4%B9%E6%AF%94%E7%89%B9%E5%B8%81%EF%BC%9F><span class=toc-text>如何使用多签安全地花费比特币？</span></a></li><li class="toc-item toc-level-2"><a class=toc-link href=#%E6%89%80%E6%9C%89%E6%94%BB%E5%87%BB%E7%9A%84%E5%85%B1%E5%90%8C%E7%82%B9%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F><span class=toc-text>所有攻击的共同点是什么？</span></a></li><li class="toc-item toc-level-2"><a class=toc-link href=#%E8%87%B4%E8%B0%A2><span class=toc-text>致谢</span></a><ol class=toc-child><li class="toc-item toc-level-3"><a class=toc-link href=#%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98%EF%BC%88FAQ%EF%BC%89><span class=toc-text>常见问题（FAQ）</span></a></li></ol></li></ol></div><div class="column is-9 post-container"><h1 class="mt-0 mb-2" id=postTitle>硬件签名器多签的潜在陷阱</h1><div class=page-author><div class="is-flex is-flex-direction-row page-data mr-6"><img class=mr-1 src=/images/default_avatar.png alt="Kaspar Etter"><div class=page-author-info><strong>Kaspar Etter</strong><time class=has-text-grey datetime=2025-08-19T01:53:10.000Z>2025-08-19</time></div></div><div class=is-flex><a href=/tags/%E5%A4%9A%E7%AD%BE%E5%90%8D%E9%92%B1%E5%8C%85><i class="page-tag mr-1 px-1">多签名钱包</i></a></div></div><article class="mt-4 post-content"><blockquote><p><em>作者：Kaspar Etter</em></p><p><em>来源：<a target=_blank rel=noopener href=https://blog.bitbox.swiss/en/the-pitfalls-of-multisig-when-using-hardware-wallets/ >https://blog.bitbox.swiss/en/the-pitfalls-of-multisig-when-using-hardware-wallets/</a></em></p></blockquote><p><img src=/images/the-pitfalls-of-multisig-when-using-hardware-wallets/33_1920.jpg alt="The pitfalls of multisig when using hardware wallets"></p><p>相较于仅用一组密钥来持有比特币，你也可以通过多组密钥来共同管理你的比特币。这被称为<a target=_blank rel=noopener href=https://en.bitcoin.it/wiki/Multisignature>多重签名（multisignature）</a>，简称多签（Multisig），它要求多个签名才能授权一笔比特币交易。你可以自行设定密钥的总数和花费资金所需的阈值（最小签名数量）。如果阈值大于一，那么即使攻击者获得了其中一个密钥，仍然无法窃取你的资金。正因如此，许多业内人士都<a target=_blank rel=noopener href=https://bitcoin-hardware-wallet.github.io/ >建议</a>每个人都应该使用多签来保护他们的比特币。然而，本文将解释为什么相较于单签而言，多签的复杂性也会带来陷阱。文中还包括我们此前从未公开披露的、向 <a target=_blank rel=noopener href=https://satoshilabs.com/ >SatoshiLabs</a>（Trezor 制造商）和 <a target=_blank rel=noopener href=https://www.ledger.com/ >Ledger</a> 在这方面做出的负责任披露。</p><h2 id=为什么我们要调查竞争对手？><a href=#为什么我们要调查竞争对手？ class=headerlink title=为什么我们要调查竞争对手？></a>为什么我们要调查竞争对手？</h2><p>在 <a target=_blank rel=noopener href=https://bitbox.swiss/app/ >BitBoxApp</a> 中实现多签的实验性支持时，我让同事 <a target=_blank rel=noopener href=https://twitter.com/_benma_>benma</a> 意识到，他在 Trezor 显示屏上看到的多签接收地址是不可信的（详见下文）。在今年早些时候意识到对找零地址的处理和接收地址同样重要后，我们对其它硬件签名器如何处理多签变得更加好奇。我们在 9 月底推出了 <a target=_blank rel=noopener href=https://bitbox.swiss/bitbox02/ >BitBox02</a>（译者注：原文发表于 2019 年 12 月），然后终于有时间研究其它硬件签名器的实现，也是为了评估我们自己若想妥善添加多签功能需要投入多少精力。在这个过程中，我们发现了几个问题，并负责任地向 <a target=_blank rel=noopener href=https://blog.bitbox.swiss/en/a-theft-attack-on-trezor-model-t/ >Trezor</a>、<a target=_blank rel=noopener href=https://thecharlatan.ch/Ransom-Coldcard/ >Coldcard</a> 和 Ledger 进行了披露（如本文所述）。</p><h2 id=为什么要使用硬件签名器？><a href=#为什么要使用硬件签名器？ class=headerlink title=为什么要使用硬件签名器？></a>为什么要使用硬件签名器？</h2><p>我在<a target=_blank rel=noopener href=https://blog.bitbox.swiss/en/how-we-do-security-assessments/ >之前的一篇博客文章</a>中有过详细说明，但简而言之，硬件签名器旨在确保，即便在电脑或手机被恶意软件感染的情况下，你仍然能够安全地接收和花费资金，并安全地将找零返回至同一账户。虽然每家制造商都可以定义他们的产品能提供何种保护、不提供何种保护。但我们认为，硬件签名器的威胁模型在多签场景下应该包括恶意或被攻破的联合签名方。这是因为许多公司喜欢将多签用作资金存储、花费速率限制（rate-limiting）或继承服务的一部分。一旦这些公司的基础设施遭到入侵，大量用户可能受到影响 —— 特别是通过服务提供商的应用程序与其硬件签名器交互的用户。</p><h2 id=使用多签的动机何在？><a href=#使用多签的动机何在？ class=headerlink title=使用多签的动机何在？></a>使用多签的动机何在？</h2><p>多签主要有两大应用场景：(i) 在多方之间共享资金花费权限，避免单点故障，或 (ii) 通过使用来自不同制造商的硬件签名器来降低漏洞的影响。在这两种场景下，你都需要注意一些细节。否则，你最终获得的安全性可能还不如使用普通的单签钱包。多签为硬件签名器、软件钱包和你自身都增加了复杂性，但 “复杂性是安全性的敌人”。此外，由于单签比多签流行得多，许多公司花了更多精力在它们单签工作流的安全性和可用性上，而非其多签的实现。虽然我同意多签在理论上更安全，但以下章节将阐述为何在实践中情况可能并非如此。</p><h2 id=如何安全地备份多签设置？><a href=#如何安全地备份多签设置？ class=headerlink title=如何安全地备份多签设置？></a>如何安全地备份多签设置？</h2><p>第一个陷阱甚至发生在你开始接收或花费资金之前。假设你创建了一个 2-3 的多签设置（阈值要小于联合签名方的数量）。换句话说，总共有 3 个可能的签名方，但只需要其中 2 个签名即可批准交易。至关重要的是，每个联合签名方的备份都必须包含所有其它联合签名方的扩展公钥（简称 xpub）（理想情况下还要包含使用的阈值、派生路径和脚本类型）。否则，一旦丢失任何一个助记词，你将无法恢复和花费资金。这是因为多签账户的未花费交易输出（UTXO）是使用所有公钥的哈希值（和阈值）锁定的。从技术上讲，如果你无法推导出所有联合签名方的公钥，你就无法确定查找和花费多签账户 UTXO 所需的<a target=_blank rel=noopener href=https://bitcoin.org/en/transactions-guide#multisig>赎回脚本</a>。例如，如果你设置了一个 2-3 的多签账户，但忘记了备份其它两个联合签名方的扩展公钥，那么只要钱包（以及各硬件签名器）功能正常，2 个签名器就足以花费和接收比特币。然而，如果你无法访问自己的钱包（不论什么原因），那么你在恢复时需要的是完整的 3 个助记词的备份，而不仅仅是 2 个。</p><h2 id=如何使用多签安全地接收比特币？><a href=#如何使用多签安全地接收比特币？ class=headerlink title=如何使用多签安全地接收比特币？></a>如何使用多签安全地接收比特币？</h2><p>你的硬件签名器应该验证，或允许你验证，来自不可信计算机的以下信息：</p><ul><li>接收地址：必须编码普通多签赎回脚本的哈希，且不包含其它花费条件</li><li>硬件签名器的密钥：必须是赎回脚本中的公钥之一</li><li>显示地址的密钥路径：用于避免在硬件签名器没有强制执行限制时的<a target=_blank rel=noopener href=https://blog.sia.tech/a-ransom-attack-on-hardware-wallets-534c075b3a92>勒索攻击</a></li><li>联合签名方的数量：防止攻击者添加更多签名方</li><li>所需签名的阈值：不要高于或低于预期设定</li><li>联合签名方的扩展公钥：防止攻击者将其调包</li></ul><p>为了避免在使用接收地址时出现人为的单点故障，相同阈值的联合签名方应该向发送者确认接收地址已正确传输。如果你的多签设置是为了规避特定设备固件漏洞的风险，那么你应该在多个硬件签名器上核对接收地址。安全地接收比特币与安全地花费比特币同样重要。</p><p>那么，不同的硬件签名器如何处理这个问题？</p><p>正如其他人之前注意到的，<a target=_blank rel=noopener href=https://twitter.com/mflaxman/status/1154538947340468224>Ledger 并没有处理这个问题</a>。相反，用户需要信任计算机上显示的接收地址，这违背了硬件签名器的设计初衷。</p><p>Trezor 会验证其密钥是否为格式正确的接收地址的一部分，并向用户显示除了联合签名方以外的所有其它信息（再次参见上面关于 Ledger 的<a target=_blank rel=noopener href=https://twitter.com/mflaxman/status/1154538947340468224>推文</a>）。为了简单起见，制造商试图让硬件签名器的固件尽可能<a target=_blank rel=noopener href=https://en.wikipedia.org/wiki/Stateless_protocol>无状态</a>，因此尽量避免存储除种子词以外的任何数据。直到 2019 年 11 月 6 日发布固件版本 2.1.8 之前，Trezor 的用户都无法验证计算机提供的联合签名方的扩展公钥。<strong>换句话说，在我们上面提到的 2-3 多签示例中，攻击者可以利用恶意软件替换掉 2 个联合签名方的扩展公钥，然后就能完全控制接收到的比特币。</strong> 这是一个真实存在的问题，因为用户被教育要信任硬件签名器的屏幕，但却未曾了解过上述的替换风险，该风险使得设备的屏幕在多签场景下变得不可信。这是我们向 Trezor 披露的第二个漏洞，在其<a target=_blank rel=noopener href=https://github.com/trezor/trezor-firmware/blob/5e7dd41613cbd3aeaadc71fa03027faa813a3691/core/ChangeLog#L9>发布说明</a>中有提及。他们认为这更多是一个可用性问题而非安全问题。（只要你在多个设备上检查接收地址，每个设备都确认其密钥包含在多签地址中，这确实不会是一个安全问题。）虽然新固件仍然不会持久保存多签设置，但现在你可以在显示多签接收地址时验证联合签名方的扩展公钥：</p><p><img src=/../images/the-pitfalls-of-multisig-when-using-hardware-wallets/small-1.gif></p><p style=text-align:center>- 如何在 Trezor Model T 上检查多签联合签名方的扩展公钥。 -</p><p>不方便的是，据我们所知，Trezor 并不指明哪个扩展公钥属于你。虽然硬件签名器会提供你自己的扩展公钥，无需你亲自验证。另一方面，由于似乎没有其它方法在 Trezor 的可信屏幕上显示你自己的扩展公钥，至少现在你可以更自信地告诉联合签名方你的扩展公钥是什么。</p><p>Coldcard 拥有最佳的方案，它会在初始设置后持久保存多签配置。然而，它在派生密钥路径的清理方面存在一个问题，我们已向其<a target=_blank rel=noopener href=https://thecharlatan.ch/Ransom-Coldcard/ >负责任地披露了这一点</a>。</p><h2 id=如何使用多签安全地花费比特币？><a href=#如何使用多签安全地花费比特币？ class=headerlink title=如何使用多签安全地花费比特币？></a>如何使用多签安全地花费比特币？</h2><p>一旦你安全地接收了一些比特币，如何才能放心地花费它们？硬件签名器必须验证，或允许你验证，来自不可信计算机的以下信息：</p><ul><li>接收者的地址：像单签名一样，由用户显示和确认</li><li>找零地址：在普通多签脚本中具有相同的联合签名方和阈值，且不含其它花费条件</li><li>找零必须转入用户可恢复的密钥路径上的地址</li></ul><p>那么，不同的硬件签名器如何处理这个问题？</p><p>通过检查多签配置，我们发现 Coldcard 的方案最为出色。然而，由于它没有对密钥路径施加足够的限制，找零的可访问性无法得到保证。我们<a target=_blank rel=noopener href=https://thecharlatan.ch/Ransom-Coldcard/ >负责任地披露</a>了这个问题，并且它在 2019 年 11 月 1 日发布的<a target=_blank rel=noopener href=https://github.com/Coldcard/firmware/blob/5475bdb0c7994cda3ae9e5fe0b2812ca19b19816/releases/ChangeLog.md#302---nov-1-2019>固件 3.0.2</a> 中得到修复。</p><p>Trezor 会验证找零是否回到了同一个钱包账户（具有相同的联合签名方和阈值），但其验证过程曾存在问题。由于 Trezor 没有正确地区分单签和多签的工作流，攻击者可以 (i) 将一个共享的多签输入添加到单签交易中，然后 (ii) 将找零发送到同一个多签账户，并 (iii) 从该账户窃取用户的所有资金。我们在 2019 年 10 月 1 日报告了这个关键的远程攻击，Trezor 在 2019 年 11 月 6 日发布的固件版本 2.1.8 中修复了它。（有关更多信息，请参阅 benma 的这篇<a target=_blank rel=noopener href=https://blog.bitbox.swiss/en/a-theft-attack-on-trezor-model-t/ >文章</a>。）除此之外，它们既不持久保存也不让用户确认联合签名方扩展公钥的方法，在花费的场景下是可行的。因为联合签名方公钥的<a target=_blank rel=noopener href=https://bitcoin.org/en/transactions-guide#multisig>赎回脚本</a>是被签名哈希的一部分。因此，如果你计算机上的恶意软件在签名交易时谎报了联合签名方的扩展公钥，比特币网络中的其它节点将拒绝无效交易。</p><p>正如 Saleem Rashid 在几乎两年前已经指出的，<a target=_blank rel=noopener href=https://saleemrashid.com/2018/01/27/hardware-wallet-electrum-multisig/ >Ledger 在多签交易的场景下会将找零输出留给用户确认</a>，这引发了各种问题。用户应该如何验证找零地址？如果需要一台单独的、完全可信的计算机来做到这一点，为什么他们最初又何必使用硬件签名器？如果我们假设用户必须与联合签名方确认找零地址，那么这会导致以下两个问题：</p><ol><li><p><strong>“发送到多个地址交易（send-to-manay）”与 “多签交易” 没有明确区分</strong>：用户判断他们签名的是多签交易还是发送给多人的交易的唯一方法是，前者他们会收到一个关于找零密钥路径的警告，而后者不会。我们不能期望普通用户注意到这种差异，而多签用户也习惯了在 Ledger 上只检查预期接收方、其它则一路按确认。因此，被攻破的联合签名方可以提供一个由它们单独控制的发送地址，并让其被错误地确认为多签 “找零” 地址。</p></li><li><p><strong>降低多签阈值</strong>：如果你的多签设置为 M-N，你无法检测到找零输出的多签阈值是否被降低到 1-N。如果一个被攻破的联合签名方在要确认的找零信息上对你撒谎，它们可以在交易完成后窃取找零。</p></li></ol><p>虽然这两个问题能通过让用户访问一个告诉他们找零应该是什么样子的 “找零断言机” 来解决，但还有另一个用户无法防范的问题：</p><ol start=3><li><strong>单签输入到多签找零</strong>：如果用户在同一台 Ledger 上的单签账户里也持有资金，攻击者可以利用用户单签账户而非多签账户里的 UTXO 来为用户想要执行的多签交易提供资金。如果多签账户的配置是 1-N，恶意或被攻破的联合签名方可以立即花费找零。换句话说，由于这种设计选择，Ledger 不会验证找零是否回到了同一个账户，这使你单签账户（和其它多签账户）里的资金面临风险。</li></ol><p>请注意，这些攻击要求受害者的计算机被攻破，这是<a target=_blank rel=noopener href=https://bitbox.swiss/bitbox02/threat-model/ >硬件签名器威胁模型</a>中的常见假设。我们在 2019 年 11 月 4 日向 Ledger 报告了所有这三个问题。他们回应说这些都属于预期行为，并且正在开发一个新的比特币应用程序来解决这些问题（有关更多信息，请参阅 Reddit 上的<a target=_blank rel=noopener href=https://old.reddit.com/r/ledgerwallet/comments/csqwwj/any_plans_to_resolve_these_issues/exgw9pt/ >这个评论</a>）。<strong>如果你确实将 Ledger 同时用于单签和多签，并且怀疑你的联合签名方会动用你的单签资金，我们建议你在签署更多的多签交易之前，首先将单签账户里资金转移到不同的钱包。</strong> 此外，我们建议一个 Trezor 或 Ledger 设备最多只用于一个多签设置，因为这些设备不会显示账户信息，你将无法得知正在从哪个账户花费资金。</p><p><img src=/../images/the-pitfalls-of-multisig-when-using-hardware-wallets/-unlock.gif></p><p style=text-align:center>Ledger Nano X 上的多签工作流</p><h2 id=所有攻击的共同点是什么？><a href=#所有攻击的共同点是什么？ class=headerlink title=所有攻击的共同点是什么？></a>所有攻击的共同点是什么？</h2><p>上文所提到的所有漏洞都源自一个共同的问题：硬件签名器要么试图 “智能化” 并尽可能少地显示信息（Trezor 和 Coldcard），要么试图 “简单化” 并显示更多信息（Ledger），但这两种方法都失败了。即它们既没有充分验证也没有充分显示。要想在两者之间取得平衡，恰到好处地实现静默验证和用户确认并不容易。此外，在我看来，我们需要更密切地关注这类 “改变找零” 攻击。本文提到的所有攻击都曾是（或仍然是）远程攻击，其中被攻破的计算机可以简单地滥用硬件签名器的 API。关于硬件签名器如何缓解此类攻击并提高其安全性的建议，请参阅 <a target=_blank rel=noopener href=https://blog.bitbox.swiss/en/a-theft-attack-on-trezor-model-t/ >benma 的文章</a>。虽然本文侧重于硬件签名器，但值得注意的是，随着多签的使用，软件钱包也同样容易遭受 API 滥用攻击，因为交易可以像传递给硬件签名器一样传递给它们。</p><h2 id=致谢><a href=#致谢 class=headerlink title=致谢></a>致谢</h2><p>感谢 <a target=_blank rel=noopener href=https://twitter.com/the_charlatan_>TheCharlatan</a> 发现在 Ledger 中可以将单签账户里的资金发送到多签找零，感谢 <a target=_blank rel=noopener href=https://twitter.com/_benma_>benma</a> 对联合签名方值得信赖这一假设提出了质疑，而我则完善了上述攻击并报告给了 Ledger。TheCharlatan 还负责通过修改 <a target=_blank rel=noopener href=https://electrum.org/ >Electrum 钱包</a> 和 <a target=_blank rel=noopener href=https://github.com/bitcoin-core/HWI>HWI</a> 来复现这些攻击。至此，我们的漏洞披露三部曲告一段落。</p><p style=text-align:center>- - -</p><h3 id=常见问题（FAQ）><a href=#常见问题（FAQ） class=headerlink title=常见问题（FAQ）></a>常见问题（FAQ）</h3><p><strong>什么是多签？</strong><br>多签要求多方签名才能授权一笔比特币交易，从而允许通过多组密钥来共同持有比特币。</p><p><strong>为什么推荐使用多签？</strong><br>多签通过要求多组密钥才能授权交易来增强安全性，使得攻击者更难仅凭一把密钥窃取资金。</p><p><strong>多签的主要应用场景是哪些？</strong><br>多签主要用于在多方之间共享权限来避免单点故障，以及通过使用不同的硬件签名器来减少漏洞的影响。</p><p><strong>多签如何增加复杂性？</strong><br>多签会增加硬件签名器、软件钱包和用户自身的复杂性，而由于这种复杂性的存在，多签有时在实际应用中安全性更低。</p><p><strong>如何备份多签设置？</strong><br>在每个联合签名方的备份中包含所有扩展公钥（xpub）对于资金的恢复和花费至关重要。</p><p>（完）</p></article></div></div></main><script src="/js/post.js?v=1682773100887"></script><script src="/js/highlight.min.js?v=1682773100887"></script><script>var containerEl=document.querySelector(".post-container"),postFontSize=localStorage.getItem("post-font-size")||"16",inputEl=document.querySelector("#size-change-input"),inputEl2=document.querySelector("#size-change-input2");inputEl.value=postFontSize,inputEl2.value=postFontSize,containerEl.style.fontSize=postFontSize+"px",$(function(){function e(t){$(".post-container").css("font-size",t+"px"),localStorage.setItem("post-font-size",t),$("#size-change-input").val(t),$("#size-change-input2").val(t)}$("#size-change-input").on("input propertychange",function(t){e(t.target.value)}),$("#size-change-input2").on("input propertychange",function(t){e(t.target.value)})})</script><script>hljs.initHighlightingOnLoad()</script></main></div><footer class="is-flex is-flex-direction-column is-align-items-center is-flex-shrink-0"><section class=sns-container><a title=nostr target=_blank rel="noopener nofollow" href=https://iris.to/npub1g2qs0ca5kpwlrcfug2em4jelmh65clk3yccwjxrs6hvdpd9qj80q022j4m>Nostr</a><a title=rss target=_blank rel="noopener nofollow" href=/atom.xml>rss</a><a title=telegram target=_blank rel="noopener nofollow" href=//t.me/btcstudyorg>Telegram</a></section></footer><script async src="/js/buttons.js?v=1682773100887"></script><script async src="/js/index.js?v=1682773100887"></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-JVCJ9XXG1Z"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-JVCJ9XXG1Z")</script><script>var _hmt=_hmt||[];(()=>{var e=document.createElement("script"),t=(e.src="https://hm.baidu.com/hm.js?c92c073c85be5be8d9b1b76f62a7e306",e.async=!0,e.defer=!0,document.getElementsByTagName("script")[0]);t.parentNode.insertBefore(e,t)})()</script></body></html>