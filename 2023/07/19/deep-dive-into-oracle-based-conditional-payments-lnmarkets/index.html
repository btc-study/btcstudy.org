<!DOCTYPE html><html lang=zh-CN><head><meta charset=UTF-8><title>基于断言机的条件式支付背后的密码学</title><meta name=keywords content="比特币, 中本聪, 比特币区块链, 闪电网络, 比特币 layer 2, 健全货币, 密码货币, 密码朋克, 学习比特币, BTC, BTC Study, Bitcoin, bitcoin, proof of work"><meta name=description content=比特币思想的中文集结地><meta name=viewport content="width=device-width,minimum-scale=1,maximum-scale=1,initial-scale=1"><link rel=icon href=/favicon.ico><link rel=stylesheet href="/style/common/bulma.css?v=1682773100887"><link rel=preload as=style onload='this.onload=null,this.rel="stylesheet"' href="/style/common/iconfont.css?v=1682773100887"><link rel=stylesheet href="/style/base.css?v=1682773100887"><link rel=stylesheet href="/style/common/helper.css?v=1682773100887"><link rel=stylesheet href="/style/themes/animation.css?v=1682773100887"><script>function ready(){var e=document.querySelector(".body-container"),t=localStorage.getItem("theme")||"light";["light","dark"].includes(t)||(t="light",localStorage.setItem("theme","light")),e.classList.remove("appearance-auto"),e.classList.add("appearance-"+t),quickInitialTheme()}function quickInitialTheme(){var e=localStorage.getItem("theme")||"light",t=document.querySelector(".logo-light"),o=document.querySelector(".logo-dark"),d=document.querySelector("#mobile-header-logo > .logo-light"),l=document.querySelector("#mobile-header-logo > .logo-dark"),a=document.getElementById("theme-btn"),i=document.querySelector(".slide-theme-light"),c=document.querySelector(".slide-theme-dark");document.body.classList.add(e),("dark"===e?(t.classList.add("hidden"),o.classList.remove("hidden"),d.classList.add("hidden"),l.classList.remove("hidden"),a.classList.remove("icon-icon_dark"),a.classList.add("icon-icon_light"),i):c).classList.remove("hidden")}document.addEventListener("DOMContentLoaded",ready)</script><script src="/js/common.js?v=1682773100887"></script><script src=/js/libs/zepto.min.js></script><link rel=stylesheet href="/style/post.css?v=1682773100887"><link rel=stylesheet href="/style/themes/highlight.css?v=1682773100887"><meta name=generator content="Hexo 6.3.0"><link rel=alternate href=/atom.xml title="BTC Study" type=application/atom+xml></head><body class="is-flex is-flex-direction-column" onload=initialTheme()><div class=clip></div><div class="body-container appearance-auto"><header class="header-widget is-hidden-mobile is-flex is-flex-shrink-0 is-align-items-center is-justify-content-center" id=header><div class="is-flex header-widget-container is-flex-shrink-0 is-align-items-center"><section class="is-hidden-mobile is-flex-shrink-0"><h1><a href=/ ><svg class=logo-light width=125px height=23px viewBox="0 0 125 23" version=1.1 xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink><title>BTCStudy</title><g id=页面-1 stroke=none stroke-width=1 fill=none fill-rule=evenodd><g id=首页-响应式 transform="translate(-249.000000, -23.000000)" fill-rule=nonzero><g id=BTCStudy transform="translate(249.680000, 23.192000)"><path d="M9.072,17.808 C11.312,17.808 13.024,17.408 14.208,16.608 C15.392,15.808 15.984,14.672 15.984,13.2 C15.984,12.192 15.712,11.332 15.168,10.62 C14.624,9.908 13.872,9.384 12.912,9.048 C13.632,8.68 14.188,8.18 14.58,7.548 C14.972,6.916 15.168,6.2 15.168,5.4 C15.168,4.056 14.608,2.988 13.488,2.196 C12.368,1.404 10.736,1.008 8.592,1.008 L8.592,1.008 L-5.68434189e-14,1.008 L-5.68434189e-14,17.808 L9.072,17.808 Z M7.968,7.68 L4.704,7.68 L4.704,4.44 L7.968,4.44 C9.568,4.44 10.368,4.976 10.368,6.048 C10.368,7.136 9.568,7.68 7.968,7.68 L7.968,7.68 Z M8.688,14.376 L4.704,14.376 L4.704,10.968 L8.688,10.968 C10.352,10.968 11.184,11.536 11.184,12.672 C11.184,13.808 10.352,14.376 8.688,14.376 L8.688,14.376 Z M26.544,17.808 L26.544,4.776 L31.68,4.776 L31.68,1.008 L16.632,1.008 L16.632,4.776 L21.792,4.776 L21.792,17.808 L26.544,17.808 Z M41.592,18.144 C43.128,18.144 44.512,17.872 45.744,17.328 C46.976,16.784 48,16 48.816,14.976 L48.816,14.976 L45.792,12.24 C44.704,13.552 43.384,14.208 41.832,14.208 C40.92,14.208 40.108,14.008 39.396,13.608 C38.684,13.208 38.132,12.644 37.74,11.916 C37.348,11.188 37.152,10.352 37.152,9.408 C37.152,8.464 37.348,7.628 37.74,6.9 C38.132,6.172 38.684,5.608 39.396,5.208 C40.108,4.808 40.92,4.608 41.832,4.608 C43.384,4.608 44.704,5.264 45.792,6.576 L45.792,6.576 L48.816,3.84 C48,2.816 46.976,2.032 45.744,1.488 C44.512,0.944 43.128,0.672 41.592,0.672 C39.832,0.672 38.252,1.044 36.852,1.788 C35.452,2.532 34.352,3.568 33.552,4.896 C32.752,6.224 32.352,7.728 32.352,9.408 C32.352,11.088 32.752,12.592 33.552,13.92 C34.352,15.248 35.452,16.284 36.852,17.028 C38.252,17.772 39.832,18.144 41.592,18.144 Z" id=BTC fill=#F2A900></path><path d="M56.64,18.144 C58.24,18.144 59.6,17.9 60.72,17.412 C61.84,16.924 62.68,16.272 63.24,15.456 C63.8,14.64 64.08,13.728 64.08,12.72 C64.08,11.552 63.772,10.628 63.156,9.948 C62.54,9.268 61.812,8.772 60.972,8.46 C60.132,8.148 59.072,7.856 57.792,7.584 C56.656,7.344 55.832,7.112 55.32,6.888 C54.808,6.664 54.552,6.328 54.552,5.88 C54.552,5.432 54.768,5.068 55.2,4.788 C55.632,4.508 56.32,4.368 57.264,4.368 C58.768,4.368 60.32,4.8 61.92,5.664 L61.92,5.664 L63.384,2.136 C62.568,1.656 61.624,1.292 60.552,1.044 C59.48,0.796 58.392,0.672 57.288,0.672 C55.672,0.672 54.308,0.912 53.196,1.392 C52.084,1.872 51.248,2.524 50.688,3.348 C50.128,4.172 49.848,5.096 49.848,6.12 C49.848,7.288 50.152,8.216 50.76,8.904 C51.368,9.592 52.096,10.092 52.944,10.404 C53.792,10.716 54.848,11.008 56.112,11.28 C57.264,11.536 58.1,11.78 58.62,12.012 C59.14,12.244 59.4,12.6 59.4,13.08 C59.4,13.992 58.488,14.448 56.664,14.448 C55.704,14.448 54.728,14.296 53.736,13.992 C52.744,13.688 51.872,13.288 51.12,12.792 L51.12,12.792 L49.56,16.296 C50.36,16.856 51.4,17.304 52.68,17.64 C53.96,17.976 55.28,18.144 56.64,18.144 Z M71.856,18.024 C72.48,18.024 73.068,17.96 73.62,17.832 C74.172,17.704 74.64,17.52 75.024,17.28 L75.024,17.28 L73.896,14.088 C73.496,14.36 73.032,14.496 72.504,14.496 C72.088,14.496 71.756,14.364 71.508,14.1 C71.26,13.836 71.136,13.472 71.136,13.008 L71.136,13.008 L71.136,8.688 L74.112,8.688 L74.112,5.28 L71.136,5.28 L71.136,1.896 L66.576,1.896 L66.576,5.28 L64.68,5.28 L64.68,8.688 L66.576,8.688 L66.576,13.056 C66.576,14.704 67.032,15.944 67.944,16.776 C68.856,17.608 70.16,18.024 71.856,18.024 Z M82.248,18.024 C83,18.024 83.712,17.888 84.384,17.616 C85.056,17.344 85.632,16.944 86.112,16.416 L86.112,16.416 L86.112,17.808 L90.456,17.808 L90.456,4.8 L85.896,4.8 L85.896,11.064 C85.896,12.104 85.668,12.876 85.212,13.38 C84.756,13.884 84.168,14.136 83.448,14.136 C82.744,14.136 82.208,13.912 81.84,13.464 C81.472,13.016 81.288,12.304 81.288,11.328 L81.288,11.328 L81.288,4.8 L76.728,4.8 L76.728,12.072 C76.728,14.056 77.228,15.544 78.228,16.536 C79.228,17.528 80.568,18.024 82.248,18.024 Z M99.048,18.024 C100.744,18.024 102.016,17.52 102.864,16.512 L102.864,16.512 L102.864,17.808 L107.208,17.808 L107.208,0 L102.648,0 L102.648,5.928 C101.8,5.032 100.6,4.584 99.048,4.584 C97.864,4.584 96.784,4.856 95.808,5.4 C94.832,5.944 94.06,6.724 93.492,7.74 C92.924,8.756 92.64,9.936 92.64,11.28 C92.64,12.624 92.924,13.808 93.492,14.832 C94.06,15.856 94.832,16.644 95.808,17.196 C96.784,17.748 97.864,18.024 99.048,18.024 Z M100.008,14.4 C99.208,14.4 98.552,14.124 98.04,13.572 C97.528,13.02 97.272,12.256 97.272,11.28 C97.272,10.32 97.528,9.568 98.04,9.024 C98.552,8.48 99.208,8.208 100.008,8.208 C100.808,8.208 101.46,8.48 101.964,9.024 C102.468,9.568 102.72,10.32 102.72,11.28 C102.72,12.256 102.464,13.02 101.952,13.572 C101.44,14.124 100.792,14.4 100.008,14.4 Z M112.368,22.68 C113.728,22.68 114.88,22.356 115.824,21.708 C116.768,21.06 117.568,19.936 118.224,18.336 L118.224,18.336 L123.84,4.8 L119.496,4.8 L116.28,12.744 L113.088,4.8 L108.408,4.8 L113.976,17.976 C113.784,18.36 113.548,18.64 113.268,18.816 C112.988,18.992 112.632,19.08 112.2,19.08 C111.832,19.08 111.468,19.012 111.108,18.876 C110.748,18.74 110.44,18.552 110.184,18.312 L110.184,18.312 L108.6,21.504 C109.032,21.856 109.596,22.14 110.292,22.356 C110.988,22.572 111.68,22.68 112.368,22.68 Z" id=Study fill-opacity=0.85 fill=#000000></path></g></g></g></svg><svg class="logo-dark hidden" width=125px height=23px viewBox="0 0 125 23" version=1.1 xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink><title>BTCStudy</title><g id=页面-1 stroke=none stroke-width=1 fill=none fill-rule=evenodd><g id=首页-响应式 transform="translate(-249.000000, -23.000000)" fill-rule=nonzero><g id=BTCStudy transform="translate(249.680000, 23.192000)"><path d="M9.072,17.808 C11.312,17.808 13.024,17.408 14.208,16.608 C15.392,15.808 15.984,14.672 15.984,13.2 C15.984,12.192 15.712,11.332 15.168,10.62 C14.624,9.908 13.872,9.384 12.912,9.048 C13.632,8.68 14.188,8.18 14.58,7.548 C14.972,6.916 15.168,6.2 15.168,5.4 C15.168,4.056 14.608,2.988 13.488,2.196 C12.368,1.404 10.736,1.008 8.592,1.008 L8.592,1.008 L-5.68434189e-14,1.008 L-5.68434189e-14,17.808 L9.072,17.808 Z M7.968,7.68 L4.704,7.68 L4.704,4.44 L7.968,4.44 C9.568,4.44 10.368,4.976 10.368,6.048 C10.368,7.136 9.568,7.68 7.968,7.68 L7.968,7.68 Z M8.688,14.376 L4.704,14.376 L4.704,10.968 L8.688,10.968 C10.352,10.968 11.184,11.536 11.184,12.672 C11.184,13.808 10.352,14.376 8.688,14.376 L8.688,14.376 Z M26.544,17.808 L26.544,4.776 L31.68,4.776 L31.68,1.008 L16.632,1.008 L16.632,4.776 L21.792,4.776 L21.792,17.808 L26.544,17.808 Z M41.592,18.144 C43.128,18.144 44.512,17.872 45.744,17.328 C46.976,16.784 48,16 48.816,14.976 L48.816,14.976 L45.792,12.24 C44.704,13.552 43.384,14.208 41.832,14.208 C40.92,14.208 40.108,14.008 39.396,13.608 C38.684,13.208 38.132,12.644 37.74,11.916 C37.348,11.188 37.152,10.352 37.152,9.408 C37.152,8.464 37.348,7.628 37.74,6.9 C38.132,6.172 38.684,5.608 39.396,5.208 C40.108,4.808 40.92,4.608 41.832,4.608 C43.384,4.608 44.704,5.264 45.792,6.576 L45.792,6.576 L48.816,3.84 C48,2.816 46.976,2.032 45.744,1.488 C44.512,0.944 43.128,0.672 41.592,0.672 C39.832,0.672 38.252,1.044 36.852,1.788 C35.452,2.532 34.352,3.568 33.552,4.896 C32.752,6.224 32.352,7.728 32.352,9.408 C32.352,11.088 32.752,12.592 33.552,13.92 C34.352,15.248 35.452,16.284 36.852,17.028 C38.252,17.772 39.832,18.144 41.592,18.144 Z" id=BTC fill=#F2A900></path><path d="M56.64,18.144 C58.24,18.144 59.6,17.9 60.72,17.412 C61.84,16.924 62.68,16.272 63.24,15.456 C63.8,14.64 64.08,13.728 64.08,12.72 C64.08,11.552 63.772,10.628 63.156,9.948 C62.54,9.268 61.812,8.772 60.972,8.46 C60.132,8.148 59.072,7.856 57.792,7.584 C56.656,7.344 55.832,7.112 55.32,6.888 C54.808,6.664 54.552,6.328 54.552,5.88 C54.552,5.432 54.768,5.068 55.2,4.788 C55.632,4.508 56.32,4.368 57.264,4.368 C58.768,4.368 60.32,4.8 61.92,5.664 L61.92,5.664 L63.384,2.136 C62.568,1.656 61.624,1.292 60.552,1.044 C59.48,0.796 58.392,0.672 57.288,0.672 C55.672,0.672 54.308,0.912 53.196,1.392 C52.084,1.872 51.248,2.524 50.688,3.348 C50.128,4.172 49.848,5.096 49.848,6.12 C49.848,7.288 50.152,8.216 50.76,8.904 C51.368,9.592 52.096,10.092 52.944,10.404 C53.792,10.716 54.848,11.008 56.112,11.28 C57.264,11.536 58.1,11.78 58.62,12.012 C59.14,12.244 59.4,12.6 59.4,13.08 C59.4,13.992 58.488,14.448 56.664,14.448 C55.704,14.448 54.728,14.296 53.736,13.992 C52.744,13.688 51.872,13.288 51.12,12.792 L51.12,12.792 L49.56,16.296 C50.36,16.856 51.4,17.304 52.68,17.64 C53.96,17.976 55.28,18.144 56.64,18.144 Z M71.856,18.024 C72.48,18.024 73.068,17.96 73.62,17.832 C74.172,17.704 74.64,17.52 75.024,17.28 L75.024,17.28 L73.896,14.088 C73.496,14.36 73.032,14.496 72.504,14.496 C72.088,14.496 71.756,14.364 71.508,14.1 C71.26,13.836 71.136,13.472 71.136,13.008 L71.136,13.008 L71.136,8.688 L74.112,8.688 L74.112,5.28 L71.136,5.28 L71.136,1.896 L66.576,1.896 L66.576,5.28 L64.68,5.28 L64.68,8.688 L66.576,8.688 L66.576,13.056 C66.576,14.704 67.032,15.944 67.944,16.776 C68.856,17.608 70.16,18.024 71.856,18.024 Z M82.248,18.024 C83,18.024 83.712,17.888 84.384,17.616 C85.056,17.344 85.632,16.944 86.112,16.416 L86.112,16.416 L86.112,17.808 L90.456,17.808 L90.456,4.8 L85.896,4.8 L85.896,11.064 C85.896,12.104 85.668,12.876 85.212,13.38 C84.756,13.884 84.168,14.136 83.448,14.136 C82.744,14.136 82.208,13.912 81.84,13.464 C81.472,13.016 81.288,12.304 81.288,11.328 L81.288,11.328 L81.288,4.8 L76.728,4.8 L76.728,12.072 C76.728,14.056 77.228,15.544 78.228,16.536 C79.228,17.528 80.568,18.024 82.248,18.024 Z M99.048,18.024 C100.744,18.024 102.016,17.52 102.864,16.512 L102.864,16.512 L102.864,17.808 L107.208,17.808 L107.208,0 L102.648,0 L102.648,5.928 C101.8,5.032 100.6,4.584 99.048,4.584 C97.864,4.584 96.784,4.856 95.808,5.4 C94.832,5.944 94.06,6.724 93.492,7.74 C92.924,8.756 92.64,9.936 92.64,11.28 C92.64,12.624 92.924,13.808 93.492,14.832 C94.06,15.856 94.832,16.644 95.808,17.196 C96.784,17.748 97.864,18.024 99.048,18.024 Z M100.008,14.4 C99.208,14.4 98.552,14.124 98.04,13.572 C97.528,13.02 97.272,12.256 97.272,11.28 C97.272,10.32 97.528,9.568 98.04,9.024 C98.552,8.48 99.208,8.208 100.008,8.208 C100.808,8.208 101.46,8.48 101.964,9.024 C102.468,9.568 102.72,10.32 102.72,11.28 C102.72,12.256 102.464,13.02 101.952,13.572 C101.44,14.124 100.792,14.4 100.008,14.4 Z M112.368,22.68 C113.728,22.68 114.88,22.356 115.824,21.708 C116.768,21.06 117.568,19.936 118.224,18.336 L118.224,18.336 L123.84,4.8 L119.496,4.8 L116.28,12.744 L113.088,4.8 L108.408,4.8 L113.976,17.976 C113.784,18.36 113.548,18.64 113.268,18.816 C112.988,18.992 112.632,19.08 112.2,19.08 C111.832,19.08 111.468,19.012 111.108,18.876 C110.748,18.74 110.44,18.552 110.184,18.312 L110.184,18.312 L108.6,21.504 C109.032,21.856 109.596,22.14 110.292,22.356 C110.988,22.572 111.68,22.68 112.368,22.68 Z" id=Study fill-opacity=0.85 fill=#FFFFFF></path></g></g></g></svg></a></h1></section><div class="is-flex is-flex-direction-column header-menu-wrap"><aside class="is-flex-shrink-0 is-flex is-flex-direction-row is-align-items-center" id=header-menu><a class="is-inline-block header-activity mr-4" href=/ >首页</a><a class="is-inline-block mr-4" href=/archives>全站目录</a><a class="is-inline-block mr-4" href=/tags>标签</a><a class="is-inline-block mr-4" href=/maps>地图</a><a class="is-inline-block mr-4" href=/tools>工具</a><a class="is-inline-block mr-4" target=_blank rel=noopener href=https://123btc.org/ >123btc</a><div class="right-content is-flex is-flex-direction-row is-align-items-center"><div class="size-wrap mr-1"><i class="iconfont icon-a-bianzu5" id=change-size-btn></i><div class=size-input-wrap><div class=input-wrap><input id=size-change-input type=range min=12 max=32 step=2></div></div></div><i class="iconfont icon-icon_dark mr-1" id=theme-btn></i><div class=search-wrap><input class=pl-3 id=search-input placeholder=请输入搜索关键词><i class="iconfont icon-icon_search" id=search-input-btn></i></div></div></aside><div class="header-title is-hidden-mobile is-full-height is-flex is-align-items-center is-flex-shrink-0"><div class="is-full-height hidden" id=postTopic><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">基于断言机的条件式支付背后的密码学</p><div class="size-wrap mr-1"><i class="iconfont icon-a-bianzu5" id=change-size-btn2></i><div class=size-input-wrap><div class=input-wrap><input id=size-change-input2 type=range min=12 max=32 step=2></div></div></div></div></div></div></div></header><header class="is-flex header-widget is-flex-shrink-0 is-align-items-center is-justify-content-space-between is-hidden-tablet" id=mobile-header><div class="is-flex is-flex-direction-row is-align-items-center"><i class="iconfont icon-icon_bar mobile-header-menu"></i><div id=mobile-header-logo><svg class=logo-light width=125px height=23px viewBox="0 0 125 23" version=1.1 xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink><title>BTCStudy</title><g id=页面-1 stroke=none stroke-width=1 fill=none fill-rule=evenodd><g id=首页-响应式 transform="translate(-249.000000, -23.000000)" fill-rule=nonzero><g id=BTCStudy transform="translate(249.680000, 23.192000)"><path d="M9.072,17.808 C11.312,17.808 13.024,17.408 14.208,16.608 C15.392,15.808 15.984,14.672 15.984,13.2 C15.984,12.192 15.712,11.332 15.168,10.62 C14.624,9.908 13.872,9.384 12.912,9.048 C13.632,8.68 14.188,8.18 14.58,7.548 C14.972,6.916 15.168,6.2 15.168,5.4 C15.168,4.056 14.608,2.988 13.488,2.196 C12.368,1.404 10.736,1.008 8.592,1.008 L8.592,1.008 L-5.68434189e-14,1.008 L-5.68434189e-14,17.808 L9.072,17.808 Z M7.968,7.68 L4.704,7.68 L4.704,4.44 L7.968,4.44 C9.568,4.44 10.368,4.976 10.368,6.048 C10.368,7.136 9.568,7.68 7.968,7.68 L7.968,7.68 Z M8.688,14.376 L4.704,14.376 L4.704,10.968 L8.688,10.968 C10.352,10.968 11.184,11.536 11.184,12.672 C11.184,13.808 10.352,14.376 8.688,14.376 L8.688,14.376 Z M26.544,17.808 L26.544,4.776 L31.68,4.776 L31.68,1.008 L16.632,1.008 L16.632,4.776 L21.792,4.776 L21.792,17.808 L26.544,17.808 Z M41.592,18.144 C43.128,18.144 44.512,17.872 45.744,17.328 C46.976,16.784 48,16 48.816,14.976 L48.816,14.976 L45.792,12.24 C44.704,13.552 43.384,14.208 41.832,14.208 C40.92,14.208 40.108,14.008 39.396,13.608 C38.684,13.208 38.132,12.644 37.74,11.916 C37.348,11.188 37.152,10.352 37.152,9.408 C37.152,8.464 37.348,7.628 37.74,6.9 C38.132,6.172 38.684,5.608 39.396,5.208 C40.108,4.808 40.92,4.608 41.832,4.608 C43.384,4.608 44.704,5.264 45.792,6.576 L45.792,6.576 L48.816,3.84 C48,2.816 46.976,2.032 45.744,1.488 C44.512,0.944 43.128,0.672 41.592,0.672 C39.832,0.672 38.252,1.044 36.852,1.788 C35.452,2.532 34.352,3.568 33.552,4.896 C32.752,6.224 32.352,7.728 32.352,9.408 C32.352,11.088 32.752,12.592 33.552,13.92 C34.352,15.248 35.452,16.284 36.852,17.028 C38.252,17.772 39.832,18.144 41.592,18.144 Z" id=BTC fill=#F2A900></path><path d="M56.64,18.144 C58.24,18.144 59.6,17.9 60.72,17.412 C61.84,16.924 62.68,16.272 63.24,15.456 C63.8,14.64 64.08,13.728 64.08,12.72 C64.08,11.552 63.772,10.628 63.156,9.948 C62.54,9.268 61.812,8.772 60.972,8.46 C60.132,8.148 59.072,7.856 57.792,7.584 C56.656,7.344 55.832,7.112 55.32,6.888 C54.808,6.664 54.552,6.328 54.552,5.88 C54.552,5.432 54.768,5.068 55.2,4.788 C55.632,4.508 56.32,4.368 57.264,4.368 C58.768,4.368 60.32,4.8 61.92,5.664 L61.92,5.664 L63.384,2.136 C62.568,1.656 61.624,1.292 60.552,1.044 C59.48,0.796 58.392,0.672 57.288,0.672 C55.672,0.672 54.308,0.912 53.196,1.392 C52.084,1.872 51.248,2.524 50.688,3.348 C50.128,4.172 49.848,5.096 49.848,6.12 C49.848,7.288 50.152,8.216 50.76,8.904 C51.368,9.592 52.096,10.092 52.944,10.404 C53.792,10.716 54.848,11.008 56.112,11.28 C57.264,11.536 58.1,11.78 58.62,12.012 C59.14,12.244 59.4,12.6 59.4,13.08 C59.4,13.992 58.488,14.448 56.664,14.448 C55.704,14.448 54.728,14.296 53.736,13.992 C52.744,13.688 51.872,13.288 51.12,12.792 L51.12,12.792 L49.56,16.296 C50.36,16.856 51.4,17.304 52.68,17.64 C53.96,17.976 55.28,18.144 56.64,18.144 Z M71.856,18.024 C72.48,18.024 73.068,17.96 73.62,17.832 C74.172,17.704 74.64,17.52 75.024,17.28 L75.024,17.28 L73.896,14.088 C73.496,14.36 73.032,14.496 72.504,14.496 C72.088,14.496 71.756,14.364 71.508,14.1 C71.26,13.836 71.136,13.472 71.136,13.008 L71.136,13.008 L71.136,8.688 L74.112,8.688 L74.112,5.28 L71.136,5.28 L71.136,1.896 L66.576,1.896 L66.576,5.28 L64.68,5.28 L64.68,8.688 L66.576,8.688 L66.576,13.056 C66.576,14.704 67.032,15.944 67.944,16.776 C68.856,17.608 70.16,18.024 71.856,18.024 Z M82.248,18.024 C83,18.024 83.712,17.888 84.384,17.616 C85.056,17.344 85.632,16.944 86.112,16.416 L86.112,16.416 L86.112,17.808 L90.456,17.808 L90.456,4.8 L85.896,4.8 L85.896,11.064 C85.896,12.104 85.668,12.876 85.212,13.38 C84.756,13.884 84.168,14.136 83.448,14.136 C82.744,14.136 82.208,13.912 81.84,13.464 C81.472,13.016 81.288,12.304 81.288,11.328 L81.288,11.328 L81.288,4.8 L76.728,4.8 L76.728,12.072 C76.728,14.056 77.228,15.544 78.228,16.536 C79.228,17.528 80.568,18.024 82.248,18.024 Z M99.048,18.024 C100.744,18.024 102.016,17.52 102.864,16.512 L102.864,16.512 L102.864,17.808 L107.208,17.808 L107.208,0 L102.648,0 L102.648,5.928 C101.8,5.032 100.6,4.584 99.048,4.584 C97.864,4.584 96.784,4.856 95.808,5.4 C94.832,5.944 94.06,6.724 93.492,7.74 C92.924,8.756 92.64,9.936 92.64,11.28 C92.64,12.624 92.924,13.808 93.492,14.832 C94.06,15.856 94.832,16.644 95.808,17.196 C96.784,17.748 97.864,18.024 99.048,18.024 Z M100.008,14.4 C99.208,14.4 98.552,14.124 98.04,13.572 C97.528,13.02 97.272,12.256 97.272,11.28 C97.272,10.32 97.528,9.568 98.04,9.024 C98.552,8.48 99.208,8.208 100.008,8.208 C100.808,8.208 101.46,8.48 101.964,9.024 C102.468,9.568 102.72,10.32 102.72,11.28 C102.72,12.256 102.464,13.02 101.952,13.572 C101.44,14.124 100.792,14.4 100.008,14.4 Z M112.368,22.68 C113.728,22.68 114.88,22.356 115.824,21.708 C116.768,21.06 117.568,19.936 118.224,18.336 L118.224,18.336 L123.84,4.8 L119.496,4.8 L116.28,12.744 L113.088,4.8 L108.408,4.8 L113.976,17.976 C113.784,18.36 113.548,18.64 113.268,18.816 C112.988,18.992 112.632,19.08 112.2,19.08 C111.832,19.08 111.468,19.012 111.108,18.876 C110.748,18.74 110.44,18.552 110.184,18.312 L110.184,18.312 L108.6,21.504 C109.032,21.856 109.596,22.14 110.292,22.356 C110.988,22.572 111.68,22.68 112.368,22.68 Z" id=Study fill-opacity=0.85 fill=#000000></path></g></g></g></svg><svg class="logo-dark hidden" width=125px height=23px viewBox="0 0 125 23" version=1.1 xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink><title>BTCStudy</title><g id=页面-1 stroke=none stroke-width=1 fill=none fill-rule=evenodd><g id=首页-响应式 transform="translate(-249.000000, -23.000000)" fill-rule=nonzero><g id=BTCStudy transform="translate(249.680000, 23.192000)"><path d="M9.072,17.808 C11.312,17.808 13.024,17.408 14.208,16.608 C15.392,15.808 15.984,14.672 15.984,13.2 C15.984,12.192 15.712,11.332 15.168,10.62 C14.624,9.908 13.872,9.384 12.912,9.048 C13.632,8.68 14.188,8.18 14.58,7.548 C14.972,6.916 15.168,6.2 15.168,5.4 C15.168,4.056 14.608,2.988 13.488,2.196 C12.368,1.404 10.736,1.008 8.592,1.008 L8.592,1.008 L-5.68434189e-14,1.008 L-5.68434189e-14,17.808 L9.072,17.808 Z M7.968,7.68 L4.704,7.68 L4.704,4.44 L7.968,4.44 C9.568,4.44 10.368,4.976 10.368,6.048 C10.368,7.136 9.568,7.68 7.968,7.68 L7.968,7.68 Z M8.688,14.376 L4.704,14.376 L4.704,10.968 L8.688,10.968 C10.352,10.968 11.184,11.536 11.184,12.672 C11.184,13.808 10.352,14.376 8.688,14.376 L8.688,14.376 Z M26.544,17.808 L26.544,4.776 L31.68,4.776 L31.68,1.008 L16.632,1.008 L16.632,4.776 L21.792,4.776 L21.792,17.808 L26.544,17.808 Z M41.592,18.144 C43.128,18.144 44.512,17.872 45.744,17.328 C46.976,16.784 48,16 48.816,14.976 L48.816,14.976 L45.792,12.24 C44.704,13.552 43.384,14.208 41.832,14.208 C40.92,14.208 40.108,14.008 39.396,13.608 C38.684,13.208 38.132,12.644 37.74,11.916 C37.348,11.188 37.152,10.352 37.152,9.408 C37.152,8.464 37.348,7.628 37.74,6.9 C38.132,6.172 38.684,5.608 39.396,5.208 C40.108,4.808 40.92,4.608 41.832,4.608 C43.384,4.608 44.704,5.264 45.792,6.576 L45.792,6.576 L48.816,3.84 C48,2.816 46.976,2.032 45.744,1.488 C44.512,0.944 43.128,0.672 41.592,0.672 C39.832,0.672 38.252,1.044 36.852,1.788 C35.452,2.532 34.352,3.568 33.552,4.896 C32.752,6.224 32.352,7.728 32.352,9.408 C32.352,11.088 32.752,12.592 33.552,13.92 C34.352,15.248 35.452,16.284 36.852,17.028 C38.252,17.772 39.832,18.144 41.592,18.144 Z" id=BTC fill=#F2A900></path><path d="M56.64,18.144 C58.24,18.144 59.6,17.9 60.72,17.412 C61.84,16.924 62.68,16.272 63.24,15.456 C63.8,14.64 64.08,13.728 64.08,12.72 C64.08,11.552 63.772,10.628 63.156,9.948 C62.54,9.268 61.812,8.772 60.972,8.46 C60.132,8.148 59.072,7.856 57.792,7.584 C56.656,7.344 55.832,7.112 55.32,6.888 C54.808,6.664 54.552,6.328 54.552,5.88 C54.552,5.432 54.768,5.068 55.2,4.788 C55.632,4.508 56.32,4.368 57.264,4.368 C58.768,4.368 60.32,4.8 61.92,5.664 L61.92,5.664 L63.384,2.136 C62.568,1.656 61.624,1.292 60.552,1.044 C59.48,0.796 58.392,0.672 57.288,0.672 C55.672,0.672 54.308,0.912 53.196,1.392 C52.084,1.872 51.248,2.524 50.688,3.348 C50.128,4.172 49.848,5.096 49.848,6.12 C49.848,7.288 50.152,8.216 50.76,8.904 C51.368,9.592 52.096,10.092 52.944,10.404 C53.792,10.716 54.848,11.008 56.112,11.28 C57.264,11.536 58.1,11.78 58.62,12.012 C59.14,12.244 59.4,12.6 59.4,13.08 C59.4,13.992 58.488,14.448 56.664,14.448 C55.704,14.448 54.728,14.296 53.736,13.992 C52.744,13.688 51.872,13.288 51.12,12.792 L51.12,12.792 L49.56,16.296 C50.36,16.856 51.4,17.304 52.68,17.64 C53.96,17.976 55.28,18.144 56.64,18.144 Z M71.856,18.024 C72.48,18.024 73.068,17.96 73.62,17.832 C74.172,17.704 74.64,17.52 75.024,17.28 L75.024,17.28 L73.896,14.088 C73.496,14.36 73.032,14.496 72.504,14.496 C72.088,14.496 71.756,14.364 71.508,14.1 C71.26,13.836 71.136,13.472 71.136,13.008 L71.136,13.008 L71.136,8.688 L74.112,8.688 L74.112,5.28 L71.136,5.28 L71.136,1.896 L66.576,1.896 L66.576,5.28 L64.68,5.28 L64.68,8.688 L66.576,8.688 L66.576,13.056 C66.576,14.704 67.032,15.944 67.944,16.776 C68.856,17.608 70.16,18.024 71.856,18.024 Z M82.248,18.024 C83,18.024 83.712,17.888 84.384,17.616 C85.056,17.344 85.632,16.944 86.112,16.416 L86.112,16.416 L86.112,17.808 L90.456,17.808 L90.456,4.8 L85.896,4.8 L85.896,11.064 C85.896,12.104 85.668,12.876 85.212,13.38 C84.756,13.884 84.168,14.136 83.448,14.136 C82.744,14.136 82.208,13.912 81.84,13.464 C81.472,13.016 81.288,12.304 81.288,11.328 L81.288,11.328 L81.288,4.8 L76.728,4.8 L76.728,12.072 C76.728,14.056 77.228,15.544 78.228,16.536 C79.228,17.528 80.568,18.024 82.248,18.024 Z M99.048,18.024 C100.744,18.024 102.016,17.52 102.864,16.512 L102.864,16.512 L102.864,17.808 L107.208,17.808 L107.208,0 L102.648,0 L102.648,5.928 C101.8,5.032 100.6,4.584 99.048,4.584 C97.864,4.584 96.784,4.856 95.808,5.4 C94.832,5.944 94.06,6.724 93.492,7.74 C92.924,8.756 92.64,9.936 92.64,11.28 C92.64,12.624 92.924,13.808 93.492,14.832 C94.06,15.856 94.832,16.644 95.808,17.196 C96.784,17.748 97.864,18.024 99.048,18.024 Z M100.008,14.4 C99.208,14.4 98.552,14.124 98.04,13.572 C97.528,13.02 97.272,12.256 97.272,11.28 C97.272,10.32 97.528,9.568 98.04,9.024 C98.552,8.48 99.208,8.208 100.008,8.208 C100.808,8.208 101.46,8.48 101.964,9.024 C102.468,9.568 102.72,10.32 102.72,11.28 C102.72,12.256 102.464,13.02 101.952,13.572 C101.44,14.124 100.792,14.4 100.008,14.4 Z M112.368,22.68 C113.728,22.68 114.88,22.356 115.824,21.708 C116.768,21.06 117.568,19.936 118.224,18.336 L118.224,18.336 L123.84,4.8 L119.496,4.8 L116.28,12.744 L113.088,4.8 L108.408,4.8 L113.976,17.976 C113.784,18.36 113.548,18.64 113.268,18.816 C112.988,18.992 112.632,19.08 112.2,19.08 C111.832,19.08 111.468,19.012 111.108,18.876 C110.748,18.74 110.44,18.552 110.184,18.312 L110.184,18.312 L108.6,21.504 C109.032,21.856 109.596,22.14 110.292,22.356 C110.988,22.572 111.68,22.68 112.368,22.68 Z" id=Study fill-opacity=0.85 fill=#FFFFFF></path></g></g></g></svg></div><div class="mobile-header-title is-full-height is-flex is-align-items-center is-flex-shrink-0"><div class="is-full-height hidden" id=postTopicMobile><p class=is-full-height>基于断言机的条件式支付背后的密码学</p></div></div></div><i class="iconfont icon-icon_search mobile-header-searchIcon"></i><div class=mobile-search-wrap><div class=search-input><input class=pl-3 id=mobile-search-input placeholder=请输入搜索关键词><i class="iconfont icon-icon_search mobile-search-input-btn"></i><button class=mobile-search-input-btn>搜 索</button></div></div></header><div class=mobile-slide-menu><a class=header-activity href=/ >首页</a><a href=/archives>全站目录</a><a href=/tags>标签</a><a href=/maps>地图</a><a href=/tools>工具</a><a target=_blank rel=noopener href=https://123btc.org/ >123btc</a><div><p class="slide-menu-theme is-flex is-flex-direction-row is-justify-content-space-between is-align-items-center"><span>主题设置</span><span><i class="iconfont icon-icon_light slide-theme-light hidden"></i><i class="iconfont icon-icon_dark slide-theme-dark hidden"></i></span></p><p class=slide-menu-fontsize><span>字体设置</span><span><i class="iconfont icon-bianzubeifen"></i><i class="iconfont icon-bianzu"></i></span></p></div></div><div class="search-mask hidden"><script src="/js/header.js?v=1682773100887"></script></div><main><main class="container is-max-widescreen content section post-page pt-4"><div class="columns is-flex-desktop is-justify-content-center"><div class="column is-3 silde-bar is-hidden-mobile"><ol class=toc><li class="toc-item toc-level-2"><a class=toc-link href=#%E8%A7%81%E8%AF%81%E6%B6%88%E6%81%AF%E4%BD%9C%E4%B8%BA%E4%B8%80%E7%A7%8D%E8%A7%A3%E5%AF%86%E5%AF%86%E9%92%A5><span class=toc-text>见证消息作为一种解密密钥</span></a><ol class=toc-child><li class="toc-item toc-level-3"><a class=toc-link href=#%E4%BD%BF%E7%94%A8%E7%B2%97%E7%B3%99%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86%E7%9A%84%E5%8F%AF%E9%AA%8C%E8%AF%81%E6%80%A7><span class=toc-text>使用粗糙对称加密的可验证性</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E4%BD%BF%E7%94%A8%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86%E7%9A%84%E5%8D%95%E5%90%91%E6%80%A7%EF%BC%9A%E5%AD%97%E9%9D%A2%E6%84%8F%E4%B9%89%E4%B8%8A%E7%9A%84-%E2%80%9CDLC%E2%80%9D><span class=toc-text>使用非对称加密的单向性：字面意义上的 “DLC”</span></a></li></ol></li><li class="toc-item toc-level-2"><a class=toc-link href=#%E9%80%82%E9%85%8D%E5%99%A8%E7%AD%BE%E5%90%8D><span class=toc-text>适配器签名</span></a></li><li class="toc-item toc-level-2"><a class=toc-link href=#%E6%96%AD%E8%A8%80%E6%9C%BA%E7%9A%84%E5%AF%86%E9%92%A5%E6%B4%BE%E7%94%9F><span class=toc-text>断言机的密钥派生</span></a><ol class=toc-child><li class="toc-item toc-level-3"><a class=toc-link href=#%E2%80%9C%E4%B8%80%E4%B8%AA%E5%AF%86%E9%92%A5%E5%AF%B9%E5%BA%94%E4%B8%80%E4%B8%AA%E7%BB%93%E6%9E%9C%E2%80%9D><span class=toc-text>“一个密钥对应一个结果”</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E5%8E%9F%E7%94%9F%E7%9A%84-BIP32-%E5%85%AC%E9%92%A5%E6%B4%BE%E7%94%9F><span class=toc-text>原生的 BIP32 公钥派生</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#Schnorr-%E7%AD%BE%E5%90%8D%E4%BD%9C%E4%B8%BA%E4%B8%80%E7%A7%8D%E5%AD%90%E5%85%AC%E9%92%A5%E6%B4%BE%E7%94%9F%E6%B3%95><span class=toc-text>Schnorr 签名作为一种子公钥派生法</span></a></li></ol></li><li class="toc-item toc-level-2"><a class=toc-link href=#%E4%B8%8D%E5%90%8C-DLC-%E6%8F%90%E8%AE%AE%E7%9A%84%E7%8E%B0%E7%8A%B6><span class=toc-text>不同 DLC 提议的现状</span></a><ol class=toc-child><li class="toc-item toc-level-3"><a class=toc-link href=#Dryja-%E7%9A%84%E5%88%9D%E5%A7%8B%E6%8F%90%E8%AE%AE><span class=toc-text>Dryja 的初始提议</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#ECDSA-%E7%9A%84%E9%80%82%E9%85%8D%E5%99%A8%E7%AD%BE%E5%90%8D><span class=toc-text>ECDSA 的适配器签名</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E5%85%B6%E5%AE%83%E5%8F%AF%E9%AA%8C%E8%AF%81%E8%A7%81%E8%AF%81%E6%95%B0%E6%8D%AE%E5%8A%A0%E5%AF%86%E6%96%B9%E6%A1%88><span class=toc-text>其它可验证见证数据加密方案</span></a></li></ol></li><li class="toc-item toc-level-2"><a class=toc-link href=#%E7%BB%93%E8%AE%BA><span class=toc-text>结论</span></a></li><li class="toc-item toc-level-2"><a class=toc-link href=#%E9%99%84%E5%BD%95%EF%BC%9A%E5%9F%BA%E4%BA%8E-BLS-%E7%9A%84-ObC-%E6%94%AF%E4%BB%98><span class=toc-text>附录：基于 BLS 的 ObC 支付</span></a></li></ol></div><div class="column is-9 post-container"><h1 class="mt-0 mb-2" id=postTitle>基于断言机的条件式支付背后的密码学</h1><div class=page-author><div class="is-flex is-flex-direction-row page-data mr-6"><img class=mr-1 src=/images/default_avatar.png alt="Théo Pantamis"><div class=page-author-info><strong>Théo Pantamis</strong><time class=has-text-grey datetime=2023-07-19T09:20:11.000Z>2023-07-19</time></div></div><div class=is-flex><a href=/tags/Discreet-Log-Contract><i class="page-tag mr-1 px-1">Discreet Log Contract</i></a></div></div><article class="mt-4 post-content"><blockquote><p><em>作者：Théo Pantamis</em></p><p><em>来源：<a target=_blank rel=noopener href=https://blog.lnmarkets.com/cryptography-of-dlcs/ >https://blog.lnmarkets.com/cryptography-of-dlcs/</a></em></p></blockquote><p><img src=/images/deep-dive-into-oracle-based-conditional-payments-lnmarkets/7rdzsb.jpg alt="Deep dive into Oracle-Based Conditional payments"></p><p style=text-align:center>- 为了无脑开多，Bob 检查 Alice 的适配器签名。他只是想避免对手方风险，这非常合理。至于市场风险么 …… -</p><p>在我们上一篇关于 “谨慎日志合约（DLC）” 的文章中，我们讨论了所需的密码学元件 —— 可验证的见证数据加密方案。但是，需要指出的是，这个概念的演化并不是一蹴而就的；它从 Dryja 最初的观念开始，经过了许多人的共同开发。</p><p>在这篇文章中，我们将从使用一个私钥作为签名的解密密钥的方法开始，然后将它转化为一笔交易的扳机。这将引导我们深入研究 “适配器签名” 的概念，尤其是它在 Schnorr 签名中的构造方法（为了简洁）。然后，我们会研究断言机见证消息的定义，从而根据被见证的事件高效沟通哪个私钥会被公开。</p><p>最后，我们会展示三种主要的 DLC 协议提议。我们将从 Dryja 的初始提议的概述开始，然后是结合了适配器签名的当前提议。此外，我们还要展示最具野心的提议，叫做 “ObC 支付（基于断言机的条件式支付）”，是由 Llyold Fournier 提出的。ObC 支付利用了一种真正可验证的见证数据加密方案，通过结合 BLS 签名和 Schnorr 签名的基于身份的加密达成了最优的效率。</p><p>这篇文章的技术讲解很多，会有数学！你有时间集中精力吗？如果有的话，备好你的茶或者咖啡，跟我来！</p><h2 id=见证消息作为一种解密密钥><a href=#见证消息作为一种解密密钥 class=headerlink title=见证消息作为一种解密密钥></a>见证消息作为一种解密密钥</h2><h3 id=使用粗糙对称加密的可验证性><a href=#使用粗糙对称加密的可验证性 class=headerlink title=使用粗糙对称加密的可验证性></a>使用粗糙对称加密的可验证性</h3><p>在上一篇文章中，我们讨论了利用断言机（在案例中叫做 Olivia）的见证消息来解密 Alice 和 Bob 所交换的签名的概念。这种解密只能用在跟这条见证消息相对应的支付交易的签名中，从而 Alice 和 Bob 的其中一人可以单方面执行合约、拿走属于自己的收获。</p><p>一种直截了当而且最简单的方法是，让 Alice 和 Bob 使用 Olivia 的对应签名加密他们的 “合约执行交易（CET）” 的签名，然后再交换加密的签名。但是，这种方法假设了 Alice 和 Bob 都已经拥有了从 Olivia 的私钥发出的相同签名、不再需要 Olivia 的参与了。如果是这样，那么双方都已经可以解密对方的签名了，整个流程都没有意义了。</p><p>这种方案所缺少的一个关键的侧面，叫做 “单向性”。也就是 Alice 和 Bob 可以加密一个签名，但对方的逆向工程（不需要 Olivia 的协助就能从加密的签名中复原出原本的签名）是计算上不可行的。</p><h3 id=使用非对称加密的单向性：字面意义上的-“DLC”><a href=#使用非对称加密的单向性：字面意义上的-“DLC” class=headerlink title="使用非对称加密的单向性：字面意义上的 “DLC”"></a>使用非对称加密的单向性：字面意义上的 “DLC”</h3><p>一种更复杂的方案是对签名使用非对称密钥加密。Alice 和 Bob 在双方都只知晓一个公钥的条件下约定其背后的私钥，然后用这个公钥来加密他们的签名。但是，没有人可以解密在他们之间交换的密文，只有得到背后的私钥才可以。一种使用椭圆曲线来协助这样的加密的著名算法是 “ElGamal 加密法”。</p><p>Olivia 可以同意在见证某个事件时公开自己的私钥，从而让 Alice 和 Bob 可以解密他们之前交换的密文。如同其名称 “谨慎日志合约” 所暗示的，Alice 和 Bob 需要了解某个东西的离散对数才能结算合约（一个椭圆曲线点的私钥就是它的离散对数，而一个标量的公钥则是它的幂数）。但是，如果使用相同的密钥来加密所有 CET 的签名，那也是有问题的，因为任何一笔都可以在 Olivia 的见证消息发出后解密并用于申领资金。所以，Olivia 需要宣布自己可能见证的所有结果，并为每一个结果指定一个公钥。</p><p>然而，这种方法虽然拥有了单向性，但依然不足，因为它缺乏可验证性。像 ElGamal 这样的非对称加密算法，内在地要求被加密的消息以某一种数学对象的受限格式来表示，例如 ElGamal 要求的是一个椭圆曲线点的 x 坐标。虽然这在混合加密系统 —— 被加密的消息将用作一个随机密钥、解密一个以对称加密法加密的大消息 —— 中是没有问题的，但它没有提供直接的方法让 Alice 和 Bob 验证自己所得的真的是一个签名。</p><h2 id=适配器签名><a href=#适配器签名 class=headerlink title=适配器签名></a>适配器签名</h2><p>一开始，如果说有一种办法可以加密电子签名、同时对手方可以在不知道真实签名的条件下验证该密文的有效性，简直就像魔法。但是，我们不必在 Alice 和 Bob 生成签名之后再加密签名，我们可以修改签名协议本身，使之产生一种碎片签名。这种碎片签名自身不算是有效的签名，但结合了属于 Olivia 的某一个私钥之后就会变成有效的签名。这种方法叫做 “适配器签名”。值得一提的是，虽然出于简洁，本文选择了在 Schnorr 签名的语境下介绍适配器签名的概念，但在 ECDSA 签名中同样可以定义出适配器签名协议。</p><p>我们先了解一下基本的概念：Bob 的电子签名的首要目标是向大家证明他拥有某个公钥 B 背后的私钥。 为了证明这一点而不泄露自己的私钥，Bob 将同时证明自己知道这个私钥和另一个随机选出的私钥。一开始，Bob 会选择一个随机的标量值 $r_{Bob}$ （称为 “nonce 秘密值”），然后计算并公开这个标量的公钥 $R_{Bob} &#x3D; r_{Bob}.G$ ，叫做 “nonce”。这个叫做 “承诺阶段”。</p><p><img src=/../images/deep-dive-into-oracle-based-conditional-payments-lnmarkets/commit_schnorr.png alt=img></p><p style=text-align:center>- Bob 承诺自己将用来签名的 nonce -</p><p>下一步，Bob 必须公开一个派生公钥的私钥；这个公钥是通过他自己的公钥和他所承诺的 nonce 公钥的线性组合产生的。这个组合的系数由被签名的消息以及他所承诺的 nonce 决定（就是前后拼接这两者以及 Bob 的公钥 $B$ 之后，运行哈希计算所得的哈希值）。这个叫做 “挑战阶段”。</p><p><img src=/../images/deep-dive-into-oracle-based-conditional-payments-lnmarkets/challenge_schnorr.png alt=img></p><p style=text-align:center>- Alice 代表着一个随机数断言机，也就是哈希函数，挑战 Bob 揭示一个私钥 -</p><p>Bob 通过使用私钥（而不是公钥）运行相同的算法来应对挑战。这利用了相关的公钥和私钥的数学线性关系。任何人都可以验证结果的有效性。</p><p><img src=/../images/deep-dive-into-oracle-based-conditional-payments-lnmarkets/verif_schnorr.png alt=img></p><p style=text-align:center>- 在上图所示的虚拟交互中，Bob 的签名 R_Bob 和 s_Bob 就是他要发送给 Alice 的所有东西。 -</p><p>适配器背后的核心洞见是 <strong>nonce 秘密值在标准的签名协议中的双重作用：一是计算 nonce 值，一个是推导出公开的私钥。而在适配器签名中，nonce 公钥会使用另一个公钥来调整，同时保持 nonce 秘密值不变</strong>。这种修改让签名失效，但很容易验证复原所需的缺失的秘密值 —— 用于调整的公钥背后的私钥。为了说明这些，我们想想 Bob 可以如何为 Alice 构造适配器签名，让她可以使用 Olivia 在 Azure 团队胜出时会发布的私钥 $s_{Azure}$ 来申领自己的资金。</p><p>Bob 虽然不知道 $s_{Azure}$ ，但可以创建出 Alice 可以验证的一个适配器签名。这是因为，Olivia 已经宣布，如果 Azure 胜出，她将公开 $S_{Azure} &#x3D; s_{Azure}.G$ 背后的私钥。Bob 先按标准程序启动签名协议，使用一个随机源获得一个秘密的 nonce 标量值 $r_{Bob}$ ，然后计算 $R_{Bob} &#x3D; r_{Bob}.G$ ，这是他希望用在签名中的 nonce 值。</p><p>在标准的 Schnorr 签名中，Bob 会计算线性组合的系数，这需要将交易的内容跟 nonce 点相结合、哈希它们，最后用自己的私钥乘以这个哈希值，最后加上 $r_{Bob}$ 。他会分享这个结果，以及 $R_{Bob}$ ，任何人都可以验证这个结果就是 $R_{Bob} + hash(B||R_{Bob}||T_x) * B$ 背后的私钥。即，签名是一个点和一个标量所组成的一对数据：</p><p>$$(R_{Bob}, r_{Bob} + hash(B||R_{Bob}||T_x) * b)$$</p><p>但是，Bob 不希望自己的签名直接就是有效的。在上面这个步骤之前，Bob 先给自己的 nonce 公钥加上 $S_{Azure}$ ，然后再执行相同的计算（不会修改 nonce 秘密值哦）。</p><p><img src=/../images/deep-dive-into-oracle-based-conditional-payments-lnmarkets/commit_adapt.png alt=img></p><p style=text-align:center>- Bob 在发布 nonce 值之前修改了它，使之成了一个适配器签名 -</p><p>这里的虚拟验证者（以哈希函数表示），将理解 Bob 会产生一个使用 nonce 值 $R’_{Bob}$ 的签名，并相对应地挑战他。TA 预期 Bob 会揭示一个使用调整后的 nonce 值计算出来的公钥的私钥：</p><p><img src=/../images/deep-dive-into-oracle-based-conditional-payments-lnmarkets/challenge_adapt.png alt=img></p><p style=text-align:center>- 一旦 Bob 分享了调整后的 nonce 值，哈希函数就挑战他，但他现在无法应对这个挑战了！ -</p><p>因为不知道私钥 $s_{Azure}$ ，所以 Bob 无法计算出满足挑战所需的私钥，但他将运行跟标准的 Schnorr 签名一样的运算，就使用原本的 nonce 秘密值、要发送给 Alice 的 nonce 值（修改后的）以及他的私钥。因此，他给 Alice 提供的 “签名” 是这样的一对数值：</p><p>$$R’_{Bob} &#x3D; R_{Bob} + S_{Azure}$$</p><p>$$s_{Bob} &#x3D; r_{Bob} + hash(B||R’_{Bob}||T_x) * b)$$</p><p>这是个无效的签名，因为 nonce 秘密值 $r_{Bob}$ 跟哈希函数中的 nonce 公钥 $R’_{Bob} &#x3D; R_{Bob} + S_{Azure}$ 并不匹配。但是，Alice 可以验证，这种不匹配，正是由于 $S_{Azure}$ 而导致的。实际上，如果我们尝试验证这个签名，我们可以这样计算：</p><p>$$s_{Bob}.G$$</p><p>$$&#x3D; r_{Bob}.G + hash(B||R’_{Bob}||T_x) * b.G$$</p><p>$$&#x3D; R_{Bob} + hash(B||R’_{Bob}||T_x) * B)$$</p><p>$$&#x3D; R’_{Bob} + hash(B||R’_{Bob}||T_x) * B) - S_{Azure}$$</p><p>Alice 可以验证，添加 $S_{Azure}$ 正是让 nonce 值改变、让签名无效的调整项。对 Alice 来说，这就构成了一个证据：只要她知道私钥 $s_{Azure}$ ，就可以将这个值添加到 Bob 的适配器签名的标量元素 $s’_{Bob-CET_{Azure}}$ 中，使之成为一个有效的签名。有了这个有效的签名，Alice 就可以用来执行对应的 CET（在这里是表示 Azure 胜出的那一笔 CET），从而获得自己的收获。这意味着，只要 Olivia 揭示了 $S_{Azure}$ 背后的私钥， Alice 就可以广播一笔有效的交易、执行跟 Bob 的合约并申领资金。</p><p><img src=/../images/deep-dive-into-oracle-based-conditional-payments-lnmarkets/verif_adapt.png alt=img></p><p>这种初始步骤是可靠的，但这就给 Olivia 带来了一个挑战：她需要为每一种结果生成一把私钥，在发布承诺和见证事件期间安全地保管。那么，我们来研究如何扩展 Olivia 的能力，使之能处理大量的可能结果。</p><h2 id=断言机的密钥派生><a href=#断言机的密钥派生 class=headerlink title=断言机的密钥派生></a>断言机的密钥派生</h2><h3 id=“一个密钥对应一个结果”><a href=#“一个密钥对应一个结果” class=headerlink title=“一个密钥对应一个结果”></a>“一个密钥对应一个结果”</h3><p>前面介绍的方法对 Olivia 来说产生了挑战，是因为她需要为她可能见证的每一种结果宣布一个公钥。对 Olivia 来说，这会很难管理，因为她必须保证这些私钥都是安全的、只有那个对应与被见证的结果的私钥会揭晓。这需要 Olivia 在宣布和见证事件期间管理敏感数据的带状态的存储。</p><p>此外，这种方法对 Olivia 的用户来说也是一种成本。每一种可能的结果都需要交换一个适配器签名，这对那些只有少数几种可能结果的场景来说是没问题的，但对那些在一个大区间内分布的数字型结果来说，是不实用的。这就导致，如果交易覆盖了一大范围的数值，用户必须多次加密同一个 CET 的签名。Olivia 可以挑战她所签名的结果的范围，但这会限制她的见证消息的应用场景，或者用户必须将合约的具体内容告知 Olivia ，这会牺牲协议的隐私性。</p><p>虽然这种办法可能不适合用于买卖的 DLC，但它也提供了一些好处。一个重大的好处是，Alice 和 Bob 将很容易使用一个应用了这种签名方法的断言机的联盟。他们可以使用一种 FROST 协议、非交互式地聚合这些断言机的公钥和签名，从而秘密地建立断言机的门限联盟。但是，这也需要小心，因为 Alice 可以选择可能发生意外碰撞的断言机，从而允许她使用真正被见证的结果之外的结果来申领资金。这种叫 “瓦格纳攻击” 或者 “生日攻击”。</p><p>一种可以提升 Olivia 的断言机系统的方法是建立一种能够为每一种结果安全地推导出所有公钥的办法。Olivia 将只需宣布一个小的而且易于广播的公钥列表，而在需要见证结果的时候，她只需计算跟这个结果相对应的公钥的私钥，而无需计算其它的私钥。</p><h3 id=原生的-BIP32-公钥派生><a href=#原生的-BIP32-公钥派生 class=headerlink title="原生的 BIP32 公钥派生"></a>原生的 BIP32 公钥派生</h3><p>比特币人都熟悉使用 BIP32 标准从某些公钥派生另一些公钥的标准。BIP32 引入了一套密钥派生流程，其中一个种子词被分割成一个私钥和一个链码（chaincode），它们一起被叫做 “XPRV”。每个 XPRV 都有一个对应的 XPUB，形式上跟 XPRV 一样，只不过其中不是私钥，而是公钥。在不使用硬化派生方法的时候，只需使用 XPUB，就可以推导出所有源自 XPRV 的私钥的公钥。这意味着，Olivia 可以宣布一个 XPUB 而不是多个公钥，并说明派生的方法，每个人都可以凭此获得对应于结果的公钥；然后她会发布见证结果及其对应的私钥。</p><p>但是，最简单的办法是不可行的。虽然 XPUB 允许这样的派生，但它也有一个缺点，任何人只要知道了某个派生公钥的私钥，都可以反推出其父密钥，并相应推导出所有的子私钥（译者注：也即自己的兄弟私钥）。这意味着一旦 Olivia 为了就见证某个结果而泄露一个私钥，她就让任何人都能计算出跟其它结果相对应的私钥，这就违背了我们的初衷。</p><p>在 Tadge Dryja 的 DLC 初始论文中，他提出了一种创新的办法，可以派生出断言机的公钥，同时确保揭晓其中一个私钥不会爆破对应的断言机公钥。他实现这种派生的方法既简单又清楚：被揭晓的私钥就是一个 Schnorr 签名的标量部分。</p><h3 id=Schnorr-签名作为一种子公钥派生法><a href=#Schnorr-签名作为一种子公钥派生法 class=headerlink title="Schnorr 签名作为一种子公钥派生法"></a>Schnorr 签名作为一种子公钥派生法</h3><p>假设要见证一个事件，Olivia 会用自己的公钥 $O$ 生成一个对结果的 Schnorr 签名。</p><p>观察 Schnorr 签名的验证等式，Olivia 的签名 $s_{Azure}$ （表示胜利者为 “Azure”）跟 nonce 值 R 和她的公钥 $O$ 有这样的关系：</p><p>$$s_{Azure}.G &#x3D; R + hash(O||R||”Azure”) * O$$</p><p>这个等式就意味着：</p><p><strong>$s_{Azure}$ 就是公钥 $$R + hash(O||R||”Azure”) * O$$ 的私钥！</strong></p><p>电子签名方案的一个基本属性就是，签名只能由公钥背后的私钥的主人制造出来。这是因为签名揭示了某个点（公钥）的私钥，而这个公钥本身是由签名人的公钥和一个一次性的公钥（就是 nonce）结合而来的。Dryja 的想法很简单：通过预先承诺将用来签名见证消息的 nonce 值，断言机可以承诺将揭示一个任何人都可以派生出来的公钥的私钥。因此，Schnorr 签名的验证点，将可以用来建立一种合约，仅在这个点的离散对数得到揭晓时才结算，也就是用被见证的结果来触发合约的执行。</p><p>不像 BIP32，这种私钥的揭晓不会泄露其它结果的私钥。这是因为断言机不会公开跟其公钥相关的链码，而只会公开另一个公钥：nonce 值 R。此外，还可以创建一种欺诈证明系统：如果这个断言机使用相同的 nonce 见证了两个不同结果，那么任何人都可以推导出这个断言机的私钥，同时证明这个断言机不再值得信任。</p><p>这种子密钥派生法的一种改进方法是，我们并不需要像 Schnorr 签名协议那样使用哈希化的数据。签名中的哈希值那一项可以整个替换成将一个索引号跟结果关联起来的任何函数。如果是用作签名，这样的改动是不安全的，但只是为了派生断言机的公钥，就依然是安全的。如果断言机的 nonce 值和公钥从哈希标签中移除了，那么所有的断言机都可以为给定的结果消息使用相同的索引号。这也将允许断言机见证消息的非交互式聚合（提醒，由于潜在的瓦格纳攻击，安全性可能会下降）。</p><p>现在，我们理解了 DLC 的两个核心元素，可以来看看不同的提议以及这项技术的现状了。</p><h2 id=不同-DLC-提议的现状><a href=#不同-DLC-提议的现状 class=headerlink title="不同 DLC 提议的现状"></a>不同 DLC 提议的现状</h2><h3 id=Dryja-的初始提议><a href=#Dryja-的初始提议 class=headerlink title="Dryja 的初始提议"></a>Dryja 的初始提议</h3><p>Dryja 的初始提议并没有使用适配器签名或者可验证的见证加密技术。在预先签名 CET 的时候，Bob 直接签名，但资金不是直接发送给 Alice 的公钥，而是发送给 Alice 的公钥和断言机派生公钥的和，也就是调整了 Alice 的公钥，Alice 可以检查并发现自己必须生成新的公钥 $\hat{A}^{Azure}$ 的签名：</p><p>$$\hat{A}^{Azure} &#x3D; A + (R + hash(O||R||”Azure”) * O)$$</p><p>当 Olivia 签名 “Azure” 以见证胜出的球队时，Alice 可以计算出 $\hat{A}^{Azure}$ 的离散对数（discrete logarithm），只要把自己的私钥加入 Olivia 所发布的签名中即可，这就是 “谨慎日志合约（discreet log contract）” 的名字的由来（译者注：“离散（discrete）” 和 “谨慎（discreet）” 只有一字之差）：</p><p>$$\hat{a}^{Azure} &#x3D; a + s_{Azure}$$</p><p>然后，Alice 就可以用一笔终局交易来申领资金。如果 Alice 不消息广播了错误的 Bob 预签名交易，她将不能取出其中的资金，只有 Bob 能在时间锁超时后取出资金。</p><p>下图展示了这套协议的的 DLC 注资操作的一个简化的案例：</p><p><img src=/../images/deep-dive-into-oracle-based-conditional-payments-lnmarkets/Dryja_setup-1.png alt=img></p><p style=text-align:center>- 使用一个二元结果的合约展示 Dryja 的初版提议。赢家拿走资金需要 2 笔交易。 -</p><p>Dryja 的 DLC 设计是这个概念的第一个版本。但是，它缺乏可验证加密特性，而且，在 CET 得到确认之后，需要一笔额外的交易来取走资金。这个方法还有一个局限性：链上交易不会公开断言机的签名。所以很难公开证明这个断言机签名了两个不同的结果。此外，断言机可能签名的每一条消息都需要一笔对应的预先签名的 CET，即使最终的支付结果是一样的，因为每一种结果自身都决定了公钥的调整项。相反，在使用适配器签名或者说可验证的见证数据加密技术的时候，你可以为相同支付结果的交易的签名使用对应于不同结果的不同公钥多次加密。</p><h3 id=ECDSA-的适配器签名><a href=#ECDSA-的适配器签名 class=headerlink title="ECDSA 的适配器签名"></a>ECDSA 的适配器签名</h3><p>当前的规范没有使用 Dryja 的公钥调整法，而是使用了一种适配器签名方案。这个提议阶段的规范建议使用传统的 Schnorr 签名来为断言机的公告派生密钥，然后再用这些密钥来创建 ECDSA 的适配器签名。</p><p>断言机无法将 ECDSA 用作密钥派生。这是因为 ECDSA 在一定程度上是保守的（跟 Schnorr 相比）：签名者通过揭晓其公钥和一个从待签名消息中计算出来的公钥的组合，来证明自己知道一个私钥。这意味着，在签名发布之前，我们并不知道哪一个私钥会（通过组合的系数）被揭开。</p><p>虽然断言机无法使用 ECDSA 作为密钥派生法，但也可以定义出 ECDSA 的一种适配器签名，允许缔结和约的各方使用基于 ECDSA 的签名。当前的 DLC 规范指定了一种 ECDSA 适配器签名协议作为一种可验证见证数据加密方案。ECDSA 适配器签名的细节比较复杂，可以在 DLC 规范库中找到。值得注意的是，ECDSA 的适配器签名需要另一种叫做 “离散对数等价证明（Proof of Discrete Logarithm Equivalence）” 的密码学元件；它已经用在 JoinMarket 中作为防止洪泛攻击（spam）的手段。在 Taproot 得到采用之后，可能会又一种采用 Schnorr 签名的适配器签名的规范。</p><p><img src=/../images/deep-dive-into-oracle-based-conditional-payments-lnmarkets/DLCspec_setup.png alt=img></p><p style=text-align:center>- 适配器签名使用相对应的 Olivia 的见证消息签名转化成真正的签名 -</p><h3 id=其它可验证见证数据加密方案><a href=#其它可验证见证数据加密方案 class=headerlink title=其它可验证见证数据加密方案></a>其它可验证见证数据加密方案</h3><p>前面提到的方案的断言机都使用了 Schnorr 签名。但是，还有可能为 DLC 构造别的可验证见证数据加密方案。最开始，可验证的见证数据加密方案并不假设知道签名的 nonce 值。在 1990 年到，<em>Garg et al.</em> 提出了一种通用的方法，当且仅当找出给定的难题的一个解的时候，可以解密。在这个背景下，断言机的签名可以视作一个难题的有效的解，而这个难题就是 —— 找出一个点和一个标量，使它们满足 Schnorr 签名的验证等式。不幸的是，这种方法对 DLC 来说并不实用，难以扩展。</p><p>DLC 的可验证见证数据加密方案的一个最大胆的提议是 Lloyd Fournier 在一篇文章中提出的。它让断言机可以使用 BLS 签名来见证事件，而缔约的各方依然使用 Schnorr 签名。BLS 签名法使用了椭圆曲线配对（elliptic curve pairing）来产生签名。但是，需要支持一种允许这样的配对的椭圆曲线，而比特币所用的 spec256k1 不在此列。这种配对的一个主要特性叫做 “双线性（bi-linearity）”：可以在数学上定义 “曲线上的任何两个点的乘积”。</p><p>在 <em>Madathil et al.</em> 所提议的方法中，断言机的 BLS 签名会被重新解释成一个私钥，能够在同样使用配对的基于身份的加密方法中使用。这里的想法是使用随机的标量对同一个 CET 签名多次加密（对称加密），然后再使用基于身份的加密方法来加密这些标量。这个流程涉及一个叫做 “cut and choose” 的程序， 一半的加密过的随机标量会被随机公开（使用一个哈希函数作为随机性断言机），作为至少其中一个依然隐藏的签名大概率已经被正确加密的证明。但是，这种方法要为每一个 CET 作繁重的运算，使之难以用于非托管的交易。有兴趣的朋友可以看看文章末尾的附录。</p><p>此外，BLS 很有吸引力，因为它不需要 nonce，所以断言机是无状态的，不需要存储任何公共和任何信息。此外，这和允许容易的断言机聚合，这是由配对的数学双线性和断言机无状态性带来的。</p><p>不够，这种提议还有一些尚未解决的问题。其一，它需要一种新的椭圆曲线实现。虽然 BLS 签名密码学已经有参考实现，但也需要对使用哪种参考实现达成共识。带有配对的椭圆曲线的安全性依然没有得到很好的理解。利用配对的协议的假设是 “决策型 Diffie-Hellman 问题” 易解而 “计算型 Diffie-Hellman 问题” 难解。最近由 <em>May and al. 2023</em> 作出的贡献，已经展示了在许多椭圆曲线上，计算型 Diffie-Hellman 问题可以实用地化约成离散对数问题，这意味着计算型问题不会因为决策型问题易解而易解。</p><p>第二个问题是 cut-and-choose 流程的计算负担。足够快地建立合约、使之对广泛的采用具备实用性可能是很难的。不过，也许有一些方法可以在 DLC 中优化计算的证明并找出取舍，以减少整体的计算时间。</p><p>这种解决方案可能要在遥远的未来才能得到采用，这还是不确定的。Lloyd Fournier 正在积极开发它，自然对时间和可用性有更好的把握。</p><h2 id=结论><a href=#结论 class=headerlink title=结论></a>结论</h2><p>自 Dryja 的 DLC 初始提议以来，这套协议已经有了重大进展。适配器签名的引入消除了需要额外的交易来结算的需要，从而极大地提升了效率。但是，Dryja 所提出的基本概念依然适用：在宣布和见证期间，使用 Schnorr 签名来推导公钥和私钥。</p><p>虽然在这方面取得了进展，当前的 DLC 规范依然坚守最初的概念。但是，DLC 的未来并不必然完全依赖于 DLC 本身。Llyold Fournier 的 ObC 支付（基于断言机的条件式支付）提议，在社区中吸引了许多关注，也表现出了令人信服的可能性。它引入了无状态的、可以聚合的断言机，通过最小化用户的计算负担扩大了断言机社区。这个提议提供了有吸引力的一面，虽然还在开发当中。</p><p>虽然我们已经使用二元结果和 “赢家全拿” 展示了 DLC 的案例，我们必须知道，交易衍生品涉及一个广大的支付区间。这些支付交易会以多种方式在两方之间分发资金，取决于事件的结果，而这样的结果通常以一个数字（例如价格）表现出来。在下一篇文章中，我们将深入研究如何优化 CET 的谈判并减少 CET 的数量，从而减少需要预先签名的交易的数量，尤其在跟价格相关的场景中。</p><p>如果你对基于 BLS 的 DLC 协议的细节感兴趣，这里有一份附录：</p><h2 id=附录：基于-BLS-的-ObC-支付><a href=#附录：基于-BLS-的-ObC-支付 class=headerlink title="附录：基于 BLS 的 ObC 支付"></a>附录：基于 BLS 的 ObC 支付</h2><p>如果你想了解基于 BLS 的 DLC 设计的核心想法的话，这里有一份全景图，还带有一些有助于理解细节的提示：</p><ul><li><p>一条 BLS 曲线实际上是两条曲线：一条基础曲线，就像常用的椭圆曲线一样，曲线上的点是公钥，是通过一个生成器点连续自加而成的；另一条是给 BLS 配对求值的曲线。这种配对是双线性的，而且是非退化的（non degenerate），所以可以视为基础曲线上的公钥的一种 “乘积”，只不过这种乘积不是基础曲线上的点，而是另一条曲线上的点。</p></li><li><p>Hash1 是一种 “哈希成点（hash to curve）” 函数，结果哈希值是 BLS 基础曲线上的一个点，而不是一个数（它的名字就是这么来的）</p></li><li><p>Hash2 是一种从 BLS 配对求值曲线（不是基础曲线）上的点生成任意多随机比特的函数。你可以视它为一种伪随机比特币生成器，是用一次配对的结果作为种子来启动的。</p></li><li><p>至此，被交换的公开数据的哈希函数，可以用在任何点上，而验证者必须选择一个随机的数值来代替自己。就像我们在 Schnorr 签名的挑战阶段使用哈希函数来代替 Alice，我们也可以在决定 Bob 要揭示什么数值的时候使用一个哈希值来替代她，从而省去一轮交互。</p></li><li><p>下面的特性表示，用来对称性 加密&#x2F;解密 Schnorr 签名的调整项的密钥，只需要从一个 nonce 秘密值 $r’$ 或者使用 Olivia 对事件 “Azure” 的 BLS 签名就可以计算出来，然后就可以让 Alice 领取自己的收获：</p><p>$$r’ * pairing(Hash1(“Azure”),O)$$</p><p>$$&#x3D; o * pairing(Hash1(“Azure”),r’.G)$$</p><p>$$&#x3D; pairing(o * Hash1(“Azure”),U’)$$</p><p>$$&#x3D; pairing(S_{Olivia}, U’)$$</p></li></ul><p><img src=/../images/deep-dive-into-oracle-based-conditional-payments-lnmarkets/Llyod_DLC-3.png alt=img></p><p>-断言机使用 BLS 签名的 ObC 支付的建立和结算。注意，在设置的时候，参与方只需要断言机的公钥。抽取出的对数 (r, t) 取决于参与协议的双方沟通出来的安全性-</p><p>（完）</p></article></div></div></main><script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.8/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><script>MathJax.Hub.Config({tex2jax:{inlineMath:[["$","$"],["\\(","\\)"]],processEscapes:!0,skipTags:["script","noscript","style","textarea","pre","code"]}}),MathJax.Hub.Queue(function(){for(var a=MathJax.Hub.getAllJax(),e=0;e<a.length;e+=1)a[e].SourceElement().parentNode.className+=" has-jax"})</script><script src="/js/post.js?v=1682773100887"></script><script src="/js/highlight.min.js?v=1682773100887"></script><script>var containerEl=document.querySelector(".post-container"),postFontSize=localStorage.getItem("post-font-size")||"16",inputEl=document.querySelector("#size-change-input"),inputEl2=document.querySelector("#size-change-input2");inputEl.value=postFontSize,inputEl2.value=postFontSize,containerEl.style.fontSize=postFontSize+"px",$(function(){function e(t){$(".post-container").css("font-size",t+"px"),localStorage.setItem("post-font-size",t),$("#size-change-input").val(t),$("#size-change-input2").val(t)}$("#size-change-input").on("input propertychange",function(t){e(t.target.value)}),$("#size-change-input2").on("input propertychange",function(t){e(t.target.value)})})</script><script>hljs.initHighlightingOnLoad()</script></main></div><footer class="is-flex is-flex-direction-column is-align-items-center is-flex-shrink-0"><section class=sns-container><a title=nostr target=_blank rel="noopener nofollow" href=https://iris.to/npub1g2qs0ca5kpwlrcfug2em4jelmh65clk3yccwjxrs6hvdpd9qj80q022j4m>Nostr</a><a title=rss target=_blank rel="noopener nofollow" href=/atom.xml>rss</a><a title=telegram target=_blank rel="noopener nofollow" href=//t.me/btcstudyorg>Telegram</a></section></footer><script async src="/js/buttons.js?v=1682773100887"></script><script async src="/js/index.js?v=1682773100887"></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-JVCJ9XXG1Z"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-JVCJ9XXG1Z")</script><script>var _hmt=_hmt||[];(()=>{var e=document.createElement("script"),t=(e.src="https://hm.baidu.com/hm.js?c92c073c85be5be8d9b1b76f62a7e306",e.async=!0,e.defer=!0,document.getElementsByTagName("script")[0]);t.parentNode.insertBefore(e,t)})()</script></body></html>