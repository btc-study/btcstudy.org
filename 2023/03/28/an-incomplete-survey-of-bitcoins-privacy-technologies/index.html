<!DOCTYPE html><html lang=zh-CN><head><meta charset=UTF-8><title>比特币隐私技术的不完全调查</title><meta name=keywords content="比特币, 中本聪, 比特币区块链, 闪电网络, 比特币 layer 2, 健全货币, 密码货币, 密码朋克, 学习比特币, BTC, BTC Study, Bitcoin, bitcoin, proof of work"><meta name=description content=比特币思想的中文集结地><meta name=viewport content="width=device-width,minimum-scale=1,maximum-scale=1,initial-scale=1"><link rel=icon href=/favicon.ico><link rel=stylesheet href="/style/common/bulma.css?v=1682773100887"><link rel=preload as=style onload='this.onload=null,this.rel="stylesheet"' href="/style/common/iconfont.css?v=1682773100887"><link rel=stylesheet href="/style/base.css?v=1682773100887"><link rel=stylesheet href="/style/common/helper.css?v=1682773100887"><link rel=stylesheet href="/style/themes/animation.css?v=1682773100887"><script>function ready(){var e=document.querySelector(".body-container"),t=localStorage.getItem("theme")||"light";["light","dark"].includes(t)||(t="light",localStorage.setItem("theme","light")),e.classList.remove("appearance-auto"),e.classList.add("appearance-"+t),quickInitialTheme()}function quickInitialTheme(){var e=localStorage.getItem("theme")||"light",t=document.querySelector(".logo-light"),o=document.querySelector(".logo-dark"),d=document.querySelector("#mobile-header-logo > .logo-light"),l=document.querySelector("#mobile-header-logo > .logo-dark"),a=document.getElementById("theme-btn"),i=document.querySelector(".slide-theme-light"),c=document.querySelector(".slide-theme-dark");document.body.classList.add(e),("dark"===e?(t.classList.add("hidden"),o.classList.remove("hidden"),d.classList.add("hidden"),l.classList.remove("hidden"),a.classList.remove("icon-icon_dark"),a.classList.add("icon-icon_light"),i):c).classList.remove("hidden")}document.addEventListener("DOMContentLoaded",ready)</script><script src="/js/common.js?v=1682773100887"></script><script src=/js/libs/zepto.min.js></script><link rel=stylesheet href="/style/post.css?v=1682773100887"><link rel=stylesheet href="/style/themes/highlight.css?v=1682773100887"><meta name=generator content="Hexo 6.3.0"><link rel=alternate href=/atom.xml title="BTC Study" type=application/atom+xml></head><body class="is-flex is-flex-direction-column" onload=initialTheme()><div class=clip></div><div class="body-container appearance-auto"><header class="header-widget is-hidden-mobile is-flex is-flex-shrink-0 is-align-items-center is-justify-content-center" id=header><div class="is-flex header-widget-container is-flex-shrink-0 is-align-items-center"><section class="is-hidden-mobile is-flex-shrink-0"><h1><a href=/ ><svg class=logo-light width=125px height=23px viewBox="0 0 125 23" version=1.1 xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink><title>BTCStudy</title><g id=页面-1 stroke=none stroke-width=1 fill=none fill-rule=evenodd><g id=首页-响应式 transform="translate(-249.000000, -23.000000)" fill-rule=nonzero><g id=BTCStudy transform="translate(249.680000, 23.192000)"><path d="M9.072,17.808 C11.312,17.808 13.024,17.408 14.208,16.608 C15.392,15.808 15.984,14.672 15.984,13.2 C15.984,12.192 15.712,11.332 15.168,10.62 C14.624,9.908 13.872,9.384 12.912,9.048 C13.632,8.68 14.188,8.18 14.58,7.548 C14.972,6.916 15.168,6.2 15.168,5.4 C15.168,4.056 14.608,2.988 13.488,2.196 C12.368,1.404 10.736,1.008 8.592,1.008 L8.592,1.008 L-5.68434189e-14,1.008 L-5.68434189e-14,17.808 L9.072,17.808 Z M7.968,7.68 L4.704,7.68 L4.704,4.44 L7.968,4.44 C9.568,4.44 10.368,4.976 10.368,6.048 C10.368,7.136 9.568,7.68 7.968,7.68 L7.968,7.68 Z M8.688,14.376 L4.704,14.376 L4.704,10.968 L8.688,10.968 C10.352,10.968 11.184,11.536 11.184,12.672 C11.184,13.808 10.352,14.376 8.688,14.376 L8.688,14.376 Z M26.544,17.808 L26.544,4.776 L31.68,4.776 L31.68,1.008 L16.632,1.008 L16.632,4.776 L21.792,4.776 L21.792,17.808 L26.544,17.808 Z M41.592,18.144 C43.128,18.144 44.512,17.872 45.744,17.328 C46.976,16.784 48,16 48.816,14.976 L48.816,14.976 L45.792,12.24 C44.704,13.552 43.384,14.208 41.832,14.208 C40.92,14.208 40.108,14.008 39.396,13.608 C38.684,13.208 38.132,12.644 37.74,11.916 C37.348,11.188 37.152,10.352 37.152,9.408 C37.152,8.464 37.348,7.628 37.74,6.9 C38.132,6.172 38.684,5.608 39.396,5.208 C40.108,4.808 40.92,4.608 41.832,4.608 C43.384,4.608 44.704,5.264 45.792,6.576 L45.792,6.576 L48.816,3.84 C48,2.816 46.976,2.032 45.744,1.488 C44.512,0.944 43.128,0.672 41.592,0.672 C39.832,0.672 38.252,1.044 36.852,1.788 C35.452,2.532 34.352,3.568 33.552,4.896 C32.752,6.224 32.352,7.728 32.352,9.408 C32.352,11.088 32.752,12.592 33.552,13.92 C34.352,15.248 35.452,16.284 36.852,17.028 C38.252,17.772 39.832,18.144 41.592,18.144 Z" id=BTC fill=#F2A900></path><path d="M56.64,18.144 C58.24,18.144 59.6,17.9 60.72,17.412 C61.84,16.924 62.68,16.272 63.24,15.456 C63.8,14.64 64.08,13.728 64.08,12.72 C64.08,11.552 63.772,10.628 63.156,9.948 C62.54,9.268 61.812,8.772 60.972,8.46 C60.132,8.148 59.072,7.856 57.792,7.584 C56.656,7.344 55.832,7.112 55.32,6.888 C54.808,6.664 54.552,6.328 54.552,5.88 C54.552,5.432 54.768,5.068 55.2,4.788 C55.632,4.508 56.32,4.368 57.264,4.368 C58.768,4.368 60.32,4.8 61.92,5.664 L61.92,5.664 L63.384,2.136 C62.568,1.656 61.624,1.292 60.552,1.044 C59.48,0.796 58.392,0.672 57.288,0.672 C55.672,0.672 54.308,0.912 53.196,1.392 C52.084,1.872 51.248,2.524 50.688,3.348 C50.128,4.172 49.848,5.096 49.848,6.12 C49.848,7.288 50.152,8.216 50.76,8.904 C51.368,9.592 52.096,10.092 52.944,10.404 C53.792,10.716 54.848,11.008 56.112,11.28 C57.264,11.536 58.1,11.78 58.62,12.012 C59.14,12.244 59.4,12.6 59.4,13.08 C59.4,13.992 58.488,14.448 56.664,14.448 C55.704,14.448 54.728,14.296 53.736,13.992 C52.744,13.688 51.872,13.288 51.12,12.792 L51.12,12.792 L49.56,16.296 C50.36,16.856 51.4,17.304 52.68,17.64 C53.96,17.976 55.28,18.144 56.64,18.144 Z M71.856,18.024 C72.48,18.024 73.068,17.96 73.62,17.832 C74.172,17.704 74.64,17.52 75.024,17.28 L75.024,17.28 L73.896,14.088 C73.496,14.36 73.032,14.496 72.504,14.496 C72.088,14.496 71.756,14.364 71.508,14.1 C71.26,13.836 71.136,13.472 71.136,13.008 L71.136,13.008 L71.136,8.688 L74.112,8.688 L74.112,5.28 L71.136,5.28 L71.136,1.896 L66.576,1.896 L66.576,5.28 L64.68,5.28 L64.68,8.688 L66.576,8.688 L66.576,13.056 C66.576,14.704 67.032,15.944 67.944,16.776 C68.856,17.608 70.16,18.024 71.856,18.024 Z M82.248,18.024 C83,18.024 83.712,17.888 84.384,17.616 C85.056,17.344 85.632,16.944 86.112,16.416 L86.112,16.416 L86.112,17.808 L90.456,17.808 L90.456,4.8 L85.896,4.8 L85.896,11.064 C85.896,12.104 85.668,12.876 85.212,13.38 C84.756,13.884 84.168,14.136 83.448,14.136 C82.744,14.136 82.208,13.912 81.84,13.464 C81.472,13.016 81.288,12.304 81.288,11.328 L81.288,11.328 L81.288,4.8 L76.728,4.8 L76.728,12.072 C76.728,14.056 77.228,15.544 78.228,16.536 C79.228,17.528 80.568,18.024 82.248,18.024 Z M99.048,18.024 C100.744,18.024 102.016,17.52 102.864,16.512 L102.864,16.512 L102.864,17.808 L107.208,17.808 L107.208,0 L102.648,0 L102.648,5.928 C101.8,5.032 100.6,4.584 99.048,4.584 C97.864,4.584 96.784,4.856 95.808,5.4 C94.832,5.944 94.06,6.724 93.492,7.74 C92.924,8.756 92.64,9.936 92.64,11.28 C92.64,12.624 92.924,13.808 93.492,14.832 C94.06,15.856 94.832,16.644 95.808,17.196 C96.784,17.748 97.864,18.024 99.048,18.024 Z M100.008,14.4 C99.208,14.4 98.552,14.124 98.04,13.572 C97.528,13.02 97.272,12.256 97.272,11.28 C97.272,10.32 97.528,9.568 98.04,9.024 C98.552,8.48 99.208,8.208 100.008,8.208 C100.808,8.208 101.46,8.48 101.964,9.024 C102.468,9.568 102.72,10.32 102.72,11.28 C102.72,12.256 102.464,13.02 101.952,13.572 C101.44,14.124 100.792,14.4 100.008,14.4 Z M112.368,22.68 C113.728,22.68 114.88,22.356 115.824,21.708 C116.768,21.06 117.568,19.936 118.224,18.336 L118.224,18.336 L123.84,4.8 L119.496,4.8 L116.28,12.744 L113.088,4.8 L108.408,4.8 L113.976,17.976 C113.784,18.36 113.548,18.64 113.268,18.816 C112.988,18.992 112.632,19.08 112.2,19.08 C111.832,19.08 111.468,19.012 111.108,18.876 C110.748,18.74 110.44,18.552 110.184,18.312 L110.184,18.312 L108.6,21.504 C109.032,21.856 109.596,22.14 110.292,22.356 C110.988,22.572 111.68,22.68 112.368,22.68 Z" id=Study fill-opacity=0.85 fill=#000000></path></g></g></g></svg><svg class="logo-dark hidden" width=125px height=23px viewBox="0 0 125 23" version=1.1 xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink><title>BTCStudy</title><g id=页面-1 stroke=none stroke-width=1 fill=none fill-rule=evenodd><g id=首页-响应式 transform="translate(-249.000000, -23.000000)" fill-rule=nonzero><g id=BTCStudy transform="translate(249.680000, 23.192000)"><path d="M9.072,17.808 C11.312,17.808 13.024,17.408 14.208,16.608 C15.392,15.808 15.984,14.672 15.984,13.2 C15.984,12.192 15.712,11.332 15.168,10.62 C14.624,9.908 13.872,9.384 12.912,9.048 C13.632,8.68 14.188,8.18 14.58,7.548 C14.972,6.916 15.168,6.2 15.168,5.4 C15.168,4.056 14.608,2.988 13.488,2.196 C12.368,1.404 10.736,1.008 8.592,1.008 L8.592,1.008 L-5.68434189e-14,1.008 L-5.68434189e-14,17.808 L9.072,17.808 Z M7.968,7.68 L4.704,7.68 L4.704,4.44 L7.968,4.44 C9.568,4.44 10.368,4.976 10.368,6.048 C10.368,7.136 9.568,7.68 7.968,7.68 L7.968,7.68 Z M8.688,14.376 L4.704,14.376 L4.704,10.968 L8.688,10.968 C10.352,10.968 11.184,11.536 11.184,12.672 C11.184,13.808 10.352,14.376 8.688,14.376 L8.688,14.376 Z M26.544,17.808 L26.544,4.776 L31.68,4.776 L31.68,1.008 L16.632,1.008 L16.632,4.776 L21.792,4.776 L21.792,17.808 L26.544,17.808 Z M41.592,18.144 C43.128,18.144 44.512,17.872 45.744,17.328 C46.976,16.784 48,16 48.816,14.976 L48.816,14.976 L45.792,12.24 C44.704,13.552 43.384,14.208 41.832,14.208 C40.92,14.208 40.108,14.008 39.396,13.608 C38.684,13.208 38.132,12.644 37.74,11.916 C37.348,11.188 37.152,10.352 37.152,9.408 C37.152,8.464 37.348,7.628 37.74,6.9 C38.132,6.172 38.684,5.608 39.396,5.208 C40.108,4.808 40.92,4.608 41.832,4.608 C43.384,4.608 44.704,5.264 45.792,6.576 L45.792,6.576 L48.816,3.84 C48,2.816 46.976,2.032 45.744,1.488 C44.512,0.944 43.128,0.672 41.592,0.672 C39.832,0.672 38.252,1.044 36.852,1.788 C35.452,2.532 34.352,3.568 33.552,4.896 C32.752,6.224 32.352,7.728 32.352,9.408 C32.352,11.088 32.752,12.592 33.552,13.92 C34.352,15.248 35.452,16.284 36.852,17.028 C38.252,17.772 39.832,18.144 41.592,18.144 Z" id=BTC fill=#F2A900></path><path d="M56.64,18.144 C58.24,18.144 59.6,17.9 60.72,17.412 C61.84,16.924 62.68,16.272 63.24,15.456 C63.8,14.64 64.08,13.728 64.08,12.72 C64.08,11.552 63.772,10.628 63.156,9.948 C62.54,9.268 61.812,8.772 60.972,8.46 C60.132,8.148 59.072,7.856 57.792,7.584 C56.656,7.344 55.832,7.112 55.32,6.888 C54.808,6.664 54.552,6.328 54.552,5.88 C54.552,5.432 54.768,5.068 55.2,4.788 C55.632,4.508 56.32,4.368 57.264,4.368 C58.768,4.368 60.32,4.8 61.92,5.664 L61.92,5.664 L63.384,2.136 C62.568,1.656 61.624,1.292 60.552,1.044 C59.48,0.796 58.392,0.672 57.288,0.672 C55.672,0.672 54.308,0.912 53.196,1.392 C52.084,1.872 51.248,2.524 50.688,3.348 C50.128,4.172 49.848,5.096 49.848,6.12 C49.848,7.288 50.152,8.216 50.76,8.904 C51.368,9.592 52.096,10.092 52.944,10.404 C53.792,10.716 54.848,11.008 56.112,11.28 C57.264,11.536 58.1,11.78 58.62,12.012 C59.14,12.244 59.4,12.6 59.4,13.08 C59.4,13.992 58.488,14.448 56.664,14.448 C55.704,14.448 54.728,14.296 53.736,13.992 C52.744,13.688 51.872,13.288 51.12,12.792 L51.12,12.792 L49.56,16.296 C50.36,16.856 51.4,17.304 52.68,17.64 C53.96,17.976 55.28,18.144 56.64,18.144 Z M71.856,18.024 C72.48,18.024 73.068,17.96 73.62,17.832 C74.172,17.704 74.64,17.52 75.024,17.28 L75.024,17.28 L73.896,14.088 C73.496,14.36 73.032,14.496 72.504,14.496 C72.088,14.496 71.756,14.364 71.508,14.1 C71.26,13.836 71.136,13.472 71.136,13.008 L71.136,13.008 L71.136,8.688 L74.112,8.688 L74.112,5.28 L71.136,5.28 L71.136,1.896 L66.576,1.896 L66.576,5.28 L64.68,5.28 L64.68,8.688 L66.576,8.688 L66.576,13.056 C66.576,14.704 67.032,15.944 67.944,16.776 C68.856,17.608 70.16,18.024 71.856,18.024 Z M82.248,18.024 C83,18.024 83.712,17.888 84.384,17.616 C85.056,17.344 85.632,16.944 86.112,16.416 L86.112,16.416 L86.112,17.808 L90.456,17.808 L90.456,4.8 L85.896,4.8 L85.896,11.064 C85.896,12.104 85.668,12.876 85.212,13.38 C84.756,13.884 84.168,14.136 83.448,14.136 C82.744,14.136 82.208,13.912 81.84,13.464 C81.472,13.016 81.288,12.304 81.288,11.328 L81.288,11.328 L81.288,4.8 L76.728,4.8 L76.728,12.072 C76.728,14.056 77.228,15.544 78.228,16.536 C79.228,17.528 80.568,18.024 82.248,18.024 Z M99.048,18.024 C100.744,18.024 102.016,17.52 102.864,16.512 L102.864,16.512 L102.864,17.808 L107.208,17.808 L107.208,0 L102.648,0 L102.648,5.928 C101.8,5.032 100.6,4.584 99.048,4.584 C97.864,4.584 96.784,4.856 95.808,5.4 C94.832,5.944 94.06,6.724 93.492,7.74 C92.924,8.756 92.64,9.936 92.64,11.28 C92.64,12.624 92.924,13.808 93.492,14.832 C94.06,15.856 94.832,16.644 95.808,17.196 C96.784,17.748 97.864,18.024 99.048,18.024 Z M100.008,14.4 C99.208,14.4 98.552,14.124 98.04,13.572 C97.528,13.02 97.272,12.256 97.272,11.28 C97.272,10.32 97.528,9.568 98.04,9.024 C98.552,8.48 99.208,8.208 100.008,8.208 C100.808,8.208 101.46,8.48 101.964,9.024 C102.468,9.568 102.72,10.32 102.72,11.28 C102.72,12.256 102.464,13.02 101.952,13.572 C101.44,14.124 100.792,14.4 100.008,14.4 Z M112.368,22.68 C113.728,22.68 114.88,22.356 115.824,21.708 C116.768,21.06 117.568,19.936 118.224,18.336 L118.224,18.336 L123.84,4.8 L119.496,4.8 L116.28,12.744 L113.088,4.8 L108.408,4.8 L113.976,17.976 C113.784,18.36 113.548,18.64 113.268,18.816 C112.988,18.992 112.632,19.08 112.2,19.08 C111.832,19.08 111.468,19.012 111.108,18.876 C110.748,18.74 110.44,18.552 110.184,18.312 L110.184,18.312 L108.6,21.504 C109.032,21.856 109.596,22.14 110.292,22.356 C110.988,22.572 111.68,22.68 112.368,22.68 Z" id=Study fill-opacity=0.85 fill=#FFFFFF></path></g></g></g></svg></a></h1></section><div class="is-flex is-flex-direction-column header-menu-wrap"><aside class="is-flex-shrink-0 is-flex is-flex-direction-row is-align-items-center" id=header-menu><a class="is-inline-block header-activity mr-4" href=/ >首页</a><a class="is-inline-block mr-4" href=/archives>全站目录</a><a class="is-inline-block mr-4" href=/tags>标签</a><a class="is-inline-block mr-4" href=/maps>地图</a><a class="is-inline-block mr-4" href=/tools>工具</a><a class="is-inline-block mr-4" target=_blank rel=noopener href=https://123btc.org/ >123btc</a><div class="right-content is-flex is-flex-direction-row is-align-items-center"><div class="size-wrap mr-1"><i class="iconfont icon-a-bianzu5" id=change-size-btn></i><div class=size-input-wrap><div class=input-wrap><input id=size-change-input type=range min=12 max=32 step=2></div></div></div><i class="iconfont icon-icon_dark mr-1" id=theme-btn></i><div class=search-wrap><input class=pl-3 id=search-input placeholder=请输入搜索关键词><i class="iconfont icon-icon_search" id=search-input-btn></i></div></div></aside><div class="header-title is-hidden-mobile is-full-height is-flex is-align-items-center is-flex-shrink-0"><div class="is-full-height hidden" id=postTopic><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">比特币隐私技术的不完全调查</p><div class="size-wrap mr-1"><i class="iconfont icon-a-bianzu5" id=change-size-btn2></i><div class=size-input-wrap><div class=input-wrap><input id=size-change-input2 type=range min=12 max=32 step=2></div></div></div></div></div></div></div></header><header class="is-flex header-widget is-flex-shrink-0 is-align-items-center is-justify-content-space-between is-hidden-tablet" id=mobile-header><div class="is-flex is-flex-direction-row is-align-items-center"><i class="iconfont icon-icon_bar mobile-header-menu"></i><div id=mobile-header-logo><svg class=logo-light width=125px height=23px viewBox="0 0 125 23" version=1.1 xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink><title>BTCStudy</title><g id=页面-1 stroke=none stroke-width=1 fill=none fill-rule=evenodd><g id=首页-响应式 transform="translate(-249.000000, -23.000000)" fill-rule=nonzero><g id=BTCStudy transform="translate(249.680000, 23.192000)"><path d="M9.072,17.808 C11.312,17.808 13.024,17.408 14.208,16.608 C15.392,15.808 15.984,14.672 15.984,13.2 C15.984,12.192 15.712,11.332 15.168,10.62 C14.624,9.908 13.872,9.384 12.912,9.048 C13.632,8.68 14.188,8.18 14.58,7.548 C14.972,6.916 15.168,6.2 15.168,5.4 C15.168,4.056 14.608,2.988 13.488,2.196 C12.368,1.404 10.736,1.008 8.592,1.008 L8.592,1.008 L-5.68434189e-14,1.008 L-5.68434189e-14,17.808 L9.072,17.808 Z M7.968,7.68 L4.704,7.68 L4.704,4.44 L7.968,4.44 C9.568,4.44 10.368,4.976 10.368,6.048 C10.368,7.136 9.568,7.68 7.968,7.68 L7.968,7.68 Z M8.688,14.376 L4.704,14.376 L4.704,10.968 L8.688,10.968 C10.352,10.968 11.184,11.536 11.184,12.672 C11.184,13.808 10.352,14.376 8.688,14.376 L8.688,14.376 Z M26.544,17.808 L26.544,4.776 L31.68,4.776 L31.68,1.008 L16.632,1.008 L16.632,4.776 L21.792,4.776 L21.792,17.808 L26.544,17.808 Z M41.592,18.144 C43.128,18.144 44.512,17.872 45.744,17.328 C46.976,16.784 48,16 48.816,14.976 L48.816,14.976 L45.792,12.24 C44.704,13.552 43.384,14.208 41.832,14.208 C40.92,14.208 40.108,14.008 39.396,13.608 C38.684,13.208 38.132,12.644 37.74,11.916 C37.348,11.188 37.152,10.352 37.152,9.408 C37.152,8.464 37.348,7.628 37.74,6.9 C38.132,6.172 38.684,5.608 39.396,5.208 C40.108,4.808 40.92,4.608 41.832,4.608 C43.384,4.608 44.704,5.264 45.792,6.576 L45.792,6.576 L48.816,3.84 C48,2.816 46.976,2.032 45.744,1.488 C44.512,0.944 43.128,0.672 41.592,0.672 C39.832,0.672 38.252,1.044 36.852,1.788 C35.452,2.532 34.352,3.568 33.552,4.896 C32.752,6.224 32.352,7.728 32.352,9.408 C32.352,11.088 32.752,12.592 33.552,13.92 C34.352,15.248 35.452,16.284 36.852,17.028 C38.252,17.772 39.832,18.144 41.592,18.144 Z" id=BTC fill=#F2A900></path><path d="M56.64,18.144 C58.24,18.144 59.6,17.9 60.72,17.412 C61.84,16.924 62.68,16.272 63.24,15.456 C63.8,14.64 64.08,13.728 64.08,12.72 C64.08,11.552 63.772,10.628 63.156,9.948 C62.54,9.268 61.812,8.772 60.972,8.46 C60.132,8.148 59.072,7.856 57.792,7.584 C56.656,7.344 55.832,7.112 55.32,6.888 C54.808,6.664 54.552,6.328 54.552,5.88 C54.552,5.432 54.768,5.068 55.2,4.788 C55.632,4.508 56.32,4.368 57.264,4.368 C58.768,4.368 60.32,4.8 61.92,5.664 L61.92,5.664 L63.384,2.136 C62.568,1.656 61.624,1.292 60.552,1.044 C59.48,0.796 58.392,0.672 57.288,0.672 C55.672,0.672 54.308,0.912 53.196,1.392 C52.084,1.872 51.248,2.524 50.688,3.348 C50.128,4.172 49.848,5.096 49.848,6.12 C49.848,7.288 50.152,8.216 50.76,8.904 C51.368,9.592 52.096,10.092 52.944,10.404 C53.792,10.716 54.848,11.008 56.112,11.28 C57.264,11.536 58.1,11.78 58.62,12.012 C59.14,12.244 59.4,12.6 59.4,13.08 C59.4,13.992 58.488,14.448 56.664,14.448 C55.704,14.448 54.728,14.296 53.736,13.992 C52.744,13.688 51.872,13.288 51.12,12.792 L51.12,12.792 L49.56,16.296 C50.36,16.856 51.4,17.304 52.68,17.64 C53.96,17.976 55.28,18.144 56.64,18.144 Z M71.856,18.024 C72.48,18.024 73.068,17.96 73.62,17.832 C74.172,17.704 74.64,17.52 75.024,17.28 L75.024,17.28 L73.896,14.088 C73.496,14.36 73.032,14.496 72.504,14.496 C72.088,14.496 71.756,14.364 71.508,14.1 C71.26,13.836 71.136,13.472 71.136,13.008 L71.136,13.008 L71.136,8.688 L74.112,8.688 L74.112,5.28 L71.136,5.28 L71.136,1.896 L66.576,1.896 L66.576,5.28 L64.68,5.28 L64.68,8.688 L66.576,8.688 L66.576,13.056 C66.576,14.704 67.032,15.944 67.944,16.776 C68.856,17.608 70.16,18.024 71.856,18.024 Z M82.248,18.024 C83,18.024 83.712,17.888 84.384,17.616 C85.056,17.344 85.632,16.944 86.112,16.416 L86.112,16.416 L86.112,17.808 L90.456,17.808 L90.456,4.8 L85.896,4.8 L85.896,11.064 C85.896,12.104 85.668,12.876 85.212,13.38 C84.756,13.884 84.168,14.136 83.448,14.136 C82.744,14.136 82.208,13.912 81.84,13.464 C81.472,13.016 81.288,12.304 81.288,11.328 L81.288,11.328 L81.288,4.8 L76.728,4.8 L76.728,12.072 C76.728,14.056 77.228,15.544 78.228,16.536 C79.228,17.528 80.568,18.024 82.248,18.024 Z M99.048,18.024 C100.744,18.024 102.016,17.52 102.864,16.512 L102.864,16.512 L102.864,17.808 L107.208,17.808 L107.208,0 L102.648,0 L102.648,5.928 C101.8,5.032 100.6,4.584 99.048,4.584 C97.864,4.584 96.784,4.856 95.808,5.4 C94.832,5.944 94.06,6.724 93.492,7.74 C92.924,8.756 92.64,9.936 92.64,11.28 C92.64,12.624 92.924,13.808 93.492,14.832 C94.06,15.856 94.832,16.644 95.808,17.196 C96.784,17.748 97.864,18.024 99.048,18.024 Z M100.008,14.4 C99.208,14.4 98.552,14.124 98.04,13.572 C97.528,13.02 97.272,12.256 97.272,11.28 C97.272,10.32 97.528,9.568 98.04,9.024 C98.552,8.48 99.208,8.208 100.008,8.208 C100.808,8.208 101.46,8.48 101.964,9.024 C102.468,9.568 102.72,10.32 102.72,11.28 C102.72,12.256 102.464,13.02 101.952,13.572 C101.44,14.124 100.792,14.4 100.008,14.4 Z M112.368,22.68 C113.728,22.68 114.88,22.356 115.824,21.708 C116.768,21.06 117.568,19.936 118.224,18.336 L118.224,18.336 L123.84,4.8 L119.496,4.8 L116.28,12.744 L113.088,4.8 L108.408,4.8 L113.976,17.976 C113.784,18.36 113.548,18.64 113.268,18.816 C112.988,18.992 112.632,19.08 112.2,19.08 C111.832,19.08 111.468,19.012 111.108,18.876 C110.748,18.74 110.44,18.552 110.184,18.312 L110.184,18.312 L108.6,21.504 C109.032,21.856 109.596,22.14 110.292,22.356 C110.988,22.572 111.68,22.68 112.368,22.68 Z" id=Study fill-opacity=0.85 fill=#000000></path></g></g></g></svg><svg class="logo-dark hidden" width=125px height=23px viewBox="0 0 125 23" version=1.1 xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink><title>BTCStudy</title><g id=页面-1 stroke=none stroke-width=1 fill=none fill-rule=evenodd><g id=首页-响应式 transform="translate(-249.000000, -23.000000)" fill-rule=nonzero><g id=BTCStudy transform="translate(249.680000, 23.192000)"><path d="M9.072,17.808 C11.312,17.808 13.024,17.408 14.208,16.608 C15.392,15.808 15.984,14.672 15.984,13.2 C15.984,12.192 15.712,11.332 15.168,10.62 C14.624,9.908 13.872,9.384 12.912,9.048 C13.632,8.68 14.188,8.18 14.58,7.548 C14.972,6.916 15.168,6.2 15.168,5.4 C15.168,4.056 14.608,2.988 13.488,2.196 C12.368,1.404 10.736,1.008 8.592,1.008 L8.592,1.008 L-5.68434189e-14,1.008 L-5.68434189e-14,17.808 L9.072,17.808 Z M7.968,7.68 L4.704,7.68 L4.704,4.44 L7.968,4.44 C9.568,4.44 10.368,4.976 10.368,6.048 C10.368,7.136 9.568,7.68 7.968,7.68 L7.968,7.68 Z M8.688,14.376 L4.704,14.376 L4.704,10.968 L8.688,10.968 C10.352,10.968 11.184,11.536 11.184,12.672 C11.184,13.808 10.352,14.376 8.688,14.376 L8.688,14.376 Z M26.544,17.808 L26.544,4.776 L31.68,4.776 L31.68,1.008 L16.632,1.008 L16.632,4.776 L21.792,4.776 L21.792,17.808 L26.544,17.808 Z M41.592,18.144 C43.128,18.144 44.512,17.872 45.744,17.328 C46.976,16.784 48,16 48.816,14.976 L48.816,14.976 L45.792,12.24 C44.704,13.552 43.384,14.208 41.832,14.208 C40.92,14.208 40.108,14.008 39.396,13.608 C38.684,13.208 38.132,12.644 37.74,11.916 C37.348,11.188 37.152,10.352 37.152,9.408 C37.152,8.464 37.348,7.628 37.74,6.9 C38.132,6.172 38.684,5.608 39.396,5.208 C40.108,4.808 40.92,4.608 41.832,4.608 C43.384,4.608 44.704,5.264 45.792,6.576 L45.792,6.576 L48.816,3.84 C48,2.816 46.976,2.032 45.744,1.488 C44.512,0.944 43.128,0.672 41.592,0.672 C39.832,0.672 38.252,1.044 36.852,1.788 C35.452,2.532 34.352,3.568 33.552,4.896 C32.752,6.224 32.352,7.728 32.352,9.408 C32.352,11.088 32.752,12.592 33.552,13.92 C34.352,15.248 35.452,16.284 36.852,17.028 C38.252,17.772 39.832,18.144 41.592,18.144 Z" id=BTC fill=#F2A900></path><path d="M56.64,18.144 C58.24,18.144 59.6,17.9 60.72,17.412 C61.84,16.924 62.68,16.272 63.24,15.456 C63.8,14.64 64.08,13.728 64.08,12.72 C64.08,11.552 63.772,10.628 63.156,9.948 C62.54,9.268 61.812,8.772 60.972,8.46 C60.132,8.148 59.072,7.856 57.792,7.584 C56.656,7.344 55.832,7.112 55.32,6.888 C54.808,6.664 54.552,6.328 54.552,5.88 C54.552,5.432 54.768,5.068 55.2,4.788 C55.632,4.508 56.32,4.368 57.264,4.368 C58.768,4.368 60.32,4.8 61.92,5.664 L61.92,5.664 L63.384,2.136 C62.568,1.656 61.624,1.292 60.552,1.044 C59.48,0.796 58.392,0.672 57.288,0.672 C55.672,0.672 54.308,0.912 53.196,1.392 C52.084,1.872 51.248,2.524 50.688,3.348 C50.128,4.172 49.848,5.096 49.848,6.12 C49.848,7.288 50.152,8.216 50.76,8.904 C51.368,9.592 52.096,10.092 52.944,10.404 C53.792,10.716 54.848,11.008 56.112,11.28 C57.264,11.536 58.1,11.78 58.62,12.012 C59.14,12.244 59.4,12.6 59.4,13.08 C59.4,13.992 58.488,14.448 56.664,14.448 C55.704,14.448 54.728,14.296 53.736,13.992 C52.744,13.688 51.872,13.288 51.12,12.792 L51.12,12.792 L49.56,16.296 C50.36,16.856 51.4,17.304 52.68,17.64 C53.96,17.976 55.28,18.144 56.64,18.144 Z M71.856,18.024 C72.48,18.024 73.068,17.96 73.62,17.832 C74.172,17.704 74.64,17.52 75.024,17.28 L75.024,17.28 L73.896,14.088 C73.496,14.36 73.032,14.496 72.504,14.496 C72.088,14.496 71.756,14.364 71.508,14.1 C71.26,13.836 71.136,13.472 71.136,13.008 L71.136,13.008 L71.136,8.688 L74.112,8.688 L74.112,5.28 L71.136,5.28 L71.136,1.896 L66.576,1.896 L66.576,5.28 L64.68,5.28 L64.68,8.688 L66.576,8.688 L66.576,13.056 C66.576,14.704 67.032,15.944 67.944,16.776 C68.856,17.608 70.16,18.024 71.856,18.024 Z M82.248,18.024 C83,18.024 83.712,17.888 84.384,17.616 C85.056,17.344 85.632,16.944 86.112,16.416 L86.112,16.416 L86.112,17.808 L90.456,17.808 L90.456,4.8 L85.896,4.8 L85.896,11.064 C85.896,12.104 85.668,12.876 85.212,13.38 C84.756,13.884 84.168,14.136 83.448,14.136 C82.744,14.136 82.208,13.912 81.84,13.464 C81.472,13.016 81.288,12.304 81.288,11.328 L81.288,11.328 L81.288,4.8 L76.728,4.8 L76.728,12.072 C76.728,14.056 77.228,15.544 78.228,16.536 C79.228,17.528 80.568,18.024 82.248,18.024 Z M99.048,18.024 C100.744,18.024 102.016,17.52 102.864,16.512 L102.864,16.512 L102.864,17.808 L107.208,17.808 L107.208,0 L102.648,0 L102.648,5.928 C101.8,5.032 100.6,4.584 99.048,4.584 C97.864,4.584 96.784,4.856 95.808,5.4 C94.832,5.944 94.06,6.724 93.492,7.74 C92.924,8.756 92.64,9.936 92.64,11.28 C92.64,12.624 92.924,13.808 93.492,14.832 C94.06,15.856 94.832,16.644 95.808,17.196 C96.784,17.748 97.864,18.024 99.048,18.024 Z M100.008,14.4 C99.208,14.4 98.552,14.124 98.04,13.572 C97.528,13.02 97.272,12.256 97.272,11.28 C97.272,10.32 97.528,9.568 98.04,9.024 C98.552,8.48 99.208,8.208 100.008,8.208 C100.808,8.208 101.46,8.48 101.964,9.024 C102.468,9.568 102.72,10.32 102.72,11.28 C102.72,12.256 102.464,13.02 101.952,13.572 C101.44,14.124 100.792,14.4 100.008,14.4 Z M112.368,22.68 C113.728,22.68 114.88,22.356 115.824,21.708 C116.768,21.06 117.568,19.936 118.224,18.336 L118.224,18.336 L123.84,4.8 L119.496,4.8 L116.28,12.744 L113.088,4.8 L108.408,4.8 L113.976,17.976 C113.784,18.36 113.548,18.64 113.268,18.816 C112.988,18.992 112.632,19.08 112.2,19.08 C111.832,19.08 111.468,19.012 111.108,18.876 C110.748,18.74 110.44,18.552 110.184,18.312 L110.184,18.312 L108.6,21.504 C109.032,21.856 109.596,22.14 110.292,22.356 C110.988,22.572 111.68,22.68 112.368,22.68 Z" id=Study fill-opacity=0.85 fill=#FFFFFF></path></g></g></g></svg></div><div class="mobile-header-title is-full-height is-flex is-align-items-center is-flex-shrink-0"><div class="is-full-height hidden" id=postTopicMobile><p class=is-full-height>比特币隐私技术的不完全调查</p></div></div></div><i class="iconfont icon-icon_search mobile-header-searchIcon"></i><div class=mobile-search-wrap><div class=search-input><input class=pl-3 id=mobile-search-input placeholder=请输入搜索关键词><i class="iconfont icon-icon_search mobile-search-input-btn"></i><button class=mobile-search-input-btn>搜 索</button></div></div></header><div class=mobile-slide-menu><a class=header-activity href=/ >首页</a><a href=/archives>全站目录</a><a href=/tags>标签</a><a href=/maps>地图</a><a href=/tools>工具</a><a target=_blank rel=noopener href=https://123btc.org/ >123btc</a><div><p class="slide-menu-theme is-flex is-flex-direction-row is-justify-content-space-between is-align-items-center"><span>主题设置</span><span><i class="iconfont icon-icon_light slide-theme-light hidden"></i><i class="iconfont icon-icon_dark slide-theme-dark hidden"></i></span></p><p class=slide-menu-fontsize><span>字体设置</span><span><i class="iconfont icon-bianzubeifen"></i><i class="iconfont icon-bianzu"></i></span></p></div></div><div class="search-mask hidden"><script src="/js/header.js?v=1682773100887"></script></div><main><main class="container is-max-widescreen content section post-page pt-4"><div class="columns is-flex-desktop is-justify-content-center"><div class="column is-3 silde-bar is-hidden-mobile"><ol class=toc><li class="toc-item toc-level-2"><a class=toc-link href=#%E6%8E%A5%E6%94%B6%E6%96%B9><span class=toc-text>接收方</span></a><ol class=toc-child><li class="toc-item toc-level-3"><a class=toc-link href=#%E5%88%86%E5%B1%82%E7%A1%AE%E5%AE%9A%E6%80%A7%E9%92%B1%E5%8C%85%EF%BC%88HDW%EF%BC%89><span class=toc-text>分层确定性钱包（HDW）</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E9%9A%90%E8%BA%AB%E5%9C%B0%E5%9D%80%EF%BC%88Stealth-Address%EF%BC%89><span class=toc-text>隐身地址（Stealth Address）</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E5%8F%AF%E9%87%8D%E5%A4%8D%E4%BD%BF%E7%94%A8%E7%9A%84%E4%BB%98%E6%AC%BE%E7%A0%81><span class=toc-text>可重复使用的付款码</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E6%8C%91%E9%80%89%E6%AC%BE%E9%A1%B9%EF%BC%88Coin-Control%EF%BC%89><span class=toc-text>挑选款项（Coin Control）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class=toc-link href=#%E5%8F%91%E9%80%81%E6%96%B9><span class=toc-text>发送方</span></a><ol class=toc-child><li class="toc-item toc-level-3"><a class=toc-link href=#%E4%B8%AD%E5%BF%83%E5%8C%96%E6%B7%B7%E5%B8%81%E6%9C%8D%E5%8A%A1%EF%BC%88Tumbler%EF%BC%89><span class=toc-text>中心化混币服务（Tumbler）</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#CoinJoin><span class=toc-text>CoinJoin</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#TumbleBit><span class=toc-text>TumbleBit</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E7%8E%AF%E7%AD%BE%E5%90%8D><span class=toc-text>环签名</span></a></li></ol></li><li class="toc-item toc-level-2"><a class=toc-link href=#%E4%BA%A4%E6%98%93%E9%A2%9D><span class=toc-text>交易额</span></a><ol class=toc-child><li class="toc-item toc-level-3"><a class=toc-link href=#%E5%9F%BA%E4%BA%8E%E8%BD%AE%E6%AC%A1%E7%9A%84%E5%AE%9A%E9%A2%9D%E6%B7%B7%E5%B8%81><span class=toc-text>基于轮次的定额混币</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E9%9D%9E%E7%AD%89%E9%A2%9D%E8%BE%93%E5%85%A5%E6%B7%B7%E5%B8%81><span class=toc-text>非等额输入混币</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E6%9C%BA%E5%AF%86%E4%BA%A4%E6%98%93><span class=toc-text>机密交易</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#Mimblewimble><span class=toc-text>Mimblewimble</span></a></li></ol></li><li class="toc-item toc-level-2"><a class=toc-link href=#%E4%BA%A4%E6%98%93%E9%80%BB%E8%BE%91><span class=toc-text>交易逻辑</span></a><ol class=toc-child><li class="toc-item toc-level-3"><a class=toc-link href=#P2SH><span class=toc-text>P2SH</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E9%BB%98%E5%85%8B%E5%B0%94%E5%88%86%E6%94%AF-MAST><span class=toc-text>默克尔分支 (MAST)</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#Schnorr-%E7%AD%BE%E5%90%8D><span class=toc-text>Schnorr 签名</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#Taproot><span class=toc-text>Taproot</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#Graftroot><span class=toc-text>Graftroot</span></a></li></ol></li></ol></div><div class="column is-9 post-container"><h1 class="mt-0 mb-2" id=postTitle>比特币隐私技术的不完全调查</h1><div class=page-author><div class="is-flex is-flex-direction-row page-data mr-6"><img class=mr-1 src=/images/default_avatar.png alt=Hongchao><div class=page-author-info><strong>Hongchao</strong><time class=has-text-grey datetime=2023-03-28T06:07:34.000Z>2023-03-28</time></div></div><div class=is-flex><a href=/tags/CoinJoin><i class="page-tag mr-1 px-1">CoinJoin</i></a><a href=/tags/%E9%9A%90%E7%A7%81%E6%80%A7><i class="page-tag mr-1 px-1">隐私性</i></a><a href=/tags/Taproot><i class="page-tag mr-1 px-1">Taproot</i></a></div></div><article class="mt-4 post-content"><blockquote><p><em>作者：Hongchao</em></p><p><em>来源：<a target=_blank rel=noopener href=https://hongchao.me/bitcoin-privacy/ >https://hongchao.me/bitcoin-privacy/</a></em></p></blockquote><p>本文首发于 2019 年 2 月 4 日</p><p><strong>太长不看</strong>：比特币生来就不具备匿名性。增强比特币的私密性是比特币领域最热门的研究方向之一。虽然一些提案已经（或即将）被纳入比特币的<a target=_blank rel=noopener href=https://github.com/bitcoin/bitcoin>参考实现</a>，但是其余提案不是变成了山寨币，就是被全盘放弃。本文根据各项技术尝试隐藏的信息，为它们分门别类并逐一探究：</p><ul><li>接收方：<a target=_blank rel=noopener href=https://github.com/bitcoin/bips/blob/master/bip-0032.mediawiki>HD Wallet</a>、<a target=_blank rel=noopener href=https://github.com/genjix/bips/blob/master/bip-stealth.mediawiki>Stealth Address</a>、<a target=_blank rel=noopener href=https://github.com/bitcoin/bips/blob/master/bip-0047.mediawiki>Resusable Payment Code</a>、<a target=_blank rel=noopener href=https://bitcoin.stackexchange.com/questions/37486/what-does-bitcoin-cores-coin-control-features-do-and-how-do-i-use-it>Coin Control</a> 等等</li><li>发送方：<a target=_blank rel=noopener href=https://en.bitcoin.it/wiki/Mixing_service>中心化混币服务</a>、<a target=_blank rel=noopener href="https://bitcointalk.org/index.php?topic=279249.0">CoinJoin</a> 及其变体、<a target=_blank rel=noopener href="https://bitcointalk.org/index.php?topic=567625.0">CoinShuffle</a>、<a target=_blank rel=noopener href=http://cs-people.bu.edu/heilman/tumblebit/ >TumbleBit</a>、<a target=_blank rel=noopener href=https://en.wikipedia.org/wiki/Ring_signature>Ring Signatures</a> 等等</li><li>交易数额：多轮定额混币、<a target=_blank rel=noopener href=https://github.com/nopara73/ZeroLink/issues/74>不定额输入混币</a>、<a target=_blank rel=noopener href=https://people.xiph.org/~greg/confidential_values.txt>机密交易</a>，<a target=_blank rel=noopener href=https://github.com/mimblewimble/docs/wiki/MimbleWimble-Origin>Minblewimble</a>，等等</li><li>交易逻辑：<a target=_blank rel=noopener href=https://en.bitcoin.it/wiki/Pay_to_script_hash>P2SH</a>、<a target=_blank rel=noopener href=https://www.mail-archive.com/bitcoin-dev@lists.linuxfoundation.org/msg05991.html>Merkle Branches</a> (MAST)、<a target=_blank rel=noopener href=https://en.wikipedia.org/wiki/Schnorr_signature>Schnorr 签名</a>、<a target=_blank rel=noopener href=https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2018-January/015614.html>Taproot</a>、<a target=_blank rel=noopener href=https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2018-February/015700.html>Graftroot</a> 等等</li></ul><p><a target=_blank rel=noopener href=https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2018-June/016071.html>Dandelion</a> 和<a target=_blank rel=noopener href=https://github.com/bitcoin/bips/blob/master/bip-0151.mediawiki>点对点加密</a>之类的网络层隐私技术不在本文的讨论范围内。另外，<a target=_blank rel=noopener href=https://en.wikipedia.org/wiki/Bitcoin_scalability_problem#%22Layer_2%22_systems>Layer 2</a> 系统为增强底层的隐私性带来了哪些好处，还有 <a target=_blank rel=noopener href=https://z.cash/ >ZCash</a> 之类的技术也不会涉及。</p><p><img src=/images/an-incomplete-survey-of-bitcoins-privacy-technologies/s-crowd.jpg alt=crowd-anonymous></p><p>比特币白皮书<a target=_blank rel=noopener href=https://nakamotoinstitute.org/bitcoin/#privacy>有一节专门讨论隐私性</a>，指出：</p><blockquote><p><em>传统的银行模型通过<strong>仅限</strong>相关方和受信第三方访问信息<strong>，</strong>实现<strong>了</strong>一定程度的隐私性。由于所有交易必须公开，这种方法无法采用，但还是能够通过在其它地方中断信息流保护隐私性：保持公钥匿名。</em></p></blockquote><p>显然，比特币这么多年来从未达到人们所期望的隐私性。比特币交易包含 4 个敏感信息：发送方、接收方、交易数量和交易逻辑（写在<a target=_blank rel=noopener href=https://en.bitcoin.it/wiki/Script>比特币脚本</a>中）。上述信息全都广播至比特币网络并永远存储在区块链上，因为<a target=_blank rel=noopener href=https://twitter.com/francispouliot_/status/1075414899235409920>验证一笔交易是否存在的唯一方式就是知道所有交易</a>。在保护力度不强的情况下，记录一个交易的所有信息是否是知道这个交易的唯一（甚至是最佳）方法？这个问题尚存在争议。但是，由于所有交易在比特币区块链上都是透明的，假设 Alice 的真实身份因为某种方式与某个比特币地址绑定，那么涉及该地址的所有已发生和未发生交易都会失去隐私性。</p><p>在比特币系统中，大多数隐私技术都是为了混淆写入比特币区块链的一个或多个敏感交易信息。每个技术都做出了不同的取舍。评估这些技术时，你可以从以下几个方面进行考量：</p><ul><li>去中心化，意味着安全性源于公开验证，后者往往与隐私性相悖。幸运的是，这种表面上的冲突并不一定是真实的，但是评估一项隐私增强技术是否会牺牲中心化依然很重要。</li><li>隐私性和可扩展性并不总能很好地结合在一起。很多隐私技术需要较多计算资源，在区块链领域会被显著放大，进而影响其可扩展性。还有一些隐私技术破坏了“<a target=_blank rel=noopener href=https://coinguides.org/bitcoin-blockchain-pruning/ >剪枝（pruning）</a>”，导致用于验证新交易的数据库加速膨胀。幸好实际情况并非总是如此。</li><li>隐私技术会增加计算量和验证时间或导致用户之间的交互变得更为复杂，从而影响用户体验。无论一项隐私技术从理论上来说有多完美，如果用户体验差到没人愿意使用它，就根本无法产生任何现实价值。</li></ul><p>接下来本文将分为四个部分：<strong>接收方</strong>、<strong>发送方</strong>、<strong>账户</strong>和<strong>交易逻辑，</strong>分别讨论相关的隐私技术。</p><h2 id=接收方><a href=#接收方 class=headerlink title=接收方></a>接收方</h2><h3 id=分层确定性钱包（HDW）><a href=#分层确定性钱包（HDW） class=headerlink title=分层确定性钱包（HDW）></a>分层确定性钱包（HDW）</h3><p>假设 Alice 一直使用同一个比特币地址，且该地址因为某种方式与她的现实身份绑定，Alice 在比特币网络上的全部交易历史都将被公开。缓解该问题的方法之一是为每笔收款生成一个新的收款地址。如果 Alice 使用的是 <a target=_blank rel=noopener href=https://github.com/bitcoin/bips/blob/master/bip-0032.mediawiki>HDW</a>，实现该操作不仅易如反掌，而且会带来很高的安全性。这样一来，攻击者必须找出与 Alice 的身份相关联的所有地址，才能拼凑出 Alice 的交易历史。要做到这点<a target=_blank rel=noopener href=https://cseweb.ucsd.edu/~smeiklejohn/files/imc13.pdf>并非完全不可能</a>，但是难上加难。事实上，就比特币而言，使用新地址（包括找零地址）接收付款是<a target=_blank rel=noopener href=https://bitcoin.org/en/protect-your-privacy#receive>最佳做法</a>。</p><h3 id=隐身地址（Stealth-Address）><a href=#隐身地址（Stealth-Address） class=headerlink title="隐身地址（Stealth Address）"></a>隐身地址（Stealth Address）</h3><p>在电视或广告牌广告之类的场景中，生成一个新的收款地址并不可行，<a target=_blank rel=noopener href=https://github.com/genjix/bips/blob/master/bip-stealth.mediawiki>隐身地址</a>可能是一种解决方案。隐身地址的思路是在 Alice 公布其公钥后，想要向 Alice 付款的人需要获得该信息，生成并“支付给”一个新的公钥，而这个公钥的对应私钥只能由 Alice 生成。我们可以利用 <a target=_blank rel=noopener href=https://en.wikipedia.org/wiki/Elliptic-curve_Diffie%E2%80%93Hellman>ECDH</a> 协议来实现隐身地址。</p><p>假设 Alice 的密钥对是 <strong>A&#x3D;aG</strong>，其中 <strong>G</strong> 是一条<a target=_blank rel=noopener href=https://en.wikipedia.org/wiki/Elliptic-curve_cryptography>椭圆曲线</a>上的基点，Bob 首先需要生成一个临时密钥对 <strong>B&#x3D;bG</strong>。通过 <a target=_blank rel=noopener href=https://en.wikipedia.org/wiki/Elliptic-curve_Diffie%E2%80%93Hellman>ECDH</a> 协议，Alice 和 Bob 之间共享的秘密值是 <strong>secret&#x3D;bA&#x3D;aB&#x3D;abG</strong>。然后，Bob 付款至根据 <strong>A+H(secret)G</strong> 生成的新地址，其中 <strong>H</strong> 是一个密码哈希函数。由于只有 Alice 知道 <strong>a+H(secret)</strong>，只有她能够花费新地址上的资金。</p><p>实际上，正如比特币开发者 Peter Todd <a target=_blank rel=noopener href=https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2014-January/004020.html>所言</a>，Bob 需要通过额外创建一笔带有 <strong>OP_RETURN</strong> 输出的交易，将临时公钥 B 告知 Alice，以便 Alice 获得共享秘密值。但是，<a target=_blank rel=noopener href=https://www.reddit.com/r/Bitcoin/comments/5xm9bt/what_happened_to_stealth_addresses/dejcjmw>Peter 随后又表示</a>，由于 <strong>OP_RETURN</strong> 最后被改成仅能容纳 40 字节的数据，提出隐身地址的 BIP（BIP 63）未能发布。总的来说，隐身地址在比特币生态中采用率不高。<a target=_blank rel=noopener href=https://www.darkwallet.is/ >DarkWallet</a> 似乎支持<a target=_blank rel=noopener href=https://github.com/darkwallet/darkwallet/blob/4c51dacacb8541305f1442ef7fa1628eb7c19a79/src/js/util/stealth.js>隐身地址</a>，但是该项目很少有人维护了。另外，<a target=_blank rel=noopener href=https://www.getmonero.org/ >Monero</a> 和 <a target=_blank rel=noopener href=https://www.tokenpay.com/ >TokenPay</a> 引入了一个<a target=_blank rel=noopener href=https://src.getmonero.org/resources/moneropedia/stealthaddress.html>更加有趣的隐身地址版本</a>，利用<a target=_blank rel=noopener href=https://medium.com/tokenpay/tokenpay-utilizes-dual-key-stealth-addresses-for-complete-anonymity-c5ae682ce879>双密钥隐身地址协议</a>将查看密钥和花费密钥分离。这可以用来让第三方查看交易历史，同时又不让他们有能力花费资金。</p><h3 id=可重复使用的付款码><a href=#可重复使用的付款码 class=headerlink title=可重复使用的付款码></a>可重复使用的付款码</h3><p><a target=_blank rel=noopener href=https://github.com/bitcoin/bips/blob/master/bip-0047.mediawiki>可重复使用的付款码</a>协议试图将 <a target=_blank rel=noopener href=https://en.wikipedia.org/wiki/Elliptic-curve_Diffie%E2%80%93Hellman>ECDH</a> 协议和<a target=_blank rel=noopener href=https://github.com/bitcoin/bips/blob/master/bip-0032.mediawiki>分层确定性钱包</a>结合起来，达到与隐身地址相同的效果。</p><p>假如 Alice 和 Bob 想要进行私密交易却又不想一直向对方发送新地址，他们可以生成一个可重复使用的付款码，实际上就是<a target=_blank rel=noopener href=https://github.com/bitcoin/bips/blob/master/bip-0032.mediawiki>分层确定性钱包</a>的<a target=_blank rel=noopener href=https://bitcoin.org/en/glossary/extended-key>扩展公钥</a>。Alice 先通过通知交易（notification transaction）将她的付款码告知 Bob，然后 Alice 和 Bob 就可以共享由 <a target=_blank rel=noopener href=https://en.wikipedia.org/wiki/Elliptic-curve_Diffie%E2%80%93Hellman>ECDH</a> 协议生成的秘密值、并用在隐身地址中。</p><p>有了这个共享秘密值和彼此的可重复使用付款码，Alice 和 Bob 就可以各自生成一个新的分层确定性钱包，只有自己能花费其中的资金，但是可以为对方生成新的地址。这本质上就是在二人之间创建了一个秘密付款通道。</p><p><a target=_blank rel=noopener href=https://samouraiwallet.com/ >Samourai</a> 就是<a target=_blank rel=noopener href=https://samouraiwallet.com/bips>支持</a>可重复使用的付款码的钱包之一。</p><h3 id=挑选款项（Coin-Control）><a href=#挑选款项（Coin-Control） class=headerlink title="挑选款项（Coin Control）"></a>挑选款项（Coin Control）</h3><p>如果同一个交易花费了两个输出，这两个输出通常为同一个人所有（除非是 <a target=_blank rel=noopener href="https://bitcointalk.org/index.php?topic=279249.0">CoinJoin</a> 之类的交易）。如果恰好其中一个输出被污染了，人们会认为另一个输出也被污染了。通过 <a target=_blank rel=noopener href=https://bitcoin.stackexchange.com/questions/37486/what-does-bitcoin-cores-coin-control-features-do-and-how-do-i-use-it>Coin Control</a> 功能，用户可以选择使用哪个输出组合来创建交易，这会降低输出被意外污染的可能性。</p><p>很多钱包都支持 Coin Control 功能，包括 <a target=_blank rel=noopener href=https://github.com/bitcoin/bitcoin/tree/master/src/wallet>Bitcoin Core 钱包</a>。</p><h2 id=发送方><a href=#发送方 class=headerlink title=发送方></a>发送方</h2><p>为了混淆交易发送方，通常的想法是将真正的发送方隐藏在其他发送方或诱饵之中，让攻击者难以辨识真正的发送方。</p><p>比特币的一大重要洞见是，交易中的输入和输出是相互独立的，而且没有迹象表明输入和输出之间存在联系。因此，如果多个用户使用各自的输入和输出共同创建一笔交易，他们的资金实际上是混合在一起的。</p><p><img src=/../images/an-incomplete-survey-of-bitcoins-privacy-technologies/oinjoin.png alt=coinjoin></p><p style=text-align:center>- 图源：https://bitcointalk.org/index.php?topic=279249.0 -</p><p>如上图所示，我们很难知道交易 2 的第一个输出是由第二个输入还是第一个和第三个输入合并支付的。</p><h3 id=中心化混币服务（Tumbler）><a href=#中心化混币服务（Tumbler） class=headerlink title=中心化混币服务（Tumbler）></a>中心化混币服务（Tumbler）</h3><p>一种方法是利用<a target=_blank rel=noopener href=https://en.bitcoin.it/wiki/Mixing_service>中心化混币服务</a>从用户那里获得资金，然后将它们与其他用户的资金 和&#x2F;或 混币服务提供商自己的资金混合起来。如果是善意的混币服务提供商，等量资金（减去服务费）将通过新地址发送给用户。这个想法非常简单，但是其中心化特性意味着中心化混币服务面临着与银行和中心化交易所同样的问题。中心化混币服务有可能窃取用户资金，还有可能保留追踪资金来源的能力。在部分司法辖区，混合大额资金<a target=_blank rel=noopener href=https://en.wikipedia.org/wiki/Cryptocurrency_tumbler#Background>可能是非法行为</a>，而背后的中心化实体可能会面临更大的监管风险。</p><p>即使中心化混币服务值得信赖，也会有很多缺陷。一个例子是，如果待混合的所有<a target=_blank rel=noopener href=https://en.bitcoin.it/wiki/Transaction#Output>交易输出</a>的面额不等，泄露发送方身份的线索就会再多上一条。因此，最好将符合标准输入大小的交易混合，也就是说大额资金可能需要经历多轮混合，用户体验极差（公平地说，这个问题并非只有中心化混币服务才有。如果没有采取机密交易（<a target=_blank rel=noopener href=https://people.xiph.org/~greg/confidential_values.txt>Confidential Transactions</a>）之类的措施来隐藏交易额，去中心化混币服务也会面临这样的问题。）《比特币和区块链技术（<a target=_blank rel=noopener href=https://d28rh4a8wq0iu5.cloudfront.net/bitcointech/readings/princeton_bitcoin_book.pdf>Bitcoin and Blockchain Technologies</a>）》的第 6.3 节《混币》详细讨论了中心化混币服务的其它一些潜在实现问题，以及如何为用户提供更优质服务的指导，例如，多轮混币。</p><p>尽管如此，<a target=_blank rel=noopener href=https://bestmixer.io/en>bestmixer.io</a> 等中心化混币服务对于某些威胁模型和风险状况的人来说依然有用。<a target=_blank rel=noopener href=https://medium.com/@nopara73/traditional-bitcoin-mixers-6a092e59d8c2>大多数决定混币的用户</a>还是会选择中心化混币服务。</p><h3 id=CoinJoin><a href=#CoinJoin class=headerlink title=CoinJoin></a>CoinJoin</h3><p><a target=_blank rel=noopener href="https://bitcointalk.org/index.php?topic=279249.0">CoinJoin</a> 由比特币开发者 <a target=_blank rel=noopener href=https://github.com/gmaxwell>Greg Maxwell</a> 于 2013 年提议，能够消除第三方盗窃风险。</p><p>若要创建一个 CoinJoin 交易，一组用户需要通过某种方式找到彼此，可能会借助于一个中心化发现服务。然后，用户开始互相交换输入和输出。一旦所有输入和输出收集完毕，任何用户都可以使用它们构建未签名版本的交易并发送给所有用户签名。一旦交易经过所有用户的验证和签署，就会在全网广播。</p><p>与中心化混币一样，重点还是在于确保所有输出面额相同。CoinJoin 的缺点之一是需要大量用户交互，这不仅会损害可用性，还容易遭受<a target=_blank rel=noopener href=https://en.wikipedia.org/wiki/Sybil_attack>女巫攻击</a>。例如，攻击者可能会潜入用户群，尝试洞悉输入和输出之间的关联。即使输入和输出是基于匿名通信协议（如 <a target=_blank rel=noopener href=https://www.torproject.org/ >Tor</a>）进行交换的，如果攻击者还控制了用户群中的其他“用户”，他们依然可以缩小匿名集。还有可能发生 <a target=_blank rel=noopener href=https://en.wikipedia.org/wiki/DOS>DoS</a> 攻击，例如，攻击者重复花费 CoinJoin 交易中的任意输入（需要先移除恶意方再重试）或在最后关头拒绝签名（或许能够通过<a target=_blank rel=noopener href=https://en.bitcoin.it/wiki/CoinJoin#What_about_DOS_attacks.3F_Can.27t_someone_refuse_to_sign_even_if_the_transaction_is_valid.3F>类似 PoW 的方案</a>解决）。</p><p><a target=_blank rel=noopener href=https://github.com/nopara73/ZeroLink/#ii-chaumian-coinjoin>Chaumian CoinJoin</a> 是 CoinJoin 的变体。该方案在原有的 CoinJoin 上进行优化，利用<a target=_blank rel=noopener href=https://en.wikipedia.org/wiki/Blind_signature>盲签名</a>确保即使是中心化服务（如 <a target=_blank rel=noopener href=https://wasabiwallet.io/ >Wasabi Wallet</a> 的<a target=_blank rel=noopener href=https://www.reddit.com/r/Bitcoin/comments/afjf9u/wasabi_wallet_what_is_the_coordinator/ >协调服务</a>）也无法知晓输入和输出之间的联系。</p><p>为了解决 CoinJoin 的匿名性问题，<a target=_blank rel=noopener href="https://bitcointalk.org/index.php?topic=567625.0">CoinShuffle</a> 在参与者之间运行了一个巧妙的去中心化协议。假设 Alice、Bob 和 Charlie 要执行 CoinJoin 交易，他们新生成的密钥对分别是 <strong>PubA</strong>&#x2F;<strong>PrivA</strong>、<strong>PubB</strong>&#x2F;<strong>PrivB</strong> 和 <strong>PubC</strong>&#x2F;<strong>PrivC</strong>。以下是 CoinShuffle 的运行方式。</p><ul><li><p>随机选择将 <strong>PubA</strong>、<strong>PubB</strong> 和 <strong>PubC</strong> 告诉 Alice，将 <strong>PubB</strong> 和 <strong>PubC</strong> 告诉 Bob，只将 <strong>PubB</strong> 告诉 Charlie。</p></li><li><p>Alice 使用 <strong>PubC</strong> 将她的输出地址加密，再使用 <strong>PubB</strong> 将此加密消息加密。Alice 将双重加密后的消息发送给 Bob。</p></li><li><p>Bob 从 Alice 那里收到双重加密后的消息，使用 <strong>PrivB</strong> 进行解密。然后，Bob 使用 <strong>PubC</strong> 将他自己的输出地址加密，再将两个加密消息发送给 Charlie。</p></li><li><p>Charlie 收到两个加密消息后，使用 <strong>PrivC</strong> 解密，得到 Alice 和 Bob 的输出地址。然后，Charlie 使用这两个地址连同他自己的输出地址一起构建 CoinJoin 交易。</p></li></ul><p>这个类似 <a target=_blank rel=noopener href=https://www.torproject.org/ >Tor</a> 的洋葱结构能够确保没有参与方知道输出的所有权。<a target=_blank rel=noopener href=https://github.com/DanielKrawisz/Shufflepuff>Shufflepuff</a> 尝试在 <a target=_blank rel=noopener href=https://wallet.mycelium.com/ >Mycelium</a> 钱包中实现 CoinShuffle，但是这个项目似乎很少有人维护了。</p><p>总的来说，CoinJoin 在比特币生态中还没有得到广泛应用。<a target=_blank rel=noopener href=https://github.com/JoinMarket-Org/joinmarket-clientserver>JoinMarket</a> 尝试引入经济激励来解决这一问题，但是效果不佳。比特币开发者 <a target=_blank rel=noopener href="https://twitter.com/jimmysong?lang=en">Jimmy Song</a> 最近录了一段视频呼吁<a target=_blank rel=noopener href="https://www.youtube.com/watch?v=-G3b3NPGWRE">简单易用的 CoinJoin</a>，或许在易用性方面取得突破是重中之重。</p><h3 id=TumbleBit><a href=#TumbleBit class=headerlink title=TumbleBit></a>TumbleBit</h3><p>相比将资金在单笔交易中混合的 CoinJoin，<a target=_blank rel=noopener href=http://cs-people.bu.edu/heilman/tumblebit/ >TumbleBit</a> 通过中心化支付中心在付款方和收款方之间创建了互联<a target=_blank rel=noopener href=https://en.bitcoin.it/wiki/Payment_channels>支付通道</a>。支付通道可以通过<a target=_blank rel=noopener href=https://en.bitcoin.it/wiki/Hashed_Timelock_Contracts>哈希时间锁合约</a>进行连接，以确保支付中心无法窃取资金。</p><p>另外，TumbleBit 还使用了受<a target=_blank rel=noopener href=https://en.wikipedia.org/wiki/Blind_signature>盲签名</a>启发而来的<a target=_blank rel=noopener href=https://hackernoon.com/understanding-tumblebit-part-3-not-even-the-tumbler-can-breach-your-privacy-how-8d49d89e3a0d>盲难题技术</a>（blinded puzzle technique），确保支付中心无法发现付款方和收款方之间的关联。</p><p>TumbleBit 目前已整合到 <a target=_blank rel=noopener href=https://stratisplatform.com/ >Stratis</a> 的 <a target=_blank rel=noopener href=https://github.com/stratisproject/Breeze>Breeze wallet</a> 内。</p><h3 id=环签名><a href=#环签名 class=headerlink title=环签名></a>环签名</h3><p>同样值得一提的还有环签名，尽管它从未被比特币之类的项目采用。环签名是一个有趣的签名方案，可用于实现无需用户交互的去中心化混币服务。</p><p>验证一个环签名是否由某个群体中的成员生成非常容易，但是无法通过计算来确定生成者的具体身份。基于 <a target=_blank rel=noopener href=https://cryptonote.org/coins>CryptoNotes</a> 的密码学货币（如，<a target=_blank rel=noopener href=https://ww.getmonero.org/ >Monero</a>）就利用了这一特性来隐藏交易发送方的身份。构建一笔交易时，Monero 会从区块链上<a target=_blank rel=noopener href="https://www.youtube.com/watch?v=Sn44ahKxC1E">随机选择</a> <a target=_blank rel=noopener href=https://github.com/wownero/meta/issues/11>10</a> 个已花费输出充当诱饵，与真正的输出放在一起。然后，Monero 会：</p><ul><li><p>根据真正的输出生成一个<a target=_blank rel=noopener href=https://monerodocs.org/cryptography/asymmetric/key-image/ >密钥镜像</a></p></li><li><p>根据整个输出集合生成一个环签名</p></li></ul><p><a target=_blank rel=noopener href=https://monerodocs.org/cryptography/asymmetric/key-image/ >密钥镜像</a>对于输出来说具有唯一性，即使同一个输出混合到不同的诱饵集合中，其密钥镜像也不会发生变化。Monero 区块链追踪所有已花费输出的密钥镜像来避免双重花费问题，从而破坏了剪枝节点模式<a target=_blank rel=noopener href=https://coinguides.org/bitcoin-blockchain-pruning/ >（pruning）</a>。有效的环签名意味着对应的输出集合中有一个输出被授权花费，但不会揭露具体是哪个输出。</p><p>发送方保护被认为是 Monero 的隐私方案中最薄弱之处，因为已知环签名存在一些问题，如 <a target=_blank rel=noopener href="https://www.youtube.com/watch?v=1CfXHC2IFx4">0 诱饵和连锁反应</a>、<a target=_blank rel=noopener href="https://www.youtube.com/watch?v=6CVcirD90pg">硬分叉</a>期间有隐私泄露风险等等。在<a target=_blank rel=noopener href="https://www.youtube.com/watch?v=Sn44ahKxC1E&t=1s">诱饵选择</a>上，经常会变成一场猫鼠游戏，因为很难预想到所有可能性。尽管如此，环签名依然被认为是提供最强发送方保护的技术之一。</p><h2 id=交易额><a href=#交易额 class=headerlink title=交易额></a>交易额</h2><p>交易额本身就是非常敏感的信息，还会影响 CoinJoin 和中心化混币服务等交易图混淆机制的效果。一般来说，我们会采用两种方法来隐藏交易额，要么将交易切分成多个较小的等额交易，要么使用只有参与方知道的密码学方法将交易额隐藏起来，但是要保证其他人都能验证交易过程中是否存在货币增发问题。</p><h3 id=基于轮次的定额混币><a href=#基于轮次的定额混币 class=headerlink title=基于轮次的定额混币></a>基于轮次的定额混币</h3><p>通过在一组标准切分额上达成共识，混币服务能够扩大待上链交易的匿名集规模。只要在切分额上达成共识，就能同时使用多个混币服务。此方法的缺点在于大额混币耗时较长。例如，假设一个混币服务的固定切分额为 0.1、0.5 和 1 BTC，8.6 BTC 至少需要经过 10 轮混币。另外，金额过低的款项必须先与其它款项合并，才能参与混币。</p><h3 id=非等额输入混币><a href=#非等额输入混币 class=headerlink title=非等额输入混币></a>非等额输入混币</h3><p>如果支持非等额输入参与混币会怎么样？能否通过保障<a target=_blank rel=noopener href=https://bitcoin.stackexchange.com/questions/73431/mixing-unequal-inputs>最优</a>匿名性的方法对输出进行切分？如果存在这种算法，即使未达到最低切分额的代币也无需与其它代币合并。大额代币也可以匹配在一起，大幅提高混币速度。<a target=_blank rel=noopener href=https://github.com/nopara73/ZeroLink/issues/74>非等额输入混币</a>试图解决该问题，但仍需要<a target=_blank rel=noopener href=https://gist.github.com/nothingmuch/544cdd47dd18ef8fe923b54e0d5ee141>更多研究</a>。尽管如此，在不久的将来，一个基础版的非等额输入混币方案可能会<a target=_blank rel=noopener href=https://medium.com/@nopara73/upcoming-wasabi-wallet-hard-fork-609f271d9c41>登陆</a> <a target=_blank rel=noopener href=https://wasabiwallet.io/ >Wasabi 钱包</a>。</p><h3 id=机密交易><a href=#机密交易 class=headerlink title=机密交易></a>机密交易</h3><p>由 <a target=_blank rel=noopener href=https://en.wikipedia.org/wiki/Adam_Back>Adam Back</a> 提出<a target=_blank rel=noopener href="https://bitcointalk.org/index.php?topic=305791.0">构想</a>并由 <a target=_blank rel=noopener href=https://github.com/gmaxwell>Gregory Maxwell</a> <a target=_blank rel=noopener href=https://people.xiph.org/~greg/confidential_values.txt>改进</a>的机密交易 <a target=_blank rel=noopener href=https://people.xiph.org/~greg/confidential_values.txt>Confidential Transactions</a> 能够在向区块链隐藏交易额的同时，确保人们可以验证所有交易是否平衡，以及是否存在蓄意的货币增发行为。</p><p>在类似比特币的系统中实现机密交易离不开一些密码学构造。</p><p>首先，机密交易使用了一个叫作<a target=_blank rel=noopener href=https://link.springer.com/chapter/10.1007/3-540-46766-1_9>佩德森承诺（pederson commitment）</a>的<a target=_blank rel=noopener href=https://en.wikipedia.org/wiki/Commitment_scheme>承诺方案</a>来隐藏交易额。佩德森承诺是一个密码学原语，既能让用户“<em>在对其他人保密的情况下对所选值做出承诺，且有能力揭示所选值</em>”，还保留了加法和交换律，得以应用于类似账本的系统：</p><p>假设 <strong>G</strong> 和 <strong>H</strong> 是两条<a target=_blank rel=noopener href=https://en.wikipedia.org/wiki/Elliptic-curve_cryptography>椭圆曲线</a>上的<a target=_blank rel=noopener href=https://bitcoin.stackexchange.com/questions/29904/what-exactly-is-generator-g-in-bitcoins-elliptical-curve-algorithm>生成点</a>，<strong>v</strong> 是交易额<strong>，r</strong> 是一个随机数。然后 <code>r*G + v*H</code> 是交易额 <strong>v</strong> 的佩德森承诺。<strong>r</strong> 被称为结合因子，本质上是一个大随机数。假设 <em>v &#x3D; v1 + v2</em>，且 <strong>v1</strong> 和 <strong>v2</strong> 对应的佩德森承诺分别是</p><pre><code>r1 * G + v1 * H
r2 * G + v2 * H
</code></pre><p>只要 <em>r &#x3D; r1 + r2</em>，则 <strong>v</strong> 的佩德森承诺减去 <strong>v1</strong> 和 <strong>v2</strong> 的佩德森承诺之和为 0。</p><pre><code>(r * G + v * H) - (r1 * G + v1 * H + r2 * G + v2 * H) == 0
</code></pre><p>因此，从算术的角度来看，交易额的佩德森承诺可以用来代替类似比特币的系统中的交易额。事实上，<a target=_blank rel=noopener href=https://elementsproject.org/features/confidential-transactions>Element</a> 项目正是这么做的。</p><p>这种做法虽然可行，却有个例外情况，即，如果 <strong>v1</strong> 是负数<strong>，v2</strong> 会大于 <strong>v</strong>，这意味着存在代币增发现象。范围证明（range proof）通过证明交易额位于一定范围内解决了该问题。在最初的机密交易文章中，范围证明是为了利用<a target=_blank rel=noopener href="https://bitcointalk.org/index.php?topic=1077994.0">波罗米恩环签名</a>（<a target=_blank rel=noopener href="https://bitcointalk.org/index.php?topic=1077994.0">Borromean ring signature</a>）而设计的。后来，有人提议通过 <a target=_blank rel=noopener href=https://eprint.iacr.org/2017/1066.pdf>Bulletproof</a> 以更高效的方式执行范围证明。</p><p>最后需要解决的问题是，如果</p><pre><code>r1 * G + v1 * H
</code></pre><p>是一个交易输出额，接收方如何知晓交易额 <strong>v1</strong> 和结合因子 <strong>r1</strong>？在 <a target=_blank rel=noopener href=https://elementsproject.org/features/confidential-transactions>Element</a> 中，这是通过经典的 <a target=_blank rel=noopener href=https://en.wikipedia.org/wiki/Elliptic-curve_Diffie%E2%80%93Hellman>ECDH</a> 密钥交换来实现的。在 <a target=_blank rel=noopener href=https://elementsproject.org/features/confidential-transactions>Element</a> 中，交易的输出额实际上包含的不仅是佩德森承诺，还有来自发送方的范围证明和 <a target=_blank rel=noopener href=https://en.wikipedia.org/wiki/Elliptic-curve_Diffie%E2%80%93Hellman>ECDH</a> 临时公钥。有了这些，接收方能够与发送方生成共享密钥，用于揭露 <strong>v1</strong> 和 <strong>r1</strong>。如果你想了解更多详情，可以查看 <a target=_blank rel=noopener href="https://twitter.com/pwuille?lang=en">Pieter Wuille</a> 的<a target=_blank rel=noopener href=https://bitcoin.stackexchange.com/questions/48064/sending-confidential-transaction-amount-to-the-receiver>文章</a>。</p><p>自 2017 年 1 月以来，门罗实现了环机密交易（<a target=_blank rel=noopener href=https://src.getmonero.org/resources/moneropedia/ringCT.html>Ring Confidential Transaction</a>, RingCT）。在此之前，同一个环的成员必须确保输出额相等。在机密交易中，不仅交易额是隐藏的，可以被用作诱饵的潜在输出数量也会多得多。</p><h3 id=Mimblewimble><a href=#Mimblewimble class=headerlink title=Mimblewimble></a>Mimblewimble</h3><p><a target=_blank rel=noopener href=https://github.com/mimblewimble/docs/wiki/MimbleWimble-Origin>Mimblewimble</a> 同样<a target=_blank rel=noopener href=https://src.getmonero.org/resources/moneropedia/ringCT.html>使用机密交易</a>，以求无需公开交易数额就能证明交易是平衡的。但是，相比比特币等需要由独立私钥直接签署的签名来证明输出所有权的系统，Mimblewimble <a target=_blank rel=noopener href=https://github.com/mimblewimble/grin/blob/master/doc/intro.md#ownership>利用盲因子</a>更进了一步。</p><p>假设</p><pre><code>ri * G + vi * H
ro * G + vo * H
</code></pre><p>分别是输入额 <strong>v1</strong> 和输出额 <strong>v2</strong> 的佩德森承诺。如果 <em>v1 &#x3D; v2，</em>则两个承诺相减得到 <em>(ro-ri)*G</em>，即，一个有效的公钥。只要发送方和接收方共同生成一个签名来证明他们知道 *(ro-ri)*，则交易被视为有效，代币的所有权发生转移。这种证明所有权的能力实现了 <a target=_blank rel=noopener href=https://github.com/mimblewimble/grin/blob/master/doc/intro.md#cut-through>cut-through</a>，进一步增强了 MimbleWimble 的隐私性和可扩展性。</p><h2 id=交易逻辑><a href=#交易逻辑 class=headerlink title=交易逻辑></a>交易逻辑</h2><p>比特币交易中的每个输出都有一个条件。如果一个输入试图花费一个输出，必须满足该输出的条件。验证交易时，输入脚本和输出脚本拼接后的求值结果必须为真。最常见的花费条件是 <a target=_blank rel=noopener href=https://en.bitcoinwiki.org/wiki/Pay-to-Pubkey_Hash>P2PKH</a>，需要提供公钥及其对应私钥创建的数字签名。</p><p><a target=_blank rel=noopener href=https://en.bitcoin.it/wiki/Script>比特币脚本</a>也可以用来表达更复杂的交易逻辑或<a target=_blank rel=noopener href=https://en.wikipedia.org/wiki/Smart_contract>智能合约</a>。<a target=_blank rel=noopener href=https://bitcoin.org/en/glossary/multisig>多签（MultiSig）</a>就是其中一例，需要不止一个签名来解锁输出，通常被用来分割资金的所有权。<a target=_blank rel=noopener href="https://nioctib.tech/#/transaction/f2f398dace996dab12e0cfb02fb0b59de0ef0398be393d90ebc8ab397550370b/input/0/interpret?step=9">这里</a>有一个 2&#x2F;2 多签的例子。</p><p>从隐私性的角度来看，将交易逻辑透明记录在公钥账本上通常是不可取的，因为它会不必要地揭示整个所有权结构。</p><h3 id=P2SH><a href=#P2SH class=headerlink title=P2SH></a>P2SH</h3><p>通过 <a target=_blank rel=noopener href=https://en.bitcoin.it/wiki/Pay_to_script_hash>P2SH</a>，输出可以发送至脚本哈希，本质上是将揭示复杂交易逻辑的负担从发送方转移至接收方。P2SH 本身并非一项隐私增强技术，因为同样的逻辑仍将由接收方揭示。但是，由于逻辑分支通常在花费时就已经决定好了，在隐藏信息方面有更多操纵空间。</p><h3 id=默克尔分支-MAST><a href=#默克尔分支-MAST class=headerlink title="默克尔分支 (MAST)"></a>默克尔分支 (MAST)</h3><p>一个洞见是，大多数交易逻辑只是通过某种方式对可能性进行分离。但即使一个代币只能经由众多可能路径中的一条花费，包含所有可能性的完整脚本也需要在花费交易输入中揭示。</p><p><a target=_blank rel=noopener href=https://www.mail-archive.com/bitcoin-dev@lists.linuxfoundation.org/msg05991.html>默克尔分支</a> (Merkle branch, MAST) 将这些可能性构建成了<a target=_blank rel=noopener href=https://en.wikipedia.org/wiki/Merkle_tree>默克尔树</a>。假设 有一个代币是 Alice 随时都能花费的，但如果 Alice 长达 3 个月都没有花费此代币，Bob 和 Charlie 就可以在双方都同意的情况下共同花费该代币。此场景可以用以下比特币脚本来表示：</p><pre><code>OP_If
   &lt;alice&#39;s pubkey&gt; OP_CheckSig
OP_Else
   &quot;3 months&quot; OP_CSV OP_Drop
   2 &lt;bob&#39;s pubkey&gt; &lt;charlie&#39;s pubkey&gt; 2 OP_CheckMultiSig
OP_EndIf
</code></pre><p>（脚本及相关图片来自 <a target=_blank rel=noopener href="https://twitter.com/hrdng?lang=en">David A Harding</a> 关于 MAST 的优质<a target=_blank rel=noopener href=https://bitcointechtalk.com/what-is-a-bitcoin-merklized-abstract-syntax-tree-mast-33fdf2da5e2f>文章</a>）</p><p>我们可以利用默克尔分支将上述脚本转化为下图所示的树，图中每个方形节点包含其子节点的标签的哈希。</p><p><img src=/../images/an-incomplete-survey-of-bitcoins-privacy-technologies/ee-full.png alt=merkle-tree-full></p><p>如果 Alice 想要花费此代币，只需揭示左分支和右分支的哈希值。3 个月后，如果 Bob 和 Charlie 决定共同花费此代币，他们只需揭示右分支和左分支的哈希值。</p><p><img src=/../images/an-incomplete-survey-of-bitcoins-privacy-technologies/le-tree.png alt=merkle-tree></p><p>通过这个例子，我们可以明显看出 MAST 在隐私性和缩减交易大小方面的优点。如果你想更深入地了解，可以阅读 David Harding 的<a target=_blank rel=noopener href=https://bitcointechtalk.com/what-is-a-bitcoin-merklized-abstract-syntax-tree-mast-33fdf2da5e2f>文章</a>（<a href=https://www.btcstudy.org/2021/09/07/what-is-a-bitcoin-merklized-abstract-syntax-tree-mast/ >中文译本</a>）。</p><h3 id=Schnorr-签名><a href=#Schnorr-签名 class=headerlink title="Schnorr 签名"></a>Schnorr 签名</h3><p><a target=_blank rel=noopener href=https://en.wikipedia.org/wiki/Schnorr_signature>Schnorr 签名</a>依赖于与 <a target=_blank rel=noopener href=https://en.wikipedia.org/wiki/Elliptic_Curve_Digital_Signature_Algorithm>ECDSA</a> 相同的安全假设，即<a target=_blank rel=noopener href=https://en.wikipedia.org/wiki/Discrete_logarithm>离散</a><a target=_blank rel=noopener href=https://en.wikipedia.org/wiki/Discrete_logarithm>对数</a><a target=_blank rel=noopener href=https://en.wikipedia.org/wiki/Discrete_logarithm>问题</a>难解。相较于比特币目前使用的 ECDSA 算法，Schnorr 签名的最大优势是使用不同私钥签署同一个消息得到的多个 Schnorr 签名，可以通过对所有对应公钥求和来进行验证。这是一个非常重要的特性，可以用来实现许多有趣的功能，例如：</p><ul><li><p>协议可以被<a target=_blank rel=noopener href=https://github.com/sipa/bips/blob/bip-schnorr/bip-schnorr.mediawiki#multisignatures-and-threshold-signatures>设计</a>成只需要一个聚合签名来验证 N&#x2F;M <a target=_blank rel=noopener href=https://bitcoin.org/en/glossary/multisig>多签</a>智能合约，从而极大提高隐私性和可扩展性。</p></li><li><p>能够增强 <a target=_blank rel=noopener href="https://bitcointalk.org/index.php?topic=279249.0">CoinJoin</a> 交易的隐私性，因为所有参与者只需提供一个联合签名。这会大幅缩减交易大小，为用户执行 CoinJoin 提供额外的经济激励（译者注：这需要 “跨输入的签名聚合” 技术，在当前的比特币上没有实现）。</p></li></ul><p>其它可以实现的功能有批量验证、区块级签名聚合等等。<a target=_blank rel=noopener href=https://github.com/sipa/bips/blob/bip-schnorr/bip-schnorr.mediawiki>查看此处</a>，了解更多信息。</p><h3 id=Taproot><a href=#Taproot class=headerlink title=Taproot></a>Taproot</h3><p>尽管交易逻辑包含可能性分离，但一项重要发现是，多人参与的合约通常会存在一个“共识分支”，即，如果每个参与者都同意，就可以花费此代币。这就好比是现实生活中的法院，尽管它可以强制当事人履行复杂的合约，但它在大多数情况下只是一种威慑，庭外和解才是常态。</p><p><img src=/../images/an-incomplete-survey-of-bitcoins-privacy-technologies/-branch.png alt=unamimous-branch></p><p>一种基于 MAST 实现“共识分支”的方法是将其表示为原始 MAST 树旁的一个额外分支，即，上图的绿色节点。红色节点变成了新的默克尔根。通过 Schnorr 签名，红色节点可以被简化为一个签名。这是可行的，但是每次通过共识分支达成一笔交易（这应该是最常见的场景）时，依然需要占用宝贵的区块链空间来揭示其实际值。</p><p><a target=_blank rel=noopener href=https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2018-January/015614.html>Taproot</a> 旨在以更高效的方式代表共识分支。其灵感源于 <a target=_blank rel=noopener href=https://twitter.com/timothanke>Timo Hanke</a> 的 <a target=_blank rel=noopener href=https://arxiv.org/abs/1212.3257>Pay-to-Contract</a>（付款给合约）构想。假设一个 MAST 脚本的默克尔根是 <strong>C</strong>，共识分支的聚合公钥为 <strong>K</strong>，则上述脚本的 Taproot 版本如下图所示：</p><p><img src=/../images/an-incomplete-survey-of-bitcoins-privacy-technologies/taproot.png alt=taproot></p><p>Taproot 节点包含 <code>K + H(K||C) * G</code> 的值，可以通过以下两种方式花费：</p><ul><li><p>如果选择了共识分支，只需由 <code>k + H(K||C)</code> （其中 <strong>k</strong> 指的是 <strong>K</strong> 的私钥）签署的签名即可。</p></li><li><p>如果没有达成共识，需要揭示并执行 <strong>C</strong>。</p></li></ul><p>由于大多数交易都通过共识分支达成，大多数 Taproot 交易看起来与普通的 <a target=_blank rel=noopener href=https://en.bitcoinwiki.org/wiki/Pay-to-Pubkey_Hash>P2PKH</a> 交易无异，交易逻辑的复杂部分很少被揭示。</p><h3 id=Graftroot><a href=#Graftroot class=headerlink title=Graftroot></a>Graftroot</h3><p>Taproot 的一处局限在于它天生只能提供一种替代方案。<a target=_blank rel=noopener href=https://github.com/gmaxwell>Greg Maxwell</a> 发明的 <a target=_blank rel=noopener href=https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2018-February/015700.html>Graftroot</a> 使用委托模型打破了这一局限性。</p><p><img src=/../images/an-incomplete-survey-of-bitcoins-privacy-technologies/aftroot.png alt=graftroot></p><p>在上图示例中，<strong>K</strong> 是共识分支的聚合公钥，<strong>S1</strong>、<strong>S2</strong> 和 <strong>S3</strong> 分别是三个执行路径。交易可以通过以下两种方式达成：</p><ul><li><p>使用 <strong>K</strong> 的对应私钥 <strong>k</strong> 签署交易。</p></li><li><p>使用 <strong>K</strong> 的对应私钥 <strong>k</strong> 签署 <strong>S1</strong>、<strong>S2</strong> 或 <strong>S3</strong>，被签署的脚本必须成功执行。</p></li></ul><p>第二种方法可以被认为是每个参与者都决定将代币的所有权委托给脚本。通过这种方式，我们可以实现任意多的替代方案。</p><p>许多针对比特币的隐私增强技术正在大放异彩，有的尚处于提案阶段，有的正在实现中。希望本文能够帮助你对该领域有更进一步的了解。就我个人而言，我期待 看到 Schnorr 签名和 Taproot 尽快在比特币中实现。还有机密交易，或许我想得有点太美了 :)</p><p>（完）</p></article></div></div></main><script src="/js/post.js?v=1682773100887"></script><script src="/js/highlight.min.js?v=1682773100887"></script><script>var containerEl=document.querySelector(".post-container"),postFontSize=localStorage.getItem("post-font-size")||"16",inputEl=document.querySelector("#size-change-input"),inputEl2=document.querySelector("#size-change-input2");inputEl.value=postFontSize,inputEl2.value=postFontSize,containerEl.style.fontSize=postFontSize+"px",$(function(){function e(t){$(".post-container").css("font-size",t+"px"),localStorage.setItem("post-font-size",t),$("#size-change-input").val(t),$("#size-change-input2").val(t)}$("#size-change-input").on("input propertychange",function(t){e(t.target.value)}),$("#size-change-input2").on("input propertychange",function(t){e(t.target.value)})})</script><script>hljs.initHighlightingOnLoad()</script></main></div><footer class="is-flex is-flex-direction-column is-align-items-center is-flex-shrink-0"><section class=sns-container><a title=nostr target=_blank rel="noopener nofollow" href=https://iris.to/npub1g2qs0ca5kpwlrcfug2em4jelmh65clk3yccwjxrs6hvdpd9qj80q022j4m>Nostr</a><a title=rss target=_blank rel="noopener nofollow" href=/atom.xml>rss</a><a title=telegram target=_blank rel="noopener nofollow" href=//t.me/btcstudyorg>Telegram</a></section></footer><script async src="/js/buttons.js?v=1682773100887"></script><script async src="/js/index.js?v=1682773100887"></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-JVCJ9XXG1Z"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-JVCJ9XXG1Z")</script><script>var _hmt=_hmt||[];(()=>{var e=document.createElement("script"),t=(e.src="https://hm.baidu.com/hm.js?c92c073c85be5be8d9b1b76f62a7e306",e.async=!0,e.defer=!0,document.getElementsByTagName("script")[0]);t.parentNode.insertBefore(e,t)})()</script></body></html>