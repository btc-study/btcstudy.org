<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><title>谨慎日志合约的浅显指南</title><meta name="keywords" content="比特币, 中本聪, 比特币区块链, 闪电网络, 比特币 layer 2, 健全货币, 密码货币, 密码朋克, 学习比特币, BTC, BTC Study, Bitcoin, bitcoin, proof of work"><meta name="description" content="比特币思想的中文集结地"><meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, initial-scale=1"><link rel="icon" href="/favicon.ico"><link rel="stylesheet" href="/style/common/bulma.css?v=1675761398920"><link rel="preload" as="style" onload="this.onload=null;this.rel='stylesheet'" href="/style/common/iconfont.css?v=1675761398920"><link rel="stylesheet" href="/style/base.css?v=1675761398920"><link rel="stylesheet" href="/style/common/helper.css?v=1675761398920"><link rel="stylesheet" href="/style/themes/animation.css?v=1675761398920"><script>function ready() {
  var bodyEl = document.querySelector('.body-container');
  var theme = localStorage.getItem('theme') || 'light';
  if (!['light', 'dark'].includes(theme)) {
    theme = 'light';
    localStorage.setItem('theme', 'light');
  }
  bodyEl.classList.remove('appearance-auto');
  bodyEl.classList.add('appearance-' + theme);
  quickInitialTheme();
}
function quickInitialTheme() {
  var theme = localStorage.getItem('theme') || 'light';
  var logoLightEl = document.querySelector('.logo-light');
  var logoDarkEl = document.querySelector('.logo-dark');
  
  var mLogoLightEl = document.querySelector('#mobile-header-logo > .logo-light');
  var mLogoDarkEl = document.querySelector('#mobile-header-logo > .logo-dark');
  var themeBtnEl = document.getElementById('theme-btn');
  
  var slideThemeLightEl = document.querySelector('.slide-theme-light');
  var slideThemeDarkEl = document.querySelector('.slide-theme-dark');
  
  document.body.classList.add(theme);
  if (theme === 'dark') {
    logoLightEl.classList.add('hidden');
    logoDarkEl.classList.remove('hidden');
    
    mLogoLightEl.classList.add('hidden');
    mLogoDarkEl.classList.remove('hidden');
    
    themeBtnEl.classList.remove('icon-icon_dark');
    themeBtnEl.classList.add('icon-icon_light');
    
    slideThemeLightEl.classList.remove('hidden');
  } else {
    slideThemeDarkEl.classList.remove('hidden');
  }
}
document.addEventListener("DOMContentLoaded", ready);</script><script src="/js/common.js?v=1675761398920"></script><script src="/js/libs/zepto.min.js"></script><link rel="stylesheet" href="/style/post.css?v=1675761398920"><link rel="stylesheet" href="/style/themes/highlight.css?v=1675761398920"><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="BTC Study" type="application/atom+xml">
</head><body class="is-flex is-flex-direction-column" onload="initialTheme()"><div class="clip"></div><div class="body-container appearance-auto"><header class="header-widget is-hidden-mobile is-flex is-flex-shrink-0 is-align-items-center is-justify-content-center" id="header"><div class="is-flex header-widget-container is-flex-shrink-0 is-align-items-center"><section class="is-hidden-mobile is-flex-shrink-0"><h1><a href="/"><svg class="logo-light" width="125px" height="23px" viewBox="0 0 125 23" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>BTCStudy</title><g id="页面-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="首页-响应式" transform="translate(-249.000000, -23.000000)" fill-rule="nonzero"><g id="BTCStudy" transform="translate(249.680000, 23.192000)"><path d="M9.072,17.808 C11.312,17.808 13.024,17.408 14.208,16.608 C15.392,15.808 15.984,14.672 15.984,13.2 C15.984,12.192 15.712,11.332 15.168,10.62 C14.624,9.908 13.872,9.384 12.912,9.048 C13.632,8.68 14.188,8.18 14.58,7.548 C14.972,6.916 15.168,6.2 15.168,5.4 C15.168,4.056 14.608,2.988 13.488,2.196 C12.368,1.404 10.736,1.008 8.592,1.008 L8.592,1.008 L-5.68434189e-14,1.008 L-5.68434189e-14,17.808 L9.072,17.808 Z M7.968,7.68 L4.704,7.68 L4.704,4.44 L7.968,4.44 C9.568,4.44 10.368,4.976 10.368,6.048 C10.368,7.136 9.568,7.68 7.968,7.68 L7.968,7.68 Z M8.688,14.376 L4.704,14.376 L4.704,10.968 L8.688,10.968 C10.352,10.968 11.184,11.536 11.184,12.672 C11.184,13.808 10.352,14.376 8.688,14.376 L8.688,14.376 Z M26.544,17.808 L26.544,4.776 L31.68,4.776 L31.68,1.008 L16.632,1.008 L16.632,4.776 L21.792,4.776 L21.792,17.808 L26.544,17.808 Z M41.592,18.144 C43.128,18.144 44.512,17.872 45.744,17.328 C46.976,16.784 48,16 48.816,14.976 L48.816,14.976 L45.792,12.24 C44.704,13.552 43.384,14.208 41.832,14.208 C40.92,14.208 40.108,14.008 39.396,13.608 C38.684,13.208 38.132,12.644 37.74,11.916 C37.348,11.188 37.152,10.352 37.152,9.408 C37.152,8.464 37.348,7.628 37.74,6.9 C38.132,6.172 38.684,5.608 39.396,5.208 C40.108,4.808 40.92,4.608 41.832,4.608 C43.384,4.608 44.704,5.264 45.792,6.576 L45.792,6.576 L48.816,3.84 C48,2.816 46.976,2.032 45.744,1.488 C44.512,0.944 43.128,0.672 41.592,0.672 C39.832,0.672 38.252,1.044 36.852,1.788 C35.452,2.532 34.352,3.568 33.552,4.896 C32.752,6.224 32.352,7.728 32.352,9.408 C32.352,11.088 32.752,12.592 33.552,13.92 C34.352,15.248 35.452,16.284 36.852,17.028 C38.252,17.772 39.832,18.144 41.592,18.144 Z" id="BTC" fill="#F2A900"></path><path d="M56.64,18.144 C58.24,18.144 59.6,17.9 60.72,17.412 C61.84,16.924 62.68,16.272 63.24,15.456 C63.8,14.64 64.08,13.728 64.08,12.72 C64.08,11.552 63.772,10.628 63.156,9.948 C62.54,9.268 61.812,8.772 60.972,8.46 C60.132,8.148 59.072,7.856 57.792,7.584 C56.656,7.344 55.832,7.112 55.32,6.888 C54.808,6.664 54.552,6.328 54.552,5.88 C54.552,5.432 54.768,5.068 55.2,4.788 C55.632,4.508 56.32,4.368 57.264,4.368 C58.768,4.368 60.32,4.8 61.92,5.664 L61.92,5.664 L63.384,2.136 C62.568,1.656 61.624,1.292 60.552,1.044 C59.48,0.796 58.392,0.672 57.288,0.672 C55.672,0.672 54.308,0.912 53.196,1.392 C52.084,1.872 51.248,2.524 50.688,3.348 C50.128,4.172 49.848,5.096 49.848,6.12 C49.848,7.288 50.152,8.216 50.76,8.904 C51.368,9.592 52.096,10.092 52.944,10.404 C53.792,10.716 54.848,11.008 56.112,11.28 C57.264,11.536 58.1,11.78 58.62,12.012 C59.14,12.244 59.4,12.6 59.4,13.08 C59.4,13.992 58.488,14.448 56.664,14.448 C55.704,14.448 54.728,14.296 53.736,13.992 C52.744,13.688 51.872,13.288 51.12,12.792 L51.12,12.792 L49.56,16.296 C50.36,16.856 51.4,17.304 52.68,17.64 C53.96,17.976 55.28,18.144 56.64,18.144 Z M71.856,18.024 C72.48,18.024 73.068,17.96 73.62,17.832 C74.172,17.704 74.64,17.52 75.024,17.28 L75.024,17.28 L73.896,14.088 C73.496,14.36 73.032,14.496 72.504,14.496 C72.088,14.496 71.756,14.364 71.508,14.1 C71.26,13.836 71.136,13.472 71.136,13.008 L71.136,13.008 L71.136,8.688 L74.112,8.688 L74.112,5.28 L71.136,5.28 L71.136,1.896 L66.576,1.896 L66.576,5.28 L64.68,5.28 L64.68,8.688 L66.576,8.688 L66.576,13.056 C66.576,14.704 67.032,15.944 67.944,16.776 C68.856,17.608 70.16,18.024 71.856,18.024 Z M82.248,18.024 C83,18.024 83.712,17.888 84.384,17.616 C85.056,17.344 85.632,16.944 86.112,16.416 L86.112,16.416 L86.112,17.808 L90.456,17.808 L90.456,4.8 L85.896,4.8 L85.896,11.064 C85.896,12.104 85.668,12.876 85.212,13.38 C84.756,13.884 84.168,14.136 83.448,14.136 C82.744,14.136 82.208,13.912 81.84,13.464 C81.472,13.016 81.288,12.304 81.288,11.328 L81.288,11.328 L81.288,4.8 L76.728,4.8 L76.728,12.072 C76.728,14.056 77.228,15.544 78.228,16.536 C79.228,17.528 80.568,18.024 82.248,18.024 Z M99.048,18.024 C100.744,18.024 102.016,17.52 102.864,16.512 L102.864,16.512 L102.864,17.808 L107.208,17.808 L107.208,0 L102.648,0 L102.648,5.928 C101.8,5.032 100.6,4.584 99.048,4.584 C97.864,4.584 96.784,4.856 95.808,5.4 C94.832,5.944 94.06,6.724 93.492,7.74 C92.924,8.756 92.64,9.936 92.64,11.28 C92.64,12.624 92.924,13.808 93.492,14.832 C94.06,15.856 94.832,16.644 95.808,17.196 C96.784,17.748 97.864,18.024 99.048,18.024 Z M100.008,14.4 C99.208,14.4 98.552,14.124 98.04,13.572 C97.528,13.02 97.272,12.256 97.272,11.28 C97.272,10.32 97.528,9.568 98.04,9.024 C98.552,8.48 99.208,8.208 100.008,8.208 C100.808,8.208 101.46,8.48 101.964,9.024 C102.468,9.568 102.72,10.32 102.72,11.28 C102.72,12.256 102.464,13.02 101.952,13.572 C101.44,14.124 100.792,14.4 100.008,14.4 Z M112.368,22.68 C113.728,22.68 114.88,22.356 115.824,21.708 C116.768,21.06 117.568,19.936 118.224,18.336 L118.224,18.336 L123.84,4.8 L119.496,4.8 L116.28,12.744 L113.088,4.8 L108.408,4.8 L113.976,17.976 C113.784,18.36 113.548,18.64 113.268,18.816 C112.988,18.992 112.632,19.08 112.2,19.08 C111.832,19.08 111.468,19.012 111.108,18.876 C110.748,18.74 110.44,18.552 110.184,18.312 L110.184,18.312 L108.6,21.504 C109.032,21.856 109.596,22.14 110.292,22.356 C110.988,22.572 111.68,22.68 112.368,22.68 Z" id="Study" fill-opacity="0.85" fill="#000000"></path></g></g></g></svg><svg class="logo-dark hidden" width="125px" height="23px" viewBox="0 0 125 23" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>BTCStudy</title><g id="页面-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="首页-响应式" transform="translate(-249.000000, -23.000000)" fill-rule="nonzero"><g id="BTCStudy" transform="translate(249.680000, 23.192000)"><path d="M9.072,17.808 C11.312,17.808 13.024,17.408 14.208,16.608 C15.392,15.808 15.984,14.672 15.984,13.2 C15.984,12.192 15.712,11.332 15.168,10.62 C14.624,9.908 13.872,9.384 12.912,9.048 C13.632,8.68 14.188,8.18 14.58,7.548 C14.972,6.916 15.168,6.2 15.168,5.4 C15.168,4.056 14.608,2.988 13.488,2.196 C12.368,1.404 10.736,1.008 8.592,1.008 L8.592,1.008 L-5.68434189e-14,1.008 L-5.68434189e-14,17.808 L9.072,17.808 Z M7.968,7.68 L4.704,7.68 L4.704,4.44 L7.968,4.44 C9.568,4.44 10.368,4.976 10.368,6.048 C10.368,7.136 9.568,7.68 7.968,7.68 L7.968,7.68 Z M8.688,14.376 L4.704,14.376 L4.704,10.968 L8.688,10.968 C10.352,10.968 11.184,11.536 11.184,12.672 C11.184,13.808 10.352,14.376 8.688,14.376 L8.688,14.376 Z M26.544,17.808 L26.544,4.776 L31.68,4.776 L31.68,1.008 L16.632,1.008 L16.632,4.776 L21.792,4.776 L21.792,17.808 L26.544,17.808 Z M41.592,18.144 C43.128,18.144 44.512,17.872 45.744,17.328 C46.976,16.784 48,16 48.816,14.976 L48.816,14.976 L45.792,12.24 C44.704,13.552 43.384,14.208 41.832,14.208 C40.92,14.208 40.108,14.008 39.396,13.608 C38.684,13.208 38.132,12.644 37.74,11.916 C37.348,11.188 37.152,10.352 37.152,9.408 C37.152,8.464 37.348,7.628 37.74,6.9 C38.132,6.172 38.684,5.608 39.396,5.208 C40.108,4.808 40.92,4.608 41.832,4.608 C43.384,4.608 44.704,5.264 45.792,6.576 L45.792,6.576 L48.816,3.84 C48,2.816 46.976,2.032 45.744,1.488 C44.512,0.944 43.128,0.672 41.592,0.672 C39.832,0.672 38.252,1.044 36.852,1.788 C35.452,2.532 34.352,3.568 33.552,4.896 C32.752,6.224 32.352,7.728 32.352,9.408 C32.352,11.088 32.752,12.592 33.552,13.92 C34.352,15.248 35.452,16.284 36.852,17.028 C38.252,17.772 39.832,18.144 41.592,18.144 Z" id="BTC" fill="#F2A900"></path><path d="M56.64,18.144 C58.24,18.144 59.6,17.9 60.72,17.412 C61.84,16.924 62.68,16.272 63.24,15.456 C63.8,14.64 64.08,13.728 64.08,12.72 C64.08,11.552 63.772,10.628 63.156,9.948 C62.54,9.268 61.812,8.772 60.972,8.46 C60.132,8.148 59.072,7.856 57.792,7.584 C56.656,7.344 55.832,7.112 55.32,6.888 C54.808,6.664 54.552,6.328 54.552,5.88 C54.552,5.432 54.768,5.068 55.2,4.788 C55.632,4.508 56.32,4.368 57.264,4.368 C58.768,4.368 60.32,4.8 61.92,5.664 L61.92,5.664 L63.384,2.136 C62.568,1.656 61.624,1.292 60.552,1.044 C59.48,0.796 58.392,0.672 57.288,0.672 C55.672,0.672 54.308,0.912 53.196,1.392 C52.084,1.872 51.248,2.524 50.688,3.348 C50.128,4.172 49.848,5.096 49.848,6.12 C49.848,7.288 50.152,8.216 50.76,8.904 C51.368,9.592 52.096,10.092 52.944,10.404 C53.792,10.716 54.848,11.008 56.112,11.28 C57.264,11.536 58.1,11.78 58.62,12.012 C59.14,12.244 59.4,12.6 59.4,13.08 C59.4,13.992 58.488,14.448 56.664,14.448 C55.704,14.448 54.728,14.296 53.736,13.992 C52.744,13.688 51.872,13.288 51.12,12.792 L51.12,12.792 L49.56,16.296 C50.36,16.856 51.4,17.304 52.68,17.64 C53.96,17.976 55.28,18.144 56.64,18.144 Z M71.856,18.024 C72.48,18.024 73.068,17.96 73.62,17.832 C74.172,17.704 74.64,17.52 75.024,17.28 L75.024,17.28 L73.896,14.088 C73.496,14.36 73.032,14.496 72.504,14.496 C72.088,14.496 71.756,14.364 71.508,14.1 C71.26,13.836 71.136,13.472 71.136,13.008 L71.136,13.008 L71.136,8.688 L74.112,8.688 L74.112,5.28 L71.136,5.28 L71.136,1.896 L66.576,1.896 L66.576,5.28 L64.68,5.28 L64.68,8.688 L66.576,8.688 L66.576,13.056 C66.576,14.704 67.032,15.944 67.944,16.776 C68.856,17.608 70.16,18.024 71.856,18.024 Z M82.248,18.024 C83,18.024 83.712,17.888 84.384,17.616 C85.056,17.344 85.632,16.944 86.112,16.416 L86.112,16.416 L86.112,17.808 L90.456,17.808 L90.456,4.8 L85.896,4.8 L85.896,11.064 C85.896,12.104 85.668,12.876 85.212,13.38 C84.756,13.884 84.168,14.136 83.448,14.136 C82.744,14.136 82.208,13.912 81.84,13.464 C81.472,13.016 81.288,12.304 81.288,11.328 L81.288,11.328 L81.288,4.8 L76.728,4.8 L76.728,12.072 C76.728,14.056 77.228,15.544 78.228,16.536 C79.228,17.528 80.568,18.024 82.248,18.024 Z M99.048,18.024 C100.744,18.024 102.016,17.52 102.864,16.512 L102.864,16.512 L102.864,17.808 L107.208,17.808 L107.208,0 L102.648,0 L102.648,5.928 C101.8,5.032 100.6,4.584 99.048,4.584 C97.864,4.584 96.784,4.856 95.808,5.4 C94.832,5.944 94.06,6.724 93.492,7.74 C92.924,8.756 92.64,9.936 92.64,11.28 C92.64,12.624 92.924,13.808 93.492,14.832 C94.06,15.856 94.832,16.644 95.808,17.196 C96.784,17.748 97.864,18.024 99.048,18.024 Z M100.008,14.4 C99.208,14.4 98.552,14.124 98.04,13.572 C97.528,13.02 97.272,12.256 97.272,11.28 C97.272,10.32 97.528,9.568 98.04,9.024 C98.552,8.48 99.208,8.208 100.008,8.208 C100.808,8.208 101.46,8.48 101.964,9.024 C102.468,9.568 102.72,10.32 102.72,11.28 C102.72,12.256 102.464,13.02 101.952,13.572 C101.44,14.124 100.792,14.4 100.008,14.4 Z M112.368,22.68 C113.728,22.68 114.88,22.356 115.824,21.708 C116.768,21.06 117.568,19.936 118.224,18.336 L118.224,18.336 L123.84,4.8 L119.496,4.8 L116.28,12.744 L113.088,4.8 L108.408,4.8 L113.976,17.976 C113.784,18.36 113.548,18.64 113.268,18.816 C112.988,18.992 112.632,19.08 112.2,19.08 C111.832,19.08 111.468,19.012 111.108,18.876 C110.748,18.74 110.44,18.552 110.184,18.312 L110.184,18.312 L108.6,21.504 C109.032,21.856 109.596,22.14 110.292,22.356 C110.988,22.572 111.68,22.68 112.368,22.68 Z" id="Study" fill-opacity="0.85" fill="#FFFFFF"></path></g></g></g></svg></a></h1></section><div class="is-flex is-flex-direction-column header-menu-wrap"><aside class="is-flex-shrink-0 is-flex is-flex-direction-row is-align-items-center" id="header-menu"><a class="is-inline-block header-activity mr-4" href="/">首页</a><a class="is-inline-block mr-4" href="/archives">全站目录</a><a class="is-inline-block mr-4" href="/tags">标签</a><a class="is-inline-block mr-4" href="/maps">地图</a><a class="is-inline-block mr-4" href="/mempool">mempool</a><a class="is-inline-block mr-4" target="_blank" rel="noopener" href="https://123btc.org/">123btc</a><div class="right-content is-flex is-flex-direction-row is-align-items-center"><div class="size-wrap mr-1"><i class="iconfont icon-a-bianzu5" id="change-size-btn"></i><div class="size-input-wrap"><div class="input-wrap"><input id="size-change-input" type="range" min="12" max="32" step="2"></div></div></div><i class="iconfont icon-icon_dark mr-1" id="theme-btn"></i><div class="search-wrap"><input class="pl-3" id="search-input" placeholder="请输入搜索关键词"><i class="iconfont icon-icon_search" id="search-input-btn"></i></div></div></aside><div class="header-title is-hidden-mobile is-full-height is-flex is-align-items-center is-flex-shrink-0"><div class="is-full-height hidden" id="postTopic"><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">谨慎日志合约的浅显指南</p><div class="size-wrap mr-1"><i class="iconfont icon-a-bianzu5" id="change-size-btn2"></i><div class="size-input-wrap"><div class="input-wrap"><input id="size-change-input2" type="range" min="12" max="32" step="2"></div></div></div></div></div></div></div></header><header class="is-flex header-widget is-flex-shrink-0 is-align-items-center is-justify-content-space-between is-hidden-tablet" id="mobile-header"><div class="is-flex is-flex-direction-row is-align-items-center"><i class="iconfont icon-icon_bar mobile-header-menu"></i><div id="mobile-header-logo"><svg class="logo-light" width="125px" height="23px" viewBox="0 0 125 23" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>BTCStudy</title><g id="页面-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="首页-响应式" transform="translate(-249.000000, -23.000000)" fill-rule="nonzero"><g id="BTCStudy" transform="translate(249.680000, 23.192000)"><path d="M9.072,17.808 C11.312,17.808 13.024,17.408 14.208,16.608 C15.392,15.808 15.984,14.672 15.984,13.2 C15.984,12.192 15.712,11.332 15.168,10.62 C14.624,9.908 13.872,9.384 12.912,9.048 C13.632,8.68 14.188,8.18 14.58,7.548 C14.972,6.916 15.168,6.2 15.168,5.4 C15.168,4.056 14.608,2.988 13.488,2.196 C12.368,1.404 10.736,1.008 8.592,1.008 L8.592,1.008 L-5.68434189e-14,1.008 L-5.68434189e-14,17.808 L9.072,17.808 Z M7.968,7.68 L4.704,7.68 L4.704,4.44 L7.968,4.44 C9.568,4.44 10.368,4.976 10.368,6.048 C10.368,7.136 9.568,7.68 7.968,7.68 L7.968,7.68 Z M8.688,14.376 L4.704,14.376 L4.704,10.968 L8.688,10.968 C10.352,10.968 11.184,11.536 11.184,12.672 C11.184,13.808 10.352,14.376 8.688,14.376 L8.688,14.376 Z M26.544,17.808 L26.544,4.776 L31.68,4.776 L31.68,1.008 L16.632,1.008 L16.632,4.776 L21.792,4.776 L21.792,17.808 L26.544,17.808 Z M41.592,18.144 C43.128,18.144 44.512,17.872 45.744,17.328 C46.976,16.784 48,16 48.816,14.976 L48.816,14.976 L45.792,12.24 C44.704,13.552 43.384,14.208 41.832,14.208 C40.92,14.208 40.108,14.008 39.396,13.608 C38.684,13.208 38.132,12.644 37.74,11.916 C37.348,11.188 37.152,10.352 37.152,9.408 C37.152,8.464 37.348,7.628 37.74,6.9 C38.132,6.172 38.684,5.608 39.396,5.208 C40.108,4.808 40.92,4.608 41.832,4.608 C43.384,4.608 44.704,5.264 45.792,6.576 L45.792,6.576 L48.816,3.84 C48,2.816 46.976,2.032 45.744,1.488 C44.512,0.944 43.128,0.672 41.592,0.672 C39.832,0.672 38.252,1.044 36.852,1.788 C35.452,2.532 34.352,3.568 33.552,4.896 C32.752,6.224 32.352,7.728 32.352,9.408 C32.352,11.088 32.752,12.592 33.552,13.92 C34.352,15.248 35.452,16.284 36.852,17.028 C38.252,17.772 39.832,18.144 41.592,18.144 Z" id="BTC" fill="#F2A900"></path><path d="M56.64,18.144 C58.24,18.144 59.6,17.9 60.72,17.412 C61.84,16.924 62.68,16.272 63.24,15.456 C63.8,14.64 64.08,13.728 64.08,12.72 C64.08,11.552 63.772,10.628 63.156,9.948 C62.54,9.268 61.812,8.772 60.972,8.46 C60.132,8.148 59.072,7.856 57.792,7.584 C56.656,7.344 55.832,7.112 55.32,6.888 C54.808,6.664 54.552,6.328 54.552,5.88 C54.552,5.432 54.768,5.068 55.2,4.788 C55.632,4.508 56.32,4.368 57.264,4.368 C58.768,4.368 60.32,4.8 61.92,5.664 L61.92,5.664 L63.384,2.136 C62.568,1.656 61.624,1.292 60.552,1.044 C59.48,0.796 58.392,0.672 57.288,0.672 C55.672,0.672 54.308,0.912 53.196,1.392 C52.084,1.872 51.248,2.524 50.688,3.348 C50.128,4.172 49.848,5.096 49.848,6.12 C49.848,7.288 50.152,8.216 50.76,8.904 C51.368,9.592 52.096,10.092 52.944,10.404 C53.792,10.716 54.848,11.008 56.112,11.28 C57.264,11.536 58.1,11.78 58.62,12.012 C59.14,12.244 59.4,12.6 59.4,13.08 C59.4,13.992 58.488,14.448 56.664,14.448 C55.704,14.448 54.728,14.296 53.736,13.992 C52.744,13.688 51.872,13.288 51.12,12.792 L51.12,12.792 L49.56,16.296 C50.36,16.856 51.4,17.304 52.68,17.64 C53.96,17.976 55.28,18.144 56.64,18.144 Z M71.856,18.024 C72.48,18.024 73.068,17.96 73.62,17.832 C74.172,17.704 74.64,17.52 75.024,17.28 L75.024,17.28 L73.896,14.088 C73.496,14.36 73.032,14.496 72.504,14.496 C72.088,14.496 71.756,14.364 71.508,14.1 C71.26,13.836 71.136,13.472 71.136,13.008 L71.136,13.008 L71.136,8.688 L74.112,8.688 L74.112,5.28 L71.136,5.28 L71.136,1.896 L66.576,1.896 L66.576,5.28 L64.68,5.28 L64.68,8.688 L66.576,8.688 L66.576,13.056 C66.576,14.704 67.032,15.944 67.944,16.776 C68.856,17.608 70.16,18.024 71.856,18.024 Z M82.248,18.024 C83,18.024 83.712,17.888 84.384,17.616 C85.056,17.344 85.632,16.944 86.112,16.416 L86.112,16.416 L86.112,17.808 L90.456,17.808 L90.456,4.8 L85.896,4.8 L85.896,11.064 C85.896,12.104 85.668,12.876 85.212,13.38 C84.756,13.884 84.168,14.136 83.448,14.136 C82.744,14.136 82.208,13.912 81.84,13.464 C81.472,13.016 81.288,12.304 81.288,11.328 L81.288,11.328 L81.288,4.8 L76.728,4.8 L76.728,12.072 C76.728,14.056 77.228,15.544 78.228,16.536 C79.228,17.528 80.568,18.024 82.248,18.024 Z M99.048,18.024 C100.744,18.024 102.016,17.52 102.864,16.512 L102.864,16.512 L102.864,17.808 L107.208,17.808 L107.208,0 L102.648,0 L102.648,5.928 C101.8,5.032 100.6,4.584 99.048,4.584 C97.864,4.584 96.784,4.856 95.808,5.4 C94.832,5.944 94.06,6.724 93.492,7.74 C92.924,8.756 92.64,9.936 92.64,11.28 C92.64,12.624 92.924,13.808 93.492,14.832 C94.06,15.856 94.832,16.644 95.808,17.196 C96.784,17.748 97.864,18.024 99.048,18.024 Z M100.008,14.4 C99.208,14.4 98.552,14.124 98.04,13.572 C97.528,13.02 97.272,12.256 97.272,11.28 C97.272,10.32 97.528,9.568 98.04,9.024 C98.552,8.48 99.208,8.208 100.008,8.208 C100.808,8.208 101.46,8.48 101.964,9.024 C102.468,9.568 102.72,10.32 102.72,11.28 C102.72,12.256 102.464,13.02 101.952,13.572 C101.44,14.124 100.792,14.4 100.008,14.4 Z M112.368,22.68 C113.728,22.68 114.88,22.356 115.824,21.708 C116.768,21.06 117.568,19.936 118.224,18.336 L118.224,18.336 L123.84,4.8 L119.496,4.8 L116.28,12.744 L113.088,4.8 L108.408,4.8 L113.976,17.976 C113.784,18.36 113.548,18.64 113.268,18.816 C112.988,18.992 112.632,19.08 112.2,19.08 C111.832,19.08 111.468,19.012 111.108,18.876 C110.748,18.74 110.44,18.552 110.184,18.312 L110.184,18.312 L108.6,21.504 C109.032,21.856 109.596,22.14 110.292,22.356 C110.988,22.572 111.68,22.68 112.368,22.68 Z" id="Study" fill-opacity="0.85" fill="#000000"></path></g></g></g></svg><svg class="logo-dark hidden" width="125px" height="23px" viewBox="0 0 125 23" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>BTCStudy</title><g id="页面-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="首页-响应式" transform="translate(-249.000000, -23.000000)" fill-rule="nonzero"><g id="BTCStudy" transform="translate(249.680000, 23.192000)"><path d="M9.072,17.808 C11.312,17.808 13.024,17.408 14.208,16.608 C15.392,15.808 15.984,14.672 15.984,13.2 C15.984,12.192 15.712,11.332 15.168,10.62 C14.624,9.908 13.872,9.384 12.912,9.048 C13.632,8.68 14.188,8.18 14.58,7.548 C14.972,6.916 15.168,6.2 15.168,5.4 C15.168,4.056 14.608,2.988 13.488,2.196 C12.368,1.404 10.736,1.008 8.592,1.008 L8.592,1.008 L-5.68434189e-14,1.008 L-5.68434189e-14,17.808 L9.072,17.808 Z M7.968,7.68 L4.704,7.68 L4.704,4.44 L7.968,4.44 C9.568,4.44 10.368,4.976 10.368,6.048 C10.368,7.136 9.568,7.68 7.968,7.68 L7.968,7.68 Z M8.688,14.376 L4.704,14.376 L4.704,10.968 L8.688,10.968 C10.352,10.968 11.184,11.536 11.184,12.672 C11.184,13.808 10.352,14.376 8.688,14.376 L8.688,14.376 Z M26.544,17.808 L26.544,4.776 L31.68,4.776 L31.68,1.008 L16.632,1.008 L16.632,4.776 L21.792,4.776 L21.792,17.808 L26.544,17.808 Z M41.592,18.144 C43.128,18.144 44.512,17.872 45.744,17.328 C46.976,16.784 48,16 48.816,14.976 L48.816,14.976 L45.792,12.24 C44.704,13.552 43.384,14.208 41.832,14.208 C40.92,14.208 40.108,14.008 39.396,13.608 C38.684,13.208 38.132,12.644 37.74,11.916 C37.348,11.188 37.152,10.352 37.152,9.408 C37.152,8.464 37.348,7.628 37.74,6.9 C38.132,6.172 38.684,5.608 39.396,5.208 C40.108,4.808 40.92,4.608 41.832,4.608 C43.384,4.608 44.704,5.264 45.792,6.576 L45.792,6.576 L48.816,3.84 C48,2.816 46.976,2.032 45.744,1.488 C44.512,0.944 43.128,0.672 41.592,0.672 C39.832,0.672 38.252,1.044 36.852,1.788 C35.452,2.532 34.352,3.568 33.552,4.896 C32.752,6.224 32.352,7.728 32.352,9.408 C32.352,11.088 32.752,12.592 33.552,13.92 C34.352,15.248 35.452,16.284 36.852,17.028 C38.252,17.772 39.832,18.144 41.592,18.144 Z" id="BTC" fill="#F2A900"></path><path d="M56.64,18.144 C58.24,18.144 59.6,17.9 60.72,17.412 C61.84,16.924 62.68,16.272 63.24,15.456 C63.8,14.64 64.08,13.728 64.08,12.72 C64.08,11.552 63.772,10.628 63.156,9.948 C62.54,9.268 61.812,8.772 60.972,8.46 C60.132,8.148 59.072,7.856 57.792,7.584 C56.656,7.344 55.832,7.112 55.32,6.888 C54.808,6.664 54.552,6.328 54.552,5.88 C54.552,5.432 54.768,5.068 55.2,4.788 C55.632,4.508 56.32,4.368 57.264,4.368 C58.768,4.368 60.32,4.8 61.92,5.664 L61.92,5.664 L63.384,2.136 C62.568,1.656 61.624,1.292 60.552,1.044 C59.48,0.796 58.392,0.672 57.288,0.672 C55.672,0.672 54.308,0.912 53.196,1.392 C52.084,1.872 51.248,2.524 50.688,3.348 C50.128,4.172 49.848,5.096 49.848,6.12 C49.848,7.288 50.152,8.216 50.76,8.904 C51.368,9.592 52.096,10.092 52.944,10.404 C53.792,10.716 54.848,11.008 56.112,11.28 C57.264,11.536 58.1,11.78 58.62,12.012 C59.14,12.244 59.4,12.6 59.4,13.08 C59.4,13.992 58.488,14.448 56.664,14.448 C55.704,14.448 54.728,14.296 53.736,13.992 C52.744,13.688 51.872,13.288 51.12,12.792 L51.12,12.792 L49.56,16.296 C50.36,16.856 51.4,17.304 52.68,17.64 C53.96,17.976 55.28,18.144 56.64,18.144 Z M71.856,18.024 C72.48,18.024 73.068,17.96 73.62,17.832 C74.172,17.704 74.64,17.52 75.024,17.28 L75.024,17.28 L73.896,14.088 C73.496,14.36 73.032,14.496 72.504,14.496 C72.088,14.496 71.756,14.364 71.508,14.1 C71.26,13.836 71.136,13.472 71.136,13.008 L71.136,13.008 L71.136,8.688 L74.112,8.688 L74.112,5.28 L71.136,5.28 L71.136,1.896 L66.576,1.896 L66.576,5.28 L64.68,5.28 L64.68,8.688 L66.576,8.688 L66.576,13.056 C66.576,14.704 67.032,15.944 67.944,16.776 C68.856,17.608 70.16,18.024 71.856,18.024 Z M82.248,18.024 C83,18.024 83.712,17.888 84.384,17.616 C85.056,17.344 85.632,16.944 86.112,16.416 L86.112,16.416 L86.112,17.808 L90.456,17.808 L90.456,4.8 L85.896,4.8 L85.896,11.064 C85.896,12.104 85.668,12.876 85.212,13.38 C84.756,13.884 84.168,14.136 83.448,14.136 C82.744,14.136 82.208,13.912 81.84,13.464 C81.472,13.016 81.288,12.304 81.288,11.328 L81.288,11.328 L81.288,4.8 L76.728,4.8 L76.728,12.072 C76.728,14.056 77.228,15.544 78.228,16.536 C79.228,17.528 80.568,18.024 82.248,18.024 Z M99.048,18.024 C100.744,18.024 102.016,17.52 102.864,16.512 L102.864,16.512 L102.864,17.808 L107.208,17.808 L107.208,0 L102.648,0 L102.648,5.928 C101.8,5.032 100.6,4.584 99.048,4.584 C97.864,4.584 96.784,4.856 95.808,5.4 C94.832,5.944 94.06,6.724 93.492,7.74 C92.924,8.756 92.64,9.936 92.64,11.28 C92.64,12.624 92.924,13.808 93.492,14.832 C94.06,15.856 94.832,16.644 95.808,17.196 C96.784,17.748 97.864,18.024 99.048,18.024 Z M100.008,14.4 C99.208,14.4 98.552,14.124 98.04,13.572 C97.528,13.02 97.272,12.256 97.272,11.28 C97.272,10.32 97.528,9.568 98.04,9.024 C98.552,8.48 99.208,8.208 100.008,8.208 C100.808,8.208 101.46,8.48 101.964,9.024 C102.468,9.568 102.72,10.32 102.72,11.28 C102.72,12.256 102.464,13.02 101.952,13.572 C101.44,14.124 100.792,14.4 100.008,14.4 Z M112.368,22.68 C113.728,22.68 114.88,22.356 115.824,21.708 C116.768,21.06 117.568,19.936 118.224,18.336 L118.224,18.336 L123.84,4.8 L119.496,4.8 L116.28,12.744 L113.088,4.8 L108.408,4.8 L113.976,17.976 C113.784,18.36 113.548,18.64 113.268,18.816 C112.988,18.992 112.632,19.08 112.2,19.08 C111.832,19.08 111.468,19.012 111.108,18.876 C110.748,18.74 110.44,18.552 110.184,18.312 L110.184,18.312 L108.6,21.504 C109.032,21.856 109.596,22.14 110.292,22.356 C110.988,22.572 111.68,22.68 112.368,22.68 Z" id="Study" fill-opacity="0.85" fill="#FFFFFF"></path></g></g></g></svg></div><div class="mobile-header-title is-full-height is-flex is-align-items-center is-flex-shrink-0"><div class="is-full-height hidden" id="postTopicMobile"><p class="is-full-height">谨慎日志合约的浅显指南</p></div></div></div><i class="iconfont icon-icon_search mobile-header-searchIcon"></i><div class="mobile-search-wrap"><div class="search-input"><input class="pl-3" id="mobile-search-input" placeholder="请输入搜索关键词"><i class="iconfont icon-icon_search mobile-search-input-btn"></i><button class="mobile-search-input-btn">搜 索</button></div></div></header><div class="mobile-slide-menu"><a class="header-activity" href="/">首页</a><a href="/archives">全站目录</a><a href="/tags">标签</a><a href="/maps">地图</a><a href="/mempool">mempool</a><a target="_blank" rel="noopener" href="https://123btc.org/">123btc</a><div><p class="slide-menu-theme is-flex is-flex-direction-row is-justify-content-space-between is-align-items-center"><span>主题设置</span><span><i class="iconfont icon-icon_light slide-theme-light hidden"></i><i class="iconfont icon-icon_dark slide-theme-dark hidden"></i></span></p><p class="slide-menu-fontsize"><span>字体设置</span><span><i class="iconfont icon-bianzubeifen"></i><i class="iconfont icon-bianzu"></i></span></p></div></div><div class="search-mask hidden"><script src="/js/header.js?v=1675761398920"> </script></div><main><main class="container is-max-widescreen content section post-page pt-4"><div class="columns is-flex-desktop is-justify-content-center"><div class="column is-3 silde-bar is-hidden-mobile"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#I-%E5%BC%95%E8%A8%80"><span class="toc-text">I. 引言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#II-%E6%9C%9D%E5%90%91-DLC-%E4%B9%8B%E8%B7%AF"><span class="toc-text">II. 朝向 DLC 之路</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#III-%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8-DLC-%E6%9D%A5%E6%89%93%E8%B5%8C"><span class="toc-text">III. 如何使用 DLC 来打赌</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AD%A5%E9%AA%A4-1-%E4%B8%BA%E5%90%88%E7%BA%A6%E6%8F%90%E4%BE%9B%E8%B5%84%E9%87%91"><span class="toc-text">步骤 1. 为合约提供资金</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AD%A5%E9%AA%A4-2-%E7%BC%96%E5%86%99%E5%90%88%E7%BA%A6"><span class="toc-text">步骤 2. 编写合约</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#IV-%E6%9C%89%E5%85%B3%E6%96%AD%E8%A8%80%E6%9C%BA%E7%9A%84%E6%8F%92%E6%9B%B2"><span class="toc-text">IV. 有关断言机的插曲</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%AD%E8%A8%80%E6%9C%BA%EF%BC%88oracle%EF%BC%89%E5%A6%82%E4%BD%95%E8%A7%A3%E5%86%B3%E4%BD%9C%E5%BC%8A%E9%97%AE%E9%A2%98"><span class="toc-text">断言机（oracle）如何解决作弊问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%AD%E8%A8%80%E6%9C%BA%E5%A6%82%E4%BD%95%E8%A7%A3%E5%86%B3%E7%9C%9F%E7%9B%B8%E9%97%AE%E9%A2%98"><span class="toc-text">断言机如何解决真相问题</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#V-%E6%94%AF%E4%BB%98%E5%92%8C%E6%94%B6%E7%9B%8A"><span class="toc-text">V. 支付和收益</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%89%A7%E8%A1%8C%E5%90%88%E7%BA%A6"><span class="toc-text">执行合约</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#VI-%E6%96%AD%E8%A8%80%E6%9C%BA%E9%A3%8E%E9%99%A9"><span class="toc-text">VI. 断言机风险</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#VII-%E7%BB%93%E8%AE%BA"><span class="toc-text">VII. 结论</span></a></li></ol></div><div class="column is-9 post-container"><h1 class="mt-0 mb-2" id="postTitle">谨慎日志合约的浅显指南</h1><div class="page-author"><div class="is-flex is-flex-direction-row page-data mr-6"><img class="mr-1" src="//res.btcstudy.org/btcstudy/images/default_avatar.png" alt="Craig Warmke"><div class="page-author-info"><strong>Craig Warmke</strong><time class="has-text-grey" datetime="2022-03-09T09:15:09.000Z">2022-03-09</time></div></div><div class="is-flex"><a href="/tags/Discreet-Log-Contract"><i class="page-tag mr-1 px-1">Discreet Log Contract<!-- 订正图片路径--></i></a></div></div><article class="mt-4 post-content"><blockquote>
<p><em>作者：Craig Warmke</em></p>
<p><em>来源：<a target="_blank" rel="noopener" href="https://atomic.finance/blog/a-laypersons-guide-to-discreet-log-contracts-atomic-yield-series-part-3/">https://atomic.finance/blog/a-laypersons-guide-to-discreet-log-contracts-atomic-yield-series-part-3/</a></em></p>
</blockquote>
<p><img src="//res.btcstudy.org/btcstudy/images/a-laypersons-guide-to-discreet-log-contracts/ration-.png" alt="img"></p>
<h2 id="I-引言"><a href="#I-引言" class="headerlink" title="I. 引言"></a>I. 引言</h2><p>有一段时间，比特币原生的去中心化金融一度看起来是不可能的。比特币的账本缺乏容纳大量复杂金融合约的空间。而且其简单的编程语言 —— 本身是为安全性而设计的 —— 缺乏在一笔交易中编码复杂金融合约的能力。</p>
<p>所以，比特币的持有者必须在其它地方寻找利息，并且在原则上妥协。比特币的银行既掌控着你的私钥，又掌控着你的私人信息。而汇入其它网络（比如以太坊）的 “封装的” 比特币在幕后常常有比特币银行，在智能合约风险之上又加了一层对手方风险。此外，这些服务常常加入新的山寨币来美化收益率。在 2017 年，比特币的持币人似乎只能通过牺牲自己的自我主权、隐私和安全性 —— 比特币理念的核心原则 —— 来获得利息。</p>
<p>但是，Thaddeus (Tadge) Dryja 发表了一篇论书谨慎日志合约（DLC）的白皮书 <sup><a href="#note1" id="jump-1">1</a></sup>。这份白皮书概述了一种链上足迹最小化、与比特币的简单编程语言兼容的比特币原生智能合约。最重要的是，DLC 允许用户保留自己的私钥以及他们的金融主权。</p>
<p>在 2020 年末，Atomic.Finance 看到了 DLC 的潜能，从一家以太坊 DeFi 公司<a target="_blank" rel="noopener" href="https://atomic.finance/blog/an-atomic-pivot/">转变</a>成了一个只经营比特币、使用 DLC 来做比特币原生业务的公司。通过将金融合约编码为 DLC，我们将<a target="_blank" rel="noopener" href="https://atomic.finance/blog/a-sound-finance-manifesto/">在健全金融与健全货币之间架起桥梁</a>。</p>
<p>DLC 既新颖，又复杂。因为我们希望用户在使用我们的产品之前先理解它们，所以我们写了这个三部曲，来解释为什么你可以无需托管而赚到比特币收益。<a target="_blank" rel="noopener" href="https://atomic.finance/blog/atomic-yield/">Part 1</a> 提供了一个鸟瞰式的概览。<a target="_blank" rel="noopener" href="https://atomic.finance/blog/bitcoin-covered-calls/">Part 2</a> 解释了比特币担保看涨期权（bitcoin covered calls）的最重要的特性。这篇文章作为 Part 3，将向感兴趣而没有技术背景的人解释 DLC 的工作原理。你不需要数学上的背景知识。只需一些耐心和毅力就可获得回报。</p>
<p><img src="//res.btcstudy.org/btcstudy/images/a-laypersons-guide-to-discreet-log-contracts/pivot.png" alt="img"></p>
<p style="text-align:center">- Atomic.Finance 在 2020 年末转向只开发比特币产品并只用比特币原生的技术 -</p>


<h2 id="II-朝向-DLC-之路"><a href="#II-朝向-DLC-之路" class="headerlink" title="II. 朝向 DLC 之路"></a>II. 朝向 DLC 之路</h2><p>假设 Alice 和 Bob 想跟对方用比特币来打赌某次选举的结果。他们有许多办法可以实现。</p>
<p>他们可以在链下打赌。但是，赢家必须相信输家会愿赌服输。这其实不太理想，因为一些输家不会履行自己的承诺。</p>
<p>又或者，他们可以用一个 2-of-2 的多签名合约来打赌。这就是说，Alice 和 Bob 可以发起一条交易将奖金锁在一个托管合约中，而解锁这些奖金就需要发起另一笔交易，需要双方都使用自己的私钥来签名这笔解锁交易。但这可能比上面那种方法更糟，因为当输家拒绝配合的时候，赢家什么也拿不到 —— 甚至一开始当奖金锁进去的那部分也要赔掉。</p>
<p>或者他们可以用一个 2-of-3 的多签名合约来打赌。这就是说，Alice 和 Bob 使用一条交易把奖金锁到一个托管合约内，此外还有一个第三方，三方中只有要两方的签名就可以花费托管合约中的奖金。Alice 和 Bob 可以选择一个双方都信任的第三方在输家拒绝合作的情形中介入。不过，因为要签名，这个第三方将知道合约的内容。所以不止 Alice 和 Bob 将失去隐私，第三方也可以跟输家勾结从而拿走奖金。</p>
<p>此外，Alice 和 Bob 还可以使用像以太坊这样的网络，将他们的比特币封装，并请求一个第三方的帮助。这个第三方（作为断言机）将把选举的结果输入到区块链以及相关合约的函数中。在这个案例中，这个断言机将是自动化的。Alice 和 Bob 可以将对赌合约编码成一笔交易来调用这个断言机。然后，当这个自动化的断言机提供结构的时候，这个合约将执行奖金支付。信息密集型合约会很快堵塞掉区块链，导致高昂的交易费和更少的隐私。这种金融偷窥行为也让 MEV（矿工可抽取的价值）成为可能 —— 也即一些人利用自己在网络中的位置<a target="_blank" rel="noopener" href="https://www.coindesk.com/ethereum-mev-frontrunning-solutions">抢跑和敲诈用户</a>可以获得利润 <sup><a href="#note2" id="jump-2">2</a></sup>。</p>
<p>Alice 和 Bob 应该使用 DLC。</p>
<h2 id="III-如何使用-DLC-来打赌"><a href="#III-如何使用-DLC-来打赌" class="headerlink" title="III. 如何使用 DLC 来打赌"></a>III. 如何使用 DLC 来打赌</h2><p>DLC 帮助解决了我们在上面遇到的一系列问题。它同时保护了用户的隐私、减少了用户在链上的足迹，也有助于防止 MEV（利用信息密集型的智能合约交互可获得的价值）。而且它还不需要第三方托管资金。听起来好像不可思议。DLC 确实涉及一些复杂的数学，但它的原理是很简单的。</p>
<p>首先，打赌的双方不会把完整的复杂智能合约作为单笔交易发送到链上（像以太坊上的方案那样），而是会将一个合约的逻辑分解成多笔更小的交易，只有少量交易需要在链上曝光。</p>
<p>其次，这个合约会调用一个或多个断言机，并激励他们诚实行事，帮助保证合约的成功执行。</p>
<p>DLC 可分成三个主要步骤。我们会以 Alice 和 Bob 之间赌约为例，讲解这三个步骤。它很像 Atomic <a target="_blank" rel="noopener" href="https://mobile.twitter.com/AtomicFinance/status/1321181338112851975">已经在运行</a>的打赌服务。</p>
<h3 id="步骤-1-为合约提供资金"><a href="#步骤-1-为合约提供资金" class="headerlink" title="步骤 1. 为合约提供资金"></a>步骤 1. 为合约提供资金</h3><p>Alice 和 Bob 都出资 1 BTC。赢家会拿回自己的 1 BTC 和输家的 1 BTC。</p>
<p>为了给赌约出资，Alice 和 Bob 一起构造一笔交易，锁定他们的总计 2 BTC 到一个新的地址。他们两人都用自己的私钥签名这笔交易并提交这笔交易到比特币账本。这就是所谓的 “充值交易”。</p>
<p><img src="//res.btcstudy.org/btcstudy/images/a-laypersons-guide-to-discreet-log-contracts/g.dlc-1.png" alt="The transaction inputs and transaction output in a funding transaction."></p>
<p style="text-align:center">- 图 1. Alice 和 Bob 的充值交易 -</p>


<p>这个新地址跟他们 <em>两人</em> 的私钥相关联。Alice 和 Bob 两人都用自己的私钥签名的交易，才能解锁这 2 BTC。所以，这笔充值交易实际上声成了一个 2-of-2 的多签名合约。</p>
<p>一旦这笔交易出现在比特币的账本上（上链了），资金就被 Alice 和 Bob 的联合托管合约锁定了。</p>
<h3 id="步骤-2-编写合约"><a href="#步骤-2-编写合约" class="headerlink" title="步骤 2. 编写合约"></a>步骤 2. 编写合约</h3><p>智能合约实际上就是一套逻辑，用来判定哪种情况将如何处理。在以太坊区块链上，一个金融合约的全部逻辑都放在一笔交易中（译者注：此言仅在一个合约部署时才为真。而当一个合约部署之后，它可被重复调用，而调用这个合约的交易将不再包含逻辑，只涉及调用这些逻辑所需的数据）。但 DLC 是将逻辑切分成多笔交易，也就是所谓的 “合约执行交易（CET）”。粗糙地来说，合约的每一种可能的结果都有自己的 CET。在 Alice 和 Bob 的赌约中，每一笔 CET 都是花费锁定在他们的充值交易的输出中的 2 BTC，但这些 CET 中只有一笔会在赌约产生结果时被发送上链。</p>
<p>我们来详细了解下 Alice 和 Bob 的 CET。假设 Alice 和 Bob 打赌 Dorian 是否会赢得选举，Alice 赌他会赢，而 Bob 赌他会输，那么，在选举之前，Alice 和 Bob 需要构造 4 笔 CET：</p>
<ul>
<li>一笔表示 Dorian 胜出，发送 2 BTC 给 Alice</li>
<li>一笔表示 Dorian 落败，发送 2 BTC 给 Bob</li>
<li>一笔表示 Dorian 平局，给 Alice 和 Bob 各返还 1 BTC</li>
<li>一笔是为其它不可能发生的情形准备的，也是给 Alice 和 Bob 返还资金</li>
</ul>
<p>此时，你可能会产生两个关于 CET 的质疑。</p>
<p><strong>作弊</strong>。Alice 和 Bob 在选举之前就已经签名了，那什么措施能阻止他们其中一人在选举揭晓之前就拿走那 2 BTC 呢？</p>
<p><strong>真相</strong>。 Alice 和 Bob 怎么保证选举的结果会导致正确的资金分配？</p>
<p>这两个质疑有同一个解决方案 —— 断言机。</p>
<p>在这个点上我们要保留悬念，因为我们需要先绕开断言机制。不过，如果你愿意继续跟着我，你很快会深入理解 DLC 到底是如何工作的。</p>
<h2 id="IV-有关断言机的插曲"><a href="#IV-有关断言机的插曲" class="headerlink" title="IV. 有关断言机的插曲"></a>IV. 有关断言机的插曲</h2><p>Alice 和 Bob 需要一个他们都信任的断言机来播报选举的结果。所以，他们咨询了 <a target="_blank" rel="noopener" href="https://suredbits.com/release-of-suredbits-oracle-explorer-and-krystal-bull/">Suredbits Oracle 浏览器</a>。他们一致同意使用一个声誉良好的断言机，而该第三方已经在社交媒体上公开承诺会发布选举的结果。最重要的是，这个第三方不需要知道自己被选用了。</p>
<p>断言机的公开承诺包含两部分重要信息：</p>
<p>其一，这个承诺说明了在每个结果下，他会播报什么信息：</p>
<ul>
<li>如果 Dorian 赢了，他会播报 “Dorian_wins”</li>
<li>如果 Dorian 输了，他会播报 “Dorian_loses”</li>
<li>如果平局，他会播报 “Dorian_ties”</li>
</ul>
<p>其二，这个公开承诺包含了一段不完全从这个断言机的私钥中推导出来的密码学数据。</p>
<p>这段数据与上面的三条消息一一配对。为便于观察，我们将它们称为 “加密器”。</p>
<ul>
<li>“Dorian_wins” 加密器</li>
<li>“Dorian_loses” 加密器</li>
<li>“Dorian_ties” 加密器</li>
</ul>
<p>管它们叫加密器，因为这就是它们的用途 —— 它们是用来加密的。有了它们之后，上面关于作弊和真相的质疑就解决了。最难的部分快要讲完了，不要掉队呀。</p>
<p><img src="//res.btcstudy.org/btcstudy/images/a-laypersons-guide-to-discreet-log-contracts/8.08-PM.png" alt="John Collier&#39;s 1891 painting, Priestess of Delphi."></p>
<p style="text-align:center">- 德尔斐神谕（The Oracle of Deiphi），John Collier 作于 1891 年 -</p>


<h3 id="断言机（oracle）如何解决作弊问题"><a href="#断言机（oracle）如何解决作弊问题" class="headerlink" title="断言机（oracle）如何解决作弊问题"></a>断言机（oracle）如何解决作弊问题</h3><p>Alice 和 Bob 在打赌结果揭晓前构造了 CET。他们用自己的私钥签名了 CET 并等待选举结果揭晓、把正确的 CET 发送上链、分配奖金。但是，如何阻止对方提前提交交易，给自己奖励 2 BTC 呢？</p>
<p>这就是加密器的用场。Alice 和 Bob 构造为 Alice 支付 2 BTC 的 CET 的时候，Bob 用自己的私钥签了名。此时，只要 Bob 的签名是有效的，只要  Alice 收到了 Bob 对该笔 CET 的有效签名，她就可以用自己的私钥签名并广播该 CET、欺骗 Bob。为了防止 Alice 欺诈，Bob 使用 “Dorian_wins” 加密器加密了自己的签名。这使得他交给 Alice 的数据并非这笔 CET 的有效签名。结果是，Alice <em>无法</em> 过早地拿走 2 BTC。</p>
<p>但这样做还没完，Alice 也用“Dorian_wins”加密器加密自己的签名。他们都使用这个加密器，因为这笔 CET 是给打赌 Dorian 胜出的 Alice 奖励。我们很快会解释这些操作的重要性。现在，这笔经过双方 “签名” 的 CET 还在链下 —— 并且还是无效的（因为还未获得有效签名）。</p>
<p>在构造给 Bob 奖励 2 BTC 的 CET 时，他们重复这个过程，不过这一次，他们用的是 “Dorian_loses” 加密器。</p>
<p>最后，在给双方返还 1 BTC 的 CET 中，他们再次重复这个流程，只不过要使用 “Dorian_ties”加密器。</p>
<p>因为这些 CET 都不具备有效的签名，所以无论 Alice 还是 Bob 都不能将这些 CET 发送到比特币网络中触发支付。不过，在断言机宣布结果之后，其中一笔交易将变成有效的交易。这就是断言机解决真相问题的方式。</p>
<h3 id="断言机如何解决真相问题"><a href="#断言机如何解决真相问题" class="headerlink" title="断言机如何解决真相问题"></a>断言机如何解决真相问题</h3><p>在选举之后，断言机使用自己的私钥产生对 “Dorian_wins”、“Dorian_loses” 或 “Dorian_ties” 的一个签名并发布。无论是哪一条，都将解密对应于宣告结果的 CET 的签名。所以我们可以将这些可能出现的公告称作 “解密器”：</p>
<ul>
<li>“Dorian_wins”解密器将揭示 “Dorian_wins” 加密器所隐藏的有效签名</li>
<li>“Dorian_loses”解密器将揭示 “Dorian_loses” 加密器所隐藏的有效签名</li>
<li>“Dorian_ties”解密器将揭示 “Dorian_ties” 加密器所隐藏的有效签名</li>
</ul>
<p>Alice 和 Bob 是没法提前知道这其中任何一个解密器的形态的。然而一旦断言机发布了一个，赢家就可以将相应一笔 CET 的签名从无效转为有效，交易也能上链了。</p>
<p>这个设计怎么解决真相问题呢？只要断言机正确地播报了结果，就只有一笔 CET 可以变成有效的、可以上链的交易。</p>
<p>好了，最难的部分已经讲完了。如果你已经读到这里，那下文应该很容易了。</p>
<h2 id="V-支付和收益"><a href="#V-支付和收益" class="headerlink" title="V. 支付和收益"></a>V. 支付和收益</h2><p>假设 Dorian 赢得了选举，Alice 赢了这场赌约。那还剩下最后一步需要做。</p>
<h3 id="执行合约"><a href="#执行合约" class="headerlink" title="执行合约"></a>执行合约</h3><p>断言机宣布结果并提供相应的解密器。Alice 于是解密了自己和 Bob的签名，使得这笔给自己发放 2 BTC 的 CET 成为有效的交易。</p>
<p><img src="//res.btcstudy.org/btcstudy/images/a-laypersons-guide-to-discreet-log-contracts/ecution.png"></p>
<p style="text-align:center">- 图 2. 合约执行交易，以刚解密的签名为输入 -</p>


<p>她将这个刚刚才变成有效交易的 CET 发布到网络中。很快，账本会显示她收到了来自一开始那笔充值交易中的 2 BTC。</p>
<p>我们来回顾一些值得注意的点。</p>
<ul>
<li>在选举结束后，Alice 不需要 Bob 配合取款。Bob 已经签名了 CET，并且是可以验证的。</li>
<li>其它 CET 仍然是无效的，也永远不会出现在链上。这就减少了链上的足迹，对那些更复杂的、可能有几千个结果的合约尤其有用。</li>
<li>关于用户资金的状态，比特币的账本向 Alice 和 Bob 这样的用户提供了完全的透明性 —— 以及内在的平静。</li>
<li>DLC 同时保障了用户的高度隐私，不受链上活动监视者的刺探。在账本上，一个 DLC 跟任何其它的 2-of-2 多签名交易没有任何区别。矿工和链上活动分析师都看不到合约的内部逻辑，而只能看到那个结果。所以，让以太坊上的 MEV 成为可能的金融刺探在比特币的 DLC 世界里是不可能的。</li>
<li>DLC 让用户可以保留自己的私钥。不需要用到第三方的托管服务。</li>
</ul>
<p>幸运的是，你不需要听信我的话。Atomic.Finance 对透明性看得很重，我们很高兴地报告，我们使用开源的 DLC 协议。实际上，我们鼓励您在能力范围内测试<a target="_blank" rel="noopener" href="https://github.com/discreetlogcontracts/dlcspecs">这个协议</a>。</p>
<p>不过，风险依然存在，而且 DLC 的断言机有独特的风险。我们来看看。</p>
<h2 id="VI-断言机风险"><a href="#VI-断言机风险" class="headerlink" title="VI. 断言机风险"></a>VI. 断言机风险</h2><p>DLC 依赖断言机向比特币网络报告现实世界的事件。作为一个受信任的第三方，它们看起来是安全漏洞。那么这个漏洞有多大呢？</p>
<p>有关断言机的风险，值得专门写一篇文章。对这些风险的调查，我推荐<a target="_blank" rel="noopener" href="https://suredbits.com/dlc-oracle-failure-cases/">这篇来自 Suredbits 的文章</a>。但我们会简要介绍其主要问题。</p>
<p>除了依赖单个断言机来播报事实，DLC 也可以调用多个断言机，使得合约仅在一定数量的断言机播报相同结果时才能执行。这会极大地关键依赖于单个断言机的风险，毕竟，断言机可能错误播报、播报多个结果或者不播报。</p>
<p>我们这个 DLC 协议也会在断言机不播报或者数量太少以至于无法触发合约支付时返回资金给参与者。</p>
<p>断言机也被激励去<a target="_blank" rel="noopener" href="https://medium.com/interdax/discreet-log-contracts-smart-contracts-for-bitcoin-d75f22d25dac">播报事实</a>。最起码，出错会导致声誉的重大损失。而因为一些人可能希望利用自己的声誉来开展成功的断言机业务，声誉的损失就是未来盈利能力的损失。此外，如果断言机对单个事件播报了多个结果，他们也会泄露自己的私钥。为了获得用户的信任，一个断言机需要用这个私钥来持有资金。这就是他们有利益相关的信号，也是可以验证的。用户将知道，播报多个结果将立即沉重地惩罚这个断言机。</p>
<p>不像其它智能合约网络上的自动化断言机，DLC 世界的断言机不需要知道自己参与到了某个 DLC 中。用户只需使用断言机公开播报的信息即可。所以，虽然一个断言机 <em>可能</em> 知道他们在服务某一个 DLC（例如，通过成为 DLC 中的一方），但没有哪个断言机可以 <em>确定</em>  自己在服务的所有 DLC。因此，错误播报的影响是不可估量的。因此，所有断言机都知道，耍滑头是得不偿失的。</p>
<h2 id="VII-结论"><a href="#VII-结论" class="headerlink" title="VII. 结论"></a>VII. 结论</h2><p>DLC 可以编码简单打赌以外的金融合约。Atomic.Finance 提供期权合约，包括像担保期权这样可以让用户用自己持有的比特币赚取收益的的合约。这些合约更加复杂，但其本质与 Alice 和 Bob 的打赌差不多。</p>
<p>我们相信，随着健全金融（Sound Finance）运动成长和成熟，DLC 会变得日益重要，就像闪电网络在支付中变得日益重要一样。这些开发工作会以激动人心和意料之外的方式不断交互和复合。未来是光明的。是鲜明的橙色。（译者注：橙色是比特币 Logo 的颜色。）</p>
<p>（完）</p>
<p>1.<a id="note1"> </a>Thaddeus Dryja (2017), “<a target="_blank" rel="noopener" href="https://adiabat.github.io/dlc.pdf">Discreet Log Contracts.</a>“<a href="#jump-1">↩</a></p>
<p>2.<a id="note2"> </a>Daian et al. (2019), “<a target="_blank" rel="noopener" href="https://arxiv.org/abs/1904.05234">Flash Boys 2.0: Frontrunning, Transaction Reordering, and Consensus Instability in Decentralized Exchanges.</a>“<a href="#jump-2">↩</a></p>
</article></div></div></main><script src="/js/post.js?v=1675761398920"></script><script src="/js/highlight.min.js?v=1675761398920"></script><script>var containerEl = document.querySelector('.post-container');
var postFontSize = localStorage.getItem('post-font-size') || '16';
var inputEl = document.querySelector('#size-change-input');
var inputEl2 = document.querySelector('#size-change-input2');
inputEl.value = postFontSize;
inputEl2.value = postFontSize;
containerEl.style.fontSize = postFontSize + 'px';
$(function(){
  function setSizeChangeInputValue(size) {
    $('.post-container').css('font-size', size + 'px');
    localStorage.setItem('post-font-size', size);
    $('#size-change-input').val(size);
    $('#size-change-input2').val(size);
  }
  $('#size-change-input').on('input propertychange', function(e) {
    const size = e.target.value;
    setSizeChangeInputValue(size);
  });
  $('#size-change-input2').on('input propertychange', function(e) {
    const size = e.target.value;
    setSizeChangeInputValue(size);
  });
});
</script><script>hljs.initHighlightingOnLoad();</script></main></div><footer class="is-flex is-flex-direction-column is-align-items-center is-flex-shrink-0"><section class="sns-container"><a title="twitter" target="_blank" rel="noopener nofollow" href="//twitter.com/btcstudy">Twitter</a><!-- Github--><!-- Ins--><!-- RSS--><a title="rss" target="_blank" rel="noopener nofollow" href="/atom.xml">rss</a><!-- 知乎--><!-- 领英--><!-- 脸书--><!-- Telegram--><a title="telegram" target="_blank" rel="noopener nofollow" href="//t.me/btcstudyorg">Telegram</a></section></footer><script async src="/js/buttons.js?v=1675761398920"></script><script async src="/js/index.js?v=1675761398920"></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-JVCJ9XXG1Z"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());

gtag('config', 'G-JVCJ9XXG1Z');</script><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?c92c073c85be5be8d9b1b76f62a7e306";
  hm.async = true;
  hm.defer = true;
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
  </script></body></html>