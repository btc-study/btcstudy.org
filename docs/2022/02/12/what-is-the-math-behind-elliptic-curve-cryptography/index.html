<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><title>椭圆曲线密码学背后的数学</title><meta name="keywords" content="比特币, 中本聪, 比特币区块链, 闪电网络, 比特币 layer 2, 健全货币, 密码货币, 密码朋克, 学习比特币, BTC, BTC Study, Bitcoin, bitcoin, proof of work"><meta name="description" content="比特币思想的中文集结地"><meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, initial-scale=1"><link rel="icon" href="/favicon.ico"><link rel="stylesheet" href="/style/common/bulma.css?v=1675433295305"><link rel="preload" as="style" onload="this.onload=null;this.rel='stylesheet'" href="/style/common/iconfont.css?v=1675433295305"><link rel="stylesheet" href="/style/base.css?v=1675433295305"><link rel="stylesheet" href="/style/common/helper.css?v=1675433295305"><link rel="stylesheet" href="/style/themes/animation.css?v=1675433295305"><script>function ready() {
  var bodyEl = document.querySelector('.body-container');
  var theme = localStorage.getItem('theme') || 'light';
  if (!['light', 'dark'].includes(theme)) {
    theme = 'light';
    localStorage.setItem('theme', 'light');
  }
  bodyEl.classList.remove('appearance-auto');
  bodyEl.classList.add('appearance-' + theme);
  quickInitialTheme();
}
function quickInitialTheme() {
  var theme = localStorage.getItem('theme') || 'light';
  var logoLightEl = document.querySelector('.logo-light');
  var logoDarkEl = document.querySelector('.logo-dark');
  
  var mLogoLightEl = document.querySelector('#mobile-header-logo > .logo-light');
  var mLogoDarkEl = document.querySelector('#mobile-header-logo > .logo-dark');
  var themeBtnEl = document.getElementById('theme-btn');
  
  var slideThemeLightEl = document.querySelector('.slide-theme-light');
  var slideThemeDarkEl = document.querySelector('.slide-theme-dark');
  
  document.body.classList.add(theme);
  if (theme === 'dark') {
    logoLightEl.classList.add('hidden');
    logoDarkEl.classList.remove('hidden');
    
    mLogoLightEl.classList.add('hidden');
    mLogoDarkEl.classList.remove('hidden');
    
    themeBtnEl.classList.remove('icon-icon_dark');
    themeBtnEl.classList.add('icon-icon_light');
    
    slideThemeLightEl.classList.remove('hidden');
  } else {
    slideThemeDarkEl.classList.remove('hidden');
  }
}
document.addEventListener("DOMContentLoaded", ready);</script><script src="/js/common.js?v=1675433295305"></script><script src="/js/libs/zepto.min.js"></script><link rel="stylesheet" href="/style/post.css?v=1675433295305"><link rel="stylesheet" href="/style/themes/highlight.css?v=1675433295305"><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="BTC Study" type="application/atom+xml">
</head><body class="is-flex is-flex-direction-column" onload="initialTheme()"><div class="clip"></div><div class="body-container appearance-auto"><header class="header-widget is-hidden-mobile is-flex is-flex-shrink-0 is-align-items-center is-justify-content-center" id="header"><div class="is-flex header-widget-container is-flex-shrink-0 is-align-items-center"><section class="is-hidden-mobile is-flex-shrink-0"><h1><a href="/"><svg class="logo-light" width="125px" height="23px" viewBox="0 0 125 23" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>BTCStudy</title><g id="页面-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="首页-响应式" transform="translate(-249.000000, -23.000000)" fill-rule="nonzero"><g id="BTCStudy" transform="translate(249.680000, 23.192000)"><path d="M9.072,17.808 C11.312,17.808 13.024,17.408 14.208,16.608 C15.392,15.808 15.984,14.672 15.984,13.2 C15.984,12.192 15.712,11.332 15.168,10.62 C14.624,9.908 13.872,9.384 12.912,9.048 C13.632,8.68 14.188,8.18 14.58,7.548 C14.972,6.916 15.168,6.2 15.168,5.4 C15.168,4.056 14.608,2.988 13.488,2.196 C12.368,1.404 10.736,1.008 8.592,1.008 L8.592,1.008 L-5.68434189e-14,1.008 L-5.68434189e-14,17.808 L9.072,17.808 Z M7.968,7.68 L4.704,7.68 L4.704,4.44 L7.968,4.44 C9.568,4.44 10.368,4.976 10.368,6.048 C10.368,7.136 9.568,7.68 7.968,7.68 L7.968,7.68 Z M8.688,14.376 L4.704,14.376 L4.704,10.968 L8.688,10.968 C10.352,10.968 11.184,11.536 11.184,12.672 C11.184,13.808 10.352,14.376 8.688,14.376 L8.688,14.376 Z M26.544,17.808 L26.544,4.776 L31.68,4.776 L31.68,1.008 L16.632,1.008 L16.632,4.776 L21.792,4.776 L21.792,17.808 L26.544,17.808 Z M41.592,18.144 C43.128,18.144 44.512,17.872 45.744,17.328 C46.976,16.784 48,16 48.816,14.976 L48.816,14.976 L45.792,12.24 C44.704,13.552 43.384,14.208 41.832,14.208 C40.92,14.208 40.108,14.008 39.396,13.608 C38.684,13.208 38.132,12.644 37.74,11.916 C37.348,11.188 37.152,10.352 37.152,9.408 C37.152,8.464 37.348,7.628 37.74,6.9 C38.132,6.172 38.684,5.608 39.396,5.208 C40.108,4.808 40.92,4.608 41.832,4.608 C43.384,4.608 44.704,5.264 45.792,6.576 L45.792,6.576 L48.816,3.84 C48,2.816 46.976,2.032 45.744,1.488 C44.512,0.944 43.128,0.672 41.592,0.672 C39.832,0.672 38.252,1.044 36.852,1.788 C35.452,2.532 34.352,3.568 33.552,4.896 C32.752,6.224 32.352,7.728 32.352,9.408 C32.352,11.088 32.752,12.592 33.552,13.92 C34.352,15.248 35.452,16.284 36.852,17.028 C38.252,17.772 39.832,18.144 41.592,18.144 Z" id="BTC" fill="#F2A900"></path><path d="M56.64,18.144 C58.24,18.144 59.6,17.9 60.72,17.412 C61.84,16.924 62.68,16.272 63.24,15.456 C63.8,14.64 64.08,13.728 64.08,12.72 C64.08,11.552 63.772,10.628 63.156,9.948 C62.54,9.268 61.812,8.772 60.972,8.46 C60.132,8.148 59.072,7.856 57.792,7.584 C56.656,7.344 55.832,7.112 55.32,6.888 C54.808,6.664 54.552,6.328 54.552,5.88 C54.552,5.432 54.768,5.068 55.2,4.788 C55.632,4.508 56.32,4.368 57.264,4.368 C58.768,4.368 60.32,4.8 61.92,5.664 L61.92,5.664 L63.384,2.136 C62.568,1.656 61.624,1.292 60.552,1.044 C59.48,0.796 58.392,0.672 57.288,0.672 C55.672,0.672 54.308,0.912 53.196,1.392 C52.084,1.872 51.248,2.524 50.688,3.348 C50.128,4.172 49.848,5.096 49.848,6.12 C49.848,7.288 50.152,8.216 50.76,8.904 C51.368,9.592 52.096,10.092 52.944,10.404 C53.792,10.716 54.848,11.008 56.112,11.28 C57.264,11.536 58.1,11.78 58.62,12.012 C59.14,12.244 59.4,12.6 59.4,13.08 C59.4,13.992 58.488,14.448 56.664,14.448 C55.704,14.448 54.728,14.296 53.736,13.992 C52.744,13.688 51.872,13.288 51.12,12.792 L51.12,12.792 L49.56,16.296 C50.36,16.856 51.4,17.304 52.68,17.64 C53.96,17.976 55.28,18.144 56.64,18.144 Z M71.856,18.024 C72.48,18.024 73.068,17.96 73.62,17.832 C74.172,17.704 74.64,17.52 75.024,17.28 L75.024,17.28 L73.896,14.088 C73.496,14.36 73.032,14.496 72.504,14.496 C72.088,14.496 71.756,14.364 71.508,14.1 C71.26,13.836 71.136,13.472 71.136,13.008 L71.136,13.008 L71.136,8.688 L74.112,8.688 L74.112,5.28 L71.136,5.28 L71.136,1.896 L66.576,1.896 L66.576,5.28 L64.68,5.28 L64.68,8.688 L66.576,8.688 L66.576,13.056 C66.576,14.704 67.032,15.944 67.944,16.776 C68.856,17.608 70.16,18.024 71.856,18.024 Z M82.248,18.024 C83,18.024 83.712,17.888 84.384,17.616 C85.056,17.344 85.632,16.944 86.112,16.416 L86.112,16.416 L86.112,17.808 L90.456,17.808 L90.456,4.8 L85.896,4.8 L85.896,11.064 C85.896,12.104 85.668,12.876 85.212,13.38 C84.756,13.884 84.168,14.136 83.448,14.136 C82.744,14.136 82.208,13.912 81.84,13.464 C81.472,13.016 81.288,12.304 81.288,11.328 L81.288,11.328 L81.288,4.8 L76.728,4.8 L76.728,12.072 C76.728,14.056 77.228,15.544 78.228,16.536 C79.228,17.528 80.568,18.024 82.248,18.024 Z M99.048,18.024 C100.744,18.024 102.016,17.52 102.864,16.512 L102.864,16.512 L102.864,17.808 L107.208,17.808 L107.208,0 L102.648,0 L102.648,5.928 C101.8,5.032 100.6,4.584 99.048,4.584 C97.864,4.584 96.784,4.856 95.808,5.4 C94.832,5.944 94.06,6.724 93.492,7.74 C92.924,8.756 92.64,9.936 92.64,11.28 C92.64,12.624 92.924,13.808 93.492,14.832 C94.06,15.856 94.832,16.644 95.808,17.196 C96.784,17.748 97.864,18.024 99.048,18.024 Z M100.008,14.4 C99.208,14.4 98.552,14.124 98.04,13.572 C97.528,13.02 97.272,12.256 97.272,11.28 C97.272,10.32 97.528,9.568 98.04,9.024 C98.552,8.48 99.208,8.208 100.008,8.208 C100.808,8.208 101.46,8.48 101.964,9.024 C102.468,9.568 102.72,10.32 102.72,11.28 C102.72,12.256 102.464,13.02 101.952,13.572 C101.44,14.124 100.792,14.4 100.008,14.4 Z M112.368,22.68 C113.728,22.68 114.88,22.356 115.824,21.708 C116.768,21.06 117.568,19.936 118.224,18.336 L118.224,18.336 L123.84,4.8 L119.496,4.8 L116.28,12.744 L113.088,4.8 L108.408,4.8 L113.976,17.976 C113.784,18.36 113.548,18.64 113.268,18.816 C112.988,18.992 112.632,19.08 112.2,19.08 C111.832,19.08 111.468,19.012 111.108,18.876 C110.748,18.74 110.44,18.552 110.184,18.312 L110.184,18.312 L108.6,21.504 C109.032,21.856 109.596,22.14 110.292,22.356 C110.988,22.572 111.68,22.68 112.368,22.68 Z" id="Study" fill-opacity="0.85" fill="#000000"></path></g></g></g></svg><svg class="logo-dark hidden" width="125px" height="23px" viewBox="0 0 125 23" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>BTCStudy</title><g id="页面-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="首页-响应式" transform="translate(-249.000000, -23.000000)" fill-rule="nonzero"><g id="BTCStudy" transform="translate(249.680000, 23.192000)"><path d="M9.072,17.808 C11.312,17.808 13.024,17.408 14.208,16.608 C15.392,15.808 15.984,14.672 15.984,13.2 C15.984,12.192 15.712,11.332 15.168,10.62 C14.624,9.908 13.872,9.384 12.912,9.048 C13.632,8.68 14.188,8.18 14.58,7.548 C14.972,6.916 15.168,6.2 15.168,5.4 C15.168,4.056 14.608,2.988 13.488,2.196 C12.368,1.404 10.736,1.008 8.592,1.008 L8.592,1.008 L-5.68434189e-14,1.008 L-5.68434189e-14,17.808 L9.072,17.808 Z M7.968,7.68 L4.704,7.68 L4.704,4.44 L7.968,4.44 C9.568,4.44 10.368,4.976 10.368,6.048 C10.368,7.136 9.568,7.68 7.968,7.68 L7.968,7.68 Z M8.688,14.376 L4.704,14.376 L4.704,10.968 L8.688,10.968 C10.352,10.968 11.184,11.536 11.184,12.672 C11.184,13.808 10.352,14.376 8.688,14.376 L8.688,14.376 Z M26.544,17.808 L26.544,4.776 L31.68,4.776 L31.68,1.008 L16.632,1.008 L16.632,4.776 L21.792,4.776 L21.792,17.808 L26.544,17.808 Z M41.592,18.144 C43.128,18.144 44.512,17.872 45.744,17.328 C46.976,16.784 48,16 48.816,14.976 L48.816,14.976 L45.792,12.24 C44.704,13.552 43.384,14.208 41.832,14.208 C40.92,14.208 40.108,14.008 39.396,13.608 C38.684,13.208 38.132,12.644 37.74,11.916 C37.348,11.188 37.152,10.352 37.152,9.408 C37.152,8.464 37.348,7.628 37.74,6.9 C38.132,6.172 38.684,5.608 39.396,5.208 C40.108,4.808 40.92,4.608 41.832,4.608 C43.384,4.608 44.704,5.264 45.792,6.576 L45.792,6.576 L48.816,3.84 C48,2.816 46.976,2.032 45.744,1.488 C44.512,0.944 43.128,0.672 41.592,0.672 C39.832,0.672 38.252,1.044 36.852,1.788 C35.452,2.532 34.352,3.568 33.552,4.896 C32.752,6.224 32.352,7.728 32.352,9.408 C32.352,11.088 32.752,12.592 33.552,13.92 C34.352,15.248 35.452,16.284 36.852,17.028 C38.252,17.772 39.832,18.144 41.592,18.144 Z" id="BTC" fill="#F2A900"></path><path d="M56.64,18.144 C58.24,18.144 59.6,17.9 60.72,17.412 C61.84,16.924 62.68,16.272 63.24,15.456 C63.8,14.64 64.08,13.728 64.08,12.72 C64.08,11.552 63.772,10.628 63.156,9.948 C62.54,9.268 61.812,8.772 60.972,8.46 C60.132,8.148 59.072,7.856 57.792,7.584 C56.656,7.344 55.832,7.112 55.32,6.888 C54.808,6.664 54.552,6.328 54.552,5.88 C54.552,5.432 54.768,5.068 55.2,4.788 C55.632,4.508 56.32,4.368 57.264,4.368 C58.768,4.368 60.32,4.8 61.92,5.664 L61.92,5.664 L63.384,2.136 C62.568,1.656 61.624,1.292 60.552,1.044 C59.48,0.796 58.392,0.672 57.288,0.672 C55.672,0.672 54.308,0.912 53.196,1.392 C52.084,1.872 51.248,2.524 50.688,3.348 C50.128,4.172 49.848,5.096 49.848,6.12 C49.848,7.288 50.152,8.216 50.76,8.904 C51.368,9.592 52.096,10.092 52.944,10.404 C53.792,10.716 54.848,11.008 56.112,11.28 C57.264,11.536 58.1,11.78 58.62,12.012 C59.14,12.244 59.4,12.6 59.4,13.08 C59.4,13.992 58.488,14.448 56.664,14.448 C55.704,14.448 54.728,14.296 53.736,13.992 C52.744,13.688 51.872,13.288 51.12,12.792 L51.12,12.792 L49.56,16.296 C50.36,16.856 51.4,17.304 52.68,17.64 C53.96,17.976 55.28,18.144 56.64,18.144 Z M71.856,18.024 C72.48,18.024 73.068,17.96 73.62,17.832 C74.172,17.704 74.64,17.52 75.024,17.28 L75.024,17.28 L73.896,14.088 C73.496,14.36 73.032,14.496 72.504,14.496 C72.088,14.496 71.756,14.364 71.508,14.1 C71.26,13.836 71.136,13.472 71.136,13.008 L71.136,13.008 L71.136,8.688 L74.112,8.688 L74.112,5.28 L71.136,5.28 L71.136,1.896 L66.576,1.896 L66.576,5.28 L64.68,5.28 L64.68,8.688 L66.576,8.688 L66.576,13.056 C66.576,14.704 67.032,15.944 67.944,16.776 C68.856,17.608 70.16,18.024 71.856,18.024 Z M82.248,18.024 C83,18.024 83.712,17.888 84.384,17.616 C85.056,17.344 85.632,16.944 86.112,16.416 L86.112,16.416 L86.112,17.808 L90.456,17.808 L90.456,4.8 L85.896,4.8 L85.896,11.064 C85.896,12.104 85.668,12.876 85.212,13.38 C84.756,13.884 84.168,14.136 83.448,14.136 C82.744,14.136 82.208,13.912 81.84,13.464 C81.472,13.016 81.288,12.304 81.288,11.328 L81.288,11.328 L81.288,4.8 L76.728,4.8 L76.728,12.072 C76.728,14.056 77.228,15.544 78.228,16.536 C79.228,17.528 80.568,18.024 82.248,18.024 Z M99.048,18.024 C100.744,18.024 102.016,17.52 102.864,16.512 L102.864,16.512 L102.864,17.808 L107.208,17.808 L107.208,0 L102.648,0 L102.648,5.928 C101.8,5.032 100.6,4.584 99.048,4.584 C97.864,4.584 96.784,4.856 95.808,5.4 C94.832,5.944 94.06,6.724 93.492,7.74 C92.924,8.756 92.64,9.936 92.64,11.28 C92.64,12.624 92.924,13.808 93.492,14.832 C94.06,15.856 94.832,16.644 95.808,17.196 C96.784,17.748 97.864,18.024 99.048,18.024 Z M100.008,14.4 C99.208,14.4 98.552,14.124 98.04,13.572 C97.528,13.02 97.272,12.256 97.272,11.28 C97.272,10.32 97.528,9.568 98.04,9.024 C98.552,8.48 99.208,8.208 100.008,8.208 C100.808,8.208 101.46,8.48 101.964,9.024 C102.468,9.568 102.72,10.32 102.72,11.28 C102.72,12.256 102.464,13.02 101.952,13.572 C101.44,14.124 100.792,14.4 100.008,14.4 Z M112.368,22.68 C113.728,22.68 114.88,22.356 115.824,21.708 C116.768,21.06 117.568,19.936 118.224,18.336 L118.224,18.336 L123.84,4.8 L119.496,4.8 L116.28,12.744 L113.088,4.8 L108.408,4.8 L113.976,17.976 C113.784,18.36 113.548,18.64 113.268,18.816 C112.988,18.992 112.632,19.08 112.2,19.08 C111.832,19.08 111.468,19.012 111.108,18.876 C110.748,18.74 110.44,18.552 110.184,18.312 L110.184,18.312 L108.6,21.504 C109.032,21.856 109.596,22.14 110.292,22.356 C110.988,22.572 111.68,22.68 112.368,22.68 Z" id="Study" fill-opacity="0.85" fill="#FFFFFF"></path></g></g></g></svg></a></h1></section><div class="is-flex is-flex-direction-column header-menu-wrap"><aside class="is-flex-shrink-0 is-flex is-flex-direction-row is-align-items-center" id="header-menu"><a class="is-inline-block header-activity mr-4" href="/">首页</a><a class="is-inline-block mr-4" href="/archives">全站目录</a><a class="is-inline-block mr-4" href="/tags">标签</a><a class="is-inline-block mr-4" href="/maps">地图</a><a class="is-inline-block mr-4" href="/mempool">mempool</a><a class="is-inline-block mr-4" target="_blank" rel="noopener" href="https://123btc.org/">123btc</a><div class="right-content is-flex is-flex-direction-row is-align-items-center"><div class="size-wrap mr-1"><i class="iconfont icon-a-bianzu5" id="change-size-btn"></i><div class="size-input-wrap"><div class="input-wrap"><input id="size-change-input" type="range" min="12" max="32" step="2"></div></div></div><i class="iconfont icon-icon_dark mr-1" id="theme-btn"></i><div class="search-wrap"><input class="pl-3" id="search-input" placeholder="请输入搜索关键词"><i class="iconfont icon-icon_search" id="search-input-btn"></i></div></div></aside><div class="header-title is-hidden-mobile is-full-height is-flex is-align-items-center is-flex-shrink-0"><div class="is-full-height hidden" id="postTopic"><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">椭圆曲线密码学背后的数学</p><div class="size-wrap mr-1"><i class="iconfont icon-a-bianzu5" id="change-size-btn2"></i><div class="size-input-wrap"><div class="input-wrap"><input id="size-change-input2" type="range" min="12" max="32" step="2"></div></div></div></div></div></div></div></header><header class="is-flex header-widget is-flex-shrink-0 is-align-items-center is-justify-content-space-between is-hidden-tablet" id="mobile-header"><div class="is-flex is-flex-direction-row is-align-items-center"><i class="iconfont icon-icon_bar mobile-header-menu"></i><div id="mobile-header-logo"><svg class="logo-light" width="125px" height="23px" viewBox="0 0 125 23" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>BTCStudy</title><g id="页面-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="首页-响应式" transform="translate(-249.000000, -23.000000)" fill-rule="nonzero"><g id="BTCStudy" transform="translate(249.680000, 23.192000)"><path d="M9.072,17.808 C11.312,17.808 13.024,17.408 14.208,16.608 C15.392,15.808 15.984,14.672 15.984,13.2 C15.984,12.192 15.712,11.332 15.168,10.62 C14.624,9.908 13.872,9.384 12.912,9.048 C13.632,8.68 14.188,8.18 14.58,7.548 C14.972,6.916 15.168,6.2 15.168,5.4 C15.168,4.056 14.608,2.988 13.488,2.196 C12.368,1.404 10.736,1.008 8.592,1.008 L8.592,1.008 L-5.68434189e-14,1.008 L-5.68434189e-14,17.808 L9.072,17.808 Z M7.968,7.68 L4.704,7.68 L4.704,4.44 L7.968,4.44 C9.568,4.44 10.368,4.976 10.368,6.048 C10.368,7.136 9.568,7.68 7.968,7.68 L7.968,7.68 Z M8.688,14.376 L4.704,14.376 L4.704,10.968 L8.688,10.968 C10.352,10.968 11.184,11.536 11.184,12.672 C11.184,13.808 10.352,14.376 8.688,14.376 L8.688,14.376 Z M26.544,17.808 L26.544,4.776 L31.68,4.776 L31.68,1.008 L16.632,1.008 L16.632,4.776 L21.792,4.776 L21.792,17.808 L26.544,17.808 Z M41.592,18.144 C43.128,18.144 44.512,17.872 45.744,17.328 C46.976,16.784 48,16 48.816,14.976 L48.816,14.976 L45.792,12.24 C44.704,13.552 43.384,14.208 41.832,14.208 C40.92,14.208 40.108,14.008 39.396,13.608 C38.684,13.208 38.132,12.644 37.74,11.916 C37.348,11.188 37.152,10.352 37.152,9.408 C37.152,8.464 37.348,7.628 37.74,6.9 C38.132,6.172 38.684,5.608 39.396,5.208 C40.108,4.808 40.92,4.608 41.832,4.608 C43.384,4.608 44.704,5.264 45.792,6.576 L45.792,6.576 L48.816,3.84 C48,2.816 46.976,2.032 45.744,1.488 C44.512,0.944 43.128,0.672 41.592,0.672 C39.832,0.672 38.252,1.044 36.852,1.788 C35.452,2.532 34.352,3.568 33.552,4.896 C32.752,6.224 32.352,7.728 32.352,9.408 C32.352,11.088 32.752,12.592 33.552,13.92 C34.352,15.248 35.452,16.284 36.852,17.028 C38.252,17.772 39.832,18.144 41.592,18.144 Z" id="BTC" fill="#F2A900"></path><path d="M56.64,18.144 C58.24,18.144 59.6,17.9 60.72,17.412 C61.84,16.924 62.68,16.272 63.24,15.456 C63.8,14.64 64.08,13.728 64.08,12.72 C64.08,11.552 63.772,10.628 63.156,9.948 C62.54,9.268 61.812,8.772 60.972,8.46 C60.132,8.148 59.072,7.856 57.792,7.584 C56.656,7.344 55.832,7.112 55.32,6.888 C54.808,6.664 54.552,6.328 54.552,5.88 C54.552,5.432 54.768,5.068 55.2,4.788 C55.632,4.508 56.32,4.368 57.264,4.368 C58.768,4.368 60.32,4.8 61.92,5.664 L61.92,5.664 L63.384,2.136 C62.568,1.656 61.624,1.292 60.552,1.044 C59.48,0.796 58.392,0.672 57.288,0.672 C55.672,0.672 54.308,0.912 53.196,1.392 C52.084,1.872 51.248,2.524 50.688,3.348 C50.128,4.172 49.848,5.096 49.848,6.12 C49.848,7.288 50.152,8.216 50.76,8.904 C51.368,9.592 52.096,10.092 52.944,10.404 C53.792,10.716 54.848,11.008 56.112,11.28 C57.264,11.536 58.1,11.78 58.62,12.012 C59.14,12.244 59.4,12.6 59.4,13.08 C59.4,13.992 58.488,14.448 56.664,14.448 C55.704,14.448 54.728,14.296 53.736,13.992 C52.744,13.688 51.872,13.288 51.12,12.792 L51.12,12.792 L49.56,16.296 C50.36,16.856 51.4,17.304 52.68,17.64 C53.96,17.976 55.28,18.144 56.64,18.144 Z M71.856,18.024 C72.48,18.024 73.068,17.96 73.62,17.832 C74.172,17.704 74.64,17.52 75.024,17.28 L75.024,17.28 L73.896,14.088 C73.496,14.36 73.032,14.496 72.504,14.496 C72.088,14.496 71.756,14.364 71.508,14.1 C71.26,13.836 71.136,13.472 71.136,13.008 L71.136,13.008 L71.136,8.688 L74.112,8.688 L74.112,5.28 L71.136,5.28 L71.136,1.896 L66.576,1.896 L66.576,5.28 L64.68,5.28 L64.68,8.688 L66.576,8.688 L66.576,13.056 C66.576,14.704 67.032,15.944 67.944,16.776 C68.856,17.608 70.16,18.024 71.856,18.024 Z M82.248,18.024 C83,18.024 83.712,17.888 84.384,17.616 C85.056,17.344 85.632,16.944 86.112,16.416 L86.112,16.416 L86.112,17.808 L90.456,17.808 L90.456,4.8 L85.896,4.8 L85.896,11.064 C85.896,12.104 85.668,12.876 85.212,13.38 C84.756,13.884 84.168,14.136 83.448,14.136 C82.744,14.136 82.208,13.912 81.84,13.464 C81.472,13.016 81.288,12.304 81.288,11.328 L81.288,11.328 L81.288,4.8 L76.728,4.8 L76.728,12.072 C76.728,14.056 77.228,15.544 78.228,16.536 C79.228,17.528 80.568,18.024 82.248,18.024 Z M99.048,18.024 C100.744,18.024 102.016,17.52 102.864,16.512 L102.864,16.512 L102.864,17.808 L107.208,17.808 L107.208,0 L102.648,0 L102.648,5.928 C101.8,5.032 100.6,4.584 99.048,4.584 C97.864,4.584 96.784,4.856 95.808,5.4 C94.832,5.944 94.06,6.724 93.492,7.74 C92.924,8.756 92.64,9.936 92.64,11.28 C92.64,12.624 92.924,13.808 93.492,14.832 C94.06,15.856 94.832,16.644 95.808,17.196 C96.784,17.748 97.864,18.024 99.048,18.024 Z M100.008,14.4 C99.208,14.4 98.552,14.124 98.04,13.572 C97.528,13.02 97.272,12.256 97.272,11.28 C97.272,10.32 97.528,9.568 98.04,9.024 C98.552,8.48 99.208,8.208 100.008,8.208 C100.808,8.208 101.46,8.48 101.964,9.024 C102.468,9.568 102.72,10.32 102.72,11.28 C102.72,12.256 102.464,13.02 101.952,13.572 C101.44,14.124 100.792,14.4 100.008,14.4 Z M112.368,22.68 C113.728,22.68 114.88,22.356 115.824,21.708 C116.768,21.06 117.568,19.936 118.224,18.336 L118.224,18.336 L123.84,4.8 L119.496,4.8 L116.28,12.744 L113.088,4.8 L108.408,4.8 L113.976,17.976 C113.784,18.36 113.548,18.64 113.268,18.816 C112.988,18.992 112.632,19.08 112.2,19.08 C111.832,19.08 111.468,19.012 111.108,18.876 C110.748,18.74 110.44,18.552 110.184,18.312 L110.184,18.312 L108.6,21.504 C109.032,21.856 109.596,22.14 110.292,22.356 C110.988,22.572 111.68,22.68 112.368,22.68 Z" id="Study" fill-opacity="0.85" fill="#000000"></path></g></g></g></svg><svg class="logo-dark hidden" width="125px" height="23px" viewBox="0 0 125 23" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>BTCStudy</title><g id="页面-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="首页-响应式" transform="translate(-249.000000, -23.000000)" fill-rule="nonzero"><g id="BTCStudy" transform="translate(249.680000, 23.192000)"><path d="M9.072,17.808 C11.312,17.808 13.024,17.408 14.208,16.608 C15.392,15.808 15.984,14.672 15.984,13.2 C15.984,12.192 15.712,11.332 15.168,10.62 C14.624,9.908 13.872,9.384 12.912,9.048 C13.632,8.68 14.188,8.18 14.58,7.548 C14.972,6.916 15.168,6.2 15.168,5.4 C15.168,4.056 14.608,2.988 13.488,2.196 C12.368,1.404 10.736,1.008 8.592,1.008 L8.592,1.008 L-5.68434189e-14,1.008 L-5.68434189e-14,17.808 L9.072,17.808 Z M7.968,7.68 L4.704,7.68 L4.704,4.44 L7.968,4.44 C9.568,4.44 10.368,4.976 10.368,6.048 C10.368,7.136 9.568,7.68 7.968,7.68 L7.968,7.68 Z M8.688,14.376 L4.704,14.376 L4.704,10.968 L8.688,10.968 C10.352,10.968 11.184,11.536 11.184,12.672 C11.184,13.808 10.352,14.376 8.688,14.376 L8.688,14.376 Z M26.544,17.808 L26.544,4.776 L31.68,4.776 L31.68,1.008 L16.632,1.008 L16.632,4.776 L21.792,4.776 L21.792,17.808 L26.544,17.808 Z M41.592,18.144 C43.128,18.144 44.512,17.872 45.744,17.328 C46.976,16.784 48,16 48.816,14.976 L48.816,14.976 L45.792,12.24 C44.704,13.552 43.384,14.208 41.832,14.208 C40.92,14.208 40.108,14.008 39.396,13.608 C38.684,13.208 38.132,12.644 37.74,11.916 C37.348,11.188 37.152,10.352 37.152,9.408 C37.152,8.464 37.348,7.628 37.74,6.9 C38.132,6.172 38.684,5.608 39.396,5.208 C40.108,4.808 40.92,4.608 41.832,4.608 C43.384,4.608 44.704,5.264 45.792,6.576 L45.792,6.576 L48.816,3.84 C48,2.816 46.976,2.032 45.744,1.488 C44.512,0.944 43.128,0.672 41.592,0.672 C39.832,0.672 38.252,1.044 36.852,1.788 C35.452,2.532 34.352,3.568 33.552,4.896 C32.752,6.224 32.352,7.728 32.352,9.408 C32.352,11.088 32.752,12.592 33.552,13.92 C34.352,15.248 35.452,16.284 36.852,17.028 C38.252,17.772 39.832,18.144 41.592,18.144 Z" id="BTC" fill="#F2A900"></path><path d="M56.64,18.144 C58.24,18.144 59.6,17.9 60.72,17.412 C61.84,16.924 62.68,16.272 63.24,15.456 C63.8,14.64 64.08,13.728 64.08,12.72 C64.08,11.552 63.772,10.628 63.156,9.948 C62.54,9.268 61.812,8.772 60.972,8.46 C60.132,8.148 59.072,7.856 57.792,7.584 C56.656,7.344 55.832,7.112 55.32,6.888 C54.808,6.664 54.552,6.328 54.552,5.88 C54.552,5.432 54.768,5.068 55.2,4.788 C55.632,4.508 56.32,4.368 57.264,4.368 C58.768,4.368 60.32,4.8 61.92,5.664 L61.92,5.664 L63.384,2.136 C62.568,1.656 61.624,1.292 60.552,1.044 C59.48,0.796 58.392,0.672 57.288,0.672 C55.672,0.672 54.308,0.912 53.196,1.392 C52.084,1.872 51.248,2.524 50.688,3.348 C50.128,4.172 49.848,5.096 49.848,6.12 C49.848,7.288 50.152,8.216 50.76,8.904 C51.368,9.592 52.096,10.092 52.944,10.404 C53.792,10.716 54.848,11.008 56.112,11.28 C57.264,11.536 58.1,11.78 58.62,12.012 C59.14,12.244 59.4,12.6 59.4,13.08 C59.4,13.992 58.488,14.448 56.664,14.448 C55.704,14.448 54.728,14.296 53.736,13.992 C52.744,13.688 51.872,13.288 51.12,12.792 L51.12,12.792 L49.56,16.296 C50.36,16.856 51.4,17.304 52.68,17.64 C53.96,17.976 55.28,18.144 56.64,18.144 Z M71.856,18.024 C72.48,18.024 73.068,17.96 73.62,17.832 C74.172,17.704 74.64,17.52 75.024,17.28 L75.024,17.28 L73.896,14.088 C73.496,14.36 73.032,14.496 72.504,14.496 C72.088,14.496 71.756,14.364 71.508,14.1 C71.26,13.836 71.136,13.472 71.136,13.008 L71.136,13.008 L71.136,8.688 L74.112,8.688 L74.112,5.28 L71.136,5.28 L71.136,1.896 L66.576,1.896 L66.576,5.28 L64.68,5.28 L64.68,8.688 L66.576,8.688 L66.576,13.056 C66.576,14.704 67.032,15.944 67.944,16.776 C68.856,17.608 70.16,18.024 71.856,18.024 Z M82.248,18.024 C83,18.024 83.712,17.888 84.384,17.616 C85.056,17.344 85.632,16.944 86.112,16.416 L86.112,16.416 L86.112,17.808 L90.456,17.808 L90.456,4.8 L85.896,4.8 L85.896,11.064 C85.896,12.104 85.668,12.876 85.212,13.38 C84.756,13.884 84.168,14.136 83.448,14.136 C82.744,14.136 82.208,13.912 81.84,13.464 C81.472,13.016 81.288,12.304 81.288,11.328 L81.288,11.328 L81.288,4.8 L76.728,4.8 L76.728,12.072 C76.728,14.056 77.228,15.544 78.228,16.536 C79.228,17.528 80.568,18.024 82.248,18.024 Z M99.048,18.024 C100.744,18.024 102.016,17.52 102.864,16.512 L102.864,16.512 L102.864,17.808 L107.208,17.808 L107.208,0 L102.648,0 L102.648,5.928 C101.8,5.032 100.6,4.584 99.048,4.584 C97.864,4.584 96.784,4.856 95.808,5.4 C94.832,5.944 94.06,6.724 93.492,7.74 C92.924,8.756 92.64,9.936 92.64,11.28 C92.64,12.624 92.924,13.808 93.492,14.832 C94.06,15.856 94.832,16.644 95.808,17.196 C96.784,17.748 97.864,18.024 99.048,18.024 Z M100.008,14.4 C99.208,14.4 98.552,14.124 98.04,13.572 C97.528,13.02 97.272,12.256 97.272,11.28 C97.272,10.32 97.528,9.568 98.04,9.024 C98.552,8.48 99.208,8.208 100.008,8.208 C100.808,8.208 101.46,8.48 101.964,9.024 C102.468,9.568 102.72,10.32 102.72,11.28 C102.72,12.256 102.464,13.02 101.952,13.572 C101.44,14.124 100.792,14.4 100.008,14.4 Z M112.368,22.68 C113.728,22.68 114.88,22.356 115.824,21.708 C116.768,21.06 117.568,19.936 118.224,18.336 L118.224,18.336 L123.84,4.8 L119.496,4.8 L116.28,12.744 L113.088,4.8 L108.408,4.8 L113.976,17.976 C113.784,18.36 113.548,18.64 113.268,18.816 C112.988,18.992 112.632,19.08 112.2,19.08 C111.832,19.08 111.468,19.012 111.108,18.876 C110.748,18.74 110.44,18.552 110.184,18.312 L110.184,18.312 L108.6,21.504 C109.032,21.856 109.596,22.14 110.292,22.356 C110.988,22.572 111.68,22.68 112.368,22.68 Z" id="Study" fill-opacity="0.85" fill="#FFFFFF"></path></g></g></g></svg></div><div class="mobile-header-title is-full-height is-flex is-align-items-center is-flex-shrink-0"><div class="is-full-height hidden" id="postTopicMobile"><p class="is-full-height">椭圆曲线密码学背后的数学</p></div></div></div><i class="iconfont icon-icon_search mobile-header-searchIcon"></i><div class="mobile-search-wrap"><div class="search-input"><input class="pl-3" id="mobile-search-input" placeholder="请输入搜索关键词"><i class="iconfont icon-icon_search mobile-search-input-btn"></i><button class="mobile-search-input-btn">搜 索</button></div></div></header><div class="mobile-slide-menu"><a class="header-activity" href="/">首页</a><a href="/archives">全站目录</a><a href="/tags">标签</a><a href="/maps">地图</a><a href="/mempool">mempool</a><a target="_blank" rel="noopener" href="https://123btc.org/">123btc</a><div><p class="slide-menu-theme is-flex is-flex-direction-row is-justify-content-space-between is-align-items-center"><span>主题设置</span><span><i class="iconfont icon-icon_light slide-theme-light hidden"></i><i class="iconfont icon-icon_dark slide-theme-dark hidden"></i></span></p><p class="slide-menu-fontsize"><span>字体设置</span><span><i class="iconfont icon-bianzubeifen"></i><i class="iconfont icon-bianzu"></i></span></p></div></div><div class="search-mask hidden"><script src="/js/header.js?v=1675433295305"> </script></div><main><main class="container is-max-widescreen content section post-page pt-4"><div class="columns is-flex-desktop is-justify-content-center"><div class="column is-3 silde-bar is-hidden-mobile"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BC%95%E8%A8%80"><span class="toc-text">引言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AC%E9%92%A5%E5%AF%86%E7%A0%81%E5%AD%A6"><span class="toc-text">公钥密码学</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A4%AD%E5%9C%86%E6%9B%B2%E7%BA%BF%E5%AF%86%E7%A0%81%E5%AD%A6"><span class="toc-text">椭圆曲线密码学</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%82%B9%E5%8A%A0%E6%B3%95"><span class="toc-text">点加法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BF%AB%E9%80%9F%E7%82%B9%E5%8A%A0%E6%B3%95"><span class="toc-text">快速点加法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A4%AD%E5%9C%86%E6%9B%B2%E7%BA%BF%E5%AF%86%E7%A0%81%E5%AD%A6%E4%B8%AD%E7%9A%84%E7%A7%81%E9%92%A5%E5%92%8C%E5%85%AC%E9%92%A5"><span class="toc-text">椭圆曲线密码学中的私钥和公钥</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A7%81%E9%92%A5%E5%92%8C%E5%85%AC%E9%92%A5"><span class="toc-text">私钥和公钥</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9B%B4%E6%96%B0%E7%9A%84%E6%A4%AD%E5%9C%86%E6%9B%B2%E7%BA%BF%E6%A8%A1%E5%9E%8B"><span class="toc-text">更新的椭圆曲线模型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E8%AF%81%E6%98%8E%E4%BD%A0%E7%9F%A5%E9%81%93-x"><span class="toc-text">如何证明你知道 x</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9C%A8%E8%BF%99%E4%B8%AA%E8%BF%87%E7%A8%8B%E4%B8%AD%EF%BC%8C%E4%BD%A0%E7%9C%9F%E7%9A%84%E6%B2%A1%E6%9C%89%E6%9A%B4%E9%9C%B2%E5%85%B3%E4%BA%8E-x-%E7%9A%84%E4%BF%A1%E6%81%AF%E5%90%97%EF%BC%9F"><span class="toc-text">在这个过程中，你真的没有暴露关于 x 的信息吗？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E5%AD%97%E7%AD%BE%E5%90%8D"><span class="toc-text">数字签名</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%93%E8%AE%BA"><span class="toc-text">结论</span></a></li><li class="toc-item toc-level-2"><a class="toc-link"><span class="toc-text"></span></a></li></ol></div><div class="column is-9 post-container"><h1 class="mt-0 mb-2" id="postTitle">椭圆曲线密码学背后的数学</h1><div class="page-author"><div class="is-flex is-flex-direction-row page-data mr-6"><img class="mr-1" src="//res.btcstudy.org/btcstudy/images/default_avatar.png" alt="Hans Knutson"><div class="page-author-info"><strong>Hans Knutson</strong><time class="has-text-grey" datetime="2022-02-12T12:56:30.000Z">2022-02-12</time></div></div><div class="is-flex"><a href="/tags/%E5%AF%86%E7%A0%81%E5%AD%A6"><i class="page-tag mr-1 px-1">密码学<!-- 订正图片路径--></i></a></div></div><article class="mt-4 post-content"><blockquote>
<p><em>作者：Hans Knutson</em></p>
<p><em>来源：<a target="_blank" rel="noopener" href="https://hackernoon.com/what-is-the-math-behind-elliptic-curve-cryptography-f61b25253da3">https://hackernoon.com/what-is-the-math-behind-elliptic-curve-cryptography-f61b25253da3</a></em></p>
</blockquote>
<p><img src="//res.btcstudy.org/btcstudy/images/what-is-the-math-behind-elliptic-curve-cryptography/w=3840&q=75" alt="image"></p>
<h2 id="引言"><a href="#引言" class="headerlink" title="引言"></a>引言</h2><p>某人要给你发送比特币时，他们是把比特币发送到你的地址上。要是你想花费你的地址上的这些比特币，你需要创建一笔交易来指定把比特币发送到哪里。一笔交易的含义就像下文：</p>
<pre><code class="python">从 1A1zP1eP5QGefi2DMPTfTL5SLmv7DivfNa（你的地址）转移 5 BTC 到 12c6DSiU4Rq3P4ZxziKxzrL5LmMBrzjrJX（收款人地址）
</code></pre>
<p>当然，任何人都能创建出上面这样的交易，所以，如果区块链会径直接受这种形式的交易，那无论是谁发起了它，你地址里面的 5 个比特币就会不翼而飞。幸运的是，区块链不会接受这种形式的交易，因为它缺少一个有效的数字签名（digital signature）。数字签名是用来证明你知道这个地址 <code>1A1zP1eP5QGefi2DMPTfTL5SLmv7DivfN</code> 对应的私钥的，如果你不知道对应的私钥，那 —— 你就不应该让人把钱发到这个地址，因为你没法花费其中的比特币！</p>
<p>你在给自己创建一个比特币地址（或者创建任意某种密码学货币的 地址&#x2F;账户 时），你要先生成一个私钥。使用私钥，你可以计算出相应的公钥，并通过公钥哈希和转码生成相应的地址。幸好你不能先选择地址然后反向算出它的私钥，不然你就可以用同样的方法解出任何地址的私钥了。那还有 “账户” 这回事吗？</p>
<h2 id="公钥密码学"><a href="#公钥密码学" class="headerlink" title="公钥密码学"></a>公钥密码学</h2><p>公钥、私钥和数字签名，都是来自公钥密码学的基本概念。不论使用什么数学原理来实现一种公钥密码系统，它都必须满足下列属性（至少就我们的使用目的而言）：</p>
<ol>
<li>从给定的公钥倒推出相应的私钥在计算上是不可行的。</li>
<li>无需揭晓关于私钥的信息，就能证明一个人知道对应于某个公钥的私钥。进一步地，这样的证明可以被构造成需要结合一条具体的消息来验证。如此一来，这个证据就成了那条消息的数字签名。</li>
</ol>
<p>打造公钥密码学的其中一种方法就是椭圆曲线。另一种办法是 RSA，它是围绕质数的。大部分的密码学货币 —— 包括比特币和以太坊 —— 都使用椭圆曲线，因为一个 256 位的椭圆曲线私钥跟一个 3072 位的 RSA 私钥的安全性相当。体积更小的私钥更易于管理和使用。</p>
<h2 id="椭圆曲线密码学"><a href="#椭圆曲线密码学" class="headerlink" title="椭圆曲线密码学"></a>椭圆曲线密码学</h2><p>那什么是椭圆曲线呢？一条椭圆曲线由满足下列形式的等式的所有点构成：</p>
<p>$$<br>y^2 &#x3D; x^3 + ax + b<br>$$</p>
<p>同时 $4a^3 + 27b^2 \neq 0$ （这是为了避免奇点（<a target="_blank" rel="noopener" href="http://mathworld.wolfram.com/SingularPoint.html">singular points</a>））。</p>
<p>下面是一些椭圆曲线的例子：</p>
<p><img src="//res.btcstudy.org/btcstudy/images/what-is-the-math-behind-elliptic-curve-cryptography/KR2oOUS.gif" alt="img"></p>
<p>注意，上面所有的椭圆曲线都是 X 轴对称的。实际上，所有的椭圆曲线都如此，这是其形式所决定的。</p>
<p>$$<br>y^2 &#x3D; x^3 + ax + b<br>$$</p>
<p>如果你取等式两边的平方根，就可以得到：</p>
<p>$$<br>y &#x3D; \pm \sqrt{x^3 + ax + b}<br>$$</p>
<p>所以，如果取 a 为 27 而 b 为 2， 那么插入 x &#x3D; 2 时，可得 y &#x3D; ±8，也就是两个点 （2, -8）和（2, 8）。</p>
<p>下面这个椭圆曲线是比特币、以太坊等项目使用的椭圆曲线，叫做 “secp256k1”。这条曲线的等式是 $y^2 &#x3D; x^3 + 7$，图像是：</p>
<p><img src="//res.btcstudy.org/btcstudy/images/what-is-the-math-behind-elliptic-curve-cryptography/y-25fnw.png" alt="img"></p>
<p>中本聪选择 spec256k1 <a target="_blank" rel="noopener" href="https://bitcointalk.org/index.php?topic=2699.msg37328#msg37328">并无特殊的理由</a>。</p>
<h2 id="点加法"><a href="#点加法" class="headerlink" title="点加法"></a>点加法</h2><p>你肯定知道如何把两个数相加，得出第三个数吧？在椭圆曲线上，你可以把两个点相加，得出第三个点。</p>
<p>要在一条椭圆曲线上把两个点相加，你先要找出一条穿过这两个点的直线。然后，这条直线与椭圆曲线的交点就是第三个点，最后，这个点跟 x 轴的对称点（也即其 y 坐标值乘以 -1 ）即是两个点相加的结果。</p>
<p>我们来举个例子，假设我们要把下图所示的两个点相加：</p>
<p><img src="//res.btcstudy.org/btcstudy/images/what-is-the-math-behind-elliptic-curve-cryptography/XHYHMwA.png" alt="img"></p>
<p>首先，作出一条穿过这两个点的直线：</p>
<p><img src="//res.btcstudy.org/btcstudy/images/what-is-the-math-behind-elliptic-curve-cryptography/tbWnA3w.png" alt="img"></p>
<p>然后找出这条直线与椭圆曲线相交的点（第三个点）：</p>
<p><img src="//res.btcstudy.org/btcstudy/images/what-is-the-math-behind-elliptic-curve-cryptography/29JSqVw.png" alt="img"></p>
<p>最后，找出与该点 x 轴对称的点：</p>
<p><img src="//res.btcstudy.org/btcstudy/images/what-is-the-math-behind-elliptic-curve-cryptography/-Rtyb7w.png" alt="img"></p>
<p>所以，P + Q &#x3D; R。</p>
<p>为了方便实现椭圆曲线密码学，我们不是把两个点相加，而是在曲线上定义一个基本点，总是让这个点与自身相加。</p>
<p>举个例子，假设我们在下列曲线上有基本点 P：</p>
<p><img src="//res.btcstudy.org/btcstudy/images/what-is-the-math-behind-elliptic-curve-cryptography/9B2-krA.png" alt="img"></p>
<p>自然，我们就有了 P，或者说 1·P。</p>
<p>现在，我们让 P 与自身相加。首先，我们找出一个过 P 和 P 的直线（及其等式）。这样的直线有无数条！所以，在这种特殊的情形中，我们选择 P 点上椭圆曲线的切线：</p>
<p><img src="//res.btcstudy.org/btcstudy/images/what-is-the-math-behind-elliptic-curve-cryptography/fz9jibw.png" alt="img"></p>
<p>现在，我们可以找出 “第三点” 并通过 x 轴对称找到结果：</p>
<p><img src="//res.btcstudy.org/btcstudy/images/what-is-the-math-behind-elliptic-curve-cryptography/G1HIJXw.png" alt="img"></p>
<p>这就是 P 与自身相加的结果，P + P 或者说 2·P。</p>
<p>如果我们使之再与 P 相加，那是让 P 加上自身再加上自身，结果就是 3·P。为了计算 3·P，我们直接让两点相加即可：</p>
<p><img src="//res.btcstudy.org/btcstudy/images/what-is-the-math-behind-elliptic-curve-cryptography/1Bn7TIQ.png" alt="img"></p>
<p>我们可以继续加下去，得出 4·P、5·P，等等。</p>
<p>secp256k1 所用的基本点的 x 坐标值和 y 坐标值为：</p>
<p>x 坐标值：55066263022277343669578718895168534326250603453777594175500187360389116729240</p>
<p>y 坐标值：32670510020758816978083085130507043184471273380659243275938904335757337482424</p>
<p>在上面的例子中，我们为了让所有的点都能在一个小窗口中显示，所以使用了不同的基本点。</p>
<h2 id="快速点加法"><a href="#快速点加法" class="headerlink" title="快速点加法"></a>快速点加法</h2><p>如果你要计算 10·P，需要多少步呢？直觉来看，需要 9 步，因为 10·P 等于：</p>
<p>P + P + P + P + P + P + P + P + P + P</p>
<p>需要 9 次点加法。</p>
<p>但事实证明，你只需 4 步就可以计算 10·P，因为点加法满足下列属性：</p>
<p>n•P + r•P &#x3D; (n + r)•P</p>
<p>举个例子：</p>
<p>4•P + 6•P &#x3D; (4 + 6)•P &#x3D; 10•P</p>
<p>那么，你可以这样计算 10·P：</p>
<p>P + P &#x3D; 2•P</p>
<p>2•P + 2•P &#x3D; 4•P</p>
<p>4•P + 4•P &#x3D; 8•P</p>
<p>2•P + 8•P&#x3D;10•P</p>
<p>这就只需要 4 次点加法。</p>
<p>那么，计算 x·P 需要多少步呢？x 是一个随机的 256 位整数，在我们这个例子中，x 的取值范围是从 0 到 1.1579209e+77。</p>
<p>事实又证明，你计算 x·P 最多只需要 510 次的点加法运算。解释一下：首先，你计算下列值：</p>
<p>2⁰•P、2¹•P、2²•P、2³•P、2⁴•P、2⁵•P、2⁶•P、…、2²⁵⁵•P</p>
<p>你可以用 255 次点加法计算出上面的所有值，因为这里有 256 个点，而你只要将前一个点与自身相加就可以得到后一个点。这是因为 $2^n•P + 2^n•P &#x3D; 2^{n+1}•P$。</p>
<p>下一步就是找出 x 的二进制表示。举个例子，如果 x 是 246，那么其二进制展开就是 2⁷ + 2⁶ + 2⁵ + 2⁴ +2² + 2¹ &#x3D; 246 。那么，我们就可以使用其二进制展开式来计算 246·P 的结果：2⁷•P + 2⁶•P + 2⁵•P + 2⁴•P + 2²•P + 2¹•P。我们不再需要一个一个点计算，因为这些点我们都提前算好了。</p>
<p>因为 x 的二进制展开式最多包含 256 个元素（从 2⁰ 到 2²⁵⁵），所以我们最多只需要把 256 个点相加，因此，最多只需要 255 次点加法。因此，总的来说，计算 x·P 最多只需要 510 次点加法。</p>
<h2 id="椭圆曲线密码学中的私钥和公钥"><a href="#椭圆曲线密码学中的私钥和公钥" class="headerlink" title="椭圆曲线密码学中的私钥和公钥"></a>椭圆曲线密码学中的私钥和公钥</h2><p>假设我们要计算 x·P，而 x 是一个 256 位的随机整数。结果将是椭圆曲线上的一个点，我们称为点 X。</p>
<p>如果我给你 X，你能计算出 x 来吗？换句话来说，你能确定我相加了几次 P 来得到 X 吗？假设你是知道 P，也知道我使用的是哪条曲线。</p>
<p>事实证明，即使你拥有一台超级计算机，计算出 x 也是不可行的。没有已知的算法能计算出 x，所以你的唯一解法便是不断把 P 与自身相加，直至获得 X，或者从 X 中持续减去 P，直到结果就是 P。 x 是 0 到 2²⁵⁶-1 之间的某个数，所以其平均值为 2¹²⁸；因此，你需要做平均 2¹²⁸ 次点加法来求得 x。即使你的计算机可以每秒做 10000 亿次点加法，你从宇宙初创的那一刻开始跑计算机，到今天你也只能完成  2⁹⁸ 次点加法。而 2⁹⁸&#x2F;2¹²⁸ &#x3D;1&#x2F;1073741824。</p>
<p>从正中间开始会不会快一点呢？比如，不到 510 步就能先算出 2¹²⁸•P。嗯，因为平均而言，x 接近 2¹²⁸ 的概率并不比它接近 0 或者 2²⁵⁶-1 的概率更大，它是随机分布的，所以你从哪里开始，结果都是一样的。平均而言你还是必须做 2¹²⁸ 次点加法。</p>
<h2 id="私钥和公钥"><a href="#私钥和公钥" class="headerlink" title="私钥和公钥"></a>私钥和公钥</h2><p>所以，因为别人无法根据给定的 X 求得 x（X &#x3D; x·P），所以 x 很适合用作你的私钥，而 X 就是你的公钥。因此，你的私钥是一个 256 位的随机整数，而公钥则是椭圆曲线上的点的 x 坐标值和 y 坐标值。这就满足了私钥和公钥所需的属性：</p>
<p>“从给定的公钥中推导出对应的私钥在计算上是不可行的”。</p>
<p>此外，虽然我们还没解释过，但确实，你可以无需揭示任何关于 x 的有用信息，就向别人证明你知道 x。也就是说，你可以向别人证明，你知道 P 与自身相加多少次可以得到 X，而无需告诉他们 x 到底是多少。</p>
<h2 id="更新的椭圆曲线模型"><a href="#更新的椭圆曲线模型" class="headerlink" title="更新的椭圆曲线模型"></a>更新的椭圆曲线模型</h2><p>在我们向其他人证明自己知道 x 之前，我们需要更新我们的椭圆曲线模型。</p>
<p>我们当前的模型的一个问题在于，x·P 的结果的 x 坐标值和 y 坐标值可能过大，无法存储在一个标准的 512 位的公钥中。x 坐标值和 y 坐标值都有可能过大。</p>
<p>接近方案是将我们的椭圆曲线定义在一个有限域上。基本上，就是确保只有椭圆曲线上只有整数点，而且这个点的坐标值是有上限的。</p>
<p>为达成这个目标，我们将等式</p>
<p>$$<br>y^2 &#x3D; x^3 + ax + b<br>$$</p>
<p>转化成：</p>
<p>公式</p>
<p>y<sup>2</sup> mod p &#x3D; (x<sup>3</sup> + ax + b) mod p</p>
<p>p 是某个指数（p 必须是质数，以保证加法和乘法总是能被还原（can always be undone））。</p>
<p>在 secp256k1 中， p 是小于 2²⁵⁶ 的最大质数。</p>
<p>我们的椭圆曲线因此看起来就像这样：</p>
<p><img src="//res.btcstudy.org/btcstudy/images/what-is-the-math-behind-elliptic-curve-cryptography/K08U75g.png" alt="img"></p>
<p>注意，这里依然有一条水平的对称线。</p>
<p>那么，现在你想把两个点相加，穿过这两个点的直线在跟第三个点相交之前就会飞到值域之外，那怎么办呢？让线从另一边开始继续延伸！</p>
<p><img src="//res.btcstudy.org/btcstudy/images/what-is-the-math-behind-elliptic-curve-cryptography/C-NbSpw.png" alt="img"></p>
<p>如上图所示，你会发现，把 P 跟 Q 相加需要让 P 跟 Q 之间的线来回环绕多次。</p>
<p>除了这个变化，其余东西都暂时不需要改变。</p>
<h2 id="如何证明你知道-x"><a href="#如何证明你知道-x" class="headerlink" title="如何证明你知道 x"></a>如何证明你知道 x</h2><p>现在，你算出了 X &#x3D; x·P，而 x 是一个 256 位的整数，你如何证明你知道对应于 X 的 x，且无需暴露关于 x 的任何有用信息呢？</p>
<p>你可以使用我们前面提到的点加法的属性：</p>
<p>n•P + r•P &#x3D; (n + r)•P</p>
<p>稍微修改一下，可得：</p>
<p>hash(m, r•P)•n•P + r•P &#x3D; (hash(m, r•P)*n + r)•P</p>
<p>你把方程的右半部分展开，就可以得到左边的部分，所以它对任意的 m、r 和 n，都是成立的。</p>
<p>那，不如我们令 n·P &#x3D; X？这样就有：</p>
<p>hash(m, r•P)•X + r•P &#x3D; (hash(m, r•P)*n + r)•P</p>
<p>如果 n·P &#x3D; X，那 n 就等于 x，再转写一下，就是：</p>
<p>hash(m, r•P)•X + r•P &#x3D; (hash(m, r•P)*x + r)•P</p>
<p>最后，我们做一下代换，令 R &#x3D; r·P、 s &#x3D; hash(m, R) * x + r 。</p>
<p>于是：</p>
<p> hash(m, R)•X + R &#x3D; s•P</p>
<p>那么，我们再来回顾这个命题：如果你能提供一组 m、R 和 s，满足上述方程，那就能证明你知道对应于 X 的 x，即 x·P &#x3D; X 。</p>
<p>要使该命题为真，需要满足两个前提：</p>
<ol>
<li>只要你知道 x，那你就能提供合适的 m、R 和 s 值来满足上述方程</li>
<li>如果你不知道 x，那么你不可能找出满足上述方程的 m、R 和 s</li>
</ol>
<p>如果你知道 x，显然你可以找出可以满足上述方程的值。选择随机的 m 和 r，然后计算 R &#x3D; r·P，然后 s &#x3D; hash(m, R) * x + r，代入方程  hash(m, R)•X + R &#x3D; s•P，可得：</p>
<p>hash(m, r•P)•n•P + r•P &#x3D; (hash(m, r•P)*n + r)•P</p>
<p>正是我们前面说的，对任意 m、r 和 n（在我们这里就是 x）都成立的等式。</p>
<p>那要是你不知道 x 呢？你可以计算出能满足上述方程的 m、R 和 s 吗？问题就在于，你要解出 hash(m,R)•X + R &#x3D; s•P。基本上，你这是要找出一个哈希值的原像，而这是不可能的，至少在计算上是不可行的，因为密码学哈希函数有<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Preimage_attack">原像攻击抗性</a>。</p>
<p>因此，唯一能够提供有效的 m、R 和 s 值的方法就是使用 x 来计算它们。因此，你可以通过提供满足等式  hash(m, R)•X + R &#x3D; s•P 的 m、R 和 s 值来证明你知道 x。</p>
<h2 id="在这个过程中，你真的没有暴露关于-x-的信息吗？"><a href="#在这个过程中，你真的没有暴露关于-x-的信息吗？" class="headerlink" title="在这个过程中，你真的没有暴露关于 x 的信息吗？"></a>在这个过程中，你真的没有暴露关于 x 的信息吗？</h2><p>如果你已经提供了有效的 m、R 和 s，别人能从中知道关于 x 的有效信息吗？</p>
<p>m 和 R 都跟 x 无关，所以这些值不会暴露关于 x 的有效信息。</p>
<p>而我们知道，s &#x3D; hash(m, R) * x + r 。能不能从 s 中计算出 x 呢？</p>
<p>这就是在讨论，我们能否解出  x &#x3D; (s-r)&#x2F;hash(m, R) 。</p>
<p>因为我们不知道 r，所以无法从 s 中计算出 x。而我们也无法从 R &#x3D; r·P 中计算出 r，因为这就是想知道 P 与自己相加多少次能得到 R，也就是想从 X 中知道 x，在计算上是不可能的。</p>
<p>s 也不会暴露关于 x 的信息（比如 “x 必然小于 bala bala”）。如果 r 是随机生成的，而我们允许 hash(m, R) * x + r 溢出使得 r 可以是任何 256 位的整数，那么 s 的值就是完全随机的，s 可以是任何 256 位的整数。一个随机的 256 位整数，所蕴含的有关 x 的信息，恐怕就跟新西兰的 GDP 所蕴含的一样多。</p>
<h2 id="数字签名"><a href="#数字签名" class="headerlink" title="数字签名"></a>数字签名</h2><p>m、R 和 s 可以用来证明某人知道相应于 X 的 x（X &#x3D; x·P）。验证这个证据需要把 m、R 和 s 代入等式 hash(m,R)•X + R &#x3D; s•P。那么，我们是否能然验证依赖于一条特定的消息，使得这个证据 —— m、R 和 s —— 变成对该消息的一个数字签名？当然可以！</p>
<p>假设 m 就是那条消息，而 R 和 s 就是这条消息的数字签名。验证将仅在这条消息，也即是 m，代入验证等式之时，才会成功。如果代入的是另一条消息，则左右两边将不相等，因为计算 s 所用的 m 值与代入得消息不等。</p>
<p>因此，你可以通过提供一个数字签名 R 和 s，以及相应的消息 m，来证明你知道相应于公钥 X 的私钥 x。</p>
<p>在密码学货币中，这个消息就是一笔交易的待签名的部分。一条交易的数字签名，通常是 R 的 x 坐标值后面跟着 s（R 是椭圆曲线上的一个点，s 是近乎随机的 256 位整数），然后还要编码成十六进制的形式。</p>
<p>（译者注：作者在此处解释的数字签名方案，并不是比特币和以太坊一开始使用的 ECDSA 签名，而是一种叫做 “Schnorr 签名” 的方案（的简化版）。在 2021 年 12 月以前，比特币上也无法使用 Schnorr 签名，而只能使用 ECDSA 签名；2021 年 12 月，比特币激活 taproot 升级，该升级便引入了 Schnorr 签名，从此比特币交易可以使用 Schnorr 签名方案了。）</p>
<h2 id="结论"><a href="#结论" class="headerlink" title="结论"></a>结论</h2><p>如果你想获得一个比特币地址或者以太坊账户，你只需生成一个随机的 256 位整数 x，x 就是你的私钥。然后你使用 secp256k1 的参数就可以计算出公钥 X &#x3D; x·P。你的公钥可以放心地展示给别人，无法用来反算出你的私钥。再对公钥哈希计算，就得到了地址。</p>
<p>（译者注：以太坊的地址确实是这样得出来地，但是比特币的地址需要经过更多的编码步骤，不过原理上是差不多的）。</p>
<p>当你想把自己地址里的比特币发给其他人时，你要创建一笔比特币交易。把交易的待签名部分设置成 m，并使用该 m 计算出 R 和 s。然后在交易中附加上 R 和 s。在你把这笔交易广播到比特币网络中以后，收到交易的节点会验证 m（交易的待签名部分）、R 和 s 满足等式 hash(m,R)•X + R &#x3D; s•P。当然，这也假设了你要在交易中提供 X，因为你的公钥无法从地址中推测出来。在以太坊交易中，你无需提供 X，可以提供 v，v 可用来从 R 和 s 中计算出 X。</p>
<p>（译者注：再次提醒，作者解释的并不是 ECDSA 签名算法，而是 Schnorr 签名算法，该算法在 2021 年 12 月之后才能在比特币上使用。）</p>
<p>（完）</p>
<h2 id=""><a href="#" class="headerlink" title=""></a></h2></article></div></div></main><script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.8/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><script>MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [ ['$','$'], ["\\(","\\)"] ],
    processEscapes: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
  }
});
MathJax.Hub.Queue(function() {
  var all = MathJax.Hub.getAllJax(), i;
  for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
  }
});</script><script src="/js/post.js?v=1675433295305"></script><script src="/js/highlight.min.js?v=1675433295305"></script><script>var containerEl = document.querySelector('.post-container');
var postFontSize = localStorage.getItem('post-font-size') || '16';
var inputEl = document.querySelector('#size-change-input');
var inputEl2 = document.querySelector('#size-change-input2');
inputEl.value = postFontSize;
inputEl2.value = postFontSize;
containerEl.style.fontSize = postFontSize + 'px';
$(function(){
  function setSizeChangeInputValue(size) {
    $('.post-container').css('font-size', size + 'px');
    localStorage.setItem('post-font-size', size);
    $('#size-change-input').val(size);
    $('#size-change-input2').val(size);
  }
  $('#size-change-input').on('input propertychange', function(e) {
    const size = e.target.value;
    setSizeChangeInputValue(size);
  });
  $('#size-change-input2').on('input propertychange', function(e) {
    const size = e.target.value;
    setSizeChangeInputValue(size);
  });
});
</script><script>hljs.initHighlightingOnLoad();</script></main></div><footer class="is-flex is-flex-direction-column is-align-items-center is-flex-shrink-0"><section class="sns-container"><a title="twitter" target="_blank" rel="noopener nofollow" href="//twitter.com/btcstudy">Twitter</a><!-- Github--><!-- Ins--><!-- RSS--><a title="rss" target="_blank" rel="noopener nofollow" href="/atom.xml">rss</a><!-- 知乎--><!-- 领英--><!-- 脸书--><!-- Telegram--><a title="telegram" target="_blank" rel="noopener nofollow" href="//t.me/btcstudyorg">Telegram</a></section></footer><script async src="/js/buttons.js?v=1675433295305"></script><script async src="/js/index.js?v=1675433295305"></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-JVCJ9XXG1Z"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());

gtag('config', 'G-JVCJ9XXG1Z');</script><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?c92c073c85be5be8d9b1b76f62a7e306";
  hm.async = true;
  hm.defer = true;
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
  </script></body></html>