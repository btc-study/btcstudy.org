<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><title>使用时间锁重新想象冷存储</title><meta name="keywords" content="比特币, 中本聪, 比特币区块链, 闪电网络, 比特币 layer 2, 健全货币, 密码货币, 密码朋克, 学习比特币, BTC, BTC Study, Bitcoin, bitcoin, proof of work"><meta name="description" content="比特币思想的中文集结地"><meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, initial-scale=1"><link rel="icon" href="/favicon.ico"><link rel="stylesheet" href="/style/common/bulma.css?v=1675838663872"><link rel="preload" as="style" onload="this.onload=null;this.rel='stylesheet'" href="/style/common/iconfont.css?v=1675838663872"><link rel="stylesheet" href="/style/base.css?v=1675838663872"><link rel="stylesheet" href="/style/common/helper.css?v=1675838663872"><link rel="stylesheet" href="/style/themes/animation.css?v=1675838663872"><script>function ready() {
  var bodyEl = document.querySelector('.body-container');
  var theme = localStorage.getItem('theme') || 'light';
  if (!['light', 'dark'].includes(theme)) {
    theme = 'light';
    localStorage.setItem('theme', 'light');
  }
  bodyEl.classList.remove('appearance-auto');
  bodyEl.classList.add('appearance-' + theme);
  quickInitialTheme();
}
function quickInitialTheme() {
  var theme = localStorage.getItem('theme') || 'light';
  var logoLightEl = document.querySelector('.logo-light');
  var logoDarkEl = document.querySelector('.logo-dark');
  
  var mLogoLightEl = document.querySelector('#mobile-header-logo > .logo-light');
  var mLogoDarkEl = document.querySelector('#mobile-header-logo > .logo-dark');
  var themeBtnEl = document.getElementById('theme-btn');
  
  var slideThemeLightEl = document.querySelector('.slide-theme-light');
  var slideThemeDarkEl = document.querySelector('.slide-theme-dark');
  
  document.body.classList.add(theme);
  if (theme === 'dark') {
    logoLightEl.classList.add('hidden');
    logoDarkEl.classList.remove('hidden');
    
    mLogoLightEl.classList.add('hidden');
    mLogoDarkEl.classList.remove('hidden');
    
    themeBtnEl.classList.remove('icon-icon_dark');
    themeBtnEl.classList.add('icon-icon_light');
    
    slideThemeLightEl.classList.remove('hidden');
  } else {
    slideThemeDarkEl.classList.remove('hidden');
  }
}
document.addEventListener("DOMContentLoaded", ready);</script><script src="/js/common.js?v=1675838663872"></script><script src="/js/libs/zepto.min.js"></script><link rel="stylesheet" href="/style/post.css?v=1675838663872"><link rel="stylesheet" href="/style/themes/highlight.css?v=1675838663872"><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="BTC Study" type="application/atom+xml">
</head><body class="is-flex is-flex-direction-column" onload="initialTheme()"><div class="clip"></div><div class="body-container appearance-auto"><header class="header-widget is-hidden-mobile is-flex is-flex-shrink-0 is-align-items-center is-justify-content-center" id="header"><div class="is-flex header-widget-container is-flex-shrink-0 is-align-items-center"><section class="is-hidden-mobile is-flex-shrink-0"><h1><a href="/"><svg class="logo-light" width="125px" height="23px" viewBox="0 0 125 23" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>BTCStudy</title><g id="页面-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="首页-响应式" transform="translate(-249.000000, -23.000000)" fill-rule="nonzero"><g id="BTCStudy" transform="translate(249.680000, 23.192000)"><path d="M9.072,17.808 C11.312,17.808 13.024,17.408 14.208,16.608 C15.392,15.808 15.984,14.672 15.984,13.2 C15.984,12.192 15.712,11.332 15.168,10.62 C14.624,9.908 13.872,9.384 12.912,9.048 C13.632,8.68 14.188,8.18 14.58,7.548 C14.972,6.916 15.168,6.2 15.168,5.4 C15.168,4.056 14.608,2.988 13.488,2.196 C12.368,1.404 10.736,1.008 8.592,1.008 L8.592,1.008 L-5.68434189e-14,1.008 L-5.68434189e-14,17.808 L9.072,17.808 Z M7.968,7.68 L4.704,7.68 L4.704,4.44 L7.968,4.44 C9.568,4.44 10.368,4.976 10.368,6.048 C10.368,7.136 9.568,7.68 7.968,7.68 L7.968,7.68 Z M8.688,14.376 L4.704,14.376 L4.704,10.968 L8.688,10.968 C10.352,10.968 11.184,11.536 11.184,12.672 C11.184,13.808 10.352,14.376 8.688,14.376 L8.688,14.376 Z M26.544,17.808 L26.544,4.776 L31.68,4.776 L31.68,1.008 L16.632,1.008 L16.632,4.776 L21.792,4.776 L21.792,17.808 L26.544,17.808 Z M41.592,18.144 C43.128,18.144 44.512,17.872 45.744,17.328 C46.976,16.784 48,16 48.816,14.976 L48.816,14.976 L45.792,12.24 C44.704,13.552 43.384,14.208 41.832,14.208 C40.92,14.208 40.108,14.008 39.396,13.608 C38.684,13.208 38.132,12.644 37.74,11.916 C37.348,11.188 37.152,10.352 37.152,9.408 C37.152,8.464 37.348,7.628 37.74,6.9 C38.132,6.172 38.684,5.608 39.396,5.208 C40.108,4.808 40.92,4.608 41.832,4.608 C43.384,4.608 44.704,5.264 45.792,6.576 L45.792,6.576 L48.816,3.84 C48,2.816 46.976,2.032 45.744,1.488 C44.512,0.944 43.128,0.672 41.592,0.672 C39.832,0.672 38.252,1.044 36.852,1.788 C35.452,2.532 34.352,3.568 33.552,4.896 C32.752,6.224 32.352,7.728 32.352,9.408 C32.352,11.088 32.752,12.592 33.552,13.92 C34.352,15.248 35.452,16.284 36.852,17.028 C38.252,17.772 39.832,18.144 41.592,18.144 Z" id="BTC" fill="#F2A900"></path><path d="M56.64,18.144 C58.24,18.144 59.6,17.9 60.72,17.412 C61.84,16.924 62.68,16.272 63.24,15.456 C63.8,14.64 64.08,13.728 64.08,12.72 C64.08,11.552 63.772,10.628 63.156,9.948 C62.54,9.268 61.812,8.772 60.972,8.46 C60.132,8.148 59.072,7.856 57.792,7.584 C56.656,7.344 55.832,7.112 55.32,6.888 C54.808,6.664 54.552,6.328 54.552,5.88 C54.552,5.432 54.768,5.068 55.2,4.788 C55.632,4.508 56.32,4.368 57.264,4.368 C58.768,4.368 60.32,4.8 61.92,5.664 L61.92,5.664 L63.384,2.136 C62.568,1.656 61.624,1.292 60.552,1.044 C59.48,0.796 58.392,0.672 57.288,0.672 C55.672,0.672 54.308,0.912 53.196,1.392 C52.084,1.872 51.248,2.524 50.688,3.348 C50.128,4.172 49.848,5.096 49.848,6.12 C49.848,7.288 50.152,8.216 50.76,8.904 C51.368,9.592 52.096,10.092 52.944,10.404 C53.792,10.716 54.848,11.008 56.112,11.28 C57.264,11.536 58.1,11.78 58.62,12.012 C59.14,12.244 59.4,12.6 59.4,13.08 C59.4,13.992 58.488,14.448 56.664,14.448 C55.704,14.448 54.728,14.296 53.736,13.992 C52.744,13.688 51.872,13.288 51.12,12.792 L51.12,12.792 L49.56,16.296 C50.36,16.856 51.4,17.304 52.68,17.64 C53.96,17.976 55.28,18.144 56.64,18.144 Z M71.856,18.024 C72.48,18.024 73.068,17.96 73.62,17.832 C74.172,17.704 74.64,17.52 75.024,17.28 L75.024,17.28 L73.896,14.088 C73.496,14.36 73.032,14.496 72.504,14.496 C72.088,14.496 71.756,14.364 71.508,14.1 C71.26,13.836 71.136,13.472 71.136,13.008 L71.136,13.008 L71.136,8.688 L74.112,8.688 L74.112,5.28 L71.136,5.28 L71.136,1.896 L66.576,1.896 L66.576,5.28 L64.68,5.28 L64.68,8.688 L66.576,8.688 L66.576,13.056 C66.576,14.704 67.032,15.944 67.944,16.776 C68.856,17.608 70.16,18.024 71.856,18.024 Z M82.248,18.024 C83,18.024 83.712,17.888 84.384,17.616 C85.056,17.344 85.632,16.944 86.112,16.416 L86.112,16.416 L86.112,17.808 L90.456,17.808 L90.456,4.8 L85.896,4.8 L85.896,11.064 C85.896,12.104 85.668,12.876 85.212,13.38 C84.756,13.884 84.168,14.136 83.448,14.136 C82.744,14.136 82.208,13.912 81.84,13.464 C81.472,13.016 81.288,12.304 81.288,11.328 L81.288,11.328 L81.288,4.8 L76.728,4.8 L76.728,12.072 C76.728,14.056 77.228,15.544 78.228,16.536 C79.228,17.528 80.568,18.024 82.248,18.024 Z M99.048,18.024 C100.744,18.024 102.016,17.52 102.864,16.512 L102.864,16.512 L102.864,17.808 L107.208,17.808 L107.208,0 L102.648,0 L102.648,5.928 C101.8,5.032 100.6,4.584 99.048,4.584 C97.864,4.584 96.784,4.856 95.808,5.4 C94.832,5.944 94.06,6.724 93.492,7.74 C92.924,8.756 92.64,9.936 92.64,11.28 C92.64,12.624 92.924,13.808 93.492,14.832 C94.06,15.856 94.832,16.644 95.808,17.196 C96.784,17.748 97.864,18.024 99.048,18.024 Z M100.008,14.4 C99.208,14.4 98.552,14.124 98.04,13.572 C97.528,13.02 97.272,12.256 97.272,11.28 C97.272,10.32 97.528,9.568 98.04,9.024 C98.552,8.48 99.208,8.208 100.008,8.208 C100.808,8.208 101.46,8.48 101.964,9.024 C102.468,9.568 102.72,10.32 102.72,11.28 C102.72,12.256 102.464,13.02 101.952,13.572 C101.44,14.124 100.792,14.4 100.008,14.4 Z M112.368,22.68 C113.728,22.68 114.88,22.356 115.824,21.708 C116.768,21.06 117.568,19.936 118.224,18.336 L118.224,18.336 L123.84,4.8 L119.496,4.8 L116.28,12.744 L113.088,4.8 L108.408,4.8 L113.976,17.976 C113.784,18.36 113.548,18.64 113.268,18.816 C112.988,18.992 112.632,19.08 112.2,19.08 C111.832,19.08 111.468,19.012 111.108,18.876 C110.748,18.74 110.44,18.552 110.184,18.312 L110.184,18.312 L108.6,21.504 C109.032,21.856 109.596,22.14 110.292,22.356 C110.988,22.572 111.68,22.68 112.368,22.68 Z" id="Study" fill-opacity="0.85" fill="#000000"></path></g></g></g></svg><svg class="logo-dark hidden" width="125px" height="23px" viewBox="0 0 125 23" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>BTCStudy</title><g id="页面-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="首页-响应式" transform="translate(-249.000000, -23.000000)" fill-rule="nonzero"><g id="BTCStudy" transform="translate(249.680000, 23.192000)"><path d="M9.072,17.808 C11.312,17.808 13.024,17.408 14.208,16.608 C15.392,15.808 15.984,14.672 15.984,13.2 C15.984,12.192 15.712,11.332 15.168,10.62 C14.624,9.908 13.872,9.384 12.912,9.048 C13.632,8.68 14.188,8.18 14.58,7.548 C14.972,6.916 15.168,6.2 15.168,5.4 C15.168,4.056 14.608,2.988 13.488,2.196 C12.368,1.404 10.736,1.008 8.592,1.008 L8.592,1.008 L-5.68434189e-14,1.008 L-5.68434189e-14,17.808 L9.072,17.808 Z M7.968,7.68 L4.704,7.68 L4.704,4.44 L7.968,4.44 C9.568,4.44 10.368,4.976 10.368,6.048 C10.368,7.136 9.568,7.68 7.968,7.68 L7.968,7.68 Z M8.688,14.376 L4.704,14.376 L4.704,10.968 L8.688,10.968 C10.352,10.968 11.184,11.536 11.184,12.672 C11.184,13.808 10.352,14.376 8.688,14.376 L8.688,14.376 Z M26.544,17.808 L26.544,4.776 L31.68,4.776 L31.68,1.008 L16.632,1.008 L16.632,4.776 L21.792,4.776 L21.792,17.808 L26.544,17.808 Z M41.592,18.144 C43.128,18.144 44.512,17.872 45.744,17.328 C46.976,16.784 48,16 48.816,14.976 L48.816,14.976 L45.792,12.24 C44.704,13.552 43.384,14.208 41.832,14.208 C40.92,14.208 40.108,14.008 39.396,13.608 C38.684,13.208 38.132,12.644 37.74,11.916 C37.348,11.188 37.152,10.352 37.152,9.408 C37.152,8.464 37.348,7.628 37.74,6.9 C38.132,6.172 38.684,5.608 39.396,5.208 C40.108,4.808 40.92,4.608 41.832,4.608 C43.384,4.608 44.704,5.264 45.792,6.576 L45.792,6.576 L48.816,3.84 C48,2.816 46.976,2.032 45.744,1.488 C44.512,0.944 43.128,0.672 41.592,0.672 C39.832,0.672 38.252,1.044 36.852,1.788 C35.452,2.532 34.352,3.568 33.552,4.896 C32.752,6.224 32.352,7.728 32.352,9.408 C32.352,11.088 32.752,12.592 33.552,13.92 C34.352,15.248 35.452,16.284 36.852,17.028 C38.252,17.772 39.832,18.144 41.592,18.144 Z" id="BTC" fill="#F2A900"></path><path d="M56.64,18.144 C58.24,18.144 59.6,17.9 60.72,17.412 C61.84,16.924 62.68,16.272 63.24,15.456 C63.8,14.64 64.08,13.728 64.08,12.72 C64.08,11.552 63.772,10.628 63.156,9.948 C62.54,9.268 61.812,8.772 60.972,8.46 C60.132,8.148 59.072,7.856 57.792,7.584 C56.656,7.344 55.832,7.112 55.32,6.888 C54.808,6.664 54.552,6.328 54.552,5.88 C54.552,5.432 54.768,5.068 55.2,4.788 C55.632,4.508 56.32,4.368 57.264,4.368 C58.768,4.368 60.32,4.8 61.92,5.664 L61.92,5.664 L63.384,2.136 C62.568,1.656 61.624,1.292 60.552,1.044 C59.48,0.796 58.392,0.672 57.288,0.672 C55.672,0.672 54.308,0.912 53.196,1.392 C52.084,1.872 51.248,2.524 50.688,3.348 C50.128,4.172 49.848,5.096 49.848,6.12 C49.848,7.288 50.152,8.216 50.76,8.904 C51.368,9.592 52.096,10.092 52.944,10.404 C53.792,10.716 54.848,11.008 56.112,11.28 C57.264,11.536 58.1,11.78 58.62,12.012 C59.14,12.244 59.4,12.6 59.4,13.08 C59.4,13.992 58.488,14.448 56.664,14.448 C55.704,14.448 54.728,14.296 53.736,13.992 C52.744,13.688 51.872,13.288 51.12,12.792 L51.12,12.792 L49.56,16.296 C50.36,16.856 51.4,17.304 52.68,17.64 C53.96,17.976 55.28,18.144 56.64,18.144 Z M71.856,18.024 C72.48,18.024 73.068,17.96 73.62,17.832 C74.172,17.704 74.64,17.52 75.024,17.28 L75.024,17.28 L73.896,14.088 C73.496,14.36 73.032,14.496 72.504,14.496 C72.088,14.496 71.756,14.364 71.508,14.1 C71.26,13.836 71.136,13.472 71.136,13.008 L71.136,13.008 L71.136,8.688 L74.112,8.688 L74.112,5.28 L71.136,5.28 L71.136,1.896 L66.576,1.896 L66.576,5.28 L64.68,5.28 L64.68,8.688 L66.576,8.688 L66.576,13.056 C66.576,14.704 67.032,15.944 67.944,16.776 C68.856,17.608 70.16,18.024 71.856,18.024 Z M82.248,18.024 C83,18.024 83.712,17.888 84.384,17.616 C85.056,17.344 85.632,16.944 86.112,16.416 L86.112,16.416 L86.112,17.808 L90.456,17.808 L90.456,4.8 L85.896,4.8 L85.896,11.064 C85.896,12.104 85.668,12.876 85.212,13.38 C84.756,13.884 84.168,14.136 83.448,14.136 C82.744,14.136 82.208,13.912 81.84,13.464 C81.472,13.016 81.288,12.304 81.288,11.328 L81.288,11.328 L81.288,4.8 L76.728,4.8 L76.728,12.072 C76.728,14.056 77.228,15.544 78.228,16.536 C79.228,17.528 80.568,18.024 82.248,18.024 Z M99.048,18.024 C100.744,18.024 102.016,17.52 102.864,16.512 L102.864,16.512 L102.864,17.808 L107.208,17.808 L107.208,0 L102.648,0 L102.648,5.928 C101.8,5.032 100.6,4.584 99.048,4.584 C97.864,4.584 96.784,4.856 95.808,5.4 C94.832,5.944 94.06,6.724 93.492,7.74 C92.924,8.756 92.64,9.936 92.64,11.28 C92.64,12.624 92.924,13.808 93.492,14.832 C94.06,15.856 94.832,16.644 95.808,17.196 C96.784,17.748 97.864,18.024 99.048,18.024 Z M100.008,14.4 C99.208,14.4 98.552,14.124 98.04,13.572 C97.528,13.02 97.272,12.256 97.272,11.28 C97.272,10.32 97.528,9.568 98.04,9.024 C98.552,8.48 99.208,8.208 100.008,8.208 C100.808,8.208 101.46,8.48 101.964,9.024 C102.468,9.568 102.72,10.32 102.72,11.28 C102.72,12.256 102.464,13.02 101.952,13.572 C101.44,14.124 100.792,14.4 100.008,14.4 Z M112.368,22.68 C113.728,22.68 114.88,22.356 115.824,21.708 C116.768,21.06 117.568,19.936 118.224,18.336 L118.224,18.336 L123.84,4.8 L119.496,4.8 L116.28,12.744 L113.088,4.8 L108.408,4.8 L113.976,17.976 C113.784,18.36 113.548,18.64 113.268,18.816 C112.988,18.992 112.632,19.08 112.2,19.08 C111.832,19.08 111.468,19.012 111.108,18.876 C110.748,18.74 110.44,18.552 110.184,18.312 L110.184,18.312 L108.6,21.504 C109.032,21.856 109.596,22.14 110.292,22.356 C110.988,22.572 111.68,22.68 112.368,22.68 Z" id="Study" fill-opacity="0.85" fill="#FFFFFF"></path></g></g></g></svg></a></h1></section><div class="is-flex is-flex-direction-column header-menu-wrap"><aside class="is-flex-shrink-0 is-flex is-flex-direction-row is-align-items-center" id="header-menu"><a class="is-inline-block header-activity mr-4" href="/">首页</a><a class="is-inline-block mr-4" href="/archives">全站目录</a><a class="is-inline-block mr-4" href="/tags">标签</a><a class="is-inline-block mr-4" href="/maps">地图</a><a class="is-inline-block mr-4" href="/mempool">mempool</a><a class="is-inline-block mr-4" target="_blank" rel="noopener" href="https://123btc.org/">123btc</a><div class="right-content is-flex is-flex-direction-row is-align-items-center"><div class="size-wrap mr-1"><i class="iconfont icon-a-bianzu5" id="change-size-btn"></i><div class="size-input-wrap"><div class="input-wrap"><input id="size-change-input" type="range" min="12" max="32" step="2"></div></div></div><i class="iconfont icon-icon_dark mr-1" id="theme-btn"></i><div class="search-wrap"><input class="pl-3" id="search-input" placeholder="请输入搜索关键词"><i class="iconfont icon-icon_search" id="search-input-btn"></i></div></div></aside><div class="header-title is-hidden-mobile is-full-height is-flex is-align-items-center is-flex-shrink-0"><div class="is-full-height hidden" id="postTopic"><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">使用时间锁重新想象冷存储</p><div class="size-wrap mr-1"><i class="iconfont icon-a-bianzu5" id="change-size-btn2"></i><div class="size-input-wrap"><div class="input-wrap"><input id="size-change-input2" type="range" min="12" max="32" step="2"></div></div></div></div></div></div></div></header><header class="is-flex header-widget is-flex-shrink-0 is-align-items-center is-justify-content-space-between is-hidden-tablet" id="mobile-header"><div class="is-flex is-flex-direction-row is-align-items-center"><i class="iconfont icon-icon_bar mobile-header-menu"></i><div id="mobile-header-logo"><svg class="logo-light" width="125px" height="23px" viewBox="0 0 125 23" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>BTCStudy</title><g id="页面-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="首页-响应式" transform="translate(-249.000000, -23.000000)" fill-rule="nonzero"><g id="BTCStudy" transform="translate(249.680000, 23.192000)"><path d="M9.072,17.808 C11.312,17.808 13.024,17.408 14.208,16.608 C15.392,15.808 15.984,14.672 15.984,13.2 C15.984,12.192 15.712,11.332 15.168,10.62 C14.624,9.908 13.872,9.384 12.912,9.048 C13.632,8.68 14.188,8.18 14.58,7.548 C14.972,6.916 15.168,6.2 15.168,5.4 C15.168,4.056 14.608,2.988 13.488,2.196 C12.368,1.404 10.736,1.008 8.592,1.008 L8.592,1.008 L-5.68434189e-14,1.008 L-5.68434189e-14,17.808 L9.072,17.808 Z M7.968,7.68 L4.704,7.68 L4.704,4.44 L7.968,4.44 C9.568,4.44 10.368,4.976 10.368,6.048 C10.368,7.136 9.568,7.68 7.968,7.68 L7.968,7.68 Z M8.688,14.376 L4.704,14.376 L4.704,10.968 L8.688,10.968 C10.352,10.968 11.184,11.536 11.184,12.672 C11.184,13.808 10.352,14.376 8.688,14.376 L8.688,14.376 Z M26.544,17.808 L26.544,4.776 L31.68,4.776 L31.68,1.008 L16.632,1.008 L16.632,4.776 L21.792,4.776 L21.792,17.808 L26.544,17.808 Z M41.592,18.144 C43.128,18.144 44.512,17.872 45.744,17.328 C46.976,16.784 48,16 48.816,14.976 L48.816,14.976 L45.792,12.24 C44.704,13.552 43.384,14.208 41.832,14.208 C40.92,14.208 40.108,14.008 39.396,13.608 C38.684,13.208 38.132,12.644 37.74,11.916 C37.348,11.188 37.152,10.352 37.152,9.408 C37.152,8.464 37.348,7.628 37.74,6.9 C38.132,6.172 38.684,5.608 39.396,5.208 C40.108,4.808 40.92,4.608 41.832,4.608 C43.384,4.608 44.704,5.264 45.792,6.576 L45.792,6.576 L48.816,3.84 C48,2.816 46.976,2.032 45.744,1.488 C44.512,0.944 43.128,0.672 41.592,0.672 C39.832,0.672 38.252,1.044 36.852,1.788 C35.452,2.532 34.352,3.568 33.552,4.896 C32.752,6.224 32.352,7.728 32.352,9.408 C32.352,11.088 32.752,12.592 33.552,13.92 C34.352,15.248 35.452,16.284 36.852,17.028 C38.252,17.772 39.832,18.144 41.592,18.144 Z" id="BTC" fill="#F2A900"></path><path d="M56.64,18.144 C58.24,18.144 59.6,17.9 60.72,17.412 C61.84,16.924 62.68,16.272 63.24,15.456 C63.8,14.64 64.08,13.728 64.08,12.72 C64.08,11.552 63.772,10.628 63.156,9.948 C62.54,9.268 61.812,8.772 60.972,8.46 C60.132,8.148 59.072,7.856 57.792,7.584 C56.656,7.344 55.832,7.112 55.32,6.888 C54.808,6.664 54.552,6.328 54.552,5.88 C54.552,5.432 54.768,5.068 55.2,4.788 C55.632,4.508 56.32,4.368 57.264,4.368 C58.768,4.368 60.32,4.8 61.92,5.664 L61.92,5.664 L63.384,2.136 C62.568,1.656 61.624,1.292 60.552,1.044 C59.48,0.796 58.392,0.672 57.288,0.672 C55.672,0.672 54.308,0.912 53.196,1.392 C52.084,1.872 51.248,2.524 50.688,3.348 C50.128,4.172 49.848,5.096 49.848,6.12 C49.848,7.288 50.152,8.216 50.76,8.904 C51.368,9.592 52.096,10.092 52.944,10.404 C53.792,10.716 54.848,11.008 56.112,11.28 C57.264,11.536 58.1,11.78 58.62,12.012 C59.14,12.244 59.4,12.6 59.4,13.08 C59.4,13.992 58.488,14.448 56.664,14.448 C55.704,14.448 54.728,14.296 53.736,13.992 C52.744,13.688 51.872,13.288 51.12,12.792 L51.12,12.792 L49.56,16.296 C50.36,16.856 51.4,17.304 52.68,17.64 C53.96,17.976 55.28,18.144 56.64,18.144 Z M71.856,18.024 C72.48,18.024 73.068,17.96 73.62,17.832 C74.172,17.704 74.64,17.52 75.024,17.28 L75.024,17.28 L73.896,14.088 C73.496,14.36 73.032,14.496 72.504,14.496 C72.088,14.496 71.756,14.364 71.508,14.1 C71.26,13.836 71.136,13.472 71.136,13.008 L71.136,13.008 L71.136,8.688 L74.112,8.688 L74.112,5.28 L71.136,5.28 L71.136,1.896 L66.576,1.896 L66.576,5.28 L64.68,5.28 L64.68,8.688 L66.576,8.688 L66.576,13.056 C66.576,14.704 67.032,15.944 67.944,16.776 C68.856,17.608 70.16,18.024 71.856,18.024 Z M82.248,18.024 C83,18.024 83.712,17.888 84.384,17.616 C85.056,17.344 85.632,16.944 86.112,16.416 L86.112,16.416 L86.112,17.808 L90.456,17.808 L90.456,4.8 L85.896,4.8 L85.896,11.064 C85.896,12.104 85.668,12.876 85.212,13.38 C84.756,13.884 84.168,14.136 83.448,14.136 C82.744,14.136 82.208,13.912 81.84,13.464 C81.472,13.016 81.288,12.304 81.288,11.328 L81.288,11.328 L81.288,4.8 L76.728,4.8 L76.728,12.072 C76.728,14.056 77.228,15.544 78.228,16.536 C79.228,17.528 80.568,18.024 82.248,18.024 Z M99.048,18.024 C100.744,18.024 102.016,17.52 102.864,16.512 L102.864,16.512 L102.864,17.808 L107.208,17.808 L107.208,0 L102.648,0 L102.648,5.928 C101.8,5.032 100.6,4.584 99.048,4.584 C97.864,4.584 96.784,4.856 95.808,5.4 C94.832,5.944 94.06,6.724 93.492,7.74 C92.924,8.756 92.64,9.936 92.64,11.28 C92.64,12.624 92.924,13.808 93.492,14.832 C94.06,15.856 94.832,16.644 95.808,17.196 C96.784,17.748 97.864,18.024 99.048,18.024 Z M100.008,14.4 C99.208,14.4 98.552,14.124 98.04,13.572 C97.528,13.02 97.272,12.256 97.272,11.28 C97.272,10.32 97.528,9.568 98.04,9.024 C98.552,8.48 99.208,8.208 100.008,8.208 C100.808,8.208 101.46,8.48 101.964,9.024 C102.468,9.568 102.72,10.32 102.72,11.28 C102.72,12.256 102.464,13.02 101.952,13.572 C101.44,14.124 100.792,14.4 100.008,14.4 Z M112.368,22.68 C113.728,22.68 114.88,22.356 115.824,21.708 C116.768,21.06 117.568,19.936 118.224,18.336 L118.224,18.336 L123.84,4.8 L119.496,4.8 L116.28,12.744 L113.088,4.8 L108.408,4.8 L113.976,17.976 C113.784,18.36 113.548,18.64 113.268,18.816 C112.988,18.992 112.632,19.08 112.2,19.08 C111.832,19.08 111.468,19.012 111.108,18.876 C110.748,18.74 110.44,18.552 110.184,18.312 L110.184,18.312 L108.6,21.504 C109.032,21.856 109.596,22.14 110.292,22.356 C110.988,22.572 111.68,22.68 112.368,22.68 Z" id="Study" fill-opacity="0.85" fill="#000000"></path></g></g></g></svg><svg class="logo-dark hidden" width="125px" height="23px" viewBox="0 0 125 23" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>BTCStudy</title><g id="页面-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="首页-响应式" transform="translate(-249.000000, -23.000000)" fill-rule="nonzero"><g id="BTCStudy" transform="translate(249.680000, 23.192000)"><path d="M9.072,17.808 C11.312,17.808 13.024,17.408 14.208,16.608 C15.392,15.808 15.984,14.672 15.984,13.2 C15.984,12.192 15.712,11.332 15.168,10.62 C14.624,9.908 13.872,9.384 12.912,9.048 C13.632,8.68 14.188,8.18 14.58,7.548 C14.972,6.916 15.168,6.2 15.168,5.4 C15.168,4.056 14.608,2.988 13.488,2.196 C12.368,1.404 10.736,1.008 8.592,1.008 L8.592,1.008 L-5.68434189e-14,1.008 L-5.68434189e-14,17.808 L9.072,17.808 Z M7.968,7.68 L4.704,7.68 L4.704,4.44 L7.968,4.44 C9.568,4.44 10.368,4.976 10.368,6.048 C10.368,7.136 9.568,7.68 7.968,7.68 L7.968,7.68 Z M8.688,14.376 L4.704,14.376 L4.704,10.968 L8.688,10.968 C10.352,10.968 11.184,11.536 11.184,12.672 C11.184,13.808 10.352,14.376 8.688,14.376 L8.688,14.376 Z M26.544,17.808 L26.544,4.776 L31.68,4.776 L31.68,1.008 L16.632,1.008 L16.632,4.776 L21.792,4.776 L21.792,17.808 L26.544,17.808 Z M41.592,18.144 C43.128,18.144 44.512,17.872 45.744,17.328 C46.976,16.784 48,16 48.816,14.976 L48.816,14.976 L45.792,12.24 C44.704,13.552 43.384,14.208 41.832,14.208 C40.92,14.208 40.108,14.008 39.396,13.608 C38.684,13.208 38.132,12.644 37.74,11.916 C37.348,11.188 37.152,10.352 37.152,9.408 C37.152,8.464 37.348,7.628 37.74,6.9 C38.132,6.172 38.684,5.608 39.396,5.208 C40.108,4.808 40.92,4.608 41.832,4.608 C43.384,4.608 44.704,5.264 45.792,6.576 L45.792,6.576 L48.816,3.84 C48,2.816 46.976,2.032 45.744,1.488 C44.512,0.944 43.128,0.672 41.592,0.672 C39.832,0.672 38.252,1.044 36.852,1.788 C35.452,2.532 34.352,3.568 33.552,4.896 C32.752,6.224 32.352,7.728 32.352,9.408 C32.352,11.088 32.752,12.592 33.552,13.92 C34.352,15.248 35.452,16.284 36.852,17.028 C38.252,17.772 39.832,18.144 41.592,18.144 Z" id="BTC" fill="#F2A900"></path><path d="M56.64,18.144 C58.24,18.144 59.6,17.9 60.72,17.412 C61.84,16.924 62.68,16.272 63.24,15.456 C63.8,14.64 64.08,13.728 64.08,12.72 C64.08,11.552 63.772,10.628 63.156,9.948 C62.54,9.268 61.812,8.772 60.972,8.46 C60.132,8.148 59.072,7.856 57.792,7.584 C56.656,7.344 55.832,7.112 55.32,6.888 C54.808,6.664 54.552,6.328 54.552,5.88 C54.552,5.432 54.768,5.068 55.2,4.788 C55.632,4.508 56.32,4.368 57.264,4.368 C58.768,4.368 60.32,4.8 61.92,5.664 L61.92,5.664 L63.384,2.136 C62.568,1.656 61.624,1.292 60.552,1.044 C59.48,0.796 58.392,0.672 57.288,0.672 C55.672,0.672 54.308,0.912 53.196,1.392 C52.084,1.872 51.248,2.524 50.688,3.348 C50.128,4.172 49.848,5.096 49.848,6.12 C49.848,7.288 50.152,8.216 50.76,8.904 C51.368,9.592 52.096,10.092 52.944,10.404 C53.792,10.716 54.848,11.008 56.112,11.28 C57.264,11.536 58.1,11.78 58.62,12.012 C59.14,12.244 59.4,12.6 59.4,13.08 C59.4,13.992 58.488,14.448 56.664,14.448 C55.704,14.448 54.728,14.296 53.736,13.992 C52.744,13.688 51.872,13.288 51.12,12.792 L51.12,12.792 L49.56,16.296 C50.36,16.856 51.4,17.304 52.68,17.64 C53.96,17.976 55.28,18.144 56.64,18.144 Z M71.856,18.024 C72.48,18.024 73.068,17.96 73.62,17.832 C74.172,17.704 74.64,17.52 75.024,17.28 L75.024,17.28 L73.896,14.088 C73.496,14.36 73.032,14.496 72.504,14.496 C72.088,14.496 71.756,14.364 71.508,14.1 C71.26,13.836 71.136,13.472 71.136,13.008 L71.136,13.008 L71.136,8.688 L74.112,8.688 L74.112,5.28 L71.136,5.28 L71.136,1.896 L66.576,1.896 L66.576,5.28 L64.68,5.28 L64.68,8.688 L66.576,8.688 L66.576,13.056 C66.576,14.704 67.032,15.944 67.944,16.776 C68.856,17.608 70.16,18.024 71.856,18.024 Z M82.248,18.024 C83,18.024 83.712,17.888 84.384,17.616 C85.056,17.344 85.632,16.944 86.112,16.416 L86.112,16.416 L86.112,17.808 L90.456,17.808 L90.456,4.8 L85.896,4.8 L85.896,11.064 C85.896,12.104 85.668,12.876 85.212,13.38 C84.756,13.884 84.168,14.136 83.448,14.136 C82.744,14.136 82.208,13.912 81.84,13.464 C81.472,13.016 81.288,12.304 81.288,11.328 L81.288,11.328 L81.288,4.8 L76.728,4.8 L76.728,12.072 C76.728,14.056 77.228,15.544 78.228,16.536 C79.228,17.528 80.568,18.024 82.248,18.024 Z M99.048,18.024 C100.744,18.024 102.016,17.52 102.864,16.512 L102.864,16.512 L102.864,17.808 L107.208,17.808 L107.208,0 L102.648,0 L102.648,5.928 C101.8,5.032 100.6,4.584 99.048,4.584 C97.864,4.584 96.784,4.856 95.808,5.4 C94.832,5.944 94.06,6.724 93.492,7.74 C92.924,8.756 92.64,9.936 92.64,11.28 C92.64,12.624 92.924,13.808 93.492,14.832 C94.06,15.856 94.832,16.644 95.808,17.196 C96.784,17.748 97.864,18.024 99.048,18.024 Z M100.008,14.4 C99.208,14.4 98.552,14.124 98.04,13.572 C97.528,13.02 97.272,12.256 97.272,11.28 C97.272,10.32 97.528,9.568 98.04,9.024 C98.552,8.48 99.208,8.208 100.008,8.208 C100.808,8.208 101.46,8.48 101.964,9.024 C102.468,9.568 102.72,10.32 102.72,11.28 C102.72,12.256 102.464,13.02 101.952,13.572 C101.44,14.124 100.792,14.4 100.008,14.4 Z M112.368,22.68 C113.728,22.68 114.88,22.356 115.824,21.708 C116.768,21.06 117.568,19.936 118.224,18.336 L118.224,18.336 L123.84,4.8 L119.496,4.8 L116.28,12.744 L113.088,4.8 L108.408,4.8 L113.976,17.976 C113.784,18.36 113.548,18.64 113.268,18.816 C112.988,18.992 112.632,19.08 112.2,19.08 C111.832,19.08 111.468,19.012 111.108,18.876 C110.748,18.74 110.44,18.552 110.184,18.312 L110.184,18.312 L108.6,21.504 C109.032,21.856 109.596,22.14 110.292,22.356 C110.988,22.572 111.68,22.68 112.368,22.68 Z" id="Study" fill-opacity="0.85" fill="#FFFFFF"></path></g></g></g></svg></div><div class="mobile-header-title is-full-height is-flex is-align-items-center is-flex-shrink-0"><div class="is-full-height hidden" id="postTopicMobile"><p class="is-full-height">使用时间锁重新想象冷存储</p></div></div></div><i class="iconfont icon-icon_search mobile-header-searchIcon"></i><div class="mobile-search-wrap"><div class="search-input"><input class="pl-3" id="mobile-search-input" placeholder="请输入搜索关键词"><i class="iconfont icon-icon_search mobile-search-input-btn"></i><button class="mobile-search-input-btn">搜 索</button></div></div></header><div class="mobile-slide-menu"><a class="header-activity" href="/">首页</a><a href="/archives">全站目录</a><a href="/tags">标签</a><a href="/maps">地图</a><a href="/mempool">mempool</a><a target="_blank" rel="noopener" href="https://123btc.org/">123btc</a><div><p class="slide-menu-theme is-flex is-flex-direction-row is-justify-content-space-between is-align-items-center"><span>主题设置</span><span><i class="iconfont icon-icon_light slide-theme-light hidden"></i><i class="iconfont icon-icon_dark slide-theme-dark hidden"></i></span></p><p class="slide-menu-fontsize"><span>字体设置</span><span><i class="iconfont icon-bianzubeifen"></i><i class="iconfont icon-bianzu"></i></span></p></div></div><div class="search-mask hidden"><script src="/js/header.js?v=1675838663872"> </script></div><main><main class="container is-max-widescreen content section post-page pt-4"><div class="columns is-flex-desktop is-justify-content-center"><div class="column is-3 silde-bar is-hidden-mobile"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%9A%E6%A0%B7%E7%9A%84%E6%97%B6%E9%97%B4%E9%94%81"><span class="toc-text">多样的时间锁</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%B6%E9%97%B4%E9%94%81%E4%BA%A4%E6%98%93%E7%9A%84%E7%BB%93%E6%9E%84"><span class="toc-text">时间锁交易的结构</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%94%AF%E4%BB%98%E7%BB%99%E5%B8%A6%E6%9C%89%E6%97%B6%E9%97%B4%E9%94%81%E7%9A%84%E7%AD%BE%E5%90%8D%E4%BA%A4%E6%98%93"><span class="toc-text">支付给带有时间锁的签名交易</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%86%B7%E5%AD%98%E5%82%A8%E7%9A%84%E6%9C%AA%E6%9D%A5%EF%BC%9F"><span class="toc-text">冷存储的未来？</span></a></li></ol></div><div class="column is-9 post-container"><h1 class="mt-0 mb-2" id="postTitle">使用时间锁重新想象冷存储</h1><div class="page-author"><div class="is-flex is-flex-direction-row page-data mr-6"><img class="mr-1" src="//res.btcstudy.org/btcstudy/images/default_avatar.png" alt="Bob McElrath"><div class="page-author-info"><strong>Bob McElrath</strong><time class="has-text-grey" datetime="2022-09-22T03:40:36.000Z">2022-09-22</time></div></div><div class="is-flex"><a href="/tags/covenant"><i class="page-tag mr-1 px-1">covenant<!-- 订正图片路径--></i></a><a href="/tags/%E6%97%B6%E9%97%B4%E9%94%81"><i class="page-tag mr-1 px-1">时间锁<!-- 订正图片路径--></i></a></div></div><article class="mt-4 post-content"><blockquote>
<p><em>作者：Bob McElrath</em></p>
<p><em>来源：<a target="_blank" rel="noopener" href="https://medium.com/@BobMcElrath/re-imagining-cold-storage-with-timelocks-1f293bfe421f">https://medium.com/@BobMcElrath/re-imagining-cold-storage-with-timelocks-1f293bfe421f</a></em></p>
<p><em>原文出版于 2016 年。</em></p>
</blockquote>
<p>“冷存储” 指的是让私钥离线保管、使攻击者无法远程访问的技术。大部分比特币交易所都使用这种技术，偶尔会在 “热钱包” 和离线的 “冷钱包” 之间移动资金（用来满足用户的取款需要）。因为需求会变化，交易所不会频繁在两者间移动比特币。</p>
<p>冷存储资产的思维模式跟你到物理世界的可感知事物的直观理解相似，就像黄金、贝壳和股票证书一样。在比特币中，P2PKH（支付到公钥哈希值）地址应用这种思维模式的，只不过私钥可以放在不止一个地方，所以不论你认为比特币放在哪个地方，都是不准确的。这些技术没有得到连贯一致的实现，所以导致了一些众所周知的损失。</p>
<p>相较于中本聪最初的设计，比特币已经改变了很多，最近形成了这些 BIP 中的后面三个。</p>
<ol>
<li><a target="_blank" rel="noopener" href="https://github.com/bitcoin/bips/blob/master/bip-0065.mediawiki">BIP65 OP_CHECKLOCKTIMEVERIFY</a>（脚本层面的决定时间锁）</li>
<li><a target="_blank" rel="noopener" href="https://github.com/bitcoin/bips/blob/master/bip-0068.mediawiki">BIP68 Relative nLocktime</a>（交易层面的相对时间锁）</li>
<li><a target="_blank" rel="noopener" href="https://github.com/bitcoin/bips/blob/master/bip-0112.mediawiki">BIP112 OP_CHECKSEQUENCEVERIFY</a>（脚本层面的相对时间锁）</li>
<li><a target="_blank" rel="noopener" href="https://github.com/bitcoin/bips/blob/master/bip-0113.mediawiki">BIP113 过去时间的中值作为时间锁计算的端点</a></li>
</ol>
<p>#1 是于 2015 年 12 月在比特币主网上激活的，而 #2、3、4 是于 2016 年 7 月 4 日激活的。后面三者被集体称为 “CSV 软分叉”，而且使用它们需要你把交易的版本号设为 2。每个需要托管和移动大量比特币的交易所和其他服务现在都可以利用这些元件来提高安全性、减少偷盗。那么我们来看看这些新功能对冷存储有什么用处。大部分的内容都已经由上面列出的比特币升级提案的正文直接或间接表述了出来。现在软分叉已经激活，是时候该使用更高级的策略了。</p>
<p>在 CSV 软分叉之前，比特币已经有时间锁功能，但几乎没有什么用处。新的这些时间锁允许一个商人：</p>
<ol>
<li>根据他的时间表移动资金；</li>
<li>注意到资金是否按计划移动，并采取行动。</li>
</ol>
<p>攻击者的目标是获得一个私钥，以解锁该私钥控制的资金并发送到自己选择的地址。通过恰当地使用时间锁和已经签名的交易（而非私钥），商人可以实现带有多个层级的风险缓冲策略。</p>
<h2 id="多样的时间锁"><a href="#多样的时间锁" class="headerlink" title="多样的时间锁"></a>多样的时间锁</h2><p><img src="//res.btcstudy.org/btcstudy/images/re-imagining-cold-storage-with-timelocks/-tSlMyl.jpg" alt="img"></p>
<p style="text-align:center">- 实体保险柜的时间锁在比特币存在之前很久就发明出来了。在古代的西方，一个银行管理员可以在下班的时候锁住保险柜，用时间锁来保证这个金库在下一个工作日上班前无法打开。跟其它伟大的密码金融观念一样，这种技术在其专利于 1831 年到期后很久才得到广泛应用。 -</p>


<p>CSV 软分叉所包含的不是一个，而是至少 <em>三种</em> 不同形式的时间锁（这要看你是怎么统计的）。时间锁既可以是 <em>相对的</em>，也可以是 <em>绝对的</em>。相对时间锁的意思是（打个比方） “这笔交易在其输入得到确认后的 6 个区块内无法上链”。而绝对时间锁的意思是（打个比方）“这笔交易在 2016 年 9 月 1 日凌晨 2 点之前无法上链”。</p>
<p>时间锁中的时间有两种度量方式，一种是 <em>区块</em> 的数量，另一种是 <em>以 512 秒为一段的时间</em>。区块的生成是随机事件，你不能完全确保一段时间内会有多少个区块挖出，虽然平均来说是每 10 分钟挖出一个区块。因此，CSV 软分叉还允许用户以 512 秒为单位指定时间锁，而链上的时间则以<a target="_blank" rel="noopener" href="https://github.com/bitcoin/bips/blob/master/bip-0113.mediawiki">过去 11 个区块的时间戳的中值</a>计。选择这样做的原因是，512 是 2 的幂，而且很接近比特币的理想出块间隔（600 分钟）。所以，时间锁数据字段（<strong>sequence_no</strong> 和 <strong>lock_time</strong>）可以用两种方式来表达时间，而且可编码的时间长度最大值相当。</p>
<p><strong>sequence_no</strong> 字段的命名是出于历史原因，但 CSV 软分叉将其重新定义为 <em>每个输入分设的时间锁</em>。<strong>lock_time</strong> 字段是属于交易层面的，所以是 <em>交易层面的时间锁</em>。不论是哪一种，一笔交易只要在任何一个字段上未解除时间锁，就无法挖出（上链）。</p>
<p>最后，CSV 软分叉还加入了两个新的操作码，<strong>OP_CHECKSEQUENCEVERIFY</strong> 允许用户使用一个输入脚本来检查 <strong>sequence_no</strong> 字段；而 <strong>OP_CHECKLOCKTIMEVERIFY</strong> 允许用户使用脚本来检查 <strong>lock_time</strong> 字段。当用户让一笔支付使用 P2SH（<a target="_blank" rel="noopener" href="https://github.com/bitcoin/bips/blob/master/bip-0016.mediawiki">Pay-to-Script Hash</a>）脚本并在脚本中使用这些操作码，他可以强制让一笔交易的输出在该交易 <em>挖出</em> 后的一段时间内无法使用。</p>
<p>现在，我们来设想一下这些新工具可以如何用于交易所这样的服务。我们对这个假想的比特币服务作出如下假设：</p>
<ol>
<li>这个服务每天都会收到存款，而且会在交易日里多次把资金从热钱包 <em>移到</em> 冷钱包。</li>
<li>这个服务偶尔会需要将资金从冷钱包中 <em>移出</em>， 以满足用户的取款需求，因此乐于让这些冷存储的资金在一段时间内不可访问。</li>
<li>这个服务将只使用 P2SH 交易，这种交易将使用新的时间锁和多签名条件。</li>
</ol>
<p> 最后一条引入了比表面上更多的复杂性，因为脚本可能有复杂的执行条件。当比特币被 P2SH 脚本控制时，我们很难确认这些比特币的 “位置”。因此，我们建议你，亲爱的读者，完全抛弃关于 “热比特币”、“冷比特币” 以及 “比特币存放在某处” 的概念。一个比特币输出，在不同的条件下，<em>既可以被离线的私钥花费，也可以被在线的私钥花费</em>。</p>
<h2 id="时间锁交易的结构"><a href="#时间锁交易的结构" class="headerlink" title="时间锁交易的结构"></a>时间锁交易的结构</h2><p>第一种使用时间锁的办法就是为一笔交易指定 <strong>lock_time</strong> 字段，以及&#x2F;或者 为一个交易输入指定 <strong>sequence_no</strong> 字段 —— 这将迫使我们在签名这笔交易后留存这笔交易一段时间。这种办法很有用，假如我想把这笔签过名的交易交给一个对手，对方将无法在我选定的时间以前广播这笔交易。但是，在保护我们自己的财产时，我们没有对手方，所以需要用别的方式来使用这些字段。</p>
<p><img src="//res.btcstudy.org/btcstudy/images/re-imagining-cold-storage-with-timelocks/-MN1wug.png" alt="img"></p>
<p style="text-align:center">- 一笔使用 sequence_no 和 lock_time 时间锁（以紫色标记）的比特币交易的结构概略图。执行时间锁的输入和输出脚本以粉色标记 -</p>


<p>第二种方式是使用一个会检查时间锁的脚本。因为在 P2SH 交易中，交易输出的脚本是隐式的，所以我可以要求这个输出 “锁定” 一段时间，而不会在链上被人发现。然后，我们可以使用 IF&#x2F;ELSE 语句将多个时间锁串联起来，或者规定花费这个输出的“紧急” 方法。我们考虑一个带有紧急解锁路径的简单时间锁交易。这种形式的脚本类似于上面的图片中展示的机械时间锁，保险柜的主人也有一把万能钥匙。</p>
<pre><code>OP_IF
  &quot;24h&quot; OP_CHECKSEQUENCEVERIFY OP_DROP
  &lt;hot pubkey&gt; OP_CHECKSIGVERIFY
OP_ELSE
  OP_2 &lt;emergency pubkey1&gt; &lt;emergency pubkey2&gt; OP_2 OP_CHECKMULTISIGVERIFY
OP_ENDIF
</code></pre>
<p style="text-align:center">- 一个带有紧急解锁路径的 P2SH 脚本 -</p>


<p>这里，我们是在使用 <strong>OP_CHECKSEQUENCEVERIFY</strong>，给热钱包中的资金设置了一个 24 小时的时间锁。这个时间锁保证了这个热钱包无法在 24 小时内花费这笔资金（为了清晰，我们省去了对 “24” 小时的数字编码展示）。上述的脚本会使用 Hash160 计算出哈希值，然后生成出 3Lockedfor24hqWsoQHL7MevXvZTFrxEhi 这样的 P2SH 地址。热钱包向该地址发起一笔支付。当该支付上链之后，这些资金就带上了时间锁（因为上述的脚本）。</p>
<p>在 <strong>OP_IF</strong> 之后的第一条代码路径，要求任何使用  <code>&lt;hot pubkey&gt;</code> 的签名来花费该地址中资金的交易，都必须将 <strong>sequence_no</strong> 字段设置为形成该目标资金的交易上链的 24 小时之后。而 <strong>OP_ELSE</strong> 之后的第二条路径，则是为紧急情况准备的。在正常情况下，不会需要依赖于这些紧急私钥。这些私钥应该保存在安全的地方。</p>
<p> 相对于支付通道交易，上述交易是 “反向的”，因为其 “常规情形” 和 “罕见情形” 的代码路径刚好相反。在上面这个脚本中，“常规情形” 的代码路径带有时间锁，另一条代码路径对应的是 “罕见情形” 。而在支付通道中，使用时间锁的是 “单方面关闭通道” 的情形。在支付通道中，合作的双方可以来回签名、发送交易，所以不带时间锁的代码路径才是常规情形下的路径。</p>
<h2 id="支付给带有时间锁的签名交易"><a href="#支付给带有时间锁的签名交易" class="headerlink" title="支付给带有时间锁的签名交易"></a>支付给带有时间锁的签名交易</h2><p>无论是 P2PKH 还是多签名输出，裸露公钥本身就是一件危险的事。任何人只要拿到了这些公钥的私钥，就可以编写交易，将资金发送到自己想要的任何地方。因此，如果我需要持续控制资金，我会希望提前编写一套方案，并强制执行。裸露的公钥是做不到这一点的。光脚本自身也无法强制让未来的交易把资金发送到某个目的地。脚本只验证花费一个输入的能力，但无法影响输出。</p>
<p>因此，我们引入一个新的技巧：我们先把资金发送到一个带有时间锁的脚本中，然后编写一个从 <em>该交易（该脚本）</em> 中花费资金的交易、签好名，然后把私钥删掉。这笔交易的最终目的可以是一个热钱包地址，或者是一个使用专门保管的私钥生成的地址，日后我们再把这个私钥导入热钱包中。这样一来，我们就不仅安排好了资金存放的 脚本&#x2F;地址，还安排了它下一步 <em>必须</em> 去什么地方。只要我确定我删除了私钥，这些资金在上述第二笔交易广播之前就是无法偷盗的（因为可以签发交易的私钥已经不存在了），而且还需要等待第二笔交易的时间锁解锁（如果有的话）。我们可以把这种模式叫做 “支付给带有时间锁的签名交易”，或者 “P2TST”。我甚至可以进一步创建出支付的链条，执行更复杂的安排：用连续的带有时间锁的签名交易将所有的输入和输出关联起来，执行更复杂的安排。</p>
<p>在这种模式中，我必须存储所有的中间 TST。为了确保攻击者无法拦截相应的私钥，我可以使用一个<a target="_blank" rel="noopener" href="https://en.bitcoin.it/wiki/Hardware_wallet">硬件签名设备</a>：用这个硬件设备生成一个新的私钥、导出相应的公钥、创建并签名交易，然后重设设备、使之生成一个全新的私钥。这样一来，可以签名的私钥就删除了。 因此，即使一个攻击者控制了生成交易的热钱包服务器，他也无法控制这些私钥，因为硬件模块会拒绝导出。交易所可以定期创建这样的交易，比如每次存入量超过 100 BTC 就执行一次这样的操作。</p>
<p>当运营者想复原锁定的资金时，他就找出并广播对应的签名交易。如果这些 TST 在输入中设置了时间锁，那么这些交易就无法在时间锁解锁前广播出去。如果 TST 的输出设置了时间锁，那么这些输出就无法在 TST 上链之后的一段时间内花费。因此，TST 可以成为一种 “煤矿中的金丝雀”，提醒交易所注意可能的恶意行为。因为攻击者盗取资金的 <em>唯一</em> 方法就是获得和广播 TST，运营者可以监控区块链，看自己的 TST 有没有意外出现，有就说明有恶意行为。</p>
<p>当 TST 意外出现时，交易所运营者可以采取行动，比如召集紧急私钥，在下一个时间锁解锁前转移资金。</p>
<p>这个链条的最终目标地址和每一条 TST，都会涉及到一个在该 TST 广播之前没有用处的密钥。即使攻击者拿到了这些公钥的私钥，他们也很难断定自己能不能花费某一些资金，即使 TST 广播之后也不能，因为目标地址是脚本的哈希值，可能包含其它公钥以及当前的 TST 没有包含的花费条件。</p>
<p>TST 是带有这些有趣属性的新工具。我们可以将它们当成是同质化的。一个运营者可以创建许多固定面额的 TST ，然后将它们保管在安全地方，就像对待金条一样。</p>
<p>可能更有趣的是，TST 不是特别敏感。它们不是真正的资金，也不包含对资金的控制权（有控制权的私钥最终在主人手上）。因此，TST 可以放在相对不那么值得信任的托管方手上。也可以备份放在多个地方。但是，它们有效地保护了资金不落入攻击者之手。</p>
<p>上述所有 TST 用到的脚本都带有 “紧急解锁分支”，即使用 IF&#x2F;ELSE 来避开时间锁的代码路径，或者是带有更短时间锁的路径。所以有人想偷盗资金会被挫败。这些 “紧急私钥” 在正常情况下 <em>永远不该</em> 动用，这样才能保障安全。</p>
<h2 id="冷存储的未来？"><a href="#冷存储的未来？" class="headerlink" title="冷存储的未来？"></a>冷存储的未来？</h2><p>上述时间锁策略的一个缺点是，一旦某一笔使用这种策略的交易被花费，相应的脚本就会大白于天下，从而暴露出运营者的策略。攻击者可能无法获得你的私钥，但知道有一个 3-of-3 的紧急解锁分支可以绕过时间锁，依然是很有价值的信息。</p>
<p>比特币 “很快” 将迎来另一个叫做 “默克尔抽象语法树（<a target="_blank" rel="noopener" href="https://github.com/bitcoin/bips/blob/master/bip-0114.mediawiki">Merkle Abstract Syntax Trees</a>）” 的升级，它将允许你把复杂的布尔表达式（例如上面的脚本）转化成一个默克尔树一样的承诺树。它优点在于，当你使用 MAST 来花费某一笔交易时，只有被执行的代码路径会曝光，其它代码路径不会。所以，运营者可以隐藏其它可能设置的时间锁、紧急解锁分支、它们的结构，网络上的其他人都无法看穿。</p>
<p>我们还应该指出，上面的时间锁脚本，全部都属于 “见证数据（witness data）”，使用 “<a target="_blank" rel="noopener" href="https://github.com/bitcoin/bips/blob/master/bip-0141.mediawiki">隔离见证</a>（SegWit）” 技术可以从交易主体中分离出去。这意味着，这种复杂的脚本使用隔离见证时可以 <em>在 1MB 的区块大小限制下获得 75% 的手续费折扣</em>。隔离见证已经在比特币的测试网上激活，而且很快会在主网上激活。任何开发这种新的冷存储策略的人都应该考虑从一开始就使用时间锁和隔离见证。</p>
<p>时间锁和预先签名且删除了私钥的交易（TST）是强大的新工具，可用于风险管理及防止损失。让我们拥抱这些新工具，并制造比 “热存储” 和 “冷存储” 更好的策略吧，冷热存储感觉起来更像老旧的机械保险柜，对比特币来说可能是不够的。</p>
<p>感谢 Ivan Brightly 和 Joey Fiscella 为本文贡献的有益讨论。</p>
<blockquote>
<p>译者注：作者在这里提出的思想其实非常接近于后来的 “限制条款（covenant）”。限制条款的意思用作者的话来说，就是 “为脚本赋予限制输出的能力”。而作者则是在当时的比特币脚本限制下，设想了可实现近似效果的方式 —— 删除私钥的预先签名交易。这种中间状态可以当成是我们思考限制条款的起点 —— 在限制条款中，我们到底能获得什么？</p>
<p>默克尔抽象语法树（MAST），在作者写完这篇文章的五年后（2021 年）才在比特币主网上激活。</p>
</blockquote>
<p>（完）</p>
</article></div></div></main><script src="/js/post.js?v=1675838663872"></script><script src="/js/highlight.min.js?v=1675838663872"></script><script>var containerEl = document.querySelector('.post-container');
var postFontSize = localStorage.getItem('post-font-size') || '16';
var inputEl = document.querySelector('#size-change-input');
var inputEl2 = document.querySelector('#size-change-input2');
inputEl.value = postFontSize;
inputEl2.value = postFontSize;
containerEl.style.fontSize = postFontSize + 'px';
$(function(){
  function setSizeChangeInputValue(size) {
    $('.post-container').css('font-size', size + 'px');
    localStorage.setItem('post-font-size', size);
    $('#size-change-input').val(size);
    $('#size-change-input2').val(size);
  }
  $('#size-change-input').on('input propertychange', function(e) {
    const size = e.target.value;
    setSizeChangeInputValue(size);
  });
  $('#size-change-input2').on('input propertychange', function(e) {
    const size = e.target.value;
    setSizeChangeInputValue(size);
  });
});
</script><script>hljs.initHighlightingOnLoad();</script></main></div><footer class="is-flex is-flex-direction-column is-align-items-center is-flex-shrink-0"><section class="sns-container"><a title="twitter" target="_blank" rel="noopener nofollow" href="//twitter.com/btcstudy">Twitter</a><!-- Github--><!-- Ins--><!-- RSS--><a title="rss" target="_blank" rel="noopener nofollow" href="/atom.xml">rss</a><!-- 知乎--><!-- 领英--><!-- 脸书--><!-- Telegram--><a title="telegram" target="_blank" rel="noopener nofollow" href="//t.me/btcstudyorg">Telegram</a></section></footer><script async src="/js/buttons.js?v=1675838663872"></script><script async src="/js/index.js?v=1675838663872"></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-JVCJ9XXG1Z"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());

gtag('config', 'G-JVCJ9XXG1Z');</script><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?c92c073c85be5be8d9b1b76f62a7e306";
  hm.async = true;
  hm.defer = true;
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
  </script></body></html>