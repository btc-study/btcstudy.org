<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><title>Spookchain：使用受信任启动仪式和 APO，实现类似 drivechain 的侧链</title><meta name="keywords" content="比特币, 中本聪, 比特币区块链, 闪电网络, 比特币 layer 2, 健全货币, 密码货币, 密码朋克, 学习比特币, BTC, BTC Study, Bitcoin, bitcoin, proof of work"><meta name="description" content="比特币思想的中文集结地"><meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, initial-scale=1"><link rel="icon" href="/favicon.ico"><link rel="stylesheet" href="/style/common/bulma.css?v=1673673209171"><link rel="preload" as="style" onload="this.onload=null;this.rel='stylesheet'" href="/style/common/iconfont.css?v=1673673209171"><link rel="stylesheet" href="/style/base.css?v=1673673209171"><link rel="stylesheet" href="/style/common/helper.css?v=1673673209171"><link rel="stylesheet" href="/style/themes/animation.css?v=1673673209171"><script>function ready() {
  var bodyEl = document.querySelector('.body-container');
  var theme = localStorage.getItem('theme') || 'light';
  if (!['light', 'dark'].includes(theme)) {
    theme = 'light';
    localStorage.setItem('theme', 'light');
  }
  bodyEl.classList.remove('appearance-auto');
  bodyEl.classList.add('appearance-' + theme);
  quickInitialTheme();
}
function quickInitialTheme() {
  var theme = localStorage.getItem('theme') || 'light';
  var logoLightEl = document.querySelector('.logo-light');
  var logoDarkEl = document.querySelector('.logo-dark');
  
  var mLogoLightEl = document.querySelector('#mobile-header-logo > .logo-light');
  var mLogoDarkEl = document.querySelector('#mobile-header-logo > .logo-dark');
  var themeBtnEl = document.getElementById('theme-btn');
  
  var slideThemeLightEl = document.querySelector('.slide-theme-light');
  var slideThemeDarkEl = document.querySelector('.slide-theme-dark');
  
  document.body.classList.add(theme);
  if (theme === 'dark') {
    logoLightEl.classList.add('hidden');
    logoDarkEl.classList.remove('hidden');
    
    mLogoLightEl.classList.add('hidden');
    mLogoDarkEl.classList.remove('hidden');
    
    themeBtnEl.classList.remove('icon-icon_dark');
    themeBtnEl.classList.add('icon-icon_light');
    
    slideThemeLightEl.classList.remove('hidden');
  } else {
    slideThemeDarkEl.classList.remove('hidden');
  }
}
document.addEventListener("DOMContentLoaded", ready);</script><script src="/js/common.js?v=1673673209171"></script><script src="/js/libs/zepto.min.js"></script><link rel="stylesheet" href="/style/post.css?v=1673673209171"><link rel="stylesheet" href="/style/themes/highlight.css?v=1673673209171"><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="BTC Study" type="application/atom+xml">
</head><body class="is-flex is-flex-direction-column" onload="initialTheme()"><div class="clip"></div><div class="body-container appearance-auto"><header class="header-widget is-hidden-mobile is-flex is-flex-shrink-0 is-align-items-center is-justify-content-center" id="header"><div class="is-flex header-widget-container is-flex-shrink-0 is-align-items-center"><section class="is-hidden-mobile is-flex-shrink-0"><h1><a href="/"><svg class="logo-light" width="125px" height="23px" viewBox="0 0 125 23" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>BTCStudy</title><g id="页面-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="首页-响应式" transform="translate(-249.000000, -23.000000)" fill-rule="nonzero"><g id="BTCStudy" transform="translate(249.680000, 23.192000)"><path d="M9.072,17.808 C11.312,17.808 13.024,17.408 14.208,16.608 C15.392,15.808 15.984,14.672 15.984,13.2 C15.984,12.192 15.712,11.332 15.168,10.62 C14.624,9.908 13.872,9.384 12.912,9.048 C13.632,8.68 14.188,8.18 14.58,7.548 C14.972,6.916 15.168,6.2 15.168,5.4 C15.168,4.056 14.608,2.988 13.488,2.196 C12.368,1.404 10.736,1.008 8.592,1.008 L8.592,1.008 L-5.68434189e-14,1.008 L-5.68434189e-14,17.808 L9.072,17.808 Z M7.968,7.68 L4.704,7.68 L4.704,4.44 L7.968,4.44 C9.568,4.44 10.368,4.976 10.368,6.048 C10.368,7.136 9.568,7.68 7.968,7.68 L7.968,7.68 Z M8.688,14.376 L4.704,14.376 L4.704,10.968 L8.688,10.968 C10.352,10.968 11.184,11.536 11.184,12.672 C11.184,13.808 10.352,14.376 8.688,14.376 L8.688,14.376 Z M26.544,17.808 L26.544,4.776 L31.68,4.776 L31.68,1.008 L16.632,1.008 L16.632,4.776 L21.792,4.776 L21.792,17.808 L26.544,17.808 Z M41.592,18.144 C43.128,18.144 44.512,17.872 45.744,17.328 C46.976,16.784 48,16 48.816,14.976 L48.816,14.976 L45.792,12.24 C44.704,13.552 43.384,14.208 41.832,14.208 C40.92,14.208 40.108,14.008 39.396,13.608 C38.684,13.208 38.132,12.644 37.74,11.916 C37.348,11.188 37.152,10.352 37.152,9.408 C37.152,8.464 37.348,7.628 37.74,6.9 C38.132,6.172 38.684,5.608 39.396,5.208 C40.108,4.808 40.92,4.608 41.832,4.608 C43.384,4.608 44.704,5.264 45.792,6.576 L45.792,6.576 L48.816,3.84 C48,2.816 46.976,2.032 45.744,1.488 C44.512,0.944 43.128,0.672 41.592,0.672 C39.832,0.672 38.252,1.044 36.852,1.788 C35.452,2.532 34.352,3.568 33.552,4.896 C32.752,6.224 32.352,7.728 32.352,9.408 C32.352,11.088 32.752,12.592 33.552,13.92 C34.352,15.248 35.452,16.284 36.852,17.028 C38.252,17.772 39.832,18.144 41.592,18.144 Z" id="BTC" fill="#F2A900"></path><path d="M56.64,18.144 C58.24,18.144 59.6,17.9 60.72,17.412 C61.84,16.924 62.68,16.272 63.24,15.456 C63.8,14.64 64.08,13.728 64.08,12.72 C64.08,11.552 63.772,10.628 63.156,9.948 C62.54,9.268 61.812,8.772 60.972,8.46 C60.132,8.148 59.072,7.856 57.792,7.584 C56.656,7.344 55.832,7.112 55.32,6.888 C54.808,6.664 54.552,6.328 54.552,5.88 C54.552,5.432 54.768,5.068 55.2,4.788 C55.632,4.508 56.32,4.368 57.264,4.368 C58.768,4.368 60.32,4.8 61.92,5.664 L61.92,5.664 L63.384,2.136 C62.568,1.656 61.624,1.292 60.552,1.044 C59.48,0.796 58.392,0.672 57.288,0.672 C55.672,0.672 54.308,0.912 53.196,1.392 C52.084,1.872 51.248,2.524 50.688,3.348 C50.128,4.172 49.848,5.096 49.848,6.12 C49.848,7.288 50.152,8.216 50.76,8.904 C51.368,9.592 52.096,10.092 52.944,10.404 C53.792,10.716 54.848,11.008 56.112,11.28 C57.264,11.536 58.1,11.78 58.62,12.012 C59.14,12.244 59.4,12.6 59.4,13.08 C59.4,13.992 58.488,14.448 56.664,14.448 C55.704,14.448 54.728,14.296 53.736,13.992 C52.744,13.688 51.872,13.288 51.12,12.792 L51.12,12.792 L49.56,16.296 C50.36,16.856 51.4,17.304 52.68,17.64 C53.96,17.976 55.28,18.144 56.64,18.144 Z M71.856,18.024 C72.48,18.024 73.068,17.96 73.62,17.832 C74.172,17.704 74.64,17.52 75.024,17.28 L75.024,17.28 L73.896,14.088 C73.496,14.36 73.032,14.496 72.504,14.496 C72.088,14.496 71.756,14.364 71.508,14.1 C71.26,13.836 71.136,13.472 71.136,13.008 L71.136,13.008 L71.136,8.688 L74.112,8.688 L74.112,5.28 L71.136,5.28 L71.136,1.896 L66.576,1.896 L66.576,5.28 L64.68,5.28 L64.68,8.688 L66.576,8.688 L66.576,13.056 C66.576,14.704 67.032,15.944 67.944,16.776 C68.856,17.608 70.16,18.024 71.856,18.024 Z M82.248,18.024 C83,18.024 83.712,17.888 84.384,17.616 C85.056,17.344 85.632,16.944 86.112,16.416 L86.112,16.416 L86.112,17.808 L90.456,17.808 L90.456,4.8 L85.896,4.8 L85.896,11.064 C85.896,12.104 85.668,12.876 85.212,13.38 C84.756,13.884 84.168,14.136 83.448,14.136 C82.744,14.136 82.208,13.912 81.84,13.464 C81.472,13.016 81.288,12.304 81.288,11.328 L81.288,11.328 L81.288,4.8 L76.728,4.8 L76.728,12.072 C76.728,14.056 77.228,15.544 78.228,16.536 C79.228,17.528 80.568,18.024 82.248,18.024 Z M99.048,18.024 C100.744,18.024 102.016,17.52 102.864,16.512 L102.864,16.512 L102.864,17.808 L107.208,17.808 L107.208,0 L102.648,0 L102.648,5.928 C101.8,5.032 100.6,4.584 99.048,4.584 C97.864,4.584 96.784,4.856 95.808,5.4 C94.832,5.944 94.06,6.724 93.492,7.74 C92.924,8.756 92.64,9.936 92.64,11.28 C92.64,12.624 92.924,13.808 93.492,14.832 C94.06,15.856 94.832,16.644 95.808,17.196 C96.784,17.748 97.864,18.024 99.048,18.024 Z M100.008,14.4 C99.208,14.4 98.552,14.124 98.04,13.572 C97.528,13.02 97.272,12.256 97.272,11.28 C97.272,10.32 97.528,9.568 98.04,9.024 C98.552,8.48 99.208,8.208 100.008,8.208 C100.808,8.208 101.46,8.48 101.964,9.024 C102.468,9.568 102.72,10.32 102.72,11.28 C102.72,12.256 102.464,13.02 101.952,13.572 C101.44,14.124 100.792,14.4 100.008,14.4 Z M112.368,22.68 C113.728,22.68 114.88,22.356 115.824,21.708 C116.768,21.06 117.568,19.936 118.224,18.336 L118.224,18.336 L123.84,4.8 L119.496,4.8 L116.28,12.744 L113.088,4.8 L108.408,4.8 L113.976,17.976 C113.784,18.36 113.548,18.64 113.268,18.816 C112.988,18.992 112.632,19.08 112.2,19.08 C111.832,19.08 111.468,19.012 111.108,18.876 C110.748,18.74 110.44,18.552 110.184,18.312 L110.184,18.312 L108.6,21.504 C109.032,21.856 109.596,22.14 110.292,22.356 C110.988,22.572 111.68,22.68 112.368,22.68 Z" id="Study" fill-opacity="0.85" fill="#000000"></path></g></g></g></svg><svg class="logo-dark hidden" width="125px" height="23px" viewBox="0 0 125 23" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>BTCStudy</title><g id="页面-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="首页-响应式" transform="translate(-249.000000, -23.000000)" fill-rule="nonzero"><g id="BTCStudy" transform="translate(249.680000, 23.192000)"><path d="M9.072,17.808 C11.312,17.808 13.024,17.408 14.208,16.608 C15.392,15.808 15.984,14.672 15.984,13.2 C15.984,12.192 15.712,11.332 15.168,10.62 C14.624,9.908 13.872,9.384 12.912,9.048 C13.632,8.68 14.188,8.18 14.58,7.548 C14.972,6.916 15.168,6.2 15.168,5.4 C15.168,4.056 14.608,2.988 13.488,2.196 C12.368,1.404 10.736,1.008 8.592,1.008 L8.592,1.008 L-5.68434189e-14,1.008 L-5.68434189e-14,17.808 L9.072,17.808 Z M7.968,7.68 L4.704,7.68 L4.704,4.44 L7.968,4.44 C9.568,4.44 10.368,4.976 10.368,6.048 C10.368,7.136 9.568,7.68 7.968,7.68 L7.968,7.68 Z M8.688,14.376 L4.704,14.376 L4.704,10.968 L8.688,10.968 C10.352,10.968 11.184,11.536 11.184,12.672 C11.184,13.808 10.352,14.376 8.688,14.376 L8.688,14.376 Z M26.544,17.808 L26.544,4.776 L31.68,4.776 L31.68,1.008 L16.632,1.008 L16.632,4.776 L21.792,4.776 L21.792,17.808 L26.544,17.808 Z M41.592,18.144 C43.128,18.144 44.512,17.872 45.744,17.328 C46.976,16.784 48,16 48.816,14.976 L48.816,14.976 L45.792,12.24 C44.704,13.552 43.384,14.208 41.832,14.208 C40.92,14.208 40.108,14.008 39.396,13.608 C38.684,13.208 38.132,12.644 37.74,11.916 C37.348,11.188 37.152,10.352 37.152,9.408 C37.152,8.464 37.348,7.628 37.74,6.9 C38.132,6.172 38.684,5.608 39.396,5.208 C40.108,4.808 40.92,4.608 41.832,4.608 C43.384,4.608 44.704,5.264 45.792,6.576 L45.792,6.576 L48.816,3.84 C48,2.816 46.976,2.032 45.744,1.488 C44.512,0.944 43.128,0.672 41.592,0.672 C39.832,0.672 38.252,1.044 36.852,1.788 C35.452,2.532 34.352,3.568 33.552,4.896 C32.752,6.224 32.352,7.728 32.352,9.408 C32.352,11.088 32.752,12.592 33.552,13.92 C34.352,15.248 35.452,16.284 36.852,17.028 C38.252,17.772 39.832,18.144 41.592,18.144 Z" id="BTC" fill="#F2A900"></path><path d="M56.64,18.144 C58.24,18.144 59.6,17.9 60.72,17.412 C61.84,16.924 62.68,16.272 63.24,15.456 C63.8,14.64 64.08,13.728 64.08,12.72 C64.08,11.552 63.772,10.628 63.156,9.948 C62.54,9.268 61.812,8.772 60.972,8.46 C60.132,8.148 59.072,7.856 57.792,7.584 C56.656,7.344 55.832,7.112 55.32,6.888 C54.808,6.664 54.552,6.328 54.552,5.88 C54.552,5.432 54.768,5.068 55.2,4.788 C55.632,4.508 56.32,4.368 57.264,4.368 C58.768,4.368 60.32,4.8 61.92,5.664 L61.92,5.664 L63.384,2.136 C62.568,1.656 61.624,1.292 60.552,1.044 C59.48,0.796 58.392,0.672 57.288,0.672 C55.672,0.672 54.308,0.912 53.196,1.392 C52.084,1.872 51.248,2.524 50.688,3.348 C50.128,4.172 49.848,5.096 49.848,6.12 C49.848,7.288 50.152,8.216 50.76,8.904 C51.368,9.592 52.096,10.092 52.944,10.404 C53.792,10.716 54.848,11.008 56.112,11.28 C57.264,11.536 58.1,11.78 58.62,12.012 C59.14,12.244 59.4,12.6 59.4,13.08 C59.4,13.992 58.488,14.448 56.664,14.448 C55.704,14.448 54.728,14.296 53.736,13.992 C52.744,13.688 51.872,13.288 51.12,12.792 L51.12,12.792 L49.56,16.296 C50.36,16.856 51.4,17.304 52.68,17.64 C53.96,17.976 55.28,18.144 56.64,18.144 Z M71.856,18.024 C72.48,18.024 73.068,17.96 73.62,17.832 C74.172,17.704 74.64,17.52 75.024,17.28 L75.024,17.28 L73.896,14.088 C73.496,14.36 73.032,14.496 72.504,14.496 C72.088,14.496 71.756,14.364 71.508,14.1 C71.26,13.836 71.136,13.472 71.136,13.008 L71.136,13.008 L71.136,8.688 L74.112,8.688 L74.112,5.28 L71.136,5.28 L71.136,1.896 L66.576,1.896 L66.576,5.28 L64.68,5.28 L64.68,8.688 L66.576,8.688 L66.576,13.056 C66.576,14.704 67.032,15.944 67.944,16.776 C68.856,17.608 70.16,18.024 71.856,18.024 Z M82.248,18.024 C83,18.024 83.712,17.888 84.384,17.616 C85.056,17.344 85.632,16.944 86.112,16.416 L86.112,16.416 L86.112,17.808 L90.456,17.808 L90.456,4.8 L85.896,4.8 L85.896,11.064 C85.896,12.104 85.668,12.876 85.212,13.38 C84.756,13.884 84.168,14.136 83.448,14.136 C82.744,14.136 82.208,13.912 81.84,13.464 C81.472,13.016 81.288,12.304 81.288,11.328 L81.288,11.328 L81.288,4.8 L76.728,4.8 L76.728,12.072 C76.728,14.056 77.228,15.544 78.228,16.536 C79.228,17.528 80.568,18.024 82.248,18.024 Z M99.048,18.024 C100.744,18.024 102.016,17.52 102.864,16.512 L102.864,16.512 L102.864,17.808 L107.208,17.808 L107.208,0 L102.648,0 L102.648,5.928 C101.8,5.032 100.6,4.584 99.048,4.584 C97.864,4.584 96.784,4.856 95.808,5.4 C94.832,5.944 94.06,6.724 93.492,7.74 C92.924,8.756 92.64,9.936 92.64,11.28 C92.64,12.624 92.924,13.808 93.492,14.832 C94.06,15.856 94.832,16.644 95.808,17.196 C96.784,17.748 97.864,18.024 99.048,18.024 Z M100.008,14.4 C99.208,14.4 98.552,14.124 98.04,13.572 C97.528,13.02 97.272,12.256 97.272,11.28 C97.272,10.32 97.528,9.568 98.04,9.024 C98.552,8.48 99.208,8.208 100.008,8.208 C100.808,8.208 101.46,8.48 101.964,9.024 C102.468,9.568 102.72,10.32 102.72,11.28 C102.72,12.256 102.464,13.02 101.952,13.572 C101.44,14.124 100.792,14.4 100.008,14.4 Z M112.368,22.68 C113.728,22.68 114.88,22.356 115.824,21.708 C116.768,21.06 117.568,19.936 118.224,18.336 L118.224,18.336 L123.84,4.8 L119.496,4.8 L116.28,12.744 L113.088,4.8 L108.408,4.8 L113.976,17.976 C113.784,18.36 113.548,18.64 113.268,18.816 C112.988,18.992 112.632,19.08 112.2,19.08 C111.832,19.08 111.468,19.012 111.108,18.876 C110.748,18.74 110.44,18.552 110.184,18.312 L110.184,18.312 L108.6,21.504 C109.032,21.856 109.596,22.14 110.292,22.356 C110.988,22.572 111.68,22.68 112.368,22.68 Z" id="Study" fill-opacity="0.85" fill="#FFFFFF"></path></g></g></g></svg></a></h1></section><div class="is-flex is-flex-direction-column header-menu-wrap"><aside class="is-flex-shrink-0 is-flex is-flex-direction-row is-align-items-center" id="header-menu"><a class="is-inline-block header-activity mr-4" href="/">首页</a><a class="is-inline-block mr-4" href="/archives">全站目录</a><a class="is-inline-block mr-4" href="/tags">标签</a><a class="is-inline-block mr-4" href="/maps">地图</a><a class="is-inline-block mr-4" href="/mempool">mempool</a><a class="is-inline-block mr-4" target="_blank" rel="noopener" href="https://123btc.org/">123btc</a><div class="right-content is-flex is-flex-direction-row is-align-items-center"><div class="size-wrap mr-1"><i class="iconfont icon-a-bianzu5" id="change-size-btn"></i><div class="size-input-wrap"><div class="input-wrap"><input id="size-change-input" type="range" min="12" max="32" step="2"></div></div></div><i class="iconfont icon-icon_dark mr-1" id="theme-btn"></i><div class="search-wrap"><input class="pl-3" id="search-input" placeholder="请输入搜索关键词"><i class="iconfont icon-icon_search" id="search-input-btn"></i></div></div></aside><div class="header-title is-hidden-mobile is-full-height is-flex is-align-items-center is-flex-shrink-0"><div class="is-full-height hidden" id="postTopic"><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">Spookchain：使用受信任启动仪式和 APO，实现类似 drivechain 的侧链</p><div class="size-wrap mr-1"><i class="iconfont icon-a-bianzu5" id="change-size-btn2"></i><div class="size-input-wrap"><div class="input-wrap"><input id="size-change-input2" type="range" min="12" max="32" step="2"></div></div></div></div></div></div></div></header><header class="is-flex header-widget is-flex-shrink-0 is-align-items-center is-justify-content-space-between is-hidden-tablet" id="mobile-header"><div class="is-flex is-flex-direction-row is-align-items-center"><i class="iconfont icon-icon_bar mobile-header-menu"></i><div id="mobile-header-logo"><svg class="logo-light" width="125px" height="23px" viewBox="0 0 125 23" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>BTCStudy</title><g id="页面-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="首页-响应式" transform="translate(-249.000000, -23.000000)" fill-rule="nonzero"><g id="BTCStudy" transform="translate(249.680000, 23.192000)"><path d="M9.072,17.808 C11.312,17.808 13.024,17.408 14.208,16.608 C15.392,15.808 15.984,14.672 15.984,13.2 C15.984,12.192 15.712,11.332 15.168,10.62 C14.624,9.908 13.872,9.384 12.912,9.048 C13.632,8.68 14.188,8.18 14.58,7.548 C14.972,6.916 15.168,6.2 15.168,5.4 C15.168,4.056 14.608,2.988 13.488,2.196 C12.368,1.404 10.736,1.008 8.592,1.008 L8.592,1.008 L-5.68434189e-14,1.008 L-5.68434189e-14,17.808 L9.072,17.808 Z M7.968,7.68 L4.704,7.68 L4.704,4.44 L7.968,4.44 C9.568,4.44 10.368,4.976 10.368,6.048 C10.368,7.136 9.568,7.68 7.968,7.68 L7.968,7.68 Z M8.688,14.376 L4.704,14.376 L4.704,10.968 L8.688,10.968 C10.352,10.968 11.184,11.536 11.184,12.672 C11.184,13.808 10.352,14.376 8.688,14.376 L8.688,14.376 Z M26.544,17.808 L26.544,4.776 L31.68,4.776 L31.68,1.008 L16.632,1.008 L16.632,4.776 L21.792,4.776 L21.792,17.808 L26.544,17.808 Z M41.592,18.144 C43.128,18.144 44.512,17.872 45.744,17.328 C46.976,16.784 48,16 48.816,14.976 L48.816,14.976 L45.792,12.24 C44.704,13.552 43.384,14.208 41.832,14.208 C40.92,14.208 40.108,14.008 39.396,13.608 C38.684,13.208 38.132,12.644 37.74,11.916 C37.348,11.188 37.152,10.352 37.152,9.408 C37.152,8.464 37.348,7.628 37.74,6.9 C38.132,6.172 38.684,5.608 39.396,5.208 C40.108,4.808 40.92,4.608 41.832,4.608 C43.384,4.608 44.704,5.264 45.792,6.576 L45.792,6.576 L48.816,3.84 C48,2.816 46.976,2.032 45.744,1.488 C44.512,0.944 43.128,0.672 41.592,0.672 C39.832,0.672 38.252,1.044 36.852,1.788 C35.452,2.532 34.352,3.568 33.552,4.896 C32.752,6.224 32.352,7.728 32.352,9.408 C32.352,11.088 32.752,12.592 33.552,13.92 C34.352,15.248 35.452,16.284 36.852,17.028 C38.252,17.772 39.832,18.144 41.592,18.144 Z" id="BTC" fill="#F2A900"></path><path d="M56.64,18.144 C58.24,18.144 59.6,17.9 60.72,17.412 C61.84,16.924 62.68,16.272 63.24,15.456 C63.8,14.64 64.08,13.728 64.08,12.72 C64.08,11.552 63.772,10.628 63.156,9.948 C62.54,9.268 61.812,8.772 60.972,8.46 C60.132,8.148 59.072,7.856 57.792,7.584 C56.656,7.344 55.832,7.112 55.32,6.888 C54.808,6.664 54.552,6.328 54.552,5.88 C54.552,5.432 54.768,5.068 55.2,4.788 C55.632,4.508 56.32,4.368 57.264,4.368 C58.768,4.368 60.32,4.8 61.92,5.664 L61.92,5.664 L63.384,2.136 C62.568,1.656 61.624,1.292 60.552,1.044 C59.48,0.796 58.392,0.672 57.288,0.672 C55.672,0.672 54.308,0.912 53.196,1.392 C52.084,1.872 51.248,2.524 50.688,3.348 C50.128,4.172 49.848,5.096 49.848,6.12 C49.848,7.288 50.152,8.216 50.76,8.904 C51.368,9.592 52.096,10.092 52.944,10.404 C53.792,10.716 54.848,11.008 56.112,11.28 C57.264,11.536 58.1,11.78 58.62,12.012 C59.14,12.244 59.4,12.6 59.4,13.08 C59.4,13.992 58.488,14.448 56.664,14.448 C55.704,14.448 54.728,14.296 53.736,13.992 C52.744,13.688 51.872,13.288 51.12,12.792 L51.12,12.792 L49.56,16.296 C50.36,16.856 51.4,17.304 52.68,17.64 C53.96,17.976 55.28,18.144 56.64,18.144 Z M71.856,18.024 C72.48,18.024 73.068,17.96 73.62,17.832 C74.172,17.704 74.64,17.52 75.024,17.28 L75.024,17.28 L73.896,14.088 C73.496,14.36 73.032,14.496 72.504,14.496 C72.088,14.496 71.756,14.364 71.508,14.1 C71.26,13.836 71.136,13.472 71.136,13.008 L71.136,13.008 L71.136,8.688 L74.112,8.688 L74.112,5.28 L71.136,5.28 L71.136,1.896 L66.576,1.896 L66.576,5.28 L64.68,5.28 L64.68,8.688 L66.576,8.688 L66.576,13.056 C66.576,14.704 67.032,15.944 67.944,16.776 C68.856,17.608 70.16,18.024 71.856,18.024 Z M82.248,18.024 C83,18.024 83.712,17.888 84.384,17.616 C85.056,17.344 85.632,16.944 86.112,16.416 L86.112,16.416 L86.112,17.808 L90.456,17.808 L90.456,4.8 L85.896,4.8 L85.896,11.064 C85.896,12.104 85.668,12.876 85.212,13.38 C84.756,13.884 84.168,14.136 83.448,14.136 C82.744,14.136 82.208,13.912 81.84,13.464 C81.472,13.016 81.288,12.304 81.288,11.328 L81.288,11.328 L81.288,4.8 L76.728,4.8 L76.728,12.072 C76.728,14.056 77.228,15.544 78.228,16.536 C79.228,17.528 80.568,18.024 82.248,18.024 Z M99.048,18.024 C100.744,18.024 102.016,17.52 102.864,16.512 L102.864,16.512 L102.864,17.808 L107.208,17.808 L107.208,0 L102.648,0 L102.648,5.928 C101.8,5.032 100.6,4.584 99.048,4.584 C97.864,4.584 96.784,4.856 95.808,5.4 C94.832,5.944 94.06,6.724 93.492,7.74 C92.924,8.756 92.64,9.936 92.64,11.28 C92.64,12.624 92.924,13.808 93.492,14.832 C94.06,15.856 94.832,16.644 95.808,17.196 C96.784,17.748 97.864,18.024 99.048,18.024 Z M100.008,14.4 C99.208,14.4 98.552,14.124 98.04,13.572 C97.528,13.02 97.272,12.256 97.272,11.28 C97.272,10.32 97.528,9.568 98.04,9.024 C98.552,8.48 99.208,8.208 100.008,8.208 C100.808,8.208 101.46,8.48 101.964,9.024 C102.468,9.568 102.72,10.32 102.72,11.28 C102.72,12.256 102.464,13.02 101.952,13.572 C101.44,14.124 100.792,14.4 100.008,14.4 Z M112.368,22.68 C113.728,22.68 114.88,22.356 115.824,21.708 C116.768,21.06 117.568,19.936 118.224,18.336 L118.224,18.336 L123.84,4.8 L119.496,4.8 L116.28,12.744 L113.088,4.8 L108.408,4.8 L113.976,17.976 C113.784,18.36 113.548,18.64 113.268,18.816 C112.988,18.992 112.632,19.08 112.2,19.08 C111.832,19.08 111.468,19.012 111.108,18.876 C110.748,18.74 110.44,18.552 110.184,18.312 L110.184,18.312 L108.6,21.504 C109.032,21.856 109.596,22.14 110.292,22.356 C110.988,22.572 111.68,22.68 112.368,22.68 Z" id="Study" fill-opacity="0.85" fill="#000000"></path></g></g></g></svg><svg class="logo-dark hidden" width="125px" height="23px" viewBox="0 0 125 23" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>BTCStudy</title><g id="页面-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="首页-响应式" transform="translate(-249.000000, -23.000000)" fill-rule="nonzero"><g id="BTCStudy" transform="translate(249.680000, 23.192000)"><path d="M9.072,17.808 C11.312,17.808 13.024,17.408 14.208,16.608 C15.392,15.808 15.984,14.672 15.984,13.2 C15.984,12.192 15.712,11.332 15.168,10.62 C14.624,9.908 13.872,9.384 12.912,9.048 C13.632,8.68 14.188,8.18 14.58,7.548 C14.972,6.916 15.168,6.2 15.168,5.4 C15.168,4.056 14.608,2.988 13.488,2.196 C12.368,1.404 10.736,1.008 8.592,1.008 L8.592,1.008 L-5.68434189e-14,1.008 L-5.68434189e-14,17.808 L9.072,17.808 Z M7.968,7.68 L4.704,7.68 L4.704,4.44 L7.968,4.44 C9.568,4.44 10.368,4.976 10.368,6.048 C10.368,7.136 9.568,7.68 7.968,7.68 L7.968,7.68 Z M8.688,14.376 L4.704,14.376 L4.704,10.968 L8.688,10.968 C10.352,10.968 11.184,11.536 11.184,12.672 C11.184,13.808 10.352,14.376 8.688,14.376 L8.688,14.376 Z M26.544,17.808 L26.544,4.776 L31.68,4.776 L31.68,1.008 L16.632,1.008 L16.632,4.776 L21.792,4.776 L21.792,17.808 L26.544,17.808 Z M41.592,18.144 C43.128,18.144 44.512,17.872 45.744,17.328 C46.976,16.784 48,16 48.816,14.976 L48.816,14.976 L45.792,12.24 C44.704,13.552 43.384,14.208 41.832,14.208 C40.92,14.208 40.108,14.008 39.396,13.608 C38.684,13.208 38.132,12.644 37.74,11.916 C37.348,11.188 37.152,10.352 37.152,9.408 C37.152,8.464 37.348,7.628 37.74,6.9 C38.132,6.172 38.684,5.608 39.396,5.208 C40.108,4.808 40.92,4.608 41.832,4.608 C43.384,4.608 44.704,5.264 45.792,6.576 L45.792,6.576 L48.816,3.84 C48,2.816 46.976,2.032 45.744,1.488 C44.512,0.944 43.128,0.672 41.592,0.672 C39.832,0.672 38.252,1.044 36.852,1.788 C35.452,2.532 34.352,3.568 33.552,4.896 C32.752,6.224 32.352,7.728 32.352,9.408 C32.352,11.088 32.752,12.592 33.552,13.92 C34.352,15.248 35.452,16.284 36.852,17.028 C38.252,17.772 39.832,18.144 41.592,18.144 Z" id="BTC" fill="#F2A900"></path><path d="M56.64,18.144 C58.24,18.144 59.6,17.9 60.72,17.412 C61.84,16.924 62.68,16.272 63.24,15.456 C63.8,14.64 64.08,13.728 64.08,12.72 C64.08,11.552 63.772,10.628 63.156,9.948 C62.54,9.268 61.812,8.772 60.972,8.46 C60.132,8.148 59.072,7.856 57.792,7.584 C56.656,7.344 55.832,7.112 55.32,6.888 C54.808,6.664 54.552,6.328 54.552,5.88 C54.552,5.432 54.768,5.068 55.2,4.788 C55.632,4.508 56.32,4.368 57.264,4.368 C58.768,4.368 60.32,4.8 61.92,5.664 L61.92,5.664 L63.384,2.136 C62.568,1.656 61.624,1.292 60.552,1.044 C59.48,0.796 58.392,0.672 57.288,0.672 C55.672,0.672 54.308,0.912 53.196,1.392 C52.084,1.872 51.248,2.524 50.688,3.348 C50.128,4.172 49.848,5.096 49.848,6.12 C49.848,7.288 50.152,8.216 50.76,8.904 C51.368,9.592 52.096,10.092 52.944,10.404 C53.792,10.716 54.848,11.008 56.112,11.28 C57.264,11.536 58.1,11.78 58.62,12.012 C59.14,12.244 59.4,12.6 59.4,13.08 C59.4,13.992 58.488,14.448 56.664,14.448 C55.704,14.448 54.728,14.296 53.736,13.992 C52.744,13.688 51.872,13.288 51.12,12.792 L51.12,12.792 L49.56,16.296 C50.36,16.856 51.4,17.304 52.68,17.64 C53.96,17.976 55.28,18.144 56.64,18.144 Z M71.856,18.024 C72.48,18.024 73.068,17.96 73.62,17.832 C74.172,17.704 74.64,17.52 75.024,17.28 L75.024,17.28 L73.896,14.088 C73.496,14.36 73.032,14.496 72.504,14.496 C72.088,14.496 71.756,14.364 71.508,14.1 C71.26,13.836 71.136,13.472 71.136,13.008 L71.136,13.008 L71.136,8.688 L74.112,8.688 L74.112,5.28 L71.136,5.28 L71.136,1.896 L66.576,1.896 L66.576,5.28 L64.68,5.28 L64.68,8.688 L66.576,8.688 L66.576,13.056 C66.576,14.704 67.032,15.944 67.944,16.776 C68.856,17.608 70.16,18.024 71.856,18.024 Z M82.248,18.024 C83,18.024 83.712,17.888 84.384,17.616 C85.056,17.344 85.632,16.944 86.112,16.416 L86.112,16.416 L86.112,17.808 L90.456,17.808 L90.456,4.8 L85.896,4.8 L85.896,11.064 C85.896,12.104 85.668,12.876 85.212,13.38 C84.756,13.884 84.168,14.136 83.448,14.136 C82.744,14.136 82.208,13.912 81.84,13.464 C81.472,13.016 81.288,12.304 81.288,11.328 L81.288,11.328 L81.288,4.8 L76.728,4.8 L76.728,12.072 C76.728,14.056 77.228,15.544 78.228,16.536 C79.228,17.528 80.568,18.024 82.248,18.024 Z M99.048,18.024 C100.744,18.024 102.016,17.52 102.864,16.512 L102.864,16.512 L102.864,17.808 L107.208,17.808 L107.208,0 L102.648,0 L102.648,5.928 C101.8,5.032 100.6,4.584 99.048,4.584 C97.864,4.584 96.784,4.856 95.808,5.4 C94.832,5.944 94.06,6.724 93.492,7.74 C92.924,8.756 92.64,9.936 92.64,11.28 C92.64,12.624 92.924,13.808 93.492,14.832 C94.06,15.856 94.832,16.644 95.808,17.196 C96.784,17.748 97.864,18.024 99.048,18.024 Z M100.008,14.4 C99.208,14.4 98.552,14.124 98.04,13.572 C97.528,13.02 97.272,12.256 97.272,11.28 C97.272,10.32 97.528,9.568 98.04,9.024 C98.552,8.48 99.208,8.208 100.008,8.208 C100.808,8.208 101.46,8.48 101.964,9.024 C102.468,9.568 102.72,10.32 102.72,11.28 C102.72,12.256 102.464,13.02 101.952,13.572 C101.44,14.124 100.792,14.4 100.008,14.4 Z M112.368,22.68 C113.728,22.68 114.88,22.356 115.824,21.708 C116.768,21.06 117.568,19.936 118.224,18.336 L118.224,18.336 L123.84,4.8 L119.496,4.8 L116.28,12.744 L113.088,4.8 L108.408,4.8 L113.976,17.976 C113.784,18.36 113.548,18.64 113.268,18.816 C112.988,18.992 112.632,19.08 112.2,19.08 C111.832,19.08 111.468,19.012 111.108,18.876 C110.748,18.74 110.44,18.552 110.184,18.312 L110.184,18.312 L108.6,21.504 C109.032,21.856 109.596,22.14 110.292,22.356 C110.988,22.572 111.68,22.68 112.368,22.68 Z" id="Study" fill-opacity="0.85" fill="#FFFFFF"></path></g></g></g></svg></div><div class="mobile-header-title is-full-height is-flex is-align-items-center is-flex-shrink-0"><div class="is-full-height hidden" id="postTopicMobile"><p class="is-full-height">Spookchain：使用受信任启动仪式和 APO，实现类似 drivechain 的侧链</p></div></div></div><i class="iconfont icon-icon_search mobile-header-searchIcon"></i><div class="mobile-search-wrap"><div class="search-input"><input class="pl-3" id="mobile-search-input" placeholder="请输入搜索关键词"><i class="iconfont icon-icon_search mobile-search-input-btn"></i><button class="mobile-search-input-btn">搜 索</button></div></div></header><div class="mobile-slide-menu"><a class="header-activity" href="/">首页</a><a href="/archives">全站目录</a><a href="/tags">标签</a><a href="/maps">地图</a><a href="/mempool">mempool</a><a target="_blank" rel="noopener" href="https://123btc.org/">123btc</a><div><p class="slide-menu-theme is-flex is-flex-direction-row is-justify-content-space-between is-align-items-center"><span>主题设置</span><span><i class="iconfont icon-icon_light slide-theme-light hidden"></i><i class="iconfont icon-icon_dark slide-theme-dark hidden"></i></span></p><p class="slide-menu-fontsize"><span>字体设置</span><span><i class="iconfont icon-bianzubeifen"></i><i class="iconfont icon-bianzu"></i></span></p></div></div><div class="search-mask hidden"><script src="/js/header.js?v=1673673209171"> </script></div><main><main class="container is-max-widescreen content section post-page pt-4"><div class="columns is-flex-desktop is-justify-content-center"><div class="column is-3 silde-bar is-hidden-mobile"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9A%AE%E4%BA%9A%E8%AF%BA%E8%AE%A1%E6%95%B0%E5%99%A8"><span class="toc-text">皮亚诺计数器</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%92%E5%A2%9E%E8%A7%84%E5%88%99"><span class="toc-text">递增规则</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%92%E5%87%8F%E8%A7%84%E5%88%99"><span class="toc-text">递减规则</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B%E5%8C%96"><span class="toc-text">实例化</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%84%E7%90%86%E4%BB%BB%E6%84%8F%E7%9A%84-%E5%AD%98%E5%85%A5-x2F-%E5%8F%96%E5%87%BA"><span class="toc-text">处理任意的 存入&#x2F;取出</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E5%89%B2%E4%B8%8E%E5%90%88%E5%B9%B6"><span class="toc-text">分割与合并</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%AF%8F%E4%B8%AA%E5%8C%BA%E5%9D%97%E6%8A%95%E4%B8%80%E6%AC%A1%E7%A5%A8"><span class="toc-text">每个区块投一次票</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%88%E5%B1%80%E7%8A%B6%E6%80%81-x2F-%E9%98%88%E5%80%BC"><span class="toc-text">终局状态&#x2F;阈值</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BC%80%E6%94%BE%E7%8A%B6%E6%80%81-x2F-%E6%8F%90%E8%AE%AE"><span class="toc-text">开放状态&#x2F;提议</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%90%AF%E5%8A%A8%E4%BB%AA%E5%BC%8F%E5%8F%98%E9%87%8F"><span class="toc-text">启动仪式变量</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#xpubs"><span class="toc-text">xpubs</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%8D%E4%BF%A1%E4%BB%BB%E7%9A%84%E6%95%B0%E6%8D%AE%E6%89%BF%E8%AF%BA"><span class="toc-text">免信任的数据承诺</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%95%E6%96%B9"><span class="toc-text">单方</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-MuSig-%E7%9A%84%E5%A4%9A%E6%96%B9"><span class="toc-text">使用 MuSig 的多方</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8D%E8%81%9A%E5%90%88%E7%9A%84%E5%A4%9A%E6%96%B9"><span class="toc-text">不聚合的多方</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BD%AF%E5%88%86%E5%8F%89%E6%8E%89%E4%BF%A1%E4%BB%BB"><span class="toc-text">软分叉掉信任</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%8A%B6%E6%80%81%E8%BD%AC%E6%8D%A2%E8%A7%84%E5%88%99%E4%B8%8E-DAG-%E9%99%90%E5%88%B6%E6%9D%A1%E6%AC%BE%E7%9A%84%E5%AF%B9%E7%A7%B0%E6%80%A7"><span class="toc-text">状态转换规则与 DAG 限制条款的对称性</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B3%E4%BA%8E%E4%BF%A1%E4%BB%BB%E5%92%8C%E9%99%90%E5%88%B6%E6%9D%A1%E6%AC%BE%E7%9A%84%E8%AF%84%E8%AE%BA"><span class="toc-text">关于信任和限制条款的评论</span></a></li></ol></div><div class="column is-9 post-container"><h1 class="mt-0 mb-2" id="postTitle">Spookchain：使用受信任启动仪式和 APO，实现类似 drivechain 的侧链</h1><div class="page-author"><div class="is-flex is-flex-direction-row page-data mr-6"><img class="mr-1" src="//res.btcstudy.org/btcstudy/images/default_avatar.png" alt="Jeremy Rubin"><div class="page-author-info"><strong>Jeremy Rubin</strong><time class="has-text-grey" datetime="2022-10-11T11:12:29.000Z">2022-10-11</time></div></div><div class="is-flex"><a href="/tags/covenant"><i class="page-tag mr-1 px-1">covenant<!-- 订正图片路径--></i></a><a href="/tags/Drivechain"><i class="page-tag mr-1 px-1">Drivechain<!-- 订正图片路径--></i></a></div></div><article class="mt-4 post-content"><blockquote>
<p><em>作者：Jeremy Rubin</em></p>
<p><em>来源：<a target="_blank" rel="noopener" href="https://rubin.io/bitcoin/2022/09/14/drivechain-apo/">https://rubin.io/bitcoin/2022/09/14/drivechain-apo/</a></em></p>
</blockquote>
<p>本文大量借鉴了 <a target="_blank" rel="noopener" href="https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2022-February/019976.html">Zmnscpxj 的精彩文章</a>，他展示了如何使用递归的限制条款（covenants）来实现 drivechain。在本文中，我将展示类似的技巧，可以使用 AnyPrevOut 和一次性的受信任启动仪式，实现类似于 drivechain 的东西。</p>
<p>本文也介绍了可以用在不同类型的限制条款中的通用技巧。</p>
<p><em>注：我大概在 2022 年 5 月 5 日就写好了这篇文章，并小范围分享过。</em></p>
<p><img src="//res.btcstudy.org/btcstudy/images/spookchains-drivechain-analog-with-trusted-setup-and-apo/okchain.png" alt="Spooky Chains"></p>
<h2 id="皮亚诺计数器"><a href="#皮亚诺计数器" class="headerlink" title="皮亚诺计数器"></a>皮亚诺计数器</h2><p>我们需要构造的第一部分是一个皮亚诺计数器图（Peano counter graph）。Zmmscpxj 的方案用上了 SHA-256，但我们将使用一个公钥，并开发一个简单的从 1 到 5 的、可以递增递减（inc&#x2F;dec）的计数器。</p>
<p>假设有公钥 K1 …… K5，并且有一个点具备 NUMS 属性（Nothing-up-my-sleeve number，本意来自魔术师在表演前向观众展示自己袖子里面没有藏东西，在密码学中表示随机取出而非有意选择的数 —— 此中无后门），例如是 HashToCurve(“Spookchains”)。</p>
<p>生成如下的脚本：</p>
<pre><code>&lt;1 || K1&gt; CHECKSIG
...
&lt;1 || K5&gt; CHECKSIG
</code></pre>
<p>现在，在 Ki 下使用 sighash 标签  <code>SIGHASH_SINGLE | SIGHASH_ANYONECANPAY | SIGHASH_ANYPREVOUT</code> 生成两个签名（如下详述）。</p>
<h3 id="递增规则"><a href="#递增规则" class="headerlink" title="递增规则"></a>递增规则</h3><p>对每一个 Ki，只要  <code>i &lt; 5</code> ，就创建一个签名，包含一笔这样的交易：</p>
<pre><code>数额：1 聪
公钥：Tr(NUMS, &#123;&lt;1 || K&#123;i+1&#125;&gt; CHECKSIG&#125;)
</code></pre>
<h3 id="递减规则"><a href="#递减规则" class="headerlink" title="递减规则"></a>递减规则</h3><p>对每一个 Ki，只要  <code>i &gt; 1</code> ，就创建一个签名，包含这样的交易：</p>
<pre><code>数额：1 聪
公钥：Tr(NUMS, &#123;&lt;1 || K&#123;i+1&#125;&gt; CHECKSIG&#125;)
</code></pre>
<p><em>这真的是皮亚诺计数器吗</em>？算是吧。虽然传统的皮亚诺数字是以结构化的类型来定义的，例如  <code>Succ(Succ(Zero))</code> ，这里我们通过一个 Inc&#x2F;Dec 交易操作码定义了它们，而且我们必须显式地绑定这些皮亚诺数字，因为每个元素都需要一个唯一的公钥。它们在精神上是相似的。</p>
<h3 id="实例化"><a href="#实例化" class="headerlink" title="实例化"></a>实例化</h3><p>产生一个由递增规则和递减规则产生的所有签名的列表。</p>
<p>诚实的参与者应该销毁私钥集 <code>k</code> 。</p>
<p>要创建一个计数器的时候，只需花费输出 C：</p>
<pre><code>数额：1 聪
公钥：Tr(NUMS, &#123;&lt;1 || K1&gt; CHECKSIG&#125;)
</code></pre>
<p>来自 K1 的签名可以 绑定到 C，并将它 “转化成”（+1）状态：</p>
<pre><code>数额：1 聪
公钥：Tr(NUMS, &#123;&lt;1 || K2&gt; CHECKSIG&#125;)
</code></pre>
<p>这个输出可以转变成 （+1）状态：</p>
<pre><code>数额：1 聪
公钥：Tr(NUMS, &#123;&lt;1 || K3&gt; CHECKSIG&#125;)
</code></pre>
<p>这个输出又可以转化成（-1）状态：</p>
<pre><code>数额：1 聪
公钥：Tr(NUMS, &#123;&lt;1 || K2&gt; CHECKSIG&#125;)
</code></pre>
<p>这个过程可以无限重复。</p>
<p>我们可以把这种技巧从  <code>1 ... 5</code> 推广到 <code>1 ... N</code> 。</p>
<h2 id="处理任意的-存入-x2F-取出"><a href="#处理任意的-存入-x2F-取出" class="headerlink" title="处理任意的 存入&#x2F;取出"></a>处理任意的 存入&#x2F;取出</h2><p>前面展示的设计的一个问题是它无法很好地处理任意的存入。</p>
<p>一种简单的处理办法是为你希望支持的每一个数额实例化协议。</p>
<p>但这样做非常低效，而且需要大量的存储空间。</p>
<p>另一种方法是，按比特将存入的金额除以 2（或者其它基数），并放到计数器 UTXO 里。</p>
<p>对每一个比特，我们创建的输出需要带有 2^i 聪的面额，而不能使用 1 聪的面额。</p>
<p>这时候我们不能只使用 <code>K1 ... KN</code> ，而要使用  <code>K^i_j</code> ，其中 i 表示聪的数量，而 j 表示计数器。每个数额都需要多个公钥，不然签名就会对已经烧掉的资金有效。</p>
<h3 id="分割与合并"><a href="#分割与合并" class="headerlink" title="分割与合并"></a>分割与合并</h3><p>对每一个  <code>K^i_j</code> ，允许分割和合并也是有用的。</p>
<p>分割可以通过预签名来实现，对每一个  <code>K^i_j</code>，只要 <code>i!=0</code> ，就使用 <code>SIGHASH_ALL | SIGHASH_ANYPREVOUT</code> 签名：</p>
<pre><code>输入：公钥 K^i_j 的 2^i 聪
输出：
    - 2^&#123;i-1&#125; 聪，公钥为 K^&#123;i-1&#125;_j
    - 2^&#123;i-1&#125; 聪，公钥为 K^&#123;i-1&#125;_j
</code></pre>
<p>合并也可以通过预签名来实现，对每一个  <code>K^i_j</code>，只要 <code>i!=MAX</code> ，就使用 <code>SIGHASH_ALL | SIGHASH_ANYPREVOUT</code> 签名：</p>
<pre><code>输入：
    - 2^i 聪，公钥为 K^&#123;i_j&#125;
    - 2^i 聪，公钥为 K^&#123;i_j&#125;
输出：
    - 公钥 K^&#123;i+1&#125;_j 的 2^i+1 聪
</code></pre>
<p>注意：合并允许第三方从外部存入资金，这并不是限制条款的一部分。</p>
<p>分割及合并的动作，意味着 spookchain 的运营者可以将 UTXO 合并以减少 UTXO 的数量，同时允许存入任意数额。</p>
<h2 id="每个区块投一次票"><a href="#每个区块投一次票" class="headerlink" title="每个区块投一次票"></a>每个区块投一次票</h2><p>为了强制执行每个区块只允许投一次票的规则，需要保证签名集中所有的输入的序列号（相对时间锁）都设置成 1 个区块。不需要 CSV 是因为签名中已经包含了 nSequence 字段。</p>
<h2 id="终局状态-x2F-阈值"><a href="#终局状态-x2F-阈值" class="headerlink" title="终局状态&#x2F;阈值"></a>终局状态&#x2F;阈值</h2><p>当一个计数器到达了第 N 个状态，就表示它在一段时间内已经积累了一定量的工作量、人们已经共识了某一些结果。</p>
<p>这时候就需要一些可用的状态转换方法。</p>
<p>一种解决方案是在此时将资金都发送到一个  <code>OP_TRUE</code> 输出中，而递增状态的矿工需要负责遵守该 Spookchain 的规则。或者，出于便利，也可以将资金指定给一些 管理员公钥&#x2F;联盟，并且，在 N 个区块后降级到更少的签名者（最终是 0 ）（这是为了在联盟死亡时允许恢复资金）。</p>
<p>这看起来就像，来自某一个  <code>K^i_j</code> 的一个签名将资金放到了一个 <code>OP_TRUE</code> 输出中然后立即花掉了它。不然，其它的 spaookchain 矿工就需要孤立这个区块。</p>
<h2 id="开放状态-x2F-提议"><a href="#开放状态-x2F-提议" class="headerlink" title="开放状态&#x2F;提议"></a>开放状态&#x2F;提议</h2><p>对于一个状态 <code>K^i_1</code> ，将之转化为 <code>K^i_2</code> 的交易可以被视为 “特殊的”，而 <code>OP_RETURN</code> 输出类型可以用来承诺（例如）在到达终局状态时必须被创建的输出。这就厘清了 “被投票的是什么” 的问题。</p>
<p>这个方法 <em>不会</em> 在共识层锁定被投票的终局状态是什么。</p>
<p>在特定情况下，不违法一次性启动仪式的约束，如果一个固定的取款地址列表是提前可知的，那么开放状态可以包含给特定参与者的取款，然后这些取款必须得到来自矿工的一定数量的支持票。但是，如果不使用新的密码学元件的话，想实现可以表决任意交易提议似乎是不可能的。</p>
<h2 id="启动仪式变量"><a href="#启动仪式变量" class="headerlink" title="启动仪式变量"></a>启动仪式变量</h2><h3 id="xpubs"><a href="#xpubs" class="headerlink" title="xpubs"></a>xpubs</h3><p>不是为每一个状态使用随机生成的公钥，而是使用一个 xpub 并根据 k&#x2F;i&#x2F;j 的派生路径为每一个 状态&#x2F;面额 生成公钥。这可以节约一些数据，而且不需要那么多熵。</p>
<h3 id="免信任的数据承诺"><a href="#免信任的数据承诺" class="headerlink" title="免信任的数据承诺"></a>免信任的数据承诺</h3><p>使用整个程序的详述的哈希值，作为对 xpub 的调整项，这样其他人就能快速验证自己是否拥有了你（在诚实假设下）需要生成的所有签名。</p>
<p>实现这种方案的一种方法是将一个哈希值确定性地转化成一个层级式确定性钱包 Child Number 的一个列表，并以此调整 xpub。这是一种便利但低效的调整 xpub 的方法，因为对签名设备来说，子密钥拥有一个正常的派生路径。</p>
<h3 id="单方"><a href="#单方" class="headerlink" title="单方"></a>单方</h3><p>由一个参与者预签名一个 Spookchain 的所有交易，并销毁自己的 xpriv（私钥）。</p>
<p>你需要相信 TA 已经删除了私钥并已经准备好了所有签名，但你不必信任给你提供 spookchain 数据以及执行所有状态转换的人，因为数据承诺是免信任的。</p>
<h3 id="使用-MuSig-的多方"><a href="#使用-MuSig-的多方" class="headerlink" title="使用 MuSig 的多方"></a>使用 MuSig 的多方</h3><p>在参与启动仪式的所有参与者中定义一个 MuSig 公钥，并且是 N-of-N 的。</p>
<p>现在，你只需信任这个一次性启动仪式中至少有一个诚实参与者就可以了！非常棒！</p>
<h3 id="不聚合的多方"><a href="#不聚合的多方" class="headerlink" title="不聚合的多方"></a>不聚合的多方</h3><p>这个模式也可以使用不聚合的多签名公钥。复杂度是 O(签名者数量)，但是，这意味着你可以像照着菜单点菜那样，让从未 与启动仪式交互&#x2F;执行启动仪式 的随机参与者聚合启动，只要他们签名了同一份程序详述。</p>
<p>也可以结合多个使用 MuSig 的多方。</p>
<p>这很棒，因为 MuSig 就意味着各参与方在某个点上串通做了一次 MuSig 的启动设置，但不聚合的多签名可以在各方没有任何交集的前提下执行。</p>
<h3 id="软分叉掉信任"><a href="#软分叉掉信任" class="headerlink" title="软分叉掉信任"></a>软分叉掉信任</h3><p>假设一个 Spookchain 变得非常流行。你可以配置自己的客户端以拒绝无效的状态转换，或者限制 Spookchain 密钥、使之仅能使用已知的签名。这种软分叉将平滑地更新信任假设。</p>
<h3 id="状态转换规则与-DAG-限制条款的对称性"><a href="#状态转换规则与-DAG-限制条款的对称性" class="headerlink" title="状态转换规则与 DAG 限制条款的对称性"></a>状态转换规则与 DAG 限制条款的对称性</h3><p>我们可以通过一个免信任的限制条款实现递增的状态转换规则，也可以通过启动设置实现向后的状态转换。</p>
<p>对于状态 i，其脚本看起来就像这样：</p>
<pre><code>Tr(NUMS, &#123;
    `&lt;sig for state K_&#123;i+1&#125;&gt; &lt;1 || PK_nonsecret&gt; CHECKSIG`,
    `&lt;1 || Ki&gt; CHECKSIG`
&#125;)
</code></pre>
<p>这样的优化在理论上有很好的效果，因为它意味着计算中 <em>只有</em> 非解构性的（non-destructuring）递归部分是受制于一次性启动的信任假设的；受信任的一次性启动仪式在其它许多协议中也会用到，但在哪些协议中，递归特性只会在（例如）一段时间的超时后解锁（而在 spookchain 中，则每一步都需要用到）。</p>
<p>编译器的作者可以从任意的一个抽象图谱开始，然后有选择地移除例外情形（可以使用一些启发法，例如，最小化对一次性启动设置的依赖，或者最小化开销），直到这个图谱变成一个有向无环图，由一个或多个组件构成并使用被承诺的限制条款编译这些租金，然后使用一次性启动设置的密钥材料补回原先移除的例外情形。</p>
<h2 id="关于信任和限制条款的评论"><a href="#关于信任和限制条款的评论" class="headerlink" title="关于信任和限制条款的评论"></a>关于信任和限制条款的评论</h2><p>这是一种限制条款吗？我觉得 “是”。我在自己的 <em>Calculus of Covenants</em> 一文中定义限制条款时，每一种限制条款都有特定的一组假设。</p>
<p>在那个模型下，举个例子，你可以将使用特定已承诺指令的 7-10 多签名称作 4-10 诚实假设（需要至少 4 个签名人保持诚实，才能应对无效的状态转换）以及 4-10 可杀死假设（死亡的签名人达到 4 个就无法再恢复资金）。</p>
<p>至于被预先签名的模拟程序，例如用于模拟 CTV 的变种，那就是另一回事，因为如果你的程序是正确的，而且你预先获得了 N-N 的签名，那么它就是 1-N 诚实假设（只需要 1 个参与者是诚实的，就能防止无效的状态转换），而且是不可杀死的（所有参与者都可以安全删除私钥）。</p>
<p>我认为这些关于活性和诚实性的假设只是不同的 “复杂性类别”。</p>
<p>我想指出的是，上面展示的计数器模型，完全就是一个预先签名的 1-N 诚实假设和不可杀死的限制条款，不要求来自签名者的任何活性。更进一步地说，有了 APO，限制条款的新实例就不需要新的一组签名者，启动设置是真正一次性的。因此，这种类型的限制条款的信任复杂度类型比使用预签名交易模拟的 CTV 甚至更低，因为后者需要在每一个合约实例中动用一个新的联盟来签名。</p>
<p>讲完这些之后，我们再来分析一下这个限制条款：</p>
<p>1）交易内容集合的一个集合（一个家族），可能是递归的或者共递归的（co-recursive）（例如，可以产生的状态转换的类型）。这些内容由可以不用交易本身，而用一种可以生成这些交易的语言来表示。在这个意义上，我们使用 “家族” 而非 “集合” 来称呼，因为要想实例化一个限制条款我们必须选出一些家庭成员。</p>
<p>这个交易内容集合的集合是为了 递增&#x2F;递减 到一个后代或者祖先，以及减半为两个实例或通过增加资金而使价值翻倍。每一个后代和祖先都是同类型的限制条款，就除了第一代和最后一代 —— 它们有一些特殊的规则。</p>
<p>2）一个验证器生成器，会产生一个函数，（该函数）接收一个交易内容（该内容是内容家族的一个成员的任意元素）以及一个相应的证明，并拒绝其它东西。</p>
<p>这里的验证器生成器就是 APO CHECKSIG 脚本。</p>
<p>3）一个证明器生成器，会产生一个函数，（该函数）接收一个交易内容（该内容是内容家族的一个成员的任意元素）以及一些额外的数据，并返回一个新的证明器函数、一个完成的诚征，或者拒绝（表示这不是一个有效的内容）。</p>
<p>这里的证明器生成器是从给定脚本的一个表格中选出正确的签名。</p>
<p>运行带有私钥的证明器生成器一次，就可以为所有可到达的状态实例化，并缓存相应的签名，然后其中的私钥就可以删除了（为了后续的运行）。</p>
<p>4）一组证明，让证明器、验证器和一组内容可以 “阻抗匹配”，也就是说，证明器可以证明的所有语句，与验证器可以验证的所有语句，是一一对应的；跟内容（一组交易）的一个元素也是一一对应的。</p>
<p>对给定的一个关键状态，可以发生的唯一时间就是签过名的交易，堆栈之外不需要解释其它数据。因此这是完美的阻抗匹配。</p>
<p>5）一组假设，限制条款就在这些假设下得到验证（例如，要求至少 1-N 诚实的多签名限制条款、要求任意 3-N 诚实的多签名限制条款、SHA256 抗碰撞性、离散对数难解、正确的 SGX 模块）。</p>
<p>特别的是，在启动阶段，至少一个私钥被彻底删除了。</p>
<p>为了安全性，也要假设对任何比特币交易来说都需要假设的有用方面。</p>
<p>6）可组合性</p>
<p>如果被任何其它限制条款家族请求，终局状态可以支付给一个预先指定的限制条款。</p>
<p>（完）</p>
</article></div></div></main><script src="/js/post.js?v=1673673209171"></script><script src="/js/highlight.min.js?v=1673673209171"></script><script>var containerEl = document.querySelector('.post-container');
var postFontSize = localStorage.getItem('post-font-size') || '16';
var inputEl = document.querySelector('#size-change-input');
var inputEl2 = document.querySelector('#size-change-input2');
inputEl.value = postFontSize;
inputEl2.value = postFontSize;
containerEl.style.fontSize = postFontSize + 'px';
$(function(){
  function setSizeChangeInputValue(size) {
    $('.post-container').css('font-size', size + 'px');
    localStorage.setItem('post-font-size', size);
    $('#size-change-input').val(size);
    $('#size-change-input2').val(size);
  }
  $('#size-change-input').on('input propertychange', function(e) {
    const size = e.target.value;
    setSizeChangeInputValue(size);
  });
  $('#size-change-input2').on('input propertychange', function(e) {
    const size = e.target.value;
    setSizeChangeInputValue(size);
  });
});
</script><script>hljs.initHighlightingOnLoad();</script></main></div><footer class="is-flex is-flex-direction-column is-align-items-center is-flex-shrink-0"><section class="sns-container"><a title="twitter" target="_blank" rel="noopener nofollow" href="//twitter.com/btcstudy">Twitter</a><!-- Github--><!-- Ins--><!-- RSS--><a title="rss" target="_blank" rel="noopener nofollow" href="/atom.xml">rss</a><!-- 知乎--><!-- 领英--><!-- 脸书--><!-- Telegram--><a title="telegram" target="_blank" rel="noopener nofollow" href="//t.me/btcstudyorg">Telegram</a></section></footer><script async src="/js/buttons.js?v=1673673209171"></script><script async src="/js/index.js?v=1673673209171"></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-JVCJ9XXG1Z"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());

gtag('config', 'G-JVCJ9XXG1Z');</script><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?c92c073c85be5be8d9b1b76f62a7e306";
  hm.async = true;
  hm.defer = true;
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
  </script></body></html>