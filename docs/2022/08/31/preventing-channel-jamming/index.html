<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><title>防止通道阻塞</title><meta name="keywords" content="比特币, 中本聪, 比特币区块链, 闪电网络, 比特币 layer 2, 健全货币, 密码货币, 密码朋克, 学习比特币, BTC, BTC Study, Bitcoin, bitcoin, proof of work"><meta name="description" content="比特币思想的中文集结地"><meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, initial-scale=1"><link rel="icon" href="/favicon.ico"><link rel="stylesheet" href="/style/common/bulma.css?v=1675068529980"><link rel="preload" as="style" onload="this.onload=null;this.rel='stylesheet'" href="/style/common/iconfont.css?v=1675068529980"><link rel="stylesheet" href="/style/base.css?v=1675068529980"><link rel="stylesheet" href="/style/common/helper.css?v=1675068529980"><link rel="stylesheet" href="/style/themes/animation.css?v=1675068529980"><script>function ready() {
  var bodyEl = document.querySelector('.body-container');
  var theme = localStorage.getItem('theme') || 'light';
  if (!['light', 'dark'].includes(theme)) {
    theme = 'light';
    localStorage.setItem('theme', 'light');
  }
  bodyEl.classList.remove('appearance-auto');
  bodyEl.classList.add('appearance-' + theme);
  quickInitialTheme();
}
function quickInitialTheme() {
  var theme = localStorage.getItem('theme') || 'light';
  var logoLightEl = document.querySelector('.logo-light');
  var logoDarkEl = document.querySelector('.logo-dark');
  
  var mLogoLightEl = document.querySelector('#mobile-header-logo > .logo-light');
  var mLogoDarkEl = document.querySelector('#mobile-header-logo > .logo-dark');
  var themeBtnEl = document.getElementById('theme-btn');
  
  var slideThemeLightEl = document.querySelector('.slide-theme-light');
  var slideThemeDarkEl = document.querySelector('.slide-theme-dark');
  
  document.body.classList.add(theme);
  if (theme === 'dark') {
    logoLightEl.classList.add('hidden');
    logoDarkEl.classList.remove('hidden');
    
    mLogoLightEl.classList.add('hidden');
    mLogoDarkEl.classList.remove('hidden');
    
    themeBtnEl.classList.remove('icon-icon_dark');
    themeBtnEl.classList.add('icon-icon_light');
    
    slideThemeLightEl.classList.remove('hidden');
  } else {
    slideThemeDarkEl.classList.remove('hidden');
  }
}
document.addEventListener("DOMContentLoaded", ready);</script><script src="/js/common.js?v=1675068529980"></script><script src="/js/libs/zepto.min.js"></script><link rel="stylesheet" href="/style/post.css?v=1675068529980"><link rel="stylesheet" href="/style/themes/highlight.css?v=1675068529980"><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="BTC Study" type="application/atom+xml">
</head><body class="is-flex is-flex-direction-column" onload="initialTheme()"><div class="clip"></div><div class="body-container appearance-auto"><header class="header-widget is-hidden-mobile is-flex is-flex-shrink-0 is-align-items-center is-justify-content-center" id="header"><div class="is-flex header-widget-container is-flex-shrink-0 is-align-items-center"><section class="is-hidden-mobile is-flex-shrink-0"><h1><a href="/"><svg class="logo-light" width="125px" height="23px" viewBox="0 0 125 23" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>BTCStudy</title><g id="页面-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="首页-响应式" transform="translate(-249.000000, -23.000000)" fill-rule="nonzero"><g id="BTCStudy" transform="translate(249.680000, 23.192000)"><path d="M9.072,17.808 C11.312,17.808 13.024,17.408 14.208,16.608 C15.392,15.808 15.984,14.672 15.984,13.2 C15.984,12.192 15.712,11.332 15.168,10.62 C14.624,9.908 13.872,9.384 12.912,9.048 C13.632,8.68 14.188,8.18 14.58,7.548 C14.972,6.916 15.168,6.2 15.168,5.4 C15.168,4.056 14.608,2.988 13.488,2.196 C12.368,1.404 10.736,1.008 8.592,1.008 L8.592,1.008 L-5.68434189e-14,1.008 L-5.68434189e-14,17.808 L9.072,17.808 Z M7.968,7.68 L4.704,7.68 L4.704,4.44 L7.968,4.44 C9.568,4.44 10.368,4.976 10.368,6.048 C10.368,7.136 9.568,7.68 7.968,7.68 L7.968,7.68 Z M8.688,14.376 L4.704,14.376 L4.704,10.968 L8.688,10.968 C10.352,10.968 11.184,11.536 11.184,12.672 C11.184,13.808 10.352,14.376 8.688,14.376 L8.688,14.376 Z M26.544,17.808 L26.544,4.776 L31.68,4.776 L31.68,1.008 L16.632,1.008 L16.632,4.776 L21.792,4.776 L21.792,17.808 L26.544,17.808 Z M41.592,18.144 C43.128,18.144 44.512,17.872 45.744,17.328 C46.976,16.784 48,16 48.816,14.976 L48.816,14.976 L45.792,12.24 C44.704,13.552 43.384,14.208 41.832,14.208 C40.92,14.208 40.108,14.008 39.396,13.608 C38.684,13.208 38.132,12.644 37.74,11.916 C37.348,11.188 37.152,10.352 37.152,9.408 C37.152,8.464 37.348,7.628 37.74,6.9 C38.132,6.172 38.684,5.608 39.396,5.208 C40.108,4.808 40.92,4.608 41.832,4.608 C43.384,4.608 44.704,5.264 45.792,6.576 L45.792,6.576 L48.816,3.84 C48,2.816 46.976,2.032 45.744,1.488 C44.512,0.944 43.128,0.672 41.592,0.672 C39.832,0.672 38.252,1.044 36.852,1.788 C35.452,2.532 34.352,3.568 33.552,4.896 C32.752,6.224 32.352,7.728 32.352,9.408 C32.352,11.088 32.752,12.592 33.552,13.92 C34.352,15.248 35.452,16.284 36.852,17.028 C38.252,17.772 39.832,18.144 41.592,18.144 Z" id="BTC" fill="#F2A900"></path><path d="M56.64,18.144 C58.24,18.144 59.6,17.9 60.72,17.412 C61.84,16.924 62.68,16.272 63.24,15.456 C63.8,14.64 64.08,13.728 64.08,12.72 C64.08,11.552 63.772,10.628 63.156,9.948 C62.54,9.268 61.812,8.772 60.972,8.46 C60.132,8.148 59.072,7.856 57.792,7.584 C56.656,7.344 55.832,7.112 55.32,6.888 C54.808,6.664 54.552,6.328 54.552,5.88 C54.552,5.432 54.768,5.068 55.2,4.788 C55.632,4.508 56.32,4.368 57.264,4.368 C58.768,4.368 60.32,4.8 61.92,5.664 L61.92,5.664 L63.384,2.136 C62.568,1.656 61.624,1.292 60.552,1.044 C59.48,0.796 58.392,0.672 57.288,0.672 C55.672,0.672 54.308,0.912 53.196,1.392 C52.084,1.872 51.248,2.524 50.688,3.348 C50.128,4.172 49.848,5.096 49.848,6.12 C49.848,7.288 50.152,8.216 50.76,8.904 C51.368,9.592 52.096,10.092 52.944,10.404 C53.792,10.716 54.848,11.008 56.112,11.28 C57.264,11.536 58.1,11.78 58.62,12.012 C59.14,12.244 59.4,12.6 59.4,13.08 C59.4,13.992 58.488,14.448 56.664,14.448 C55.704,14.448 54.728,14.296 53.736,13.992 C52.744,13.688 51.872,13.288 51.12,12.792 L51.12,12.792 L49.56,16.296 C50.36,16.856 51.4,17.304 52.68,17.64 C53.96,17.976 55.28,18.144 56.64,18.144 Z M71.856,18.024 C72.48,18.024 73.068,17.96 73.62,17.832 C74.172,17.704 74.64,17.52 75.024,17.28 L75.024,17.28 L73.896,14.088 C73.496,14.36 73.032,14.496 72.504,14.496 C72.088,14.496 71.756,14.364 71.508,14.1 C71.26,13.836 71.136,13.472 71.136,13.008 L71.136,13.008 L71.136,8.688 L74.112,8.688 L74.112,5.28 L71.136,5.28 L71.136,1.896 L66.576,1.896 L66.576,5.28 L64.68,5.28 L64.68,8.688 L66.576,8.688 L66.576,13.056 C66.576,14.704 67.032,15.944 67.944,16.776 C68.856,17.608 70.16,18.024 71.856,18.024 Z M82.248,18.024 C83,18.024 83.712,17.888 84.384,17.616 C85.056,17.344 85.632,16.944 86.112,16.416 L86.112,16.416 L86.112,17.808 L90.456,17.808 L90.456,4.8 L85.896,4.8 L85.896,11.064 C85.896,12.104 85.668,12.876 85.212,13.38 C84.756,13.884 84.168,14.136 83.448,14.136 C82.744,14.136 82.208,13.912 81.84,13.464 C81.472,13.016 81.288,12.304 81.288,11.328 L81.288,11.328 L81.288,4.8 L76.728,4.8 L76.728,12.072 C76.728,14.056 77.228,15.544 78.228,16.536 C79.228,17.528 80.568,18.024 82.248,18.024 Z M99.048,18.024 C100.744,18.024 102.016,17.52 102.864,16.512 L102.864,16.512 L102.864,17.808 L107.208,17.808 L107.208,0 L102.648,0 L102.648,5.928 C101.8,5.032 100.6,4.584 99.048,4.584 C97.864,4.584 96.784,4.856 95.808,5.4 C94.832,5.944 94.06,6.724 93.492,7.74 C92.924,8.756 92.64,9.936 92.64,11.28 C92.64,12.624 92.924,13.808 93.492,14.832 C94.06,15.856 94.832,16.644 95.808,17.196 C96.784,17.748 97.864,18.024 99.048,18.024 Z M100.008,14.4 C99.208,14.4 98.552,14.124 98.04,13.572 C97.528,13.02 97.272,12.256 97.272,11.28 C97.272,10.32 97.528,9.568 98.04,9.024 C98.552,8.48 99.208,8.208 100.008,8.208 C100.808,8.208 101.46,8.48 101.964,9.024 C102.468,9.568 102.72,10.32 102.72,11.28 C102.72,12.256 102.464,13.02 101.952,13.572 C101.44,14.124 100.792,14.4 100.008,14.4 Z M112.368,22.68 C113.728,22.68 114.88,22.356 115.824,21.708 C116.768,21.06 117.568,19.936 118.224,18.336 L118.224,18.336 L123.84,4.8 L119.496,4.8 L116.28,12.744 L113.088,4.8 L108.408,4.8 L113.976,17.976 C113.784,18.36 113.548,18.64 113.268,18.816 C112.988,18.992 112.632,19.08 112.2,19.08 C111.832,19.08 111.468,19.012 111.108,18.876 C110.748,18.74 110.44,18.552 110.184,18.312 L110.184,18.312 L108.6,21.504 C109.032,21.856 109.596,22.14 110.292,22.356 C110.988,22.572 111.68,22.68 112.368,22.68 Z" id="Study" fill-opacity="0.85" fill="#000000"></path></g></g></g></svg><svg class="logo-dark hidden" width="125px" height="23px" viewBox="0 0 125 23" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>BTCStudy</title><g id="页面-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="首页-响应式" transform="translate(-249.000000, -23.000000)" fill-rule="nonzero"><g id="BTCStudy" transform="translate(249.680000, 23.192000)"><path d="M9.072,17.808 C11.312,17.808 13.024,17.408 14.208,16.608 C15.392,15.808 15.984,14.672 15.984,13.2 C15.984,12.192 15.712,11.332 15.168,10.62 C14.624,9.908 13.872,9.384 12.912,9.048 C13.632,8.68 14.188,8.18 14.58,7.548 C14.972,6.916 15.168,6.2 15.168,5.4 C15.168,4.056 14.608,2.988 13.488,2.196 C12.368,1.404 10.736,1.008 8.592,1.008 L8.592,1.008 L-5.68434189e-14,1.008 L-5.68434189e-14,17.808 L9.072,17.808 Z M7.968,7.68 L4.704,7.68 L4.704,4.44 L7.968,4.44 C9.568,4.44 10.368,4.976 10.368,6.048 C10.368,7.136 9.568,7.68 7.968,7.68 L7.968,7.68 Z M8.688,14.376 L4.704,14.376 L4.704,10.968 L8.688,10.968 C10.352,10.968 11.184,11.536 11.184,12.672 C11.184,13.808 10.352,14.376 8.688,14.376 L8.688,14.376 Z M26.544,17.808 L26.544,4.776 L31.68,4.776 L31.68,1.008 L16.632,1.008 L16.632,4.776 L21.792,4.776 L21.792,17.808 L26.544,17.808 Z M41.592,18.144 C43.128,18.144 44.512,17.872 45.744,17.328 C46.976,16.784 48,16 48.816,14.976 L48.816,14.976 L45.792,12.24 C44.704,13.552 43.384,14.208 41.832,14.208 C40.92,14.208 40.108,14.008 39.396,13.608 C38.684,13.208 38.132,12.644 37.74,11.916 C37.348,11.188 37.152,10.352 37.152,9.408 C37.152,8.464 37.348,7.628 37.74,6.9 C38.132,6.172 38.684,5.608 39.396,5.208 C40.108,4.808 40.92,4.608 41.832,4.608 C43.384,4.608 44.704,5.264 45.792,6.576 L45.792,6.576 L48.816,3.84 C48,2.816 46.976,2.032 45.744,1.488 C44.512,0.944 43.128,0.672 41.592,0.672 C39.832,0.672 38.252,1.044 36.852,1.788 C35.452,2.532 34.352,3.568 33.552,4.896 C32.752,6.224 32.352,7.728 32.352,9.408 C32.352,11.088 32.752,12.592 33.552,13.92 C34.352,15.248 35.452,16.284 36.852,17.028 C38.252,17.772 39.832,18.144 41.592,18.144 Z" id="BTC" fill="#F2A900"></path><path d="M56.64,18.144 C58.24,18.144 59.6,17.9 60.72,17.412 C61.84,16.924 62.68,16.272 63.24,15.456 C63.8,14.64 64.08,13.728 64.08,12.72 C64.08,11.552 63.772,10.628 63.156,9.948 C62.54,9.268 61.812,8.772 60.972,8.46 C60.132,8.148 59.072,7.856 57.792,7.584 C56.656,7.344 55.832,7.112 55.32,6.888 C54.808,6.664 54.552,6.328 54.552,5.88 C54.552,5.432 54.768,5.068 55.2,4.788 C55.632,4.508 56.32,4.368 57.264,4.368 C58.768,4.368 60.32,4.8 61.92,5.664 L61.92,5.664 L63.384,2.136 C62.568,1.656 61.624,1.292 60.552,1.044 C59.48,0.796 58.392,0.672 57.288,0.672 C55.672,0.672 54.308,0.912 53.196,1.392 C52.084,1.872 51.248,2.524 50.688,3.348 C50.128,4.172 49.848,5.096 49.848,6.12 C49.848,7.288 50.152,8.216 50.76,8.904 C51.368,9.592 52.096,10.092 52.944,10.404 C53.792,10.716 54.848,11.008 56.112,11.28 C57.264,11.536 58.1,11.78 58.62,12.012 C59.14,12.244 59.4,12.6 59.4,13.08 C59.4,13.992 58.488,14.448 56.664,14.448 C55.704,14.448 54.728,14.296 53.736,13.992 C52.744,13.688 51.872,13.288 51.12,12.792 L51.12,12.792 L49.56,16.296 C50.36,16.856 51.4,17.304 52.68,17.64 C53.96,17.976 55.28,18.144 56.64,18.144 Z M71.856,18.024 C72.48,18.024 73.068,17.96 73.62,17.832 C74.172,17.704 74.64,17.52 75.024,17.28 L75.024,17.28 L73.896,14.088 C73.496,14.36 73.032,14.496 72.504,14.496 C72.088,14.496 71.756,14.364 71.508,14.1 C71.26,13.836 71.136,13.472 71.136,13.008 L71.136,13.008 L71.136,8.688 L74.112,8.688 L74.112,5.28 L71.136,5.28 L71.136,1.896 L66.576,1.896 L66.576,5.28 L64.68,5.28 L64.68,8.688 L66.576,8.688 L66.576,13.056 C66.576,14.704 67.032,15.944 67.944,16.776 C68.856,17.608 70.16,18.024 71.856,18.024 Z M82.248,18.024 C83,18.024 83.712,17.888 84.384,17.616 C85.056,17.344 85.632,16.944 86.112,16.416 L86.112,16.416 L86.112,17.808 L90.456,17.808 L90.456,4.8 L85.896,4.8 L85.896,11.064 C85.896,12.104 85.668,12.876 85.212,13.38 C84.756,13.884 84.168,14.136 83.448,14.136 C82.744,14.136 82.208,13.912 81.84,13.464 C81.472,13.016 81.288,12.304 81.288,11.328 L81.288,11.328 L81.288,4.8 L76.728,4.8 L76.728,12.072 C76.728,14.056 77.228,15.544 78.228,16.536 C79.228,17.528 80.568,18.024 82.248,18.024 Z M99.048,18.024 C100.744,18.024 102.016,17.52 102.864,16.512 L102.864,16.512 L102.864,17.808 L107.208,17.808 L107.208,0 L102.648,0 L102.648,5.928 C101.8,5.032 100.6,4.584 99.048,4.584 C97.864,4.584 96.784,4.856 95.808,5.4 C94.832,5.944 94.06,6.724 93.492,7.74 C92.924,8.756 92.64,9.936 92.64,11.28 C92.64,12.624 92.924,13.808 93.492,14.832 C94.06,15.856 94.832,16.644 95.808,17.196 C96.784,17.748 97.864,18.024 99.048,18.024 Z M100.008,14.4 C99.208,14.4 98.552,14.124 98.04,13.572 C97.528,13.02 97.272,12.256 97.272,11.28 C97.272,10.32 97.528,9.568 98.04,9.024 C98.552,8.48 99.208,8.208 100.008,8.208 C100.808,8.208 101.46,8.48 101.964,9.024 C102.468,9.568 102.72,10.32 102.72,11.28 C102.72,12.256 102.464,13.02 101.952,13.572 C101.44,14.124 100.792,14.4 100.008,14.4 Z M112.368,22.68 C113.728,22.68 114.88,22.356 115.824,21.708 C116.768,21.06 117.568,19.936 118.224,18.336 L118.224,18.336 L123.84,4.8 L119.496,4.8 L116.28,12.744 L113.088,4.8 L108.408,4.8 L113.976,17.976 C113.784,18.36 113.548,18.64 113.268,18.816 C112.988,18.992 112.632,19.08 112.2,19.08 C111.832,19.08 111.468,19.012 111.108,18.876 C110.748,18.74 110.44,18.552 110.184,18.312 L110.184,18.312 L108.6,21.504 C109.032,21.856 109.596,22.14 110.292,22.356 C110.988,22.572 111.68,22.68 112.368,22.68 Z" id="Study" fill-opacity="0.85" fill="#FFFFFF"></path></g></g></g></svg></a></h1></section><div class="is-flex is-flex-direction-column header-menu-wrap"><aside class="is-flex-shrink-0 is-flex is-flex-direction-row is-align-items-center" id="header-menu"><a class="is-inline-block header-activity mr-4" href="/">首页</a><a class="is-inline-block mr-4" href="/archives">全站目录</a><a class="is-inline-block mr-4" href="/tags">标签</a><a class="is-inline-block mr-4" href="/maps">地图</a><a class="is-inline-block mr-4" href="/mempool">mempool</a><a class="is-inline-block mr-4" target="_blank" rel="noopener" href="https://123btc.org/">123btc</a><div class="right-content is-flex is-flex-direction-row is-align-items-center"><div class="size-wrap mr-1"><i class="iconfont icon-a-bianzu5" id="change-size-btn"></i><div class="size-input-wrap"><div class="input-wrap"><input id="size-change-input" type="range" min="12" max="32" step="2"></div></div></div><i class="iconfont icon-icon_dark mr-1" id="theme-btn"></i><div class="search-wrap"><input class="pl-3" id="search-input" placeholder="请输入搜索关键词"><i class="iconfont icon-icon_search" id="search-input-btn"></i></div></div></aside><div class="header-title is-hidden-mobile is-full-height is-flex is-align-items-center is-flex-shrink-0"><div class="is-full-height hidden" id="postTopic"><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">防止通道阻塞</p><div class="size-wrap mr-1"><i class="iconfont icon-a-bianzu5" id="change-size-btn2"></i><div class="size-input-wrap"><div class="input-wrap"><input id="size-change-input2" type="range" min="12" max="32" step="2"></div></div></div></div></div></div></div></header><header class="is-flex header-widget is-flex-shrink-0 is-align-items-center is-justify-content-space-between is-hidden-tablet" id="mobile-header"><div class="is-flex is-flex-direction-row is-align-items-center"><i class="iconfont icon-icon_bar mobile-header-menu"></i><div id="mobile-header-logo"><svg class="logo-light" width="125px" height="23px" viewBox="0 0 125 23" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>BTCStudy</title><g id="页面-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="首页-响应式" transform="translate(-249.000000, -23.000000)" fill-rule="nonzero"><g id="BTCStudy" transform="translate(249.680000, 23.192000)"><path d="M9.072,17.808 C11.312,17.808 13.024,17.408 14.208,16.608 C15.392,15.808 15.984,14.672 15.984,13.2 C15.984,12.192 15.712,11.332 15.168,10.62 C14.624,9.908 13.872,9.384 12.912,9.048 C13.632,8.68 14.188,8.18 14.58,7.548 C14.972,6.916 15.168,6.2 15.168,5.4 C15.168,4.056 14.608,2.988 13.488,2.196 C12.368,1.404 10.736,1.008 8.592,1.008 L8.592,1.008 L-5.68434189e-14,1.008 L-5.68434189e-14,17.808 L9.072,17.808 Z M7.968,7.68 L4.704,7.68 L4.704,4.44 L7.968,4.44 C9.568,4.44 10.368,4.976 10.368,6.048 C10.368,7.136 9.568,7.68 7.968,7.68 L7.968,7.68 Z M8.688,14.376 L4.704,14.376 L4.704,10.968 L8.688,10.968 C10.352,10.968 11.184,11.536 11.184,12.672 C11.184,13.808 10.352,14.376 8.688,14.376 L8.688,14.376 Z M26.544,17.808 L26.544,4.776 L31.68,4.776 L31.68,1.008 L16.632,1.008 L16.632,4.776 L21.792,4.776 L21.792,17.808 L26.544,17.808 Z M41.592,18.144 C43.128,18.144 44.512,17.872 45.744,17.328 C46.976,16.784 48,16 48.816,14.976 L48.816,14.976 L45.792,12.24 C44.704,13.552 43.384,14.208 41.832,14.208 C40.92,14.208 40.108,14.008 39.396,13.608 C38.684,13.208 38.132,12.644 37.74,11.916 C37.348,11.188 37.152,10.352 37.152,9.408 C37.152,8.464 37.348,7.628 37.74,6.9 C38.132,6.172 38.684,5.608 39.396,5.208 C40.108,4.808 40.92,4.608 41.832,4.608 C43.384,4.608 44.704,5.264 45.792,6.576 L45.792,6.576 L48.816,3.84 C48,2.816 46.976,2.032 45.744,1.488 C44.512,0.944 43.128,0.672 41.592,0.672 C39.832,0.672 38.252,1.044 36.852,1.788 C35.452,2.532 34.352,3.568 33.552,4.896 C32.752,6.224 32.352,7.728 32.352,9.408 C32.352,11.088 32.752,12.592 33.552,13.92 C34.352,15.248 35.452,16.284 36.852,17.028 C38.252,17.772 39.832,18.144 41.592,18.144 Z" id="BTC" fill="#F2A900"></path><path d="M56.64,18.144 C58.24,18.144 59.6,17.9 60.72,17.412 C61.84,16.924 62.68,16.272 63.24,15.456 C63.8,14.64 64.08,13.728 64.08,12.72 C64.08,11.552 63.772,10.628 63.156,9.948 C62.54,9.268 61.812,8.772 60.972,8.46 C60.132,8.148 59.072,7.856 57.792,7.584 C56.656,7.344 55.832,7.112 55.32,6.888 C54.808,6.664 54.552,6.328 54.552,5.88 C54.552,5.432 54.768,5.068 55.2,4.788 C55.632,4.508 56.32,4.368 57.264,4.368 C58.768,4.368 60.32,4.8 61.92,5.664 L61.92,5.664 L63.384,2.136 C62.568,1.656 61.624,1.292 60.552,1.044 C59.48,0.796 58.392,0.672 57.288,0.672 C55.672,0.672 54.308,0.912 53.196,1.392 C52.084,1.872 51.248,2.524 50.688,3.348 C50.128,4.172 49.848,5.096 49.848,6.12 C49.848,7.288 50.152,8.216 50.76,8.904 C51.368,9.592 52.096,10.092 52.944,10.404 C53.792,10.716 54.848,11.008 56.112,11.28 C57.264,11.536 58.1,11.78 58.62,12.012 C59.14,12.244 59.4,12.6 59.4,13.08 C59.4,13.992 58.488,14.448 56.664,14.448 C55.704,14.448 54.728,14.296 53.736,13.992 C52.744,13.688 51.872,13.288 51.12,12.792 L51.12,12.792 L49.56,16.296 C50.36,16.856 51.4,17.304 52.68,17.64 C53.96,17.976 55.28,18.144 56.64,18.144 Z M71.856,18.024 C72.48,18.024 73.068,17.96 73.62,17.832 C74.172,17.704 74.64,17.52 75.024,17.28 L75.024,17.28 L73.896,14.088 C73.496,14.36 73.032,14.496 72.504,14.496 C72.088,14.496 71.756,14.364 71.508,14.1 C71.26,13.836 71.136,13.472 71.136,13.008 L71.136,13.008 L71.136,8.688 L74.112,8.688 L74.112,5.28 L71.136,5.28 L71.136,1.896 L66.576,1.896 L66.576,5.28 L64.68,5.28 L64.68,8.688 L66.576,8.688 L66.576,13.056 C66.576,14.704 67.032,15.944 67.944,16.776 C68.856,17.608 70.16,18.024 71.856,18.024 Z M82.248,18.024 C83,18.024 83.712,17.888 84.384,17.616 C85.056,17.344 85.632,16.944 86.112,16.416 L86.112,16.416 L86.112,17.808 L90.456,17.808 L90.456,4.8 L85.896,4.8 L85.896,11.064 C85.896,12.104 85.668,12.876 85.212,13.38 C84.756,13.884 84.168,14.136 83.448,14.136 C82.744,14.136 82.208,13.912 81.84,13.464 C81.472,13.016 81.288,12.304 81.288,11.328 L81.288,11.328 L81.288,4.8 L76.728,4.8 L76.728,12.072 C76.728,14.056 77.228,15.544 78.228,16.536 C79.228,17.528 80.568,18.024 82.248,18.024 Z M99.048,18.024 C100.744,18.024 102.016,17.52 102.864,16.512 L102.864,16.512 L102.864,17.808 L107.208,17.808 L107.208,0 L102.648,0 L102.648,5.928 C101.8,5.032 100.6,4.584 99.048,4.584 C97.864,4.584 96.784,4.856 95.808,5.4 C94.832,5.944 94.06,6.724 93.492,7.74 C92.924,8.756 92.64,9.936 92.64,11.28 C92.64,12.624 92.924,13.808 93.492,14.832 C94.06,15.856 94.832,16.644 95.808,17.196 C96.784,17.748 97.864,18.024 99.048,18.024 Z M100.008,14.4 C99.208,14.4 98.552,14.124 98.04,13.572 C97.528,13.02 97.272,12.256 97.272,11.28 C97.272,10.32 97.528,9.568 98.04,9.024 C98.552,8.48 99.208,8.208 100.008,8.208 C100.808,8.208 101.46,8.48 101.964,9.024 C102.468,9.568 102.72,10.32 102.72,11.28 C102.72,12.256 102.464,13.02 101.952,13.572 C101.44,14.124 100.792,14.4 100.008,14.4 Z M112.368,22.68 C113.728,22.68 114.88,22.356 115.824,21.708 C116.768,21.06 117.568,19.936 118.224,18.336 L118.224,18.336 L123.84,4.8 L119.496,4.8 L116.28,12.744 L113.088,4.8 L108.408,4.8 L113.976,17.976 C113.784,18.36 113.548,18.64 113.268,18.816 C112.988,18.992 112.632,19.08 112.2,19.08 C111.832,19.08 111.468,19.012 111.108,18.876 C110.748,18.74 110.44,18.552 110.184,18.312 L110.184,18.312 L108.6,21.504 C109.032,21.856 109.596,22.14 110.292,22.356 C110.988,22.572 111.68,22.68 112.368,22.68 Z" id="Study" fill-opacity="0.85" fill="#000000"></path></g></g></g></svg><svg class="logo-dark hidden" width="125px" height="23px" viewBox="0 0 125 23" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>BTCStudy</title><g id="页面-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="首页-响应式" transform="translate(-249.000000, -23.000000)" fill-rule="nonzero"><g id="BTCStudy" transform="translate(249.680000, 23.192000)"><path d="M9.072,17.808 C11.312,17.808 13.024,17.408 14.208,16.608 C15.392,15.808 15.984,14.672 15.984,13.2 C15.984,12.192 15.712,11.332 15.168,10.62 C14.624,9.908 13.872,9.384 12.912,9.048 C13.632,8.68 14.188,8.18 14.58,7.548 C14.972,6.916 15.168,6.2 15.168,5.4 C15.168,4.056 14.608,2.988 13.488,2.196 C12.368,1.404 10.736,1.008 8.592,1.008 L8.592,1.008 L-5.68434189e-14,1.008 L-5.68434189e-14,17.808 L9.072,17.808 Z M7.968,7.68 L4.704,7.68 L4.704,4.44 L7.968,4.44 C9.568,4.44 10.368,4.976 10.368,6.048 C10.368,7.136 9.568,7.68 7.968,7.68 L7.968,7.68 Z M8.688,14.376 L4.704,14.376 L4.704,10.968 L8.688,10.968 C10.352,10.968 11.184,11.536 11.184,12.672 C11.184,13.808 10.352,14.376 8.688,14.376 L8.688,14.376 Z M26.544,17.808 L26.544,4.776 L31.68,4.776 L31.68,1.008 L16.632,1.008 L16.632,4.776 L21.792,4.776 L21.792,17.808 L26.544,17.808 Z M41.592,18.144 C43.128,18.144 44.512,17.872 45.744,17.328 C46.976,16.784 48,16 48.816,14.976 L48.816,14.976 L45.792,12.24 C44.704,13.552 43.384,14.208 41.832,14.208 C40.92,14.208 40.108,14.008 39.396,13.608 C38.684,13.208 38.132,12.644 37.74,11.916 C37.348,11.188 37.152,10.352 37.152,9.408 C37.152,8.464 37.348,7.628 37.74,6.9 C38.132,6.172 38.684,5.608 39.396,5.208 C40.108,4.808 40.92,4.608 41.832,4.608 C43.384,4.608 44.704,5.264 45.792,6.576 L45.792,6.576 L48.816,3.84 C48,2.816 46.976,2.032 45.744,1.488 C44.512,0.944 43.128,0.672 41.592,0.672 C39.832,0.672 38.252,1.044 36.852,1.788 C35.452,2.532 34.352,3.568 33.552,4.896 C32.752,6.224 32.352,7.728 32.352,9.408 C32.352,11.088 32.752,12.592 33.552,13.92 C34.352,15.248 35.452,16.284 36.852,17.028 C38.252,17.772 39.832,18.144 41.592,18.144 Z" id="BTC" fill="#F2A900"></path><path d="M56.64,18.144 C58.24,18.144 59.6,17.9 60.72,17.412 C61.84,16.924 62.68,16.272 63.24,15.456 C63.8,14.64 64.08,13.728 64.08,12.72 C64.08,11.552 63.772,10.628 63.156,9.948 C62.54,9.268 61.812,8.772 60.972,8.46 C60.132,8.148 59.072,7.856 57.792,7.584 C56.656,7.344 55.832,7.112 55.32,6.888 C54.808,6.664 54.552,6.328 54.552,5.88 C54.552,5.432 54.768,5.068 55.2,4.788 C55.632,4.508 56.32,4.368 57.264,4.368 C58.768,4.368 60.32,4.8 61.92,5.664 L61.92,5.664 L63.384,2.136 C62.568,1.656 61.624,1.292 60.552,1.044 C59.48,0.796 58.392,0.672 57.288,0.672 C55.672,0.672 54.308,0.912 53.196,1.392 C52.084,1.872 51.248,2.524 50.688,3.348 C50.128,4.172 49.848,5.096 49.848,6.12 C49.848,7.288 50.152,8.216 50.76,8.904 C51.368,9.592 52.096,10.092 52.944,10.404 C53.792,10.716 54.848,11.008 56.112,11.28 C57.264,11.536 58.1,11.78 58.62,12.012 C59.14,12.244 59.4,12.6 59.4,13.08 C59.4,13.992 58.488,14.448 56.664,14.448 C55.704,14.448 54.728,14.296 53.736,13.992 C52.744,13.688 51.872,13.288 51.12,12.792 L51.12,12.792 L49.56,16.296 C50.36,16.856 51.4,17.304 52.68,17.64 C53.96,17.976 55.28,18.144 56.64,18.144 Z M71.856,18.024 C72.48,18.024 73.068,17.96 73.62,17.832 C74.172,17.704 74.64,17.52 75.024,17.28 L75.024,17.28 L73.896,14.088 C73.496,14.36 73.032,14.496 72.504,14.496 C72.088,14.496 71.756,14.364 71.508,14.1 C71.26,13.836 71.136,13.472 71.136,13.008 L71.136,13.008 L71.136,8.688 L74.112,8.688 L74.112,5.28 L71.136,5.28 L71.136,1.896 L66.576,1.896 L66.576,5.28 L64.68,5.28 L64.68,8.688 L66.576,8.688 L66.576,13.056 C66.576,14.704 67.032,15.944 67.944,16.776 C68.856,17.608 70.16,18.024 71.856,18.024 Z M82.248,18.024 C83,18.024 83.712,17.888 84.384,17.616 C85.056,17.344 85.632,16.944 86.112,16.416 L86.112,16.416 L86.112,17.808 L90.456,17.808 L90.456,4.8 L85.896,4.8 L85.896,11.064 C85.896,12.104 85.668,12.876 85.212,13.38 C84.756,13.884 84.168,14.136 83.448,14.136 C82.744,14.136 82.208,13.912 81.84,13.464 C81.472,13.016 81.288,12.304 81.288,11.328 L81.288,11.328 L81.288,4.8 L76.728,4.8 L76.728,12.072 C76.728,14.056 77.228,15.544 78.228,16.536 C79.228,17.528 80.568,18.024 82.248,18.024 Z M99.048,18.024 C100.744,18.024 102.016,17.52 102.864,16.512 L102.864,16.512 L102.864,17.808 L107.208,17.808 L107.208,0 L102.648,0 L102.648,5.928 C101.8,5.032 100.6,4.584 99.048,4.584 C97.864,4.584 96.784,4.856 95.808,5.4 C94.832,5.944 94.06,6.724 93.492,7.74 C92.924,8.756 92.64,9.936 92.64,11.28 C92.64,12.624 92.924,13.808 93.492,14.832 C94.06,15.856 94.832,16.644 95.808,17.196 C96.784,17.748 97.864,18.024 99.048,18.024 Z M100.008,14.4 C99.208,14.4 98.552,14.124 98.04,13.572 C97.528,13.02 97.272,12.256 97.272,11.28 C97.272,10.32 97.528,9.568 98.04,9.024 C98.552,8.48 99.208,8.208 100.008,8.208 C100.808,8.208 101.46,8.48 101.964,9.024 C102.468,9.568 102.72,10.32 102.72,11.28 C102.72,12.256 102.464,13.02 101.952,13.572 C101.44,14.124 100.792,14.4 100.008,14.4 Z M112.368,22.68 C113.728,22.68 114.88,22.356 115.824,21.708 C116.768,21.06 117.568,19.936 118.224,18.336 L118.224,18.336 L123.84,4.8 L119.496,4.8 L116.28,12.744 L113.088,4.8 L108.408,4.8 L113.976,17.976 C113.784,18.36 113.548,18.64 113.268,18.816 C112.988,18.992 112.632,19.08 112.2,19.08 C111.832,19.08 111.468,19.012 111.108,18.876 C110.748,18.74 110.44,18.552 110.184,18.312 L110.184,18.312 L108.6,21.504 C109.032,21.856 109.596,22.14 110.292,22.356 C110.988,22.572 111.68,22.68 112.368,22.68 Z" id="Study" fill-opacity="0.85" fill="#FFFFFF"></path></g></g></g></svg></div><div class="mobile-header-title is-full-height is-flex is-align-items-center is-flex-shrink-0"><div class="is-full-height hidden" id="postTopicMobile"><p class="is-full-height">防止通道阻塞</p></div></div></div><i class="iconfont icon-icon_search mobile-header-searchIcon"></i><div class="mobile-search-wrap"><div class="search-input"><input class="pl-3" id="mobile-search-input" placeholder="请输入搜索关键词"><i class="iconfont icon-icon_search mobile-search-input-btn"></i><button class="mobile-search-input-btn">搜 索</button></div></div></header><div class="mobile-slide-menu"><a class="header-activity" href="/">首页</a><a href="/archives">全站目录</a><a href="/tags">标签</a><a href="/maps">地图</a><a href="/mempool">mempool</a><a target="_blank" rel="noopener" href="https://123btc.org/">123btc</a><div><p class="slide-menu-theme is-flex is-flex-direction-row is-justify-content-space-between is-align-items-center"><span>主题设置</span><span><i class="iconfont icon-icon_light slide-theme-light hidden"></i><i class="iconfont icon-icon_dark slide-theme-dark hidden"></i></span></p><p class="slide-menu-fontsize"><span>字体设置</span><span><i class="iconfont icon-bianzubeifen"></i><i class="iconfont icon-bianzu"></i></span></p></div></div><div class="search-mask hidden"><script src="/js/header.js?v=1675068529980"> </script></div><main><main class="container is-max-widescreen content section post-page pt-4"><div class="columns is-flex-desktop is-justify-content-center"><div class="column is-3 silde-bar is-hidden-mobile"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BC%95%E8%A8%80"><span class="toc-text">引言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF-%E2%80%9C%E9%80%9A%E9%81%93%E9%98%BB%E5%A1%9E%E6%94%BB%E5%87%BB%E2%80%9D%EF%BC%9F"><span class="toc-text">什么是 “通道阻塞攻击”？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%80%9A%E9%81%93%E9%98%BB%E5%A1%9E%E7%9A%84%E7%B1%BB%E5%9E%8B"><span class="toc-text">通道阻塞的类型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B6%85%E6%97%B6%E6%9C%BA%E5%88%B6%E6%98%AF%E4%B8%8D%E5%8F%AF%E8%A1%8C%E7%9A%84%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95"><span class="toc-text">超时机制是不可行的解决办法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9A%BE%E9%81%93%E6%89%A3%E4%BD%8F%E8%B5%84%E9%87%91%E4%B9%9F%E6%98%AF%E4%B8%80%E7%A7%8D%E6%94%BB%E5%87%BB%E5%90%97%EF%BC%9F"><span class="toc-text">难道扣住资金也是一种攻击吗？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%88%90%E6%9C%AC%E5%9F%BA%E5%87%86"><span class="toc-text">成本基准</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B8%90%E8%BF%9B%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88"><span class="toc-text">渐进的解决方案</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8F%90%E9%AB%98%E7%BA%BF%E7%A8%8B%E6%95%B0%E9%87%8F%E9%99%90%E5%88%B6%EF%BC%88%E7%94%B1-niftynei-%E6%8F%90%E5%87%BA%EF%BC%89"><span class="toc-text">提高线程数量限制（由 @niftynei 提出）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%99%E7%BA%BF%E7%A8%8B%E5%88%86%E7%B1%BB%EF%BC%88%E7%94%B1-niftynei-%E6%8F%90%E5%87%BA%EF%BC%89"><span class="toc-text">给线程分类（由 @niftynei 提出）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%B9%E7%AD%89%E8%8A%82%E7%82%B9%E5%AF%B9%E4%B8%8A%E4%B8%80%E8%B7%B3%E6%96%BD%E5%8A%A0%E9%99%90%E5%88%B6"><span class="toc-text">对等节点对上一跳施加限制</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A0%B9%E6%9C%AC%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88"><span class="toc-text">根本解决方案</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%84%E4%BB%98%E6%89%8B%E7%BB%AD%E8%B4%B9%EF%BC%88%E7%94%B1-joost-%E5%92%8C-t-bast-%E6%8F%90%E5%87%BA%EF%BC%89"><span class="toc-text">预付手续费（由 @joost 和 @t-bast 提出）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%94%AF%E4%BB%98%E5%8F%91%E9%80%81%E8%80%85%E7%9A%84%E5%A3%B0%E8%AA%89%E7%B3%BB%E7%BB%9F"><span class="toc-text">支付发送者的声誉系统</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9D%83%E7%9B%8A%E8%AF%81%E4%B9%A6%EF%BC%88%E7%94%B1-gleb-and-ariard-%E6%8F%90%E5%87%BA%EF%BC%89"><span class="toc-text">权益证书（由 @gleb and @ariard 提出）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A3%B0%E8%AA%89%E4%BB%A3%E5%B8%81%EF%BC%88%E7%94%B1-roasbeef-%E6%8F%90%E5%87%BA%EF%BC%89"><span class="toc-text">声誉代币（由 @roasbeef 提出）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%A4%E7%9B%B8%E7%BB%93%E5%90%88"><span class="toc-text">两相结合</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%84%E4%BB%98%E6%89%8B%E7%BB%AD%E8%B4%B9%E8%BF%98%E6%98%AF%E5%BB%BA%E7%AB%8B%E5%A3%B0%E8%AA%89%E7%B3%BB%E7%BB%9F%EF%BC%9F"><span class="toc-text">预付手续费还是建立声誉系统？</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%93%E8%AE%BA"><span class="toc-text">结论</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%87%B4%E8%B0%A2"><span class="toc-text">致谢</span></a></li></ol></div><div class="column is-9 post-container"><h1 class="mt-0 mb-2" id="postTitle">防止通道阻塞</h1><div class="page-author"><div class="is-flex is-flex-direction-row page-data mr-6"><img class="mr-1" src="//res.btcstudy.org/btcstudy/images/default_avatar.png" alt="BitMex Research"><div class="page-author-info"><strong>BitMex Research</strong><time class="has-text-grey" datetime="2022-08-31T07:27:14.000Z">2022-08-31</time></div></div><div class="is-flex"><a href="/tags/%E9%97%AA%E7%94%B5%E7%BD%91%E7%BB%9C"><i class="page-tag mr-1 px-1">闪电网络<!-- 订正图片路径--></i></a><a href="/tags/%E5%BC%80%E5%8F%91"><i class="page-tag mr-1 px-1">开发<!-- 订正图片路径--></i></a></div></div><article class="mt-4 post-content"><blockquote>
<p><em>作者：BitMex Research</em></p>
<p><em>来源：<a target="_blank" rel="noopener" href="https://blog.bitmex.com/preventing-channel-jamming/">https://blog.bitmex.com/preventing-channel-jamming/</a></em></p>
</blockquote>
<p><strong>摘要</strong>：在本文中，BitMEX 受奖者 Gleb Naumenko 介绍了缓解闪电网络中的通道阻塞攻击（channel jamming）的方法。所谓 “通道阻塞”，就是攻击者恶意阻塞闪电网络中的流动性，办法是通过第三方的通道给自己支付，但不公开秘密值，因此这笔支付永远不会完成。Gleb 讨论了这个问题的可能解决方案，既包括短期的修复措施，也包括长期的协议改进。他的结论是，没有一招制敌的解决方案，而且一些高效的缓解方法可能非常复杂、难以实现。因此，我们还需要进一步的研究和讨论。</p>
<p><img src="//res.btcstudy.org/btcstudy/images/preventing-channel-jamming/024x674.png" alt="img"></p>
<h2 id="引言"><a href="#引言" class="headerlink" title="引言"></a>引言</h2><p>因为闪电网络是一个免许可的系统（没有一个中心点能限制你使用它），它容易受到拒绝服务式攻击（DoS）。通道阻塞（channel jamming）正是这样的攻击的一个例子。</p>
<p>想要缓解通道阻塞而不影响闪电网络的免许可特性并不容易。在本文中，我会概述现有解决方案提议的设计空间。</p>
<p>本文基于许多闪电网络和比特币协议开发者在 2021 年秋天的讨论，是为好奇于闪电网络协议设计和熟知技术的闪电网络用户和追随者撰写的。</p>
<h2 id="什么是-“通道阻塞攻击”？"><a href="#什么是-“通道阻塞攻击”？" class="headerlink" title="什么是 “通道阻塞攻击”？"></a>什么是 “通道阻塞攻击”？</h2><p>闪电网络是由计算机节点组成的一个网络，这些节点通过支付通道来互帮互助（通常也要求手续费）、完成支付：即使 Alice 和 Bob 没有直接的支付通道，他们也可以使用由彼此间的路由节点连成的路径来传递支付；整条路径上的所有通道的余额都会同步调整。</p>
<p>这样的多跳交易应该具备原子性（要么成功，要么不成功，没有其它状态），不然路由节点就可以拿走资金而不转发支付。多条支付可以分成两个阶段：沿着从支付发送者到支付接收者的路径一路锁定资金，沿着从接收者到发送者的路径传播秘密值从而解锁资金。</p>
<p>通道阻塞攻击背后的主要想法就是通过发起虚假支付且永不完成，从而一直占用路由节点转发支付的能力。在攻击持续期间，因为资金被占用，路由节点就无法再转发其它（诚实节点发起的）支付了。</p>
<p>想要阻塞特定的通道时，攻击者会通过这些通道假装给自己支付，但作为接收者一直不公开秘密值。</p>
<h2 id="通道阻塞的类型"><a href="#通道阻塞的类型" class="headerlink" title="通道阻塞的类型"></a>通道阻塞的类型</h2><p>有两种类型的通道阻塞攻击：</p>
<ul>
<li>数额阻塞，攻击者锁死目标通道的一大部分容量</li>
<li>线程阻塞，攻击者通过让目标通道触发可同时处理的支付笔数上限来锁死其转发能力（我们会在 “成本基准” 一节更详细地解释这一点）</li>
</ul>
<p>想了解关于通道阻塞攻击的更多信息，请参考：<a target="_blank" rel="noopener" href="https://github.com/t-bast/lightning-docs/blob/master/spam-prevention.md">https://github.com/t-bast/lightning-docs/blob/master/spam-prevention.md</a> 。不过，你无需完全理解参考资料中的所有底层细节，不会影响你阅读本文。</p>
<h2 id="超时机制是不可行的解决办法"><a href="#超时机制是不可行的解决办法" class="headerlink" title="超时机制是不可行的解决办法"></a>超时机制是不可行的解决办法</h2><p>应对阻塞，最显然的解决方案是让路由节点在发现支付长时间卡住而没有完成时取消转发。</p>
<p>不幸的是，一旦支付转发出去了，就不能终止它。终止只能从路由的最后一跳一路回传。这是闪电网络协议保证路由节点的资金安全性的基础部分。</p>
<p>因此，因为最后一跳属于攻击者，他们在愿意停止攻击之前是不会回传终止信号的。</p>
<p>或者，路由节点可以在一开始商量更短的超时时间。但这也不管用，因为攻击者可以更频繁地重复攻击（从每小时发起一次虚假支付变成每分钟发起一次）。</p>
<h2 id="难道扣住资金也是一种攻击吗？"><a href="#难道扣住资金也是一种攻击吗？" class="headerlink" title="难道扣住资金也是一种攻击吗？"></a>难道扣住资金也是一种攻击吗？</h2><p>闪电网络协议栈并没有明确声称让支付悬在空中无法完成就一定是恶意的，虽然这在有些时候可能就是恶意的，因为闪电网络主要用在低延迟支付中。</p>
<p>但是，这一点在未来也许会改变。举例来说，在<a target="_blank" rel="noopener" href="https://github.com/p2pderivatives/offchain-dlc-paper/blob/master/offchaindlc.pdf">基于闪电网络的谨慎日志合约（DLC）</a>中，锁定资金可能是完全真实的用户活动。</p>
<p>就我的观察，人们对长时间锁定资金（不是终止支付！）是否就是恶意还没有共识，有两种意见：</p>
<ol>
<li>协议应该遏制长期拖欠的支付</li>
<li>协议应该切换到更灵活的流动性支付方法，将资金锁定的时间也考虑在内</li>
</ol>
<p>幸运的是，似乎（后面会讨论的）两种最可行的长期解决方案都涉及到某种形式的支付（无论是通过原生的闪电支付，还是声誉代币），所以它们都或多或少适合 #2（只需少量的协议变更），或者只需成为实现 #1 的措施。</p>
<p>与此同时，我们还不知道如何在当前的协议中实现我们的目标：支付的发送者可以假装支付会很快送达，这样我们就既不能因为其支付花费时间超过预期而惩罚 TA，也不能取消超出预期时间的支付。</p>
<p>不过，假如我们最终搞清楚了如何对悬置的支付的收费，可能发送者跟接收者开设直接的通道、支付链上手续费而不是闪电网络的流动性费用，就会常常变成更经济的事。即使这可能意味着更少人会使用 “为锁定的流动性支付” 的特性，我们为了观察结果，也不得不实现这种机制。</p>
<h2 id="成本基准"><a href="#成本基准" class="headerlink" title="成本基准"></a>成本基准</h2><p>当前的协议已经为阻塞攻击设置了连带要求：攻击者必须开设一条闪电通道，意思是 TA 必须在链上锁定一些资金（资金有机会成本）并为通道的 开启&#x2F;关闭 支付链上交易费。</p>
<p>但 开启&#x2F;关闭 通道的复杂度是 O(1)，意思是，无论这个攻击者将阻塞多少流动性、阻塞多长时间，这个成本都是不变的，因此，这个成本对严重的攻击来说是可以忽略不计的（除非攻击需要开启许多通道）。</p>
<p>不过，资金的机会成本，可能足以防止数额阻塞：为了阻塞 X 聪的流动性，攻击者必须锁定 X 从（<a target="_blank" rel="noopener" href="https://lists.linuxfoundation.org/pipermail/lightning-dev/2015-August/000135.html">环路攻击</a>大概可以让攻击的效率提高越 20 倍）。</p>
<p>至于线程阻塞，成本就低得多了。（在当前）每一条通道可以同时处理的支付数量为 483 笔（超过这个数额就不安全了，因为关闭通道的交易无法保护超过 483 个输入）。</p>
<p>因此，攻击者只需要在一条通道中锁定 <code>483 * 最小支付额</code> 的资金，就可以用 483 笔最小支付额的支付阻塞一条通道，不论被攻击的通道本身有多少容量。（攻击者还必须为路由费预留一些资金，虽然并不需要实际支付，因为支付会失败，但还是必须预留，不然支付就无法转发。） </p>
<h2 id="渐进的解决方案"><a href="#渐进的解决方案" class="headerlink" title="渐进的解决方案"></a>渐进的解决方案</h2><h3 id="提高线程数量限制（由-niftynei-提出）"><a href="#提高线程数量限制（由-niftynei-提出）" class="headerlink" title="提高线程数量限制（由 @niftynei 提出）"></a>提高线程数量限制（由 <a target="_blank" rel="noopener" href="https://twitter.com/niftynei/"><strong>@niftynei</strong></a> 提出）</h3><p>如前所述，对支付通道的线程阻塞攻击的机会成本取决于线程的数量限制，而这个限制是从闪电网络协议中推导出来的。</p>
<p>然而，协议可以变更以支持在同一条通道中同时处理超过 483 笔支付。可以通过下列方法来实现：</p>
<ul>
<li>修改闪电网络的链上交易结构（例如，我可以想象一条通道可以用两条互无冲突的交易来关闭，这样线程数量限制就可以翻倍）。可以通过嵌套来实现（举个例子）。</li>
<li>修改底层的比特币协议，以支持闪电网络相关的交易使用超过 483 个输入。</li>
</ul>
<p>这两种解决方案都需要协议研究者付出大量努力来分析和实现，而且让通道阻塞攻击的成本线性增加可能不值得付出这么多的工作量。</p>
<h3 id="给线程分类（由-niftynei-提出）"><a href="#给线程分类（由-niftynei-提出）" class="headerlink" title="给线程分类（由 @niftynei 提出）"></a>给线程分类（由 <a target="_blank" rel="noopener" href="https://twitter.com/niftynei/"><strong>@niftynei</strong></a> 提出）</h3><p>我们可以为小额的和大额的支付设置两种不同的悬置交易限额。</p>
<p><em>一条通道只能容许 483 条悬置支付</em> 的限制对粉尘支付来说根本就没有意义，因为它们本来也无法在链上申领（尽管协议允许它们存在）。与此同时，将这些粉尘支付与更大量级的支付都计算在线程数量内，也让线程阻塞攻击变得非常便宜。</p>
<p>因此，我们可以为更大量级的支付专设一个限制，同时为粉尘支付施加其它限制。</p>
<ul>
<li>攻击者无法再用粉尘支付对更大量级的支付容量造成线程阻塞。</li>
<li>但是可以用更大量级的支付对粉尘支付的容量造成线程阻塞。换句话来说，若要阻塞更大量级支付的路由，攻击者必须锁定至少 <code>483  * 最低粉尘限额 </code> 的资金，这时候没准线程攻击会比数额攻击的成本还要高</li>
<li>可以用粉尘支付来阻塞粉尘支付的容量（根据新设的粉尘支付的限制数量）</li>
</ul>
<h3 id="对等节点对上一跳施加限制"><a href="#对等节点对上一跳施加限制" class="headerlink" title="对等节点对上一跳施加限制"></a>对等节点对上一跳施加限制</h3><p>另一种解决方案是监控入账支付的流量，并根据流量的（直接）来源对等节点施加限制。</p>
<p>这种想法的一个简单实现是 joost 为 LND 开发的一个插件，叫做 “<a target="_blank" rel="noopener" href="https://github.com/lightningequipment/circuitbreaker">circuitbreaker</a>() ”。它可以低于便宜而不复杂的攻击，但可能也做不了更多了，因为支付的匿名性使我们很难断定失败支付的源头在哪里。</p>
<p>考虑如下例子：</p>
<p><img src="//res.btcstudy.org/btcstudy/images/preventing-channel-jamming/024x555.jpg" alt="img"></p>
<p>假设 Dave 信任 Carol，因为后者的名声不错，因此不施加额外的限制。</p>
<p>Carol 希望保护她通过 Dave 转发支付的能力，因此她分别对 Alice 和 Bob 施加了 241 笔入账支付的限制。现在，Alice 无法防止来自 Bob 通道的支付通过 Dave 转发，反过来也是如此。</p>
<p>同样的逻辑也会传递给 Bob，变成 Bob 对自己的入账支付数量的的限制；但我们假设 Bob 希望开设很多条通道。为了防止这些通道彼此干扰以及限制 Bob 通过 Carol 转发支付的能力，Bob 需要对这些通道施加 241 笔入账支付的<strong>总容量</strong>限制。注意，如果 Bob 拒绝对入账支付施加这样的限制，Bob-Carol 通道就会变得更容易被 Bob 的对手方阻塞；即使 Carol 愿意转发来自 Bob 的支付，她也让 Bob-Carol 通道变得更容易被 DoS 攻击。因此，Bob 必须同样实施这种限制，才能达到限制攻击的效果。</p>
<p>现在，我们假设这个限制并不低，对 Bob 的客户来说已经足够了。在攻击者这边，这意味着要阻塞 Bob-Caorl 通道需要对 Bob 开设许多通道，以争抢 241 的容量限制，让原有的通道只能获得更少的支付笔数容量。最终这可能会变成一种新的，可能更糟糕的 DoS 机会。</p>
<p>当然，Bob 可以基于实际行为（比如有无支付手续费）来调整对攻击者的入账支付限制。但这也没有用，因为现在 Bob 的对手方可以影响 Bob 在 Carol 那里的声誉，而且 Bob 无法阻止他们。而且 Bob 依然无法越过 241 笔入账支付的总容量限制。</p>
<p>显然，最终来说，这种限制只有应用在整个网络中才会起作用。与此同时，通过多跳施加的责任限制不是最优的。</p>
<h2 id="根本解决方案"><a href="#根本解决方案" class="headerlink" title="根本解决方案"></a>根本解决方案</h2><h3 id="预付手续费（由-joost-和-t-bast-提出）"><a href="#预付手续费（由-joost-和-t-bast-提出）" class="headerlink" title="预付手续费（由 @joost 和 @t-bast 提出）"></a>预付手续费（由 <a target="_blank" rel="noopener" href="http://twitter.com/joostjgr/"><strong>@joost</strong></a> 和 <a target="_blank" rel="noopener" href="https://twitter.com/realtbast"><strong>@t-bast</strong></a> 提出）</h3><p>这个<a target="_blank" rel="noopener" href="https://github.com/t-bast/lightning-docs/blob/master/spam-prevention.md#proposals">提案</a>背后的想法是但凡尝试了转账就要收费，而不是只对成功的转账收费。这可以通过改变路由协议来实现，路由节点将要求支付发送者以某种方式预付手续费。</p>
<p>这个方案的吸引力可能取决于闪电网络整体的支付失败率，因为要求用户为失败的支付付费可能是非常反直觉的，而且会让用户体验变得更糟。</p>
<p>但另一方面，闪电网络要想成功，就必须让支付失败率变得足够低，用流畅的体验和足够低的时延吸引用户（因为重试需要时间）。因此，围绕这个假设来设计协议又似乎是对的。</p>
<p>与此同时，保持低失败率也不容易，因为通道的余额不是公开信息；如果用更大体量的储备资金和流动性管理来实现的话，手续费又会变得更高。</p>
<p>因此，市场上会出现失败率更高但更便宜的路由选择。</p>
<p>除此之外，要想让整条路径都保持低失败率，就要让每一跳都实现低失败率（一条路径的成功率取决于起最薄弱的一跳），在给定的通道图谱中，可能是无法实现的。</p>
<p>缺点：</p>
<ul>
<li>低失败率但更贵的路由可能是不现实的</li>
<li>对于失败率更高但更便宜的路由路径，使用更无感的方式为失败尝试支付流动性费用可能会更好（尤其是支付最终没有敲定的情况下）</li>
<li>可能激励路由节点故意让交易失败并敲竹杠（尚不清楚最终的路由经济模型如何工作），或以<a target="_blank" rel="noopener" href="https://lists.linuxfoundation.org/pipermail/lightning-dev/2021-February/002965.html">别的方式</a>打破经济激励。取决于具体的协议</li>
</ul>
<h3 id="支付发送者的声誉系统"><a href="#支付发送者的声誉系统" class="headerlink" title="支付发送者的声誉系统"></a>支付发送者的声誉系统</h3><p>除了对上一跳转播维持 DoS 抗性的责任，路由节点也可以对支付发送者采取行动。虽然这听起来有点奇怪，因为假设了支付发送者是已知的；当前，发送者的隐私性是由洋葱路由来保护的，牺牲这种特性可能是不可接受的。</p>
<h3 id="权益证书（由-gleb-and-ariard-提出）"><a href="#权益证书（由-gleb-and-ariard-提出）" class="headerlink" title="权益证书（由 @gleb and @ariard 提出）"></a>权益证书（由 <a target="_blank" rel="noopener" href="https://thelab31.xyz/"><strong>@gleb and @ariard</strong></a> 提出）</h3><p><a target="_blank" rel="noopener" href="https://thelab31.xyz/blog/stake-certificates">权益凭证</a>基于链上资金的所有权启用匿名的证书。换句话来说，使用一个路由节点的资源将需要证明发送者在一条通道中锁定了足够数量的资金（这个 “足够” 是由路由节点来定义的，比如每小时发送 1000 次支付将要求锁定 1 BTC）。</p>
<p>更具体来说，路由节点可能每次都会要求一个证书，并持续跟踪一个证书所有者的活动。</p>
<p>攻击者当然已经锁定了资金，不然都没法使用闪电网络，但拥有证书还可以：</p>
<ul>
<li>让路由节点将来自同一来源的支付关联起来，以侦测攻击（也可能会导致一些去匿名化和审查）</li>
<li>基于证书的价值限制来自同一来源的支付</li>
</ul>
<h3 id="声誉代币（由-roasbeef-提出）"><a href="#声誉代币（由-roasbeef-提出）" class="headerlink" title="声誉代币（由 @roasbeef 提出）"></a>声誉代币（由 <a target="_blank" rel="noopener" href="http://twitter.com/roasbeef/"><strong>@roasbeef</strong></a> 提出）</h3><p>另一种声誉方案是让路由节点个体基于发送者个体的表现调整其容量。</p>
<p>举个例子，一个路由节点可以发送特殊的代币给一个支付发送者，而这些代币可以在日后为 经过该路由节点的高频支付 “付费”。</p>
<p>如果发送者发起了太多的失败支付，路由节点可以作废这些代币；或者，如果发送者的支付总是成功而且慷慨支付手续费，就增发代币。</p>
<h3 id="两相结合"><a href="#两相结合" class="headerlink" title="两相结合"></a>两相结合</h3><p>声誉代币的挑战之一是，尚不清楚应该一开始应该如何分发代币。</p>
<p>与此同时，权益证书的缺点在于相同来源的支付会被关联起来。</p>
<p>把两种思路结合在一起也许能同时解决它们各自的问题。流程是：</p>
<ol>
<li><p>支付发送者向路由节点出示权益证书，收到 10 个 代币</p>
</li>
<li><p>支付发送者可以使用一个代币来发起一次支付</p>
<p>2a）如果支付成功，发送者就能多得 1 枚代币</p>
<p>2b）如果支付失败，这个代币就会作废</p>
</li>
</ol>
<p>缺点：</p>
<ul>
<li>实现起来很复杂</li>
<li>理解跟激励相关的问题可以需要大量的研究和真实世界的实验（例如：证书和代币会出现二级市场）</li>
</ul>
<h3 id="预付手续费还是建立声誉系统？"><a href="#预付手续费还是建立声誉系统？" class="headerlink" title="预付手续费还是建立声誉系统？"></a>预付手续费还是建立声誉系统？</h3><p>预付手续费和声誉系统似乎是两种不同的思路。</p>
<p>幸运的是，我们不必二选一。路由节点可以在他们的通道宣布建立之时（通过信号位）指定自己希望获得的路由补偿。</p>
<p>它们本身也有许多共同点：</p>
<ul>
<li>加入 网络时锁定在通道中的资金就表示权益，跟证书类代币表示权益的方式类似</li>
<li>在尝试支付时要预付手续费，类似于支付之前先要耗费证书类代币</li>
</ul>
<p>声誉代币的主要缺点在于，它们需要更复杂的协议来启动，而且可能在实质上伤害隐私性。而付出这些代价我们可以得到的是可能在激励上更加兼容的协议，以及一定程度上更好的用户体验；因为 证书&#x2F;代币 不如比特币那样有价值（至少流动性没有那么强）</p>
<h2 id="结论"><a href="#结论" class="headerlink" title="结论"></a>结论</h2><p>虽然完全缓解通道阻塞攻击同时保留闪电网络的免信任特性也许是不可能的，但我们已经有主意让攻击变得更难了。</p>
<p>渐进式的解决方案可能被集成到闪电网络的实现中，或者现在节点运营者也可以自主运行，但它们是有限的。长期的根本解决方案则需要额外的研究和广泛的讨论。</p>
<p>希望本文有助于澄清解决方案的设计空间，从而帮助您更高效地推进这些想法。</p>
<h2 id="致谢"><a href="#致谢" class="headerlink" title="致谢"></a>致谢</h2><p>衷心感谢  Sergei Tikhomirov、Lisa Neigut、Antoine Riard、Joost Jager 和 Clara Shikhelman 审读本文，并向所有为解决通道阻塞攻击贡献想法的闪电网络开发者表示敬意。</p>
<p>（完）</p>
</article></div></div></main><script src="/js/post.js?v=1675068529980"></script><script src="/js/highlight.min.js?v=1675068529980"></script><script>var containerEl = document.querySelector('.post-container');
var postFontSize = localStorage.getItem('post-font-size') || '16';
var inputEl = document.querySelector('#size-change-input');
var inputEl2 = document.querySelector('#size-change-input2');
inputEl.value = postFontSize;
inputEl2.value = postFontSize;
containerEl.style.fontSize = postFontSize + 'px';
$(function(){
  function setSizeChangeInputValue(size) {
    $('.post-container').css('font-size', size + 'px');
    localStorage.setItem('post-font-size', size);
    $('#size-change-input').val(size);
    $('#size-change-input2').val(size);
  }
  $('#size-change-input').on('input propertychange', function(e) {
    const size = e.target.value;
    setSizeChangeInputValue(size);
  });
  $('#size-change-input2').on('input propertychange', function(e) {
    const size = e.target.value;
    setSizeChangeInputValue(size);
  });
});
</script><script>hljs.initHighlightingOnLoad();</script></main></div><footer class="is-flex is-flex-direction-column is-align-items-center is-flex-shrink-0"><section class="sns-container"><a title="twitter" target="_blank" rel="noopener nofollow" href="//twitter.com/btcstudy">Twitter</a><!-- Github--><!-- Ins--><!-- RSS--><a title="rss" target="_blank" rel="noopener nofollow" href="/atom.xml">rss</a><!-- 知乎--><!-- 领英--><!-- 脸书--><!-- Telegram--><a title="telegram" target="_blank" rel="noopener nofollow" href="//t.me/btcstudyorg">Telegram</a></section></footer><script async src="/js/buttons.js?v=1675068529980"></script><script async src="/js/index.js?v=1675068529980"></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-JVCJ9XXG1Z"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());

gtag('config', 'G-JVCJ9XXG1Z');</script><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?c92c073c85be5be8d9b1b76f62a7e306";
  hm.async = true;
  hm.defer = true;
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
  </script></body></html>