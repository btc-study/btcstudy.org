<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><title>OXT 研究：理解比特币的隐私性，Part3</title><meta name="keywords" content="比特币, 中本聪, 比特币区块链, 闪电网络, 比特币 layer 2, 健全货币, 密码货币, 密码朋克, 学习比特币, BTC, BTC Study, Bitcoin, bitcoin, proof of work"><meta name="description" content="比特币思想的中文集结地"><meta name="viewport" content="width=device-width,minimum-scale=1,maximum-scale=1,initial-scale=1"><link rel="icon" href="/favicon.ico"><link rel="stylesheet" href="/style/common/bulma.css?v=1673504754539"><link rel="preload" as="style" onload='this.onload=null,this.rel="stylesheet"' href="/style/common/iconfont.css?v=1673504754539"><link rel="stylesheet" href="/style/base.css?v=1673504754539"><link rel="stylesheet" href="/style/common/helper.css?v=1673504754539"><link rel="stylesheet" href="/style/themes/animation.css?v=1673504754539"><script>function ready(){var e=document.querySelector(".body-container"),t=localStorage.getItem("theme")||"light";["light","dark"].includes(t)||(t="light",localStorage.setItem("theme","light")),e.classList.remove("appearance-auto"),e.classList.add("appearance-"+t),quickInitialTheme()}function quickInitialTheme(){var e=localStorage.getItem("theme")||"light",t=document.querySelector(".logo-light"),o=document.querySelector(".logo-dark"),d=document.querySelector("#mobile-header-logo > .logo-light"),l=document.querySelector("#mobile-header-logo > .logo-dark"),a=document.getElementById("theme-btn"),i=document.querySelector(".slide-theme-light"),c=document.querySelector(".slide-theme-dark");document.body.classList.add(e),("dark"===e?(t.classList.add("hidden"),o.classList.remove("hidden"),d.classList.add("hidden"),l.classList.remove("hidden"),a.classList.remove("icon-icon_dark"),a.classList.add("icon-icon_light"),i):c).classList.remove("hidden")}document.addEventListener("DOMContentLoaded",ready)</script><script src="/js/common.js?v=1673504754539"></script><script src="/js/libs/zepto.min.js"></script><link rel="stylesheet" href="/style/post.css?v=1673504754539"><link rel="stylesheet" href="/style/themes/highlight.css?v=1673504754539"><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="BTC Study" type="application/atom+xml"></head><body class="is-flex is-flex-direction-column" onload="initialTheme()"><div class="clip"></div><div class="body-container appearance-auto"><header class="header-widget is-hidden-mobile is-flex is-flex-shrink-0 is-align-items-center is-justify-content-center" id="header"><div class="is-flex header-widget-container is-flex-shrink-0 is-align-items-center"><section class="is-hidden-mobile is-flex-shrink-0"><h1><a href="/"><svg class="logo-light" width="125px" height="23px" viewBox="0 0 125 23" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>BTCStudy</title><g id="页面-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="首页-响应式" transform="translate(-249.000000, -23.000000)" fill-rule="nonzero"><g id="BTCStudy" transform="translate(249.680000, 23.192000)"><path d="M9.072,17.808 C11.312,17.808 13.024,17.408 14.208,16.608 C15.392,15.808 15.984,14.672 15.984,13.2 C15.984,12.192 15.712,11.332 15.168,10.62 C14.624,9.908 13.872,9.384 12.912,9.048 C13.632,8.68 14.188,8.18 14.58,7.548 C14.972,6.916 15.168,6.2 15.168,5.4 C15.168,4.056 14.608,2.988 13.488,2.196 C12.368,1.404 10.736,1.008 8.592,1.008 L8.592,1.008 L-5.68434189e-14,1.008 L-5.68434189e-14,17.808 L9.072,17.808 Z M7.968,7.68 L4.704,7.68 L4.704,4.44 L7.968,4.44 C9.568,4.44 10.368,4.976 10.368,6.048 C10.368,7.136 9.568,7.68 7.968,7.68 L7.968,7.68 Z M8.688,14.376 L4.704,14.376 L4.704,10.968 L8.688,10.968 C10.352,10.968 11.184,11.536 11.184,12.672 C11.184,13.808 10.352,14.376 8.688,14.376 L8.688,14.376 Z M26.544,17.808 L26.544,4.776 L31.68,4.776 L31.68,1.008 L16.632,1.008 L16.632,4.776 L21.792,4.776 L21.792,17.808 L26.544,17.808 Z M41.592,18.144 C43.128,18.144 44.512,17.872 45.744,17.328 C46.976,16.784 48,16 48.816,14.976 L48.816,14.976 L45.792,12.24 C44.704,13.552 43.384,14.208 41.832,14.208 C40.92,14.208 40.108,14.008 39.396,13.608 C38.684,13.208 38.132,12.644 37.74,11.916 C37.348,11.188 37.152,10.352 37.152,9.408 C37.152,8.464 37.348,7.628 37.74,6.9 C38.132,6.172 38.684,5.608 39.396,5.208 C40.108,4.808 40.92,4.608 41.832,4.608 C43.384,4.608 44.704,5.264 45.792,6.576 L45.792,6.576 L48.816,3.84 C48,2.816 46.976,2.032 45.744,1.488 C44.512,0.944 43.128,0.672 41.592,0.672 C39.832,0.672 38.252,1.044 36.852,1.788 C35.452,2.532 34.352,3.568 33.552,4.896 C32.752,6.224 32.352,7.728 32.352,9.408 C32.352,11.088 32.752,12.592 33.552,13.92 C34.352,15.248 35.452,16.284 36.852,17.028 C38.252,17.772 39.832,18.144 41.592,18.144 Z" id="BTC" fill="#F2A900"></path><path d="M56.64,18.144 C58.24,18.144 59.6,17.9 60.72,17.412 C61.84,16.924 62.68,16.272 63.24,15.456 C63.8,14.64 64.08,13.728 64.08,12.72 C64.08,11.552 63.772,10.628 63.156,9.948 C62.54,9.268 61.812,8.772 60.972,8.46 C60.132,8.148 59.072,7.856 57.792,7.584 C56.656,7.344 55.832,7.112 55.32,6.888 C54.808,6.664 54.552,6.328 54.552,5.88 C54.552,5.432 54.768,5.068 55.2,4.788 C55.632,4.508 56.32,4.368 57.264,4.368 C58.768,4.368 60.32,4.8 61.92,5.664 L61.92,5.664 L63.384,2.136 C62.568,1.656 61.624,1.292 60.552,1.044 C59.48,0.796 58.392,0.672 57.288,0.672 C55.672,0.672 54.308,0.912 53.196,1.392 C52.084,1.872 51.248,2.524 50.688,3.348 C50.128,4.172 49.848,5.096 49.848,6.12 C49.848,7.288 50.152,8.216 50.76,8.904 C51.368,9.592 52.096,10.092 52.944,10.404 C53.792,10.716 54.848,11.008 56.112,11.28 C57.264,11.536 58.1,11.78 58.62,12.012 C59.14,12.244 59.4,12.6 59.4,13.08 C59.4,13.992 58.488,14.448 56.664,14.448 C55.704,14.448 54.728,14.296 53.736,13.992 C52.744,13.688 51.872,13.288 51.12,12.792 L51.12,12.792 L49.56,16.296 C50.36,16.856 51.4,17.304 52.68,17.64 C53.96,17.976 55.28,18.144 56.64,18.144 Z M71.856,18.024 C72.48,18.024 73.068,17.96 73.62,17.832 C74.172,17.704 74.64,17.52 75.024,17.28 L75.024,17.28 L73.896,14.088 C73.496,14.36 73.032,14.496 72.504,14.496 C72.088,14.496 71.756,14.364 71.508,14.1 C71.26,13.836 71.136,13.472 71.136,13.008 L71.136,13.008 L71.136,8.688 L74.112,8.688 L74.112,5.28 L71.136,5.28 L71.136,1.896 L66.576,1.896 L66.576,5.28 L64.68,5.28 L64.68,8.688 L66.576,8.688 L66.576,13.056 C66.576,14.704 67.032,15.944 67.944,16.776 C68.856,17.608 70.16,18.024 71.856,18.024 Z M82.248,18.024 C83,18.024 83.712,17.888 84.384,17.616 C85.056,17.344 85.632,16.944 86.112,16.416 L86.112,16.416 L86.112,17.808 L90.456,17.808 L90.456,4.8 L85.896,4.8 L85.896,11.064 C85.896,12.104 85.668,12.876 85.212,13.38 C84.756,13.884 84.168,14.136 83.448,14.136 C82.744,14.136 82.208,13.912 81.84,13.464 C81.472,13.016 81.288,12.304 81.288,11.328 L81.288,11.328 L81.288,4.8 L76.728,4.8 L76.728,12.072 C76.728,14.056 77.228,15.544 78.228,16.536 C79.228,17.528 80.568,18.024 82.248,18.024 Z M99.048,18.024 C100.744,18.024 102.016,17.52 102.864,16.512 L102.864,16.512 L102.864,17.808 L107.208,17.808 L107.208,0 L102.648,0 L102.648,5.928 C101.8,5.032 100.6,4.584 99.048,4.584 C97.864,4.584 96.784,4.856 95.808,5.4 C94.832,5.944 94.06,6.724 93.492,7.74 C92.924,8.756 92.64,9.936 92.64,11.28 C92.64,12.624 92.924,13.808 93.492,14.832 C94.06,15.856 94.832,16.644 95.808,17.196 C96.784,17.748 97.864,18.024 99.048,18.024 Z M100.008,14.4 C99.208,14.4 98.552,14.124 98.04,13.572 C97.528,13.02 97.272,12.256 97.272,11.28 C97.272,10.32 97.528,9.568 98.04,9.024 C98.552,8.48 99.208,8.208 100.008,8.208 C100.808,8.208 101.46,8.48 101.964,9.024 C102.468,9.568 102.72,10.32 102.72,11.28 C102.72,12.256 102.464,13.02 101.952,13.572 C101.44,14.124 100.792,14.4 100.008,14.4 Z M112.368,22.68 C113.728,22.68 114.88,22.356 115.824,21.708 C116.768,21.06 117.568,19.936 118.224,18.336 L118.224,18.336 L123.84,4.8 L119.496,4.8 L116.28,12.744 L113.088,4.8 L108.408,4.8 L113.976,17.976 C113.784,18.36 113.548,18.64 113.268,18.816 C112.988,18.992 112.632,19.08 112.2,19.08 C111.832,19.08 111.468,19.012 111.108,18.876 C110.748,18.74 110.44,18.552 110.184,18.312 L110.184,18.312 L108.6,21.504 C109.032,21.856 109.596,22.14 110.292,22.356 C110.988,22.572 111.68,22.68 112.368,22.68 Z" id="Study" fill-opacity="0.85" fill="#000000"></path></g></g></g></svg><svg class="logo-dark hidden" width="125px" height="23px" viewBox="0 0 125 23" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>BTCStudy</title><g id="页面-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="首页-响应式" transform="translate(-249.000000, -23.000000)" fill-rule="nonzero"><g id="BTCStudy" transform="translate(249.680000, 23.192000)"><path d="M9.072,17.808 C11.312,17.808 13.024,17.408 14.208,16.608 C15.392,15.808 15.984,14.672 15.984,13.2 C15.984,12.192 15.712,11.332 15.168,10.62 C14.624,9.908 13.872,9.384 12.912,9.048 C13.632,8.68 14.188,8.18 14.58,7.548 C14.972,6.916 15.168,6.2 15.168,5.4 C15.168,4.056 14.608,2.988 13.488,2.196 C12.368,1.404 10.736,1.008 8.592,1.008 L8.592,1.008 L-5.68434189e-14,1.008 L-5.68434189e-14,17.808 L9.072,17.808 Z M7.968,7.68 L4.704,7.68 L4.704,4.44 L7.968,4.44 C9.568,4.44 10.368,4.976 10.368,6.048 C10.368,7.136 9.568,7.68 7.968,7.68 L7.968,7.68 Z M8.688,14.376 L4.704,14.376 L4.704,10.968 L8.688,10.968 C10.352,10.968 11.184,11.536 11.184,12.672 C11.184,13.808 10.352,14.376 8.688,14.376 L8.688,14.376 Z M26.544,17.808 L26.544,4.776 L31.68,4.776 L31.68,1.008 L16.632,1.008 L16.632,4.776 L21.792,4.776 L21.792,17.808 L26.544,17.808 Z M41.592,18.144 C43.128,18.144 44.512,17.872 45.744,17.328 C46.976,16.784 48,16 48.816,14.976 L48.816,14.976 L45.792,12.24 C44.704,13.552 43.384,14.208 41.832,14.208 C40.92,14.208 40.108,14.008 39.396,13.608 C38.684,13.208 38.132,12.644 37.74,11.916 C37.348,11.188 37.152,10.352 37.152,9.408 C37.152,8.464 37.348,7.628 37.74,6.9 C38.132,6.172 38.684,5.608 39.396,5.208 C40.108,4.808 40.92,4.608 41.832,4.608 C43.384,4.608 44.704,5.264 45.792,6.576 L45.792,6.576 L48.816,3.84 C48,2.816 46.976,2.032 45.744,1.488 C44.512,0.944 43.128,0.672 41.592,0.672 C39.832,0.672 38.252,1.044 36.852,1.788 C35.452,2.532 34.352,3.568 33.552,4.896 C32.752,6.224 32.352,7.728 32.352,9.408 C32.352,11.088 32.752,12.592 33.552,13.92 C34.352,15.248 35.452,16.284 36.852,17.028 C38.252,17.772 39.832,18.144 41.592,18.144 Z" id="BTC" fill="#F2A900"></path><path d="M56.64,18.144 C58.24,18.144 59.6,17.9 60.72,17.412 C61.84,16.924 62.68,16.272 63.24,15.456 C63.8,14.64 64.08,13.728 64.08,12.72 C64.08,11.552 63.772,10.628 63.156,9.948 C62.54,9.268 61.812,8.772 60.972,8.46 C60.132,8.148 59.072,7.856 57.792,7.584 C56.656,7.344 55.832,7.112 55.32,6.888 C54.808,6.664 54.552,6.328 54.552,5.88 C54.552,5.432 54.768,5.068 55.2,4.788 C55.632,4.508 56.32,4.368 57.264,4.368 C58.768,4.368 60.32,4.8 61.92,5.664 L61.92,5.664 L63.384,2.136 C62.568,1.656 61.624,1.292 60.552,1.044 C59.48,0.796 58.392,0.672 57.288,0.672 C55.672,0.672 54.308,0.912 53.196,1.392 C52.084,1.872 51.248,2.524 50.688,3.348 C50.128,4.172 49.848,5.096 49.848,6.12 C49.848,7.288 50.152,8.216 50.76,8.904 C51.368,9.592 52.096,10.092 52.944,10.404 C53.792,10.716 54.848,11.008 56.112,11.28 C57.264,11.536 58.1,11.78 58.62,12.012 C59.14,12.244 59.4,12.6 59.4,13.08 C59.4,13.992 58.488,14.448 56.664,14.448 C55.704,14.448 54.728,14.296 53.736,13.992 C52.744,13.688 51.872,13.288 51.12,12.792 L51.12,12.792 L49.56,16.296 C50.36,16.856 51.4,17.304 52.68,17.64 C53.96,17.976 55.28,18.144 56.64,18.144 Z M71.856,18.024 C72.48,18.024 73.068,17.96 73.62,17.832 C74.172,17.704 74.64,17.52 75.024,17.28 L75.024,17.28 L73.896,14.088 C73.496,14.36 73.032,14.496 72.504,14.496 C72.088,14.496 71.756,14.364 71.508,14.1 C71.26,13.836 71.136,13.472 71.136,13.008 L71.136,13.008 L71.136,8.688 L74.112,8.688 L74.112,5.28 L71.136,5.28 L71.136,1.896 L66.576,1.896 L66.576,5.28 L64.68,5.28 L64.68,8.688 L66.576,8.688 L66.576,13.056 C66.576,14.704 67.032,15.944 67.944,16.776 C68.856,17.608 70.16,18.024 71.856,18.024 Z M82.248,18.024 C83,18.024 83.712,17.888 84.384,17.616 C85.056,17.344 85.632,16.944 86.112,16.416 L86.112,16.416 L86.112,17.808 L90.456,17.808 L90.456,4.8 L85.896,4.8 L85.896,11.064 C85.896,12.104 85.668,12.876 85.212,13.38 C84.756,13.884 84.168,14.136 83.448,14.136 C82.744,14.136 82.208,13.912 81.84,13.464 C81.472,13.016 81.288,12.304 81.288,11.328 L81.288,11.328 L81.288,4.8 L76.728,4.8 L76.728,12.072 C76.728,14.056 77.228,15.544 78.228,16.536 C79.228,17.528 80.568,18.024 82.248,18.024 Z M99.048,18.024 C100.744,18.024 102.016,17.52 102.864,16.512 L102.864,16.512 L102.864,17.808 L107.208,17.808 L107.208,0 L102.648,0 L102.648,5.928 C101.8,5.032 100.6,4.584 99.048,4.584 C97.864,4.584 96.784,4.856 95.808,5.4 C94.832,5.944 94.06,6.724 93.492,7.74 C92.924,8.756 92.64,9.936 92.64,11.28 C92.64,12.624 92.924,13.808 93.492,14.832 C94.06,15.856 94.832,16.644 95.808,17.196 C96.784,17.748 97.864,18.024 99.048,18.024 Z M100.008,14.4 C99.208,14.4 98.552,14.124 98.04,13.572 C97.528,13.02 97.272,12.256 97.272,11.28 C97.272,10.32 97.528,9.568 98.04,9.024 C98.552,8.48 99.208,8.208 100.008,8.208 C100.808,8.208 101.46,8.48 101.964,9.024 C102.468,9.568 102.72,10.32 102.72,11.28 C102.72,12.256 102.464,13.02 101.952,13.572 C101.44,14.124 100.792,14.4 100.008,14.4 Z M112.368,22.68 C113.728,22.68 114.88,22.356 115.824,21.708 C116.768,21.06 117.568,19.936 118.224,18.336 L118.224,18.336 L123.84,4.8 L119.496,4.8 L116.28,12.744 L113.088,4.8 L108.408,4.8 L113.976,17.976 C113.784,18.36 113.548,18.64 113.268,18.816 C112.988,18.992 112.632,19.08 112.2,19.08 C111.832,19.08 111.468,19.012 111.108,18.876 C110.748,18.74 110.44,18.552 110.184,18.312 L110.184,18.312 L108.6,21.504 C109.032,21.856 109.596,22.14 110.292,22.356 C110.988,22.572 111.68,22.68 112.368,22.68 Z" id="Study" fill-opacity="0.85" fill="#FFFFFF"></path></g></g></g></svg></a></h1></section><div class="is-flex is-flex-direction-column header-menu-wrap"><aside class="is-flex-shrink-0 is-flex is-flex-direction-row is-align-items-center" id="header-menu"><a class="is-inline-block header-activity mr-4" href="/">首页</a><a class="is-inline-block mr-4" href="/archives">全站目录</a><a class="is-inline-block mr-4" href="/tags">标签</a><a class="is-inline-block mr-4" href="/maps">地图</a><a class="is-inline-block mr-4" href="/mempool">mempool</a><a class="is-inline-block mr-4" target="_blank" rel="noopener" href="https://123btc.org/">123btc</a><div class="right-content is-flex is-flex-direction-row is-align-items-center"><div class="size-wrap mr-1"><i class="iconfont icon-a-bianzu5" id="change-size-btn"></i><div class="size-input-wrap"><div class="input-wrap"><input id="size-change-input" type="range" min="12" max="32" step="2"></div></div></div><i class="iconfont icon-icon_dark mr-1" id="theme-btn"></i><div class="search-wrap"><input class="pl-3" id="search-input" placeholder="请输入搜索关键词"><i class="iconfont icon-icon_search" id="search-input-btn"></i></div></div></aside><div class="header-title is-hidden-mobile is-full-height is-flex is-align-items-center is-flex-shrink-0"><div class="is-full-height hidden" id="postTopic"><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">OXT 研究：理解比特币的隐私性，Part3</p><div class="size-wrap mr-1"><i class="iconfont icon-a-bianzu5" id="change-size-btn2"></i><div class="size-input-wrap"><div class="input-wrap"><input id="size-change-input2" type="range" min="12" max="32" step="2"></div></div></div></div></div></div></div></header><header class="is-flex header-widget is-flex-shrink-0 is-align-items-center is-justify-content-space-between is-hidden-tablet" id="mobile-header"><div class="is-flex is-flex-direction-row is-align-items-center"><i class="iconfont icon-icon_bar mobile-header-menu"></i><div id="mobile-header-logo"><svg class="logo-light" width="125px" height="23px" viewBox="0 0 125 23" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>BTCStudy</title><g id="页面-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="首页-响应式" transform="translate(-249.000000, -23.000000)" fill-rule="nonzero"><g id="BTCStudy" transform="translate(249.680000, 23.192000)"><path d="M9.072,17.808 C11.312,17.808 13.024,17.408 14.208,16.608 C15.392,15.808 15.984,14.672 15.984,13.2 C15.984,12.192 15.712,11.332 15.168,10.62 C14.624,9.908 13.872,9.384 12.912,9.048 C13.632,8.68 14.188,8.18 14.58,7.548 C14.972,6.916 15.168,6.2 15.168,5.4 C15.168,4.056 14.608,2.988 13.488,2.196 C12.368,1.404 10.736,1.008 8.592,1.008 L8.592,1.008 L-5.68434189e-14,1.008 L-5.68434189e-14,17.808 L9.072,17.808 Z M7.968,7.68 L4.704,7.68 L4.704,4.44 L7.968,4.44 C9.568,4.44 10.368,4.976 10.368,6.048 C10.368,7.136 9.568,7.68 7.968,7.68 L7.968,7.68 Z M8.688,14.376 L4.704,14.376 L4.704,10.968 L8.688,10.968 C10.352,10.968 11.184,11.536 11.184,12.672 C11.184,13.808 10.352,14.376 8.688,14.376 L8.688,14.376 Z M26.544,17.808 L26.544,4.776 L31.68,4.776 L31.68,1.008 L16.632,1.008 L16.632,4.776 L21.792,4.776 L21.792,17.808 L26.544,17.808 Z M41.592,18.144 C43.128,18.144 44.512,17.872 45.744,17.328 C46.976,16.784 48,16 48.816,14.976 L48.816,14.976 L45.792,12.24 C44.704,13.552 43.384,14.208 41.832,14.208 C40.92,14.208 40.108,14.008 39.396,13.608 C38.684,13.208 38.132,12.644 37.74,11.916 C37.348,11.188 37.152,10.352 37.152,9.408 C37.152,8.464 37.348,7.628 37.74,6.9 C38.132,6.172 38.684,5.608 39.396,5.208 C40.108,4.808 40.92,4.608 41.832,4.608 C43.384,4.608 44.704,5.264 45.792,6.576 L45.792,6.576 L48.816,3.84 C48,2.816 46.976,2.032 45.744,1.488 C44.512,0.944 43.128,0.672 41.592,0.672 C39.832,0.672 38.252,1.044 36.852,1.788 C35.452,2.532 34.352,3.568 33.552,4.896 C32.752,6.224 32.352,7.728 32.352,9.408 C32.352,11.088 32.752,12.592 33.552,13.92 C34.352,15.248 35.452,16.284 36.852,17.028 C38.252,17.772 39.832,18.144 41.592,18.144 Z" id="BTC" fill="#F2A900"></path><path d="M56.64,18.144 C58.24,18.144 59.6,17.9 60.72,17.412 C61.84,16.924 62.68,16.272 63.24,15.456 C63.8,14.64 64.08,13.728 64.08,12.72 C64.08,11.552 63.772,10.628 63.156,9.948 C62.54,9.268 61.812,8.772 60.972,8.46 C60.132,8.148 59.072,7.856 57.792,7.584 C56.656,7.344 55.832,7.112 55.32,6.888 C54.808,6.664 54.552,6.328 54.552,5.88 C54.552,5.432 54.768,5.068 55.2,4.788 C55.632,4.508 56.32,4.368 57.264,4.368 C58.768,4.368 60.32,4.8 61.92,5.664 L61.92,5.664 L63.384,2.136 C62.568,1.656 61.624,1.292 60.552,1.044 C59.48,0.796 58.392,0.672 57.288,0.672 C55.672,0.672 54.308,0.912 53.196,1.392 C52.084,1.872 51.248,2.524 50.688,3.348 C50.128,4.172 49.848,5.096 49.848,6.12 C49.848,7.288 50.152,8.216 50.76,8.904 C51.368,9.592 52.096,10.092 52.944,10.404 C53.792,10.716 54.848,11.008 56.112,11.28 C57.264,11.536 58.1,11.78 58.62,12.012 C59.14,12.244 59.4,12.6 59.4,13.08 C59.4,13.992 58.488,14.448 56.664,14.448 C55.704,14.448 54.728,14.296 53.736,13.992 C52.744,13.688 51.872,13.288 51.12,12.792 L51.12,12.792 L49.56,16.296 C50.36,16.856 51.4,17.304 52.68,17.64 C53.96,17.976 55.28,18.144 56.64,18.144 Z M71.856,18.024 C72.48,18.024 73.068,17.96 73.62,17.832 C74.172,17.704 74.64,17.52 75.024,17.28 L75.024,17.28 L73.896,14.088 C73.496,14.36 73.032,14.496 72.504,14.496 C72.088,14.496 71.756,14.364 71.508,14.1 C71.26,13.836 71.136,13.472 71.136,13.008 L71.136,13.008 L71.136,8.688 L74.112,8.688 L74.112,5.28 L71.136,5.28 L71.136,1.896 L66.576,1.896 L66.576,5.28 L64.68,5.28 L64.68,8.688 L66.576,8.688 L66.576,13.056 C66.576,14.704 67.032,15.944 67.944,16.776 C68.856,17.608 70.16,18.024 71.856,18.024 Z M82.248,18.024 C83,18.024 83.712,17.888 84.384,17.616 C85.056,17.344 85.632,16.944 86.112,16.416 L86.112,16.416 L86.112,17.808 L90.456,17.808 L90.456,4.8 L85.896,4.8 L85.896,11.064 C85.896,12.104 85.668,12.876 85.212,13.38 C84.756,13.884 84.168,14.136 83.448,14.136 C82.744,14.136 82.208,13.912 81.84,13.464 C81.472,13.016 81.288,12.304 81.288,11.328 L81.288,11.328 L81.288,4.8 L76.728,4.8 L76.728,12.072 C76.728,14.056 77.228,15.544 78.228,16.536 C79.228,17.528 80.568,18.024 82.248,18.024 Z M99.048,18.024 C100.744,18.024 102.016,17.52 102.864,16.512 L102.864,16.512 L102.864,17.808 L107.208,17.808 L107.208,0 L102.648,0 L102.648,5.928 C101.8,5.032 100.6,4.584 99.048,4.584 C97.864,4.584 96.784,4.856 95.808,5.4 C94.832,5.944 94.06,6.724 93.492,7.74 C92.924,8.756 92.64,9.936 92.64,11.28 C92.64,12.624 92.924,13.808 93.492,14.832 C94.06,15.856 94.832,16.644 95.808,17.196 C96.784,17.748 97.864,18.024 99.048,18.024 Z M100.008,14.4 C99.208,14.4 98.552,14.124 98.04,13.572 C97.528,13.02 97.272,12.256 97.272,11.28 C97.272,10.32 97.528,9.568 98.04,9.024 C98.552,8.48 99.208,8.208 100.008,8.208 C100.808,8.208 101.46,8.48 101.964,9.024 C102.468,9.568 102.72,10.32 102.72,11.28 C102.72,12.256 102.464,13.02 101.952,13.572 C101.44,14.124 100.792,14.4 100.008,14.4 Z M112.368,22.68 C113.728,22.68 114.88,22.356 115.824,21.708 C116.768,21.06 117.568,19.936 118.224,18.336 L118.224,18.336 L123.84,4.8 L119.496,4.8 L116.28,12.744 L113.088,4.8 L108.408,4.8 L113.976,17.976 C113.784,18.36 113.548,18.64 113.268,18.816 C112.988,18.992 112.632,19.08 112.2,19.08 C111.832,19.08 111.468,19.012 111.108,18.876 C110.748,18.74 110.44,18.552 110.184,18.312 L110.184,18.312 L108.6,21.504 C109.032,21.856 109.596,22.14 110.292,22.356 C110.988,22.572 111.68,22.68 112.368,22.68 Z" id="Study" fill-opacity="0.85" fill="#000000"></path></g></g></g></svg><svg class="logo-dark hidden" width="125px" height="23px" viewBox="0 0 125 23" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>BTCStudy</title><g id="页面-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="首页-响应式" transform="translate(-249.000000, -23.000000)" fill-rule="nonzero"><g id="BTCStudy" transform="translate(249.680000, 23.192000)"><path d="M9.072,17.808 C11.312,17.808 13.024,17.408 14.208,16.608 C15.392,15.808 15.984,14.672 15.984,13.2 C15.984,12.192 15.712,11.332 15.168,10.62 C14.624,9.908 13.872,9.384 12.912,9.048 C13.632,8.68 14.188,8.18 14.58,7.548 C14.972,6.916 15.168,6.2 15.168,5.4 C15.168,4.056 14.608,2.988 13.488,2.196 C12.368,1.404 10.736,1.008 8.592,1.008 L8.592,1.008 L-5.68434189e-14,1.008 L-5.68434189e-14,17.808 L9.072,17.808 Z M7.968,7.68 L4.704,7.68 L4.704,4.44 L7.968,4.44 C9.568,4.44 10.368,4.976 10.368,6.048 C10.368,7.136 9.568,7.68 7.968,7.68 L7.968,7.68 Z M8.688,14.376 L4.704,14.376 L4.704,10.968 L8.688,10.968 C10.352,10.968 11.184,11.536 11.184,12.672 C11.184,13.808 10.352,14.376 8.688,14.376 L8.688,14.376 Z M26.544,17.808 L26.544,4.776 L31.68,4.776 L31.68,1.008 L16.632,1.008 L16.632,4.776 L21.792,4.776 L21.792,17.808 L26.544,17.808 Z M41.592,18.144 C43.128,18.144 44.512,17.872 45.744,17.328 C46.976,16.784 48,16 48.816,14.976 L48.816,14.976 L45.792,12.24 C44.704,13.552 43.384,14.208 41.832,14.208 C40.92,14.208 40.108,14.008 39.396,13.608 C38.684,13.208 38.132,12.644 37.74,11.916 C37.348,11.188 37.152,10.352 37.152,9.408 C37.152,8.464 37.348,7.628 37.74,6.9 C38.132,6.172 38.684,5.608 39.396,5.208 C40.108,4.808 40.92,4.608 41.832,4.608 C43.384,4.608 44.704,5.264 45.792,6.576 L45.792,6.576 L48.816,3.84 C48,2.816 46.976,2.032 45.744,1.488 C44.512,0.944 43.128,0.672 41.592,0.672 C39.832,0.672 38.252,1.044 36.852,1.788 C35.452,2.532 34.352,3.568 33.552,4.896 C32.752,6.224 32.352,7.728 32.352,9.408 C32.352,11.088 32.752,12.592 33.552,13.92 C34.352,15.248 35.452,16.284 36.852,17.028 C38.252,17.772 39.832,18.144 41.592,18.144 Z" id="BTC" fill="#F2A900"></path><path d="M56.64,18.144 C58.24,18.144 59.6,17.9 60.72,17.412 C61.84,16.924 62.68,16.272 63.24,15.456 C63.8,14.64 64.08,13.728 64.08,12.72 C64.08,11.552 63.772,10.628 63.156,9.948 C62.54,9.268 61.812,8.772 60.972,8.46 C60.132,8.148 59.072,7.856 57.792,7.584 C56.656,7.344 55.832,7.112 55.32,6.888 C54.808,6.664 54.552,6.328 54.552,5.88 C54.552,5.432 54.768,5.068 55.2,4.788 C55.632,4.508 56.32,4.368 57.264,4.368 C58.768,4.368 60.32,4.8 61.92,5.664 L61.92,5.664 L63.384,2.136 C62.568,1.656 61.624,1.292 60.552,1.044 C59.48,0.796 58.392,0.672 57.288,0.672 C55.672,0.672 54.308,0.912 53.196,1.392 C52.084,1.872 51.248,2.524 50.688,3.348 C50.128,4.172 49.848,5.096 49.848,6.12 C49.848,7.288 50.152,8.216 50.76,8.904 C51.368,9.592 52.096,10.092 52.944,10.404 C53.792,10.716 54.848,11.008 56.112,11.28 C57.264,11.536 58.1,11.78 58.62,12.012 C59.14,12.244 59.4,12.6 59.4,13.08 C59.4,13.992 58.488,14.448 56.664,14.448 C55.704,14.448 54.728,14.296 53.736,13.992 C52.744,13.688 51.872,13.288 51.12,12.792 L51.12,12.792 L49.56,16.296 C50.36,16.856 51.4,17.304 52.68,17.64 C53.96,17.976 55.28,18.144 56.64,18.144 Z M71.856,18.024 C72.48,18.024 73.068,17.96 73.62,17.832 C74.172,17.704 74.64,17.52 75.024,17.28 L75.024,17.28 L73.896,14.088 C73.496,14.36 73.032,14.496 72.504,14.496 C72.088,14.496 71.756,14.364 71.508,14.1 C71.26,13.836 71.136,13.472 71.136,13.008 L71.136,13.008 L71.136,8.688 L74.112,8.688 L74.112,5.28 L71.136,5.28 L71.136,1.896 L66.576,1.896 L66.576,5.28 L64.68,5.28 L64.68,8.688 L66.576,8.688 L66.576,13.056 C66.576,14.704 67.032,15.944 67.944,16.776 C68.856,17.608 70.16,18.024 71.856,18.024 Z M82.248,18.024 C83,18.024 83.712,17.888 84.384,17.616 C85.056,17.344 85.632,16.944 86.112,16.416 L86.112,16.416 L86.112,17.808 L90.456,17.808 L90.456,4.8 L85.896,4.8 L85.896,11.064 C85.896,12.104 85.668,12.876 85.212,13.38 C84.756,13.884 84.168,14.136 83.448,14.136 C82.744,14.136 82.208,13.912 81.84,13.464 C81.472,13.016 81.288,12.304 81.288,11.328 L81.288,11.328 L81.288,4.8 L76.728,4.8 L76.728,12.072 C76.728,14.056 77.228,15.544 78.228,16.536 C79.228,17.528 80.568,18.024 82.248,18.024 Z M99.048,18.024 C100.744,18.024 102.016,17.52 102.864,16.512 L102.864,16.512 L102.864,17.808 L107.208,17.808 L107.208,0 L102.648,0 L102.648,5.928 C101.8,5.032 100.6,4.584 99.048,4.584 C97.864,4.584 96.784,4.856 95.808,5.4 C94.832,5.944 94.06,6.724 93.492,7.74 C92.924,8.756 92.64,9.936 92.64,11.28 C92.64,12.624 92.924,13.808 93.492,14.832 C94.06,15.856 94.832,16.644 95.808,17.196 C96.784,17.748 97.864,18.024 99.048,18.024 Z M100.008,14.4 C99.208,14.4 98.552,14.124 98.04,13.572 C97.528,13.02 97.272,12.256 97.272,11.28 C97.272,10.32 97.528,9.568 98.04,9.024 C98.552,8.48 99.208,8.208 100.008,8.208 C100.808,8.208 101.46,8.48 101.964,9.024 C102.468,9.568 102.72,10.32 102.72,11.28 C102.72,12.256 102.464,13.02 101.952,13.572 C101.44,14.124 100.792,14.4 100.008,14.4 Z M112.368,22.68 C113.728,22.68 114.88,22.356 115.824,21.708 C116.768,21.06 117.568,19.936 118.224,18.336 L118.224,18.336 L123.84,4.8 L119.496,4.8 L116.28,12.744 L113.088,4.8 L108.408,4.8 L113.976,17.976 C113.784,18.36 113.548,18.64 113.268,18.816 C112.988,18.992 112.632,19.08 112.2,19.08 C111.832,19.08 111.468,19.012 111.108,18.876 C110.748,18.74 110.44,18.552 110.184,18.312 L110.184,18.312 L108.6,21.504 C109.032,21.856 109.596,22.14 110.292,22.356 C110.988,22.572 111.68,22.68 112.368,22.68 Z" id="Study" fill-opacity="0.85" fill="#FFFFFF"></path></g></g></g></svg></div><div class="mobile-header-title is-full-height is-flex is-align-items-center is-flex-shrink-0"><div class="is-full-height hidden" id="postTopicMobile"><p class="is-full-height">OXT 研究：理解比特币的隐私性，Part3</p></div></div></div><i class="iconfont icon-icon_search mobile-header-searchIcon"></i><div class="mobile-search-wrap"><div class="search-input"><input class="pl-3" id="mobile-search-input" placeholder="请输入搜索关键词"><i class="iconfont icon-icon_search mobile-search-input-btn"></i><button class="mobile-search-input-btn">搜 索</button></div></div></header><div class="mobile-slide-menu"><a class="header-activity" href="/">首页</a><a href="/archives">全站目录</a><a href="/tags">标签</a><a href="/maps">地图</a><a href="/mempool">mempool</a><a target="_blank" rel="noopener" href="https://123btc.org/">123btc</a><div><p class="slide-menu-theme is-flex is-flex-direction-row is-justify-content-space-between is-align-items-center"><span>主题设置</span><span><i class="iconfont icon-icon_light slide-theme-light hidden"></i><i class="iconfont icon-icon_dark slide-theme-dark hidden"></i></span></p><p class="slide-menu-fontsize"><span>字体设置</span><span><i class="iconfont icon-bianzubeifen"></i><i class="iconfont icon-bianzu"></i></span></p></div></div><div class="search-mask hidden"><script src="/js/header.js?v=1673504754539"></script></div><main><main class="container is-max-widescreen content section post-page pt-4"><div class="columns is-flex-desktop is-justify-content-center"><div class="column is-3 silde-bar is-hidden-mobile"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%8B%E7%BB%8D"><span class="toc-text">介绍</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#UTXO-%E6%89%80%E6%9C%89%E6%9D%83%E6%A8%A1%E5%9E%8B%E5%92%8C%E7%AE%80%E5%8D%95%E8%8A%B1%E8%B4%B9%E7%9A%84%E6%A8%A1%E7%B3%8A%E6%80%A7"><span class="toc-text">UTXO 所有权模型和简单花费的模糊性</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%93%E8%B4%A5%E6%89%BE%E9%9B%B6%E6%A3%80%E6%B5%8B%E5%90%AF%E5%8F%91%E6%B3%95"><span class="toc-text">打败找零检测启发法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B4%E6%95%B0%E4%BB%98%E6%AC%BE%E5%90%AF%E5%8F%91%E6%B3%95%E9%98%B2%E5%BE%A1"><span class="toc-text">整数付款启发法防御</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9B%B8%E5%90%8C%E7%9A%84%E6%89%BE%E9%9B%B6%E8%BE%93%E5%87%BA%E8%84%9A%E6%9C%AC%E7%B1%BB%E5%9E%8B"><span class="toc-text">相同的找零输出脚本类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9A%8F%E6%9C%BA%E5%8C%96%E7%9A%84%E6%89%BE%E9%9B%B6%E8%BE%93%E5%87%BA%E4%BD%8D%E7%BD%AE"><span class="toc-text">随机化的找零输出位置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%84%E4%BC%B0%E5%8C%85%E5%90%AB%E5%A4%96%E9%83%A8%E4%BA%A4%E6%98%93%E6%95%B0%E6%8D%AE%E7%9A%84%E4%BA%A4%E6%98%93"><span class="toc-text">评估包含外部交易数据的交易</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#UTXO-%E6%B5%81%E5%92%8C%E7%A1%AE%E5%AE%9A%E6%80%A7%E8%8A%B1%E8%B4%B9"><span class="toc-text">UTXO 流和确定性花费</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%93%E7%A0%B4%E5%85%B3%E8%81%94-%E2%80%94%E2%80%94-%E9%9D%9E%E7%A1%AE%E5%AE%9A%E6%80%A7%E4%BA%A4%E6%98%93"><span class="toc-text">打破关联 —— 非确定性交易</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%86%B5-%E2%80%94%E2%80%94-%E7%AD%89%E8%BE%93%E5%87%BA%E9%A2%9D%E7%9A%84-CoinJoin-%E4%BA%A4%E6%98%93%E4%BB%A5%E5%8F%8A-CIOH-%E7%9A%84%E9%80%82%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-text">熵 —— 等输出额的 CoinJoin 交易以及 CIOH 的适用场景</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#KYCP-%E4%BA%A4%E6%98%93%E8%A7%A3%E9%87%8A"><span class="toc-text">KYCP 交易解释</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CoinJoin-%E2%80%94%E2%80%94-%E7%AD%89%E8%BE%93%E5%87%BA%E9%A2%9D%EF%BC%88%E5%8A%A0%E5%AF%86%EF%BC%89%E5%92%8C-PayJoin%EF%BC%88%E9%9A%90%E5%86%99%E6%9C%AF%EF%BC%89"><span class="toc-text">CoinJoin —— 等输出额（加密）和 PayJoin（隐写术）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B6%E5%AE%83%E6%8A%80%E6%9C%AF%E6%96%B9%E6%A1%88-%E2%80%94%E2%80%94-%E2%80%9C%E7%A0%B4%E5%9D%8F%E2%80%9D-%E4%BA%A4%E6%98%93%E5%9B%BE"><span class="toc-text">其它技术方案 —— “破坏” 交易图</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9E%E9%A1%BE"><span class="toc-text">回顾</span></a></li></ol></div><div class="column is-9 post-container"><h1 class="mt-0 mb-2" id="postTitle">OXT 研究：理解比特币的隐私性，Part3</h1><div class="page-author"><div class="is-flex is-flex-direction-row page-data mr-6"><img class="mr-1" src="//res.btcstudy.org/btcstudy/images/default_avatar.png" alt="Samourai Wallet"><div class="page-author-info"><strong>Samourai Wallet</strong><time class="has-text-grey" datetime="2021-12-27T07:15:35.000Z">2021-12-27</time></div></div><div class="is-flex"><a href="/tags/%E9%9A%90%E7%A7%81%E6%80%A7"><i class="page-tag mr-1 px-1">隐私性</i></a></div></div><article class="mt-4 post-content"><blockquote><p><em>作者：Samourai Wallet</em></p><p><em>来源：<a target="_blank" rel="noopener" href="https://medium.com/oxt-research/understanding-bitcoin-privacy-with-oxt-part-3-4-9a1b2b572a8">https://medium.com/oxt-research/understanding-bitcoin-privacy-with-oxt-part-3-4-9a1b2b572a8</a></em></p><p><em><a href="https://www.btcstudy.org/2021/12/15/understanding-bitcoin-privacy-with-oxt-part-2/">前篇中文译本</a></em></p></blockquote><h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><p>我们已经在 <a target="_blank" rel="noopener" href="https://medium.com/oxt-research/understanding-bitcoin-privacy-with-oxt-part-1-4-8177a40a5923">Part 1</a> 和 <a target="_blank" rel="noopener" href="https://medium.com/oxt-research/understanding-bitcoin-privacy-with-oxt-part-2-4-20010e0dab97">Part 2</a> 中介绍了区块链分析的基础概念。Part 3 将讨论破坏区块链分析的方法。</p><p>在本文中，我们将探究以下内容：</p><ol><li>打败针对简单花费的找零检测启发法</li><li>利用等输出额的 CoinJoin 交易形成模糊的交易图</li><li>利用 CoinJoin 交易打败 CIOH</li></ol><h2 id="UTXO-所有权模型和简单花费的模糊性"><a href="#UTXO-所有权模型和简单花费的模糊性" class="headerlink" title="UTXO 所有权模型和简单花费的模糊性"></a>UTXO 所有权模型和简单花费的模糊性</h2><p>在之前的文章中，我们介绍了针对只有一个输入和两个输出的简单花费的找零检测启发法。我们<strong>假设</strong>了交易包含一笔付款输出和一笔找零输出。</p><p>事实上，根据 UTXO “所有权模型”，简单花费有很多其它解释可能。所有权模型试图为交易的输入和输出确定所有权。关于有一个输入和两个输出的交易的所有权解释完整版如图 3.1 所示。</p><p><img src="//res.btcstudy.org/btcstudy/images/understanding-bitcoin-privacy-with-oxt-part-3/LmkRL1A.png" alt="img"></p><p style="text-align:center">- 图 3.1 简单花费的 UTXO 所有权模型 -</p><p>分析师必须考虑上述每一种解释，尤其是在仅使用内部交易数据的情况下。额外的钱包指纹、正常钱包行为和典型用户行为可以用来对解释作排除法。</p><p>从典型用户行为的角度来看，解释 #1 和 #2 的可能性最高。解释 #3 和 #4也是有可能的，尽管许多比特币钱包都没有批量花费功能。解释 #5 的可能性很低，因为需要支付额外的交易费，而且会导致 UTXO 集合膨胀。</p><p>外部交易数据（如发送到中心化服务或重复使用的地址的输出）可以用来排除解释。由于比特币交易图集中于中心化服务和正常用户模式，分析师很少会在实际分析过程中考虑所有这些解释。</p><h2 id="打败找零检测启发法"><a href="#打败找零检测启发法" class="headerlink" title="打败找零检测启发法"></a>打败找零检测启发法</h2><p>旨在打败 Part 1 中所述的找零检测启发法的钱包软件能够让交易变得更加模糊。我们来单独看看下面这个交易，这是一个经过 “最大程度” 模糊化的简单花费。</p><p><img src="//res.btcstudy.org/btcstudy/images/understanding-bitcoin-privacy-with-oxt-part-3/gzep-PA.png" alt="img"></p><p style="text-align:center">- 图 3.2 模糊的简单花费（<a target="_blank" rel="noopener" href="https://oxt.me/transaction/e610d6ab26878c9f37502b3f31755ae5066d9e982613c6042757d8972d412a84">TxID</a>） -</p><h3 id="整数付款启发法防御"><a href="#整数付款启发法防御" class="headerlink" title="整数付款启发法防御"></a>整数付款启发法防御</h3><p>付款额由用户决定。如果用户选择整数付款额，钱包很难抵御应用于简单花费的整数付款启发法。对于大多数真实的付款（以法币计价）来说，这个启发法不太可能奏效。图 3.2 中的例子没有使用整数付款额，并采用了针对整数付款启发法的保护措施。</p><h3 id="相同的找零输出脚本类型"><a href="#相同的找零输出脚本类型" class="headerlink" title="相同的找零输出脚本类型"></a>相同的找零输出脚本类型</h3><p>示例交易的两个输出都采用了相同的输出脚本类型，因此特殊脚本输出启发法并不适用。这有助于维持模糊性，并增加找零检测的难度。</p><h3 id="随机化的找零输出位置"><a href="#随机化的找零输出位置" class="headerlink" title="随机化的找零输出位置"></a>随机化的找零输出位置</h3><p>为了进一步增强该钱包在一系列交易中的行为模糊性，钱包软件必须将找零输出的位置随机化。在输出 0 和 1 之间交替安排找零位置会让针对钱包（如图 2.8 中所示的活动）的自动化追踪变得更难。</p><h3 id="评估包含外部交易数据的交易"><a href="#评估包含外部交易数据的交易" class="headerlink" title="评估包含外部交易数据的交易"></a>评估包含外部交易数据的交易</h3><p>OXT 的交易图使用不同的线宽来表现 UTXO 和交易量的相对大小。这样一来，自动展开交易图会包含一些外部交易数据。</p><p><em>根据交易图和未来的 UTXO 花费情况，哪个输出有可能是付款？该交易中的地址之前有没有被重复使用过？</em></p><p>这就是使用外部交易数据来确定付款和找零输出的绝佳示例。展开交易图或追踪未来的 UTXO 花费情况验证你的 付款/找零 假设。</p><h2 id="UTXO-流和确定性花费"><a href="#UTXO-流和确定性花费" class="headerlink" title="UTXO 流和确定性花费"></a>UTXO 流和确定性花费</h2><p>钱包可以使用相同的找零输出脚本和随机化的找零位置来维持简单花费的模糊性，但是这样无法掩盖交易的输入和输出之间的基本关联。</p><p>交易的输入和输出之间始终存在关联。这些存在于交易内的 UTXO 关系可以被视为 “流”。输入 UTXO 所消耗的 BTC 被转移到了输出 UTXO 中。</p><p><img src="//res.btcstudy.org/btcstudy/images/understanding-bitcoin-privacy-with-oxt-part-3/lUpUyNg.png" alt="img"></p><p style="text-align:center">- 图 3.3 OXT 交易图的 UTXO 流可视化（<a target="_blank" rel="noopener" href="https://oxt.me/transaction/e610d6ab26878c9f37502b3f31755ae5066d9e982613c6042757d8972d412a84">TxID</a>） -</p><p>在简单花费（只有一个输入和两个输出）中，唯一的输入一定被拆分成了两个输出。一个简单花费的内部交易流只有一种解释。因此，单个输入和每个输出之间的关联在数学上具有确定性（<strong>确凿无疑</strong>）。</p><p>你可以在 OXT 交易图上选择某个输入或输出来查看输入和输出之间的关联。<a target="_blank" rel="noopener" href="http://kycp.org/">kycp.org</a> 的交易可视化界面显示了交易的内部关联。</p><p><img src="//res.btcstudy.org/btcstudy/images/understanding-bitcoin-privacy-with-oxt-part-3/Q1g8iCQ.png" alt="img"></p><p style="text-align:center">- 图 3.4 KYCP 的 UTXO 流可视化（<a target="_blank" rel="noopener" href="https://kycp.org/#/e610d6ab26878c9f37502b3f31755ae5066d9e982613c6042757d8972d412a84">TxID</a>） -</p><h2 id="打破关联-——-非确定性交易"><a href="#打破关联-——-非确定性交易" class="headerlink" title="打破关联 —— 非确定性交易"></a>打破关联 —— 非确定性交易</h2><p>尽管 UTXO 所有权模糊性始终存在，但是仅靠 UTXO 所有权模型并不能混淆链上 BTC 流。如果不打破确定性关联并向交易图中引入模糊性，比特币将永远是 “可追溯的”。</p><p>打破确定性关联并产生链上模糊性需要采用特定的交易结构。确定性取决于交易输入和输出的数量，以及每个 UTXO 中的 BTC 数量。</p><p>有多个输入和输出的交易本身就可以创建一个复杂的交易图。如果不借助特殊的工具或经过特别的考量，这类交易解释起来绝非易事。</p><p><img src="//res.btcstudy.org/btcstudy/images/understanding-bitcoin-privacy-with-oxt-part-3/XS0KvPw.png" alt="img"></p><p style="text-align:center">- 图 3.5 拥有多个输入和输出的交易示例（<a target="_blank" rel="noopener" href="https://oxt.me/transaction/c7d1e40ae001a7fe4c860f9b7ddddcf9b5a3dad461466744e9b5e28c4b47e6b7">TxID</a>） -</p><p>尽管交易图如此复杂，我们仍可以对拥有多个输入和输出的交易的 UTXO 之间的确定性关联进行评估。Kristov Atlas 是最先在他的 “<a target="_blank" rel="noopener" href="https://github.com/kristovatlas/coinjoin-sudoku">CoinJoin 数独</a>” 咨询和算法中引入这一概念的人。</p><p>CoinJoin 可以让多名用户将他们的资金集中起来，共同创建一个交易。通常情况下，这个交易的每个输出额都相等。CoinJoin 数独算法使用数学领域的子集总和分析从输入和输出的 “共同所有权” 角度对交易进行评估。</p><p>CoinJoin 数独所涉及的数学概念不在本文的讨论范围内。此处想要强调的重点是，如果 CoinJoin 交易的构造过于简单，我们完全可以通过评估找出其内部的确定性关联。</p><p>如今，CoinJoin 数独概念已经得到了进一步扩展。由 OXT 开发主管 <a target="_blank" rel="noopener" href="https://twitter.com/laurentmt">LaurentMT</a> 创建的 <a target="_blank" rel="noopener" href="https://code.samourai.io/oxt/boltzmann">Boltzmann</a> 算法使用 CoinJoin 数独概念评估交易的一些隐私相关指标。</p><p>即使是正确构造的 CoinJoin 交易，<strong>输入和相等输出之间的关联依然存在，但是这些关联是概率性的而非确定性的</strong>。Boltzmann 算法通过计算关联概率矩阵（LPM）来确定交易的输入和输出之间的关联。</p><p>交易的 LPM 输出可以在 OXT 的 TRANSACTION 页面上看到。INPUTS&amp;OUTPUTS 选项卡内可查看交易的单个输入和每个输出之间的子集。点击你感兴趣的 UTXO 右侧的 “🔗” 图标即可查看。</p><p><img src="//res.btcstudy.org/btcstudy/images/understanding-bitcoin-privacy-with-oxt-part-3/6tVOZAg.png" alt="img"></p><p style="text-align:center">- 图 3.6 OXT 关联矩阵子集（<a target="_blank" rel="noopener" href="https://oxt.me/transaction/3a7455d3f04709870f7148f9f9c8d6c8a3fd83e8c76afadf6a4acd613afdb53e">TxID</a>） -</p><p>你也可以在 OXT 交易图（见图 3.3）中选择输入和输出来查看被选中的 UTXO 的 LPM。根据 Boltzmann 算法计算出的完整 LPM 可以在 <a target="_blank" rel="noopener" href="http://kycp.org/">kycp.org</a> 上查看。</p><p><img src="//res.btcstudy.org/btcstudy/images/understanding-bitcoin-privacy-with-oxt-part-3/MlQOZA.png" alt="img"></p><p style="text-align:center">- 图 3.7 KYCP UTXO 流和 LPM（<a target="_blank" rel="noopener" href="https://kycp.org/#/aed291496b2e3fed785881a8600a0fa58dfbc706e3f9ac1f9052839b596c175a">TxID</a>） -</p><h2 id="熵-——-等输出额的-CoinJoin-交易以及-CIOH-的适用场景"><a href="#熵-——-等输出额的-CoinJoin-交易以及-CIOH-的适用场景" class="headerlink" title="熵 —— 等输出额的 CoinJoin 交易以及 CIOH 的适用场景"></a>熵 —— 等输出额的 CoinJoin 交易以及 CIOH 的适用场景</h2><p>在一个等输出额的 CoinJoin 交易中，多名用户通过共同创建交易的方式来将自己的资金集中起来，打破交易的输入与等额输出之间的确定性关联。</p><p>由于这类交易包含多名用户，CIOH（共同输入所有权启发法）并不适用。如果有可能是 CoinJoin 交易的交易的输入由同一个钱包控制，CIOH 可能会得出错误的钱包集群。</p><p>为避免出现这种情况，分析师可以对有可能是 CoinJoin 交易的交易采用等输出额启发法。但是，并非所有等输出额的交易都是 CoinJoin 交易。如果一个拥有多个等额输出的交易构造过于简单，其内部输入和<strong>等额输出</strong>之间可能依然存在确定性关系，从而证明这个交易<strong>不是</strong> CoinJoin 交易。</p><p><img src="//res.btcstudy.org/btcstudy/images/understanding-bitcoin-privacy-with-oxt-part-3/qqZW_Sw.png" alt="img"></p><p style="text-align:center">- 图 3.8 存在确定性关联的等输出额交易（<a target="_blank" rel="noopener" href="https://kycp.org/#/a9b5563592099bf6ed68e7696eeac05c8cb514e21490643e0b7a9b72dac90b07">TxID</a>） -</p>有了 Boltzmann，分析师可以真正评估交易的 CoinJoin 属性，而非错误地对交易进行聚类分析或简单地将等输出额的交易排除在外。<p>Boltzmann 本质上是利用子集总和分析来追问这样一个问题：<em>交易的输入是否有可能通过多种方式产生输出（是否存在多种解释）？</em></p><p>如果一个交易的内部 UTXO 流有多个解释，Boltzmann 给该交易的熵打分会大于或等于 0。熵的概念源自热力学心智模型。在这个模型中，我们可以将解释的数量看作是整个交易的宏观状态下的微观状态数量。</p><p><strong>熵可被视为衡量分析师对其所观察交易的确切配置了解匮乏程度的指标。</strong></p><p>带有熵的交易不仅具备 CoinJoin 属性，而且丧失了确定性关联。CoinJoin 属性可证明一个交易的输入来自多名用户。谨慎起见，带有熵的交易的输入不应该通过 CIOH 进行聚合分析。</p><p><img src="//res.btcstudy.org/btcstudy/images/understanding-bitcoin-privacy-with-oxt-part-3/UWrQrgA.png" alt="img"></p><p style="text-align:center">- 图 3.9 KYCP 对一个来自 DarkWallet 的 CoinJoin 交易的评估（<a target="_blank" rel="noopener" href="https://kycp.org/#/8e56317360a548e8ef28ec475878ef70d1371bee3526c017ac22ad61ae5740b8">TxID</a>） -</p><h3 id="KYCP-交易解释"><a href="#KYCP-交易解释" class="headerlink" title="KYCP 交易解释"></a>KYCP 交易解释</h3><p>KYCP 包含大量交易信息，包括跨交易的地址重用、确定性和概率性关联以及输入和输出合并。上图的示例交易是一个来自 DarkWallet 的 CoinJoin 交易。等额输出之间的确定性关联已经被打破，但是输入和 “找零输出” 之间的确定性关联依然存在。还要注意的是，上图中的输出 1 和 3 被发送（合并）到了同一个未来交易内。这说明相同的 用户/钱包 被混合到了一起。</p><h2 id="CoinJoin-——-等输出额（加密）和-PayJoin（隐写术）"><a href="#CoinJoin-——-等输出额（加密）和-PayJoin（隐写术）" class="headerlink" title="CoinJoin —— 等输出额（加密）和 PayJoin（隐写术）"></a>CoinJoin —— 等输出额（加密）和 PayJoin（隐写术）</h2><p>等输出额的 CoinJoin 交易拥有独特的链上足迹，可以根据多个等额输出的存在来识别。但是，等输出额的 CoinJoin 交易的 UTXO 流不具备确定性。如果分析师知道他们正在观察的是一个 CoinJoin 交易，他们必须考虑这样一个情况：众多等额输出之一就控制在他们试图追踪的用户手中。在大多数情况下，这足以让分析师停止追踪。</p><p><img src="//res.btcstudy.org/btcstudy/images/understanding-bitcoin-privacy-with-oxt-part-3/XPYU4sg.png" alt="img"></p><p style="text-align:center">- 图 3.10 Whirlpool 的 CoinJoin 交易图（<a target="_blank" rel="noopener" href="https://kycp.org/#/323df21f0b0756f98336437aa3d2fb87e02b59f1946b714a7b09df04d429dec2">TxID</a>） -</p><p>碰到等输出额的 CoinJoin 交易时，分析师知道该交易使用了隐私技术，但是无法可靠地解释该交易。如此看来，等输出额的 CoinJoin 交易就类似于<strong>加密</strong>。这就好比说加密消息的观察者明知一个消息存在（可以观察 CoinJoin 交易），但是无法破译该消息（可靠解释该交易的 UTXO 流）。</p><p>另一类 CoinJoin 交易被称为 PayJoin、pay-to-end-point（P2EP）或（在 Samourai Wallet 中叫作）Stowaway。PayJoin 交易由付款用户和收款用户之间的合作交易组成。在区块链上，许多 PayJoin 交易并没有可识别的模式或适用的启发法。</p><p>实际上，PayJoin 与用户花费多个 UTXO 的普通交易之间无法辨别。由于二者无法通过任何链上交易足迹进行区分，分析师可能会错误地将 CIOH 应用于 PayJoin 交易，并错误地假设每个输入都由同一个用户控制。</p><p>如此看来，PayJoin 交易是一种<strong>隐写术</strong>。隐写术就是将秘密消息（发生了 CoinJoin 交易）隐藏在看似正常的数据（花费多个输入的正常交易）内。由于 PayJoin 交易不会留下任何可分辨的链上足迹，分析师使用 CIOH 分析时通常会得出错误的钱包集群。</p><h2 id="其它技术方案-——-“破坏”-交易图"><a href="#其它技术方案-——-“破坏”-交易图" class="headerlink" title="其它技术方案 —— “破坏” 交易图"></a>其它技术方案 —— “破坏” 交易图</h2><p>托管式 tumbler（通常被称为混币器）是最早在应用层采用的隐私技术之一。托管式 tumbler 旨在提供互换服务。在将代币存入 tumbler 后，用户（有望）收到拥有不同交易历史的 UTXO。在理想情况下，这种互换过程会 “破坏” 交易图，斩断用户的存取款之间的联系。</p><p>混币技术还带火了 “污点” 的概念。在互换过程中，tumbler 用户可能会在不知情的情况下收到 “交易历史存在问题” 的 UTXO。有兴趣的读者可以阅读我们<a target="_blank" rel="noopener" href="https://research.oxt.me/publications">关于 Kucoin 被黑事件的调查报告</a>，里面有我们对全球最大的两家托管式混币服务提供商（ChipMixer 和 Blender）的评估。</p><p>CoinSwap 等隐私增强方案旨在以非托管方式破坏交易图。这些技术仍处于起步阶段。如果不采取其它措施，这些互换理论上将面临与托管式 tumbler 同样的 “污点” 问题。如果将来有新的技术方案成功部署，我们会相应更新这一节的内容。</p><h2 id="回顾"><a href="#回顾" class="headerlink" title="回顾"></a>回顾</h2><p>在本文中，我们介绍了很多能够打败主流区块链分析启发法的工具。</p><p>避免整数付款额、创建支付输出与找零输出脚本类型相同的交易和实现找零输出位置随机化等措施可以打败找零检测启发法。</p><p>等输出额的 CoinJoin 交易是涉及多名用户的合作交易，通过打破确定性关联形成模糊的交易图。由于包含了多名用户，这类交易得以打败 CIOH。</p><p>PayJoin 交易也属于合作交易，涉及到创建交易的付款方和收款方，其交易指纹与普通的多输入花费没有区别。由于没有可识别的指纹，这类交易得以打败 CIOH。</p><p>Part 4 讨论了：</p><ol><li>需要 “起点” 的分析</li><li>发送和接收付款对隐私性产生的影响</li><li>现有的隐私性技术如何缓解本指南中讨论的很多问题</li></ol><p>（完）</p></article></div></div></main><script src="/js/post.js?v=1673504754539"></script><script src="/js/highlight.min.js?v=1673504754539"></script><script>var containerEl=document.querySelector(".post-container"),postFontSize=localStorage.getItem("post-font-size")||"16",inputEl=document.querySelector("#size-change-input"),inputEl2=document.querySelector("#size-change-input2");inputEl.value=postFontSize,inputEl2.value=postFontSize,containerEl.style.fontSize=postFontSize+"px",$(function(){function e(t){$(".post-container").css("font-size",t+"px"),localStorage.setItem("post-font-size",t),$("#size-change-input").val(t),$("#size-change-input2").val(t)}$("#size-change-input").on("input propertychange",function(t){e(t.target.value)}),$("#size-change-input2").on("input propertychange",function(t){e(t.target.value)})})</script><script>hljs.initHighlightingOnLoad()</script></main></div><footer class="is-flex is-flex-direction-column is-align-items-center is-flex-shrink-0"><section class="sns-container"><a title="twitter" target="_blank" rel="noopener nofollow" href="//twitter.com/btcstudy">Twitter</a><a title="rss" target="_blank" rel="noopener nofollow" href="/atom.xml">rss</a><a title="telegram" target="_blank" rel="noopener nofollow" href="//t.me/btcstudyorg">Telegram</a></section></footer><script async src="/js/buttons.js?v=1673504754539"></script><script async src="/js/index.js?v=1673504754539"></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-JVCJ9XXG1Z"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-JVCJ9XXG1Z")</script><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script"),t=(e.src="https://hm.baidu.com/hm.js?c92c073c85be5be8d9b1b76f62a7e306",e.async=!0,e.defer=!0,document.getElementsByTagName("script")[0]);t.parentNode.insertBefore(e,t)}()</script></body></html>