<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><title>比特币所用的时间锁</title><meta name="keywords" content="比特币, 中本聪, 比特币区块链, 闪电网络, 比特币 layer 2, 健全货币, 密码货币, 密码朋克, 学习比特币, BTC, BTC Study, Bitcoin, bitcoin, proof of work"><meta name="description" content="比特币思想的中文集结地"><meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, initial-scale=1"><link rel="icon" href="/favicon.ico"><link rel="stylesheet" href="/style/common/bulma.css?v=1673690025615"><link rel="preload" as="style" onload="this.onload=null;this.rel='stylesheet'" href="/style/common/iconfont.css?v=1673690025615"><link rel="stylesheet" href="/style/base.css?v=1673690025615"><link rel="stylesheet" href="/style/common/helper.css?v=1673690025615"><link rel="stylesheet" href="/style/themes/animation.css?v=1673690025615"><script>function ready() {
  var bodyEl = document.querySelector('.body-container');
  var theme = localStorage.getItem('theme') || 'light';
  if (!['light', 'dark'].includes(theme)) {
    theme = 'light';
    localStorage.setItem('theme', 'light');
  }
  bodyEl.classList.remove('appearance-auto');
  bodyEl.classList.add('appearance-' + theme);
  quickInitialTheme();
}
function quickInitialTheme() {
  var theme = localStorage.getItem('theme') || 'light';
  var logoLightEl = document.querySelector('.logo-light');
  var logoDarkEl = document.querySelector('.logo-dark');
  
  var mLogoLightEl = document.querySelector('#mobile-header-logo > .logo-light');
  var mLogoDarkEl = document.querySelector('#mobile-header-logo > .logo-dark');
  var themeBtnEl = document.getElementById('theme-btn');
  
  var slideThemeLightEl = document.querySelector('.slide-theme-light');
  var slideThemeDarkEl = document.querySelector('.slide-theme-dark');
  
  document.body.classList.add(theme);
  if (theme === 'dark') {
    logoLightEl.classList.add('hidden');
    logoDarkEl.classList.remove('hidden');
    
    mLogoLightEl.classList.add('hidden');
    mLogoDarkEl.classList.remove('hidden');
    
    themeBtnEl.classList.remove('icon-icon_dark');
    themeBtnEl.classList.add('icon-icon_light');
    
    slideThemeLightEl.classList.remove('hidden');
  } else {
    slideThemeDarkEl.classList.remove('hidden');
  }
}
document.addEventListener("DOMContentLoaded", ready);</script><script src="/js/common.js?v=1673690025615"></script><script src="/js/libs/zepto.min.js"></script><link rel="stylesheet" href="/style/post.css?v=1673690025615"><link rel="stylesheet" href="/style/themes/highlight.css?v=1673690025615"><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="BTC Study" type="application/atom+xml">
</head><body class="is-flex is-flex-direction-column" onload="initialTheme()"><div class="clip"></div><div class="body-container appearance-auto"><header class="header-widget is-hidden-mobile is-flex is-flex-shrink-0 is-align-items-center is-justify-content-center" id="header"><div class="is-flex header-widget-container is-flex-shrink-0 is-align-items-center"><section class="is-hidden-mobile is-flex-shrink-0"><h1><a href="/"><svg class="logo-light" width="125px" height="23px" viewBox="0 0 125 23" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>BTCStudy</title><g id="页面-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="首页-响应式" transform="translate(-249.000000, -23.000000)" fill-rule="nonzero"><g id="BTCStudy" transform="translate(249.680000, 23.192000)"><path d="M9.072,17.808 C11.312,17.808 13.024,17.408 14.208,16.608 C15.392,15.808 15.984,14.672 15.984,13.2 C15.984,12.192 15.712,11.332 15.168,10.62 C14.624,9.908 13.872,9.384 12.912,9.048 C13.632,8.68 14.188,8.18 14.58,7.548 C14.972,6.916 15.168,6.2 15.168,5.4 C15.168,4.056 14.608,2.988 13.488,2.196 C12.368,1.404 10.736,1.008 8.592,1.008 L8.592,1.008 L-5.68434189e-14,1.008 L-5.68434189e-14,17.808 L9.072,17.808 Z M7.968,7.68 L4.704,7.68 L4.704,4.44 L7.968,4.44 C9.568,4.44 10.368,4.976 10.368,6.048 C10.368,7.136 9.568,7.68 7.968,7.68 L7.968,7.68 Z M8.688,14.376 L4.704,14.376 L4.704,10.968 L8.688,10.968 C10.352,10.968 11.184,11.536 11.184,12.672 C11.184,13.808 10.352,14.376 8.688,14.376 L8.688,14.376 Z M26.544,17.808 L26.544,4.776 L31.68,4.776 L31.68,1.008 L16.632,1.008 L16.632,4.776 L21.792,4.776 L21.792,17.808 L26.544,17.808 Z M41.592,18.144 C43.128,18.144 44.512,17.872 45.744,17.328 C46.976,16.784 48,16 48.816,14.976 L48.816,14.976 L45.792,12.24 C44.704,13.552 43.384,14.208 41.832,14.208 C40.92,14.208 40.108,14.008 39.396,13.608 C38.684,13.208 38.132,12.644 37.74,11.916 C37.348,11.188 37.152,10.352 37.152,9.408 C37.152,8.464 37.348,7.628 37.74,6.9 C38.132,6.172 38.684,5.608 39.396,5.208 C40.108,4.808 40.92,4.608 41.832,4.608 C43.384,4.608 44.704,5.264 45.792,6.576 L45.792,6.576 L48.816,3.84 C48,2.816 46.976,2.032 45.744,1.488 C44.512,0.944 43.128,0.672 41.592,0.672 C39.832,0.672 38.252,1.044 36.852,1.788 C35.452,2.532 34.352,3.568 33.552,4.896 C32.752,6.224 32.352,7.728 32.352,9.408 C32.352,11.088 32.752,12.592 33.552,13.92 C34.352,15.248 35.452,16.284 36.852,17.028 C38.252,17.772 39.832,18.144 41.592,18.144 Z" id="BTC" fill="#F2A900"></path><path d="M56.64,18.144 C58.24,18.144 59.6,17.9 60.72,17.412 C61.84,16.924 62.68,16.272 63.24,15.456 C63.8,14.64 64.08,13.728 64.08,12.72 C64.08,11.552 63.772,10.628 63.156,9.948 C62.54,9.268 61.812,8.772 60.972,8.46 C60.132,8.148 59.072,7.856 57.792,7.584 C56.656,7.344 55.832,7.112 55.32,6.888 C54.808,6.664 54.552,6.328 54.552,5.88 C54.552,5.432 54.768,5.068 55.2,4.788 C55.632,4.508 56.32,4.368 57.264,4.368 C58.768,4.368 60.32,4.8 61.92,5.664 L61.92,5.664 L63.384,2.136 C62.568,1.656 61.624,1.292 60.552,1.044 C59.48,0.796 58.392,0.672 57.288,0.672 C55.672,0.672 54.308,0.912 53.196,1.392 C52.084,1.872 51.248,2.524 50.688,3.348 C50.128,4.172 49.848,5.096 49.848,6.12 C49.848,7.288 50.152,8.216 50.76,8.904 C51.368,9.592 52.096,10.092 52.944,10.404 C53.792,10.716 54.848,11.008 56.112,11.28 C57.264,11.536 58.1,11.78 58.62,12.012 C59.14,12.244 59.4,12.6 59.4,13.08 C59.4,13.992 58.488,14.448 56.664,14.448 C55.704,14.448 54.728,14.296 53.736,13.992 C52.744,13.688 51.872,13.288 51.12,12.792 L51.12,12.792 L49.56,16.296 C50.36,16.856 51.4,17.304 52.68,17.64 C53.96,17.976 55.28,18.144 56.64,18.144 Z M71.856,18.024 C72.48,18.024 73.068,17.96 73.62,17.832 C74.172,17.704 74.64,17.52 75.024,17.28 L75.024,17.28 L73.896,14.088 C73.496,14.36 73.032,14.496 72.504,14.496 C72.088,14.496 71.756,14.364 71.508,14.1 C71.26,13.836 71.136,13.472 71.136,13.008 L71.136,13.008 L71.136,8.688 L74.112,8.688 L74.112,5.28 L71.136,5.28 L71.136,1.896 L66.576,1.896 L66.576,5.28 L64.68,5.28 L64.68,8.688 L66.576,8.688 L66.576,13.056 C66.576,14.704 67.032,15.944 67.944,16.776 C68.856,17.608 70.16,18.024 71.856,18.024 Z M82.248,18.024 C83,18.024 83.712,17.888 84.384,17.616 C85.056,17.344 85.632,16.944 86.112,16.416 L86.112,16.416 L86.112,17.808 L90.456,17.808 L90.456,4.8 L85.896,4.8 L85.896,11.064 C85.896,12.104 85.668,12.876 85.212,13.38 C84.756,13.884 84.168,14.136 83.448,14.136 C82.744,14.136 82.208,13.912 81.84,13.464 C81.472,13.016 81.288,12.304 81.288,11.328 L81.288,11.328 L81.288,4.8 L76.728,4.8 L76.728,12.072 C76.728,14.056 77.228,15.544 78.228,16.536 C79.228,17.528 80.568,18.024 82.248,18.024 Z M99.048,18.024 C100.744,18.024 102.016,17.52 102.864,16.512 L102.864,16.512 L102.864,17.808 L107.208,17.808 L107.208,0 L102.648,0 L102.648,5.928 C101.8,5.032 100.6,4.584 99.048,4.584 C97.864,4.584 96.784,4.856 95.808,5.4 C94.832,5.944 94.06,6.724 93.492,7.74 C92.924,8.756 92.64,9.936 92.64,11.28 C92.64,12.624 92.924,13.808 93.492,14.832 C94.06,15.856 94.832,16.644 95.808,17.196 C96.784,17.748 97.864,18.024 99.048,18.024 Z M100.008,14.4 C99.208,14.4 98.552,14.124 98.04,13.572 C97.528,13.02 97.272,12.256 97.272,11.28 C97.272,10.32 97.528,9.568 98.04,9.024 C98.552,8.48 99.208,8.208 100.008,8.208 C100.808,8.208 101.46,8.48 101.964,9.024 C102.468,9.568 102.72,10.32 102.72,11.28 C102.72,12.256 102.464,13.02 101.952,13.572 C101.44,14.124 100.792,14.4 100.008,14.4 Z M112.368,22.68 C113.728,22.68 114.88,22.356 115.824,21.708 C116.768,21.06 117.568,19.936 118.224,18.336 L118.224,18.336 L123.84,4.8 L119.496,4.8 L116.28,12.744 L113.088,4.8 L108.408,4.8 L113.976,17.976 C113.784,18.36 113.548,18.64 113.268,18.816 C112.988,18.992 112.632,19.08 112.2,19.08 C111.832,19.08 111.468,19.012 111.108,18.876 C110.748,18.74 110.44,18.552 110.184,18.312 L110.184,18.312 L108.6,21.504 C109.032,21.856 109.596,22.14 110.292,22.356 C110.988,22.572 111.68,22.68 112.368,22.68 Z" id="Study" fill-opacity="0.85" fill="#000000"></path></g></g></g></svg><svg class="logo-dark hidden" width="125px" height="23px" viewBox="0 0 125 23" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>BTCStudy</title><g id="页面-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="首页-响应式" transform="translate(-249.000000, -23.000000)" fill-rule="nonzero"><g id="BTCStudy" transform="translate(249.680000, 23.192000)"><path d="M9.072,17.808 C11.312,17.808 13.024,17.408 14.208,16.608 C15.392,15.808 15.984,14.672 15.984,13.2 C15.984,12.192 15.712,11.332 15.168,10.62 C14.624,9.908 13.872,9.384 12.912,9.048 C13.632,8.68 14.188,8.18 14.58,7.548 C14.972,6.916 15.168,6.2 15.168,5.4 C15.168,4.056 14.608,2.988 13.488,2.196 C12.368,1.404 10.736,1.008 8.592,1.008 L8.592,1.008 L-5.68434189e-14,1.008 L-5.68434189e-14,17.808 L9.072,17.808 Z M7.968,7.68 L4.704,7.68 L4.704,4.44 L7.968,4.44 C9.568,4.44 10.368,4.976 10.368,6.048 C10.368,7.136 9.568,7.68 7.968,7.68 L7.968,7.68 Z M8.688,14.376 L4.704,14.376 L4.704,10.968 L8.688,10.968 C10.352,10.968 11.184,11.536 11.184,12.672 C11.184,13.808 10.352,14.376 8.688,14.376 L8.688,14.376 Z M26.544,17.808 L26.544,4.776 L31.68,4.776 L31.68,1.008 L16.632,1.008 L16.632,4.776 L21.792,4.776 L21.792,17.808 L26.544,17.808 Z M41.592,18.144 C43.128,18.144 44.512,17.872 45.744,17.328 C46.976,16.784 48,16 48.816,14.976 L48.816,14.976 L45.792,12.24 C44.704,13.552 43.384,14.208 41.832,14.208 C40.92,14.208 40.108,14.008 39.396,13.608 C38.684,13.208 38.132,12.644 37.74,11.916 C37.348,11.188 37.152,10.352 37.152,9.408 C37.152,8.464 37.348,7.628 37.74,6.9 C38.132,6.172 38.684,5.608 39.396,5.208 C40.108,4.808 40.92,4.608 41.832,4.608 C43.384,4.608 44.704,5.264 45.792,6.576 L45.792,6.576 L48.816,3.84 C48,2.816 46.976,2.032 45.744,1.488 C44.512,0.944 43.128,0.672 41.592,0.672 C39.832,0.672 38.252,1.044 36.852,1.788 C35.452,2.532 34.352,3.568 33.552,4.896 C32.752,6.224 32.352,7.728 32.352,9.408 C32.352,11.088 32.752,12.592 33.552,13.92 C34.352,15.248 35.452,16.284 36.852,17.028 C38.252,17.772 39.832,18.144 41.592,18.144 Z" id="BTC" fill="#F2A900"></path><path d="M56.64,18.144 C58.24,18.144 59.6,17.9 60.72,17.412 C61.84,16.924 62.68,16.272 63.24,15.456 C63.8,14.64 64.08,13.728 64.08,12.72 C64.08,11.552 63.772,10.628 63.156,9.948 C62.54,9.268 61.812,8.772 60.972,8.46 C60.132,8.148 59.072,7.856 57.792,7.584 C56.656,7.344 55.832,7.112 55.32,6.888 C54.808,6.664 54.552,6.328 54.552,5.88 C54.552,5.432 54.768,5.068 55.2,4.788 C55.632,4.508 56.32,4.368 57.264,4.368 C58.768,4.368 60.32,4.8 61.92,5.664 L61.92,5.664 L63.384,2.136 C62.568,1.656 61.624,1.292 60.552,1.044 C59.48,0.796 58.392,0.672 57.288,0.672 C55.672,0.672 54.308,0.912 53.196,1.392 C52.084,1.872 51.248,2.524 50.688,3.348 C50.128,4.172 49.848,5.096 49.848,6.12 C49.848,7.288 50.152,8.216 50.76,8.904 C51.368,9.592 52.096,10.092 52.944,10.404 C53.792,10.716 54.848,11.008 56.112,11.28 C57.264,11.536 58.1,11.78 58.62,12.012 C59.14,12.244 59.4,12.6 59.4,13.08 C59.4,13.992 58.488,14.448 56.664,14.448 C55.704,14.448 54.728,14.296 53.736,13.992 C52.744,13.688 51.872,13.288 51.12,12.792 L51.12,12.792 L49.56,16.296 C50.36,16.856 51.4,17.304 52.68,17.64 C53.96,17.976 55.28,18.144 56.64,18.144 Z M71.856,18.024 C72.48,18.024 73.068,17.96 73.62,17.832 C74.172,17.704 74.64,17.52 75.024,17.28 L75.024,17.28 L73.896,14.088 C73.496,14.36 73.032,14.496 72.504,14.496 C72.088,14.496 71.756,14.364 71.508,14.1 C71.26,13.836 71.136,13.472 71.136,13.008 L71.136,13.008 L71.136,8.688 L74.112,8.688 L74.112,5.28 L71.136,5.28 L71.136,1.896 L66.576,1.896 L66.576,5.28 L64.68,5.28 L64.68,8.688 L66.576,8.688 L66.576,13.056 C66.576,14.704 67.032,15.944 67.944,16.776 C68.856,17.608 70.16,18.024 71.856,18.024 Z M82.248,18.024 C83,18.024 83.712,17.888 84.384,17.616 C85.056,17.344 85.632,16.944 86.112,16.416 L86.112,16.416 L86.112,17.808 L90.456,17.808 L90.456,4.8 L85.896,4.8 L85.896,11.064 C85.896,12.104 85.668,12.876 85.212,13.38 C84.756,13.884 84.168,14.136 83.448,14.136 C82.744,14.136 82.208,13.912 81.84,13.464 C81.472,13.016 81.288,12.304 81.288,11.328 L81.288,11.328 L81.288,4.8 L76.728,4.8 L76.728,12.072 C76.728,14.056 77.228,15.544 78.228,16.536 C79.228,17.528 80.568,18.024 82.248,18.024 Z M99.048,18.024 C100.744,18.024 102.016,17.52 102.864,16.512 L102.864,16.512 L102.864,17.808 L107.208,17.808 L107.208,0 L102.648,0 L102.648,5.928 C101.8,5.032 100.6,4.584 99.048,4.584 C97.864,4.584 96.784,4.856 95.808,5.4 C94.832,5.944 94.06,6.724 93.492,7.74 C92.924,8.756 92.64,9.936 92.64,11.28 C92.64,12.624 92.924,13.808 93.492,14.832 C94.06,15.856 94.832,16.644 95.808,17.196 C96.784,17.748 97.864,18.024 99.048,18.024 Z M100.008,14.4 C99.208,14.4 98.552,14.124 98.04,13.572 C97.528,13.02 97.272,12.256 97.272,11.28 C97.272,10.32 97.528,9.568 98.04,9.024 C98.552,8.48 99.208,8.208 100.008,8.208 C100.808,8.208 101.46,8.48 101.964,9.024 C102.468,9.568 102.72,10.32 102.72,11.28 C102.72,12.256 102.464,13.02 101.952,13.572 C101.44,14.124 100.792,14.4 100.008,14.4 Z M112.368,22.68 C113.728,22.68 114.88,22.356 115.824,21.708 C116.768,21.06 117.568,19.936 118.224,18.336 L118.224,18.336 L123.84,4.8 L119.496,4.8 L116.28,12.744 L113.088,4.8 L108.408,4.8 L113.976,17.976 C113.784,18.36 113.548,18.64 113.268,18.816 C112.988,18.992 112.632,19.08 112.2,19.08 C111.832,19.08 111.468,19.012 111.108,18.876 C110.748,18.74 110.44,18.552 110.184,18.312 L110.184,18.312 L108.6,21.504 C109.032,21.856 109.596,22.14 110.292,22.356 C110.988,22.572 111.68,22.68 112.368,22.68 Z" id="Study" fill-opacity="0.85" fill="#FFFFFF"></path></g></g></g></svg></a></h1></section><div class="is-flex is-flex-direction-column header-menu-wrap"><aside class="is-flex-shrink-0 is-flex is-flex-direction-row is-align-items-center" id="header-menu"><a class="is-inline-block header-activity mr-4" href="/">首页</a><a class="is-inline-block mr-4" href="/archives">全站目录</a><a class="is-inline-block mr-4" href="/tags">标签</a><a class="is-inline-block mr-4" href="/maps">地图</a><a class="is-inline-block mr-4" href="/mempool">mempool</a><a class="is-inline-block mr-4" target="_blank" rel="noopener" href="https://123btc.org/">123btc</a><div class="right-content is-flex is-flex-direction-row is-align-items-center"><div class="size-wrap mr-1"><i class="iconfont icon-a-bianzu5" id="change-size-btn"></i><div class="size-input-wrap"><div class="input-wrap"><input id="size-change-input" type="range" min="12" max="32" step="2"></div></div></div><i class="iconfont icon-icon_dark mr-1" id="theme-btn"></i><div class="search-wrap"><input class="pl-3" id="search-input" placeholder="请输入搜索关键词"><i class="iconfont icon-icon_search" id="search-input-btn"></i></div></div></aside><div class="header-title is-hidden-mobile is-full-height is-flex is-align-items-center is-flex-shrink-0"><div class="is-full-height hidden" id="postTopic"><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">比特币所用的时间锁</p><div class="size-wrap mr-1"><i class="iconfont icon-a-bianzu5" id="change-size-btn2"></i><div class="size-input-wrap"><div class="input-wrap"><input id="size-change-input2" type="range" min="12" max="32" step="2"></div></div></div></div></div></div></div></header><header class="is-flex header-widget is-flex-shrink-0 is-align-items-center is-justify-content-space-between is-hidden-tablet" id="mobile-header"><div class="is-flex is-flex-direction-row is-align-items-center"><i class="iconfont icon-icon_bar mobile-header-menu"></i><div id="mobile-header-logo"><svg class="logo-light" width="125px" height="23px" viewBox="0 0 125 23" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>BTCStudy</title><g id="页面-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="首页-响应式" transform="translate(-249.000000, -23.000000)" fill-rule="nonzero"><g id="BTCStudy" transform="translate(249.680000, 23.192000)"><path d="M9.072,17.808 C11.312,17.808 13.024,17.408 14.208,16.608 C15.392,15.808 15.984,14.672 15.984,13.2 C15.984,12.192 15.712,11.332 15.168,10.62 C14.624,9.908 13.872,9.384 12.912,9.048 C13.632,8.68 14.188,8.18 14.58,7.548 C14.972,6.916 15.168,6.2 15.168,5.4 C15.168,4.056 14.608,2.988 13.488,2.196 C12.368,1.404 10.736,1.008 8.592,1.008 L8.592,1.008 L-5.68434189e-14,1.008 L-5.68434189e-14,17.808 L9.072,17.808 Z M7.968,7.68 L4.704,7.68 L4.704,4.44 L7.968,4.44 C9.568,4.44 10.368,4.976 10.368,6.048 C10.368,7.136 9.568,7.68 7.968,7.68 L7.968,7.68 Z M8.688,14.376 L4.704,14.376 L4.704,10.968 L8.688,10.968 C10.352,10.968 11.184,11.536 11.184,12.672 C11.184,13.808 10.352,14.376 8.688,14.376 L8.688,14.376 Z M26.544,17.808 L26.544,4.776 L31.68,4.776 L31.68,1.008 L16.632,1.008 L16.632,4.776 L21.792,4.776 L21.792,17.808 L26.544,17.808 Z M41.592,18.144 C43.128,18.144 44.512,17.872 45.744,17.328 C46.976,16.784 48,16 48.816,14.976 L48.816,14.976 L45.792,12.24 C44.704,13.552 43.384,14.208 41.832,14.208 C40.92,14.208 40.108,14.008 39.396,13.608 C38.684,13.208 38.132,12.644 37.74,11.916 C37.348,11.188 37.152,10.352 37.152,9.408 C37.152,8.464 37.348,7.628 37.74,6.9 C38.132,6.172 38.684,5.608 39.396,5.208 C40.108,4.808 40.92,4.608 41.832,4.608 C43.384,4.608 44.704,5.264 45.792,6.576 L45.792,6.576 L48.816,3.84 C48,2.816 46.976,2.032 45.744,1.488 C44.512,0.944 43.128,0.672 41.592,0.672 C39.832,0.672 38.252,1.044 36.852,1.788 C35.452,2.532 34.352,3.568 33.552,4.896 C32.752,6.224 32.352,7.728 32.352,9.408 C32.352,11.088 32.752,12.592 33.552,13.92 C34.352,15.248 35.452,16.284 36.852,17.028 C38.252,17.772 39.832,18.144 41.592,18.144 Z" id="BTC" fill="#F2A900"></path><path d="M56.64,18.144 C58.24,18.144 59.6,17.9 60.72,17.412 C61.84,16.924 62.68,16.272 63.24,15.456 C63.8,14.64 64.08,13.728 64.08,12.72 C64.08,11.552 63.772,10.628 63.156,9.948 C62.54,9.268 61.812,8.772 60.972,8.46 C60.132,8.148 59.072,7.856 57.792,7.584 C56.656,7.344 55.832,7.112 55.32,6.888 C54.808,6.664 54.552,6.328 54.552,5.88 C54.552,5.432 54.768,5.068 55.2,4.788 C55.632,4.508 56.32,4.368 57.264,4.368 C58.768,4.368 60.32,4.8 61.92,5.664 L61.92,5.664 L63.384,2.136 C62.568,1.656 61.624,1.292 60.552,1.044 C59.48,0.796 58.392,0.672 57.288,0.672 C55.672,0.672 54.308,0.912 53.196,1.392 C52.084,1.872 51.248,2.524 50.688,3.348 C50.128,4.172 49.848,5.096 49.848,6.12 C49.848,7.288 50.152,8.216 50.76,8.904 C51.368,9.592 52.096,10.092 52.944,10.404 C53.792,10.716 54.848,11.008 56.112,11.28 C57.264,11.536 58.1,11.78 58.62,12.012 C59.14,12.244 59.4,12.6 59.4,13.08 C59.4,13.992 58.488,14.448 56.664,14.448 C55.704,14.448 54.728,14.296 53.736,13.992 C52.744,13.688 51.872,13.288 51.12,12.792 L51.12,12.792 L49.56,16.296 C50.36,16.856 51.4,17.304 52.68,17.64 C53.96,17.976 55.28,18.144 56.64,18.144 Z M71.856,18.024 C72.48,18.024 73.068,17.96 73.62,17.832 C74.172,17.704 74.64,17.52 75.024,17.28 L75.024,17.28 L73.896,14.088 C73.496,14.36 73.032,14.496 72.504,14.496 C72.088,14.496 71.756,14.364 71.508,14.1 C71.26,13.836 71.136,13.472 71.136,13.008 L71.136,13.008 L71.136,8.688 L74.112,8.688 L74.112,5.28 L71.136,5.28 L71.136,1.896 L66.576,1.896 L66.576,5.28 L64.68,5.28 L64.68,8.688 L66.576,8.688 L66.576,13.056 C66.576,14.704 67.032,15.944 67.944,16.776 C68.856,17.608 70.16,18.024 71.856,18.024 Z M82.248,18.024 C83,18.024 83.712,17.888 84.384,17.616 C85.056,17.344 85.632,16.944 86.112,16.416 L86.112,16.416 L86.112,17.808 L90.456,17.808 L90.456,4.8 L85.896,4.8 L85.896,11.064 C85.896,12.104 85.668,12.876 85.212,13.38 C84.756,13.884 84.168,14.136 83.448,14.136 C82.744,14.136 82.208,13.912 81.84,13.464 C81.472,13.016 81.288,12.304 81.288,11.328 L81.288,11.328 L81.288,4.8 L76.728,4.8 L76.728,12.072 C76.728,14.056 77.228,15.544 78.228,16.536 C79.228,17.528 80.568,18.024 82.248,18.024 Z M99.048,18.024 C100.744,18.024 102.016,17.52 102.864,16.512 L102.864,16.512 L102.864,17.808 L107.208,17.808 L107.208,0 L102.648,0 L102.648,5.928 C101.8,5.032 100.6,4.584 99.048,4.584 C97.864,4.584 96.784,4.856 95.808,5.4 C94.832,5.944 94.06,6.724 93.492,7.74 C92.924,8.756 92.64,9.936 92.64,11.28 C92.64,12.624 92.924,13.808 93.492,14.832 C94.06,15.856 94.832,16.644 95.808,17.196 C96.784,17.748 97.864,18.024 99.048,18.024 Z M100.008,14.4 C99.208,14.4 98.552,14.124 98.04,13.572 C97.528,13.02 97.272,12.256 97.272,11.28 C97.272,10.32 97.528,9.568 98.04,9.024 C98.552,8.48 99.208,8.208 100.008,8.208 C100.808,8.208 101.46,8.48 101.964,9.024 C102.468,9.568 102.72,10.32 102.72,11.28 C102.72,12.256 102.464,13.02 101.952,13.572 C101.44,14.124 100.792,14.4 100.008,14.4 Z M112.368,22.68 C113.728,22.68 114.88,22.356 115.824,21.708 C116.768,21.06 117.568,19.936 118.224,18.336 L118.224,18.336 L123.84,4.8 L119.496,4.8 L116.28,12.744 L113.088,4.8 L108.408,4.8 L113.976,17.976 C113.784,18.36 113.548,18.64 113.268,18.816 C112.988,18.992 112.632,19.08 112.2,19.08 C111.832,19.08 111.468,19.012 111.108,18.876 C110.748,18.74 110.44,18.552 110.184,18.312 L110.184,18.312 L108.6,21.504 C109.032,21.856 109.596,22.14 110.292,22.356 C110.988,22.572 111.68,22.68 112.368,22.68 Z" id="Study" fill-opacity="0.85" fill="#000000"></path></g></g></g></svg><svg class="logo-dark hidden" width="125px" height="23px" viewBox="0 0 125 23" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>BTCStudy</title><g id="页面-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="首页-响应式" transform="translate(-249.000000, -23.000000)" fill-rule="nonzero"><g id="BTCStudy" transform="translate(249.680000, 23.192000)"><path d="M9.072,17.808 C11.312,17.808 13.024,17.408 14.208,16.608 C15.392,15.808 15.984,14.672 15.984,13.2 C15.984,12.192 15.712,11.332 15.168,10.62 C14.624,9.908 13.872,9.384 12.912,9.048 C13.632,8.68 14.188,8.18 14.58,7.548 C14.972,6.916 15.168,6.2 15.168,5.4 C15.168,4.056 14.608,2.988 13.488,2.196 C12.368,1.404 10.736,1.008 8.592,1.008 L8.592,1.008 L-5.68434189e-14,1.008 L-5.68434189e-14,17.808 L9.072,17.808 Z M7.968,7.68 L4.704,7.68 L4.704,4.44 L7.968,4.44 C9.568,4.44 10.368,4.976 10.368,6.048 C10.368,7.136 9.568,7.68 7.968,7.68 L7.968,7.68 Z M8.688,14.376 L4.704,14.376 L4.704,10.968 L8.688,10.968 C10.352,10.968 11.184,11.536 11.184,12.672 C11.184,13.808 10.352,14.376 8.688,14.376 L8.688,14.376 Z M26.544,17.808 L26.544,4.776 L31.68,4.776 L31.68,1.008 L16.632,1.008 L16.632,4.776 L21.792,4.776 L21.792,17.808 L26.544,17.808 Z M41.592,18.144 C43.128,18.144 44.512,17.872 45.744,17.328 C46.976,16.784 48,16 48.816,14.976 L48.816,14.976 L45.792,12.24 C44.704,13.552 43.384,14.208 41.832,14.208 C40.92,14.208 40.108,14.008 39.396,13.608 C38.684,13.208 38.132,12.644 37.74,11.916 C37.348,11.188 37.152,10.352 37.152,9.408 C37.152,8.464 37.348,7.628 37.74,6.9 C38.132,6.172 38.684,5.608 39.396,5.208 C40.108,4.808 40.92,4.608 41.832,4.608 C43.384,4.608 44.704,5.264 45.792,6.576 L45.792,6.576 L48.816,3.84 C48,2.816 46.976,2.032 45.744,1.488 C44.512,0.944 43.128,0.672 41.592,0.672 C39.832,0.672 38.252,1.044 36.852,1.788 C35.452,2.532 34.352,3.568 33.552,4.896 C32.752,6.224 32.352,7.728 32.352,9.408 C32.352,11.088 32.752,12.592 33.552,13.92 C34.352,15.248 35.452,16.284 36.852,17.028 C38.252,17.772 39.832,18.144 41.592,18.144 Z" id="BTC" fill="#F2A900"></path><path d="M56.64,18.144 C58.24,18.144 59.6,17.9 60.72,17.412 C61.84,16.924 62.68,16.272 63.24,15.456 C63.8,14.64 64.08,13.728 64.08,12.72 C64.08,11.552 63.772,10.628 63.156,9.948 C62.54,9.268 61.812,8.772 60.972,8.46 C60.132,8.148 59.072,7.856 57.792,7.584 C56.656,7.344 55.832,7.112 55.32,6.888 C54.808,6.664 54.552,6.328 54.552,5.88 C54.552,5.432 54.768,5.068 55.2,4.788 C55.632,4.508 56.32,4.368 57.264,4.368 C58.768,4.368 60.32,4.8 61.92,5.664 L61.92,5.664 L63.384,2.136 C62.568,1.656 61.624,1.292 60.552,1.044 C59.48,0.796 58.392,0.672 57.288,0.672 C55.672,0.672 54.308,0.912 53.196,1.392 C52.084,1.872 51.248,2.524 50.688,3.348 C50.128,4.172 49.848,5.096 49.848,6.12 C49.848,7.288 50.152,8.216 50.76,8.904 C51.368,9.592 52.096,10.092 52.944,10.404 C53.792,10.716 54.848,11.008 56.112,11.28 C57.264,11.536 58.1,11.78 58.62,12.012 C59.14,12.244 59.4,12.6 59.4,13.08 C59.4,13.992 58.488,14.448 56.664,14.448 C55.704,14.448 54.728,14.296 53.736,13.992 C52.744,13.688 51.872,13.288 51.12,12.792 L51.12,12.792 L49.56,16.296 C50.36,16.856 51.4,17.304 52.68,17.64 C53.96,17.976 55.28,18.144 56.64,18.144 Z M71.856,18.024 C72.48,18.024 73.068,17.96 73.62,17.832 C74.172,17.704 74.64,17.52 75.024,17.28 L75.024,17.28 L73.896,14.088 C73.496,14.36 73.032,14.496 72.504,14.496 C72.088,14.496 71.756,14.364 71.508,14.1 C71.26,13.836 71.136,13.472 71.136,13.008 L71.136,13.008 L71.136,8.688 L74.112,8.688 L74.112,5.28 L71.136,5.28 L71.136,1.896 L66.576,1.896 L66.576,5.28 L64.68,5.28 L64.68,8.688 L66.576,8.688 L66.576,13.056 C66.576,14.704 67.032,15.944 67.944,16.776 C68.856,17.608 70.16,18.024 71.856,18.024 Z M82.248,18.024 C83,18.024 83.712,17.888 84.384,17.616 C85.056,17.344 85.632,16.944 86.112,16.416 L86.112,16.416 L86.112,17.808 L90.456,17.808 L90.456,4.8 L85.896,4.8 L85.896,11.064 C85.896,12.104 85.668,12.876 85.212,13.38 C84.756,13.884 84.168,14.136 83.448,14.136 C82.744,14.136 82.208,13.912 81.84,13.464 C81.472,13.016 81.288,12.304 81.288,11.328 L81.288,11.328 L81.288,4.8 L76.728,4.8 L76.728,12.072 C76.728,14.056 77.228,15.544 78.228,16.536 C79.228,17.528 80.568,18.024 82.248,18.024 Z M99.048,18.024 C100.744,18.024 102.016,17.52 102.864,16.512 L102.864,16.512 L102.864,17.808 L107.208,17.808 L107.208,0 L102.648,0 L102.648,5.928 C101.8,5.032 100.6,4.584 99.048,4.584 C97.864,4.584 96.784,4.856 95.808,5.4 C94.832,5.944 94.06,6.724 93.492,7.74 C92.924,8.756 92.64,9.936 92.64,11.28 C92.64,12.624 92.924,13.808 93.492,14.832 C94.06,15.856 94.832,16.644 95.808,17.196 C96.784,17.748 97.864,18.024 99.048,18.024 Z M100.008,14.4 C99.208,14.4 98.552,14.124 98.04,13.572 C97.528,13.02 97.272,12.256 97.272,11.28 C97.272,10.32 97.528,9.568 98.04,9.024 C98.552,8.48 99.208,8.208 100.008,8.208 C100.808,8.208 101.46,8.48 101.964,9.024 C102.468,9.568 102.72,10.32 102.72,11.28 C102.72,12.256 102.464,13.02 101.952,13.572 C101.44,14.124 100.792,14.4 100.008,14.4 Z M112.368,22.68 C113.728,22.68 114.88,22.356 115.824,21.708 C116.768,21.06 117.568,19.936 118.224,18.336 L118.224,18.336 L123.84,4.8 L119.496,4.8 L116.28,12.744 L113.088,4.8 L108.408,4.8 L113.976,17.976 C113.784,18.36 113.548,18.64 113.268,18.816 C112.988,18.992 112.632,19.08 112.2,19.08 C111.832,19.08 111.468,19.012 111.108,18.876 C110.748,18.74 110.44,18.552 110.184,18.312 L110.184,18.312 L108.6,21.504 C109.032,21.856 109.596,22.14 110.292,22.356 C110.988,22.572 111.68,22.68 112.368,22.68 Z" id="Study" fill-opacity="0.85" fill="#FFFFFF"></path></g></g></g></svg></div><div class="mobile-header-title is-full-height is-flex is-align-items-center is-flex-shrink-0"><div class="is-full-height hidden" id="postTopicMobile"><p class="is-full-height">比特币所用的时间锁</p></div></div></div><i class="iconfont icon-icon_search mobile-header-searchIcon"></i><div class="mobile-search-wrap"><div class="search-input"><input class="pl-3" id="mobile-search-input" placeholder="请输入搜索关键词"><i class="iconfont icon-icon_search mobile-search-input-btn"></i><button class="mobile-search-input-btn">搜 索</button></div></div></header><div class="mobile-slide-menu"><a class="header-activity" href="/">首页</a><a href="/archives">全站目录</a><a href="/tags">标签</a><a href="/maps">地图</a><a href="/mempool">mempool</a><a target="_blank" rel="noopener" href="https://123btc.org/">123btc</a><div><p class="slide-menu-theme is-flex is-flex-direction-row is-justify-content-space-between is-align-items-center"><span>主题设置</span><span><i class="iconfont icon-icon_light slide-theme-light hidden"></i><i class="iconfont icon-icon_dark slide-theme-dark hidden"></i></span></p><p class="slide-menu-fontsize"><span>字体设置</span><span><i class="iconfont icon-bianzubeifen"></i><i class="iconfont icon-bianzu"></i></span></p></div></div><div class="search-mask hidden"><script src="/js/header.js?v=1673690025615"> </script></div><main><main class="container is-max-widescreen content section post-page pt-4"><div class="columns is-flex-desktop is-justify-content-center"><div class="column is-3 silde-bar is-hidden-mobile"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%99%E6%97%B6%E9%97%B4%E9%94%81%E5%88%86%E7%B1%BB"><span class="toc-text">给时间锁分类</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%8D%E7%BD%AE%EF%BC%9A%E4%BA%A4%E6%98%93%E5%B1%82-vs-%E8%84%9A%E6%9C%AC%E5%B1%82"><span class="toc-text">位置：交易层 vs. 脚本层</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9B%AE%E6%A0%87%EF%BC%9A%E7%BB%9D%E5%AF%B9-vs-%E7%9B%B8%E5%AF%B9"><span class="toc-text">目标：绝对 vs. 相对</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BA%A6%E9%87%8F%EF%BC%9A%E5%8C%BA%E5%9D%97-vs-%E7%A7%92"><span class="toc-text">度量：区块 vs. 秒</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%8D%E5%90%8C%E7%9A%84%E9%94%81"><span class="toc-text">不同的锁</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#nLocktime"><span class="toc-text">nLocktime</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#nSequence"><span class="toc-text">nSequence</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CLTV"><span class="toc-text">CLTV</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#OP-CHECKSIGOP-CSV"><span class="toc-text">OP_CHECKSIGOP_CSV</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BB%B6%E4%BC%B8%E9%98%85%E8%AF%BB"><span class="toc-text">延伸阅读</span></a></li></ol></div><div class="column is-9 post-container"><h1 class="mt-0 mb-2" id="postTitle">比特币所用的时间锁</h1><div class="page-author"><div class="is-flex is-flex-direction-row page-data mr-6"><img class="mr-1" src="//res.btcstudy.org/btcstudy/images/default_avatar.png" alt="James Prestwich"><div class="page-author-info"><strong>James Prestwich</strong><time class="has-text-grey" datetime="2021-10-31T08:30:54.000Z">2021-10-31</time></div></div><div class="is-flex"><a href="/tags/%E6%AF%94%E7%89%B9%E5%B8%81"><i class="page-tag mr-1 px-1">比特币<!-- 订正图片路径--></i></a></div></div><article class="mt-4 post-content"><blockquote>
<p><em>作者：James Prestwich</em></p>
<p><em>来源：<a target="_blank" rel="noopener" href="https://medium.com/summa-technology/bitcoins-time-locks-27e0c362d7a1">https://medium.com/summa-technology/bitcoins-time-locks-27e0c362d7a1</a></em></p>
</blockquote>
<p>比特币没有明显的缺陷，它配置了多种时间锁。这些工具让用户可以用基于时间的条件来指定交易（transaction）的有效性。使用时间锁，你可以延期到下周支付、增设资金转移的强制等待期、设置用多笔交易组成的复杂智能合约，当然也有可能一不小心把你的币锁住几个世纪。</p>
<p>大部分时间锁功能都是很晚近才加到比特币里面的。它们内置在交易的结构中，还从我们最喜爱的匿名密码朋克，中本聪先生，所编写的漏洞百出的代码中继承了许多奇怪的特点。时间锁功能相应的比特币升级提议（BIP）都写得很好、很详尽，但需要你有大量背景知识才能读得懂。我在这里尝试汇集我能找到的所有关于时间锁的信息，并深入解释它们。</p>
<p><img src="//res.btcstudy.org/btcstudy/images/bitcoins-time-locks/-tcpGlF.jpg" alt="img"></p>
<h2 id="给时间锁分类"><a href="#给时间锁分类" class="headerlink" title="给时间锁分类"></a>给时间锁分类</h2><p>在深入了解这些工具之前，我们先分辨一下如何描述它们的操作。时间锁有三种重要属性：位置、目标和度量。</p>
<h3 id="位置：交易层-vs-脚本层"><a href="#位置：交易层-vs-脚本层" class="headerlink" title="位置：交易层 vs. 脚本层"></a><strong>位置：交易层 vs. 脚本层</strong></h3><blockquote>
<p>时间是两地间最远的距离。</p>
<p>—— Tennessee Williams</p>
</blockquote>
<p>时间锁可以放置在交易本身中 以及&#x2F;或者 放置在其 P2SH 输入的相关脚本中。每笔交易都有多个时间锁字段（即使不使用，它们也存在）。脚本则不然，可以不使用，也可以使用很多个。从功能上来看，交易层面的时间锁和脚本层面的时间锁，是极为相似的，但扮演的角色差别很大。<strong>交易层面的时间锁</strong>使得这笔交易在特定时间以前是无效的，无论是否提供了有效的签名和脚本。而<strong>脚本层面的时间锁</strong>会导致脚本的计算失败（除非交易本身也在锁定阶段，进不到脚本的处理）。脚本计算失败也会导致交易无效。总而言之，交易层面的锁决定了什么时候开始这笔交易能打包上链，而脚本层面的时间锁决定了给定的一个 scriptsig（“解锁脚本”）是否有效。</p>
<p>两者之间最主要的区别是它们锁定的东西。交易层的锁，锁住的是具体的一笔交易；可以把交易时间锁看成是一张日后生效的支票：我可以给你写一张未来会生效的支票，但是这个生效日期的限制仅适用于这张支票，我还是可以用你不知道的方式花掉这笔钱。脚本锁则为所有试图花费这个输出的交易都设置了条件。换句话来说，交易层面的锁只能在一笔交易构造好之后影响这笔交易的处理方式；但脚本层面的锁在一开始就决定了什么交易能够构造、什么不能。</p>
<p>交易时间锁不像你想的那么有用。它并不控制资金本身，只能控制这一次的花费。这就是为什么所有新颖的技术都需要 OP_CLTV 和 OP_CSV（脚本层面的时间锁）。使用脚本层面的锁和条件式逻辑（OP_IF），我们可以做出复杂的脚本，比如：允许多签名在任意时间花费这笔资金，或者，在一段时间过后，某一个签名可以花费这笔资金。这为 P2SH 交易提供了丰富的通用性。</p>
<h3 id="目标：绝对-vs-相对"><a href="#目标：绝对-vs-相对" class="headerlink" title="目标：绝对 vs. 相对"></a><strong>目标：绝对 vs. 相对</strong></h3><blockquote>
<p>时间是一种幻觉，午餐时间尤甚。</p>
<p>—— Douglas Adams</p>
</blockquote>
<p>好吧，其实，它们都是相对的。你其实是在 “相对于时间原点” 和 “相对于上一个输出的产生时间点” 之间选一个。我就是喜欢搞这种没有用的吹毛求疵 : )</p>
<p>当你对一些币施加了时间锁时，你同时也设置了其释放的时间目标。<strong>绝对时间锁</strong>使用一个设定的时间来定义这个目标，也就是到了具体的某个时间点，这个锁会过期。<strong>相对时间锁</strong>则用前序输出生成以来经过的时间来定义（过期时间）。两者的区别相当于 “下午三点约定你” 和 “四个钟头后我们见面”。</p>
<p>用绝对时间锁锁定的交易，在到达那个时间点之前，都是无效的交易。这就意味着我可以提前一年构造一笔交易，可以签名、可以分享出去，甚至广播出去，而不用担心这笔交易会在一年内打包上链。我可以用绝对时间锁给我的孩子安排资金，还可以设立一个你可以存钱进去、但得等到明年才可以取出的储蓄账户。</p>
<p>相对时间锁则相反，它使得一笔交易在该交易的前序输出生成后的一段时间内，该交易是无效的。这是一个微妙又强大的特性。相对时间锁真正巧妙的用法在于，可以拿 <em>未广播</em>、<em>未确认</em> 的交易，作为锁的条件。一笔交易上链确认之后，你当然总是可以（为后序交易）设定一个绝对时间锁。但想要这么做，你得先等待前一笔交易上链，而且要知道其上链的时间；或者你要提前设置一个很长的锁，这个时间也就变成了你整套智能合约的解锁时间。但相对时间锁可以根据未确认的交易来设定，也就是说，你可以提前创建和签名一整套多步骤的智能合约，并且确信这些交易会按照你安排的顺序上链，<em>不论这些交易具体在什么时候执行</em>。</p>
<h3 id="度量：区块-vs-秒"><a href="#度量：区块-vs-秒" class="headerlink" title="度量：区块 vs. 秒"></a><strong>度量：区块 vs. 秒</strong></h3><blockquote>
<p>Then’s the time to time the time flies –</p>
<p>Like time flies like an arrow.</p>
<p>— Edison B. Schroeder</p>
</blockquote>
<p>在比特币中，时间是一个共识出来的幻觉，所以永远没有午餐时间。交易不可能看着墙上的钟来决定自己什么时候上链，所以我们需要定义 “时间”。比特币用两种办法来度量 “时间”：区块号，区块时间戳。每一种时间锁都以这两个度量为操作模式，没有专门、独立的锁机制。你可以为锁设定一个<strong>区块数量</strong>（区块号），也可以设置<strong>秒数</strong>（时间）。两种方式都有各自的复杂性。在实践中，这两种度量对现实世界的应用来说都是足够准确的。但了解它们的特点很重要。</p>
<p>我们常常说，区块挖出符合泊松分布：一般来说每 10 分钟出现一次。但并不绝对数次。当挖矿的算力在增加的时候，区块挖出的速度会比预期要快。当算力离线或者转向别的链时，网络的出块速度会变慢。挖矿难度每 2016 个区块（大约 2 周）调整一次，目标是让出块速度回到 10 分钟，但区块出现的速度可能单纯因为网络阻塞或随机因素而大幅偏离。</p>
<p>时间戳也同样耐人寻味。你可以再到，在比特币里面，区块的时间戳不是单向递增的。因为区块时间戳的共识规则，时间戳在一两个区块内可能向后滚动，或停滞一分钟。我可以跟你保证，共识规则这样设计不是胡闹。它可以保证时间戳总是在整个网络的 “真实时间” 的前后几小时范围内（译者注：在比特币网络中，节点收到区块时会查看时间戳，只要时间戳与本地时间相差在一定范围内，都能接受；但相差范围过大，区块会被拒绝；前后区块的时间戳并没有只能增不能减的要求）。尽管如此，为了让基于时间戳的锁变得可靠，开发者们使用了 <a target="_blank" rel="noopener" href="https://github.com/bitcoin/bips/blob/master/bip-0113.mediawiki">BIP 113</a> 中描述的 “过往中值时间（median time past，MTP）” 方法来度量时间。时间锁不会使用当下区块的时间戳来度量时间，而是使用过去 11 个区块的时间戳中值。这样既能平滑化时间的推进，也能保证时间不会 “倒流”。</p>
<p><img src="//res.btcstudy.org/btcstudy/images/bitcoins-time-locks/qrLicCV.jpg" alt="img"></p>
<h2 id="不同的锁"><a href="#不同的锁" class="headerlink" title="不同的锁"></a>不同的锁</h2><p>现在你们应该有点概念了，所以我么可以具体讲讲这些时间锁工具了。现在比特币有四种时间锁：nLocktime、nSequence、OP_CHECKLOCKTIMEVERIFY（OP_CLTV）和 OP_CHECKSEQUENCEVERIFY（OP_CSV）。两个是脚本层面的，两个是交易层面的。</p>
<h3 id="nLocktime"><a href="#nLocktime" class="headerlink" title="nLocktime"></a><strong>nLocktime</strong></h3><p><strong>nLocktime 是交易层面的绝对时间锁</strong>。它也是中本聪初版软件（Satoshi’s Original Vision）所用的唯一一种时间锁。</p>
<p>交易的数据结构很简单，包含了版本、输入、输出和其它的一些字段。nLocktime 有自己的专属字段 <code>lock_time</code>。它指定了一个区块号或者时间戳。在到达这个指定时间之前，这笔交易都是无效的。Bitcoin Core 软件构造的交易默认将 <code>lock_time</code> 字段设为当前的区块号，<a target="_blank" rel="noopener" href="https://www.reddit.com/r/Bitcoin/comments/47upgx/nsequence_and_optin_replacebyfee_difference/d0g612x/?context=5">以避免有人靠重组区块来获得更多手续费</a>。时间被表示为一个 32 位的非负整数（32 bit integer）。如果 <code>lock_time</code> 的值是 0，则这个字段会被忽略掉；如果它的值大于等于 5 0000 0000（5 亿），则会被当成一个 unix 时间戳。所以 nLocktime 可以使用区块号把一笔交易锁定 9500 年之久；用时间戳，也可以锁定到 <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Time_formatting_and_storage_bugs#Year_2106">2106 年</a>。</p>
<p>奇异的是，如果所有的输入的序列号都是 <code>0xFFFFFFFF</code>（32 位整数的最大值），<code>lock_time</code> 字段会被完全忽略掉。<a target="_blank" rel="noopener" href="https://github.com/bitcoin/bips/blob/master/bip-0125.mediawiki">BIP 125</a> 所描述的可选的 replace-By-Fee（RBF，用增加手续费来 替换&#x2F;加速 未上链交易的办法）也类似。使用 <code>sequence_no</code> 来发送信号是中本聪不成熟时代的时间锁实现的产物。要想改变，只能动用硬分叉。nLocktime 和交易输入的序列号一开始提出是为了构建一个简单的交易更新机制：你可以构建一个带有时间锁的交易，然后通过发送带有至少一个更高序列号的版本来替换原交易。</p>
<p>按照假设，矿工会抛弃掉带有更低序列号的交易。那么，如果所有的输入都具有最大的序列号，这就成了一笔没法更新的交易，它当然可以无视掉时间锁。这个更新机制没有完全实现过，后来就被抛弃了。阴沟里翻船，中本聪似乎假设了一种良好的实践，但这个假设在比特币中是不合理的。没法保证矿工总能看到更新后的交易，也没法保证他们看到了就会丢弃掉旧的版本。矿工只会打包最有利可图的版本，而不是最新的版本。</p>
<p><strong>nLocktime 案例</strong></p>
<pre><code class="java"># 交易的大部分结构都已省去，为便于阅读，使用十进制。
# 因为标签的存在，在序列号中使用十六进制。

# 这笔交易在区块高度 499999999 之前都是无效的（不要学，反面教材）
tx_1:
  lock_time: 49999999
  
# 这笔交易在区块时间戳中值到达 1514764800 (1/1/2018 0:00:00 GMT) 之前都是无效的。
tx_2:
  lock_time: 1514764800
  
# 没有时间锁，所以这笔交易即时可上链。
tx_3:
  lock_time: 0

# 这个时间锁无效，因为所有输入的序列号都已经是最大值 0xFFFFFFFF。
tx_4:
  lock_time: 3928420
  input_1:
    sequence_no: 0xFFFFFFFF
</code></pre>
<h3 id="nSequence"><a href="#nSequence" class="headerlink" title="nSequence"></a><strong>nSequence</strong></h3><p><strong>nSequence 是交易层面的相对时间锁</strong>（从技术上来说，nSequence 实际上是输入层面的，容后详述）。它提议重新使用每个输入的 <code>sequence_no</code> 字段，基于前一个输出确认后经过的时间来开启交易的有效性。nSequence 时间锁是在 <a target="_blank" rel="noopener" href="https://github.com/bitcoin/bips/blob/master/bip-0068.mediawiki">BIP 68</a> 引入的，后来在 2016 年中段的软分叉中激活。Satoshi 给了我们柠檬，我们做出了 nSequence 时间锁。</p>
<p>Sequence  字段从一开始就存在。但因为中本聪的交易替换机制从未被实现（而且长期来看也不可能奏效），这个字段就变得繁琐无用。多年以来，这个字段唯一的用途就是禁用时间锁。现在，序列号可用于实施交易层面的相对时间锁，就像 BIP 68 提议的那样。nSequence 锁是在每个输入中设置的，是根据每个输入所消耗的输出的上链确认时间来度量的。这也意味着，同一条交易可以指定多个不同的时间锁条件，所有条件都必须满足，这笔交易才是有效的。即使只有一个时间锁未解锁，整笔交易也无法上链。</p>
<p>比特币开发者精通升级改造（upcycling），但有时仍不免留下蛛丝马迹。因为 nSequence 时间锁是重用了已有的 <code>sequence_no</code> 字段，它会有一些奇怪的行为。序列号字段是 32 位的，但我们没法全部使用，因为它还是会跟 nLoncktime 和 RBF 信号交互。此外，<code>sequence_no</code> 也是我们仍有余力在未来作出变更的地方之一。为了平衡这些需求，nSequence 时间锁只使用这个字段的 18 个位。其余 14 个位留给未来可能派上用场的地方。</p>
<p>有两个位充当告诉节点如何处理 <code>sequence_no</code> 字段的标签。最高有效位（most significant bit）就是 “禁用” 标签。如果设置了这个标签，nSequence 时间锁就被禁用了。如果没有设置这个标签，其余的 <code>sequence_no</code> 就会被作为相对时间锁。Bit 22（第 23 个最低有效位，least significant bit）是类型标签，如果设置了这个标签，时间锁会以秒来计量；如果未设置，则表示以区块数量来指定。</p>
<p><code>sequence_no</code> 字段最低的 16 个有效位用来编码目标时间。不像 nLocktime，nSequence 只使用 16 位来编码锁定时间。也就意味着，nSequence 时间锁最长只能达到 65535 个单位。如果以区块为单位，在最长可以锁定 455 天；但如果使用一秒为单位，则最长只有 18 个小时。为了缓解这个问题，nSequence 不使用一秒为单位，而是以 512 秒为单位。如果设置了类型标签，则锁定时间会被设置为 16 单位，也即该输入会被相对锁定 16 × 512 秒。</p>
<p>Bitcoin core 软件构造的交易会默认把每个输入的 <code>sequence_no</code> 都设为 <code>0xFFFFFFFE</code>。这样做会启用 nLocktime 来防止有人专门挑选高手续费的交易来重组区块；同时会禁用 Replace-By-Fee。Replac-By-Fee 交易一般会把每个输入的 <code>sequence_no</code> 设为 <code>0xFFFFFFFD</code>。值得点出的是，RBF <em>不是</em> 协议层的变更，只是默认挖矿策略的变更。但是，因为 nSequence 锁需要把 <code>sequence_no</code> 字段设置得小于 <code>0xFFFFFFFD</code>，所有的 nSequence 锁定交易都支持 RBF。</p>
<p><strong>nSequence 示例</strong></p>
<pre><code># 交易的大部分结构都已省去，为便于阅读，使用十进制。
# 因为标签的存在，在序列号中使用十六进制。

# 这笔交易相对锁定了 4096 秒，也就差不多一个小时。
tx_1:
  input_1:
    sequence_no: 0x00400008
    # 未设置禁用标签，设置了类型标签。所以该输入会被锁定 8 * 512 秒。
    
# 这笔交易没有使用 nSequence 锁，但可能使用了 nLocktime 锁，并且允许 RBF。
tx_2:
  input_1:
    sequence_no: 0xFEDC3210
    # 设置了禁用标签，所以 nSequence 锁定禁用了。
    
# 这笔交易在 input 1 所使用的输出首次确认（上链）后的 16 个区块内，都是无效的。
tx_3:
  input_1:
    sequence_no: 0x00000010  
    # 未设置禁用标签，未设置类型标签。所以该输入会被锁定 16 个区块。
  input_2:
    sequence_no: 0xFFFFFFFF  
    # 设置了禁用标签。

# 这个交易没有设时间锁，但可以选择 RBF 替换机制。
tx_4:
  lock_time: 0
  input_1:
    sequence_no: 0xFFFFFFFE  
    # nSequence 已禁用，nLocktime 启用了，未表示使用 RBF。
  input_2:
    sequence_no: 0xFFFFFFFD  
    # nSequence 已禁用，nLocktime 启用了，表示使用 RBF。
    
# 这笔交易在区块高度 506221 前都是无效的。
# 在 input_1 所用的输出首次确认后的 87040 秒内，这笔交易也同样是无效的。
tx_5:
  lock_time: 506221
  input_1:
    sequence_no: 0x004000AA
</code></pre>
<p><img src="//res.btcstudy.org/btcstudy/images/bitcoins-time-locks/vzSG6Ro.jpg" alt="img"></p>
<h3 id="CLTV"><a href="#CLTV" class="headerlink" title="CLTV"></a><strong>CLTV</strong></h3><p><strong>OP_CHECKLOCKTIMEVERIFY（OP_CLTV）是脚本级的绝对时间锁</strong>。它是在 <a target="_blank" rel="noopener" href="https://github.com/bitcoin/bips/blob/master/bip-0065.mediawiki">BIP 65</a> 中提出，并在 2015 年底的软分叉中激活的。OP_CLTV 使得<a target="_blank" rel="noopener" href="https://z.cash/blog/htlc-bip.html">哈希时间锁合约</a>得以出现，这对闪电网络通道的第一个版本来说是硬性要求。</p>
<p>CLTV 的软代码简单而优雅，只有不到 20 行的简洁、注释详尽的代码。简而言之：OP_CLTV 会比较栈顶的元素与交易的 nLocktime。它会检查栈顶的元素是不是一个有效的时间（以秒为单位或者以区块为单位），并且交易自身也通过合适的 <code>lock_time</code> 锁定了至少那么长时间。如此一来，OP_CLTV 就相当于保证了交易不会在某个特定的时间点之前上链。</p>
<p>在下列情况中，OP_CHECKLOCKTIMEVERIFY 会立即导致脚本计算失败：</p>
<ol>
<li>栈是空的（即没有为 OP_CLTV 指定目标时间）。</li>
<li>栈顶的元素小于 0（负数的时间锁是没有意义的）。</li>
<li>nLocktime 以区块为单位，栈顶的元素却以秒为单位，反之亦然（苹果与梨不可比较）。</li>
<li>栈顶的元素大于交易的 <code>lock_time</code>（也即还没到解锁时间）。</li>
<li>这个输入的 nSequence 字段设为 <code>0xFFFFFFFF</code>（时间锁可能被禁用）。</li>
</ol>
<p>OP_CLTV 取代了 OP_NOP2，那是一个（你可能也猜到了）没有任何作用的操作码。设计 OP_CLTV 来取代 OP_NOP2 产生了一个有趣的约束：OP_CLTV 只能让堆栈保持原样。因为 OP_CLTV 只能读取栈元素，但不能 <em>消耗</em> 栈元素。它只是检查时间锁，然后就会把目标时间留在栈中。因此，它后面总是必须接一个 OP_DROP，用来丢掉栈顶元素（然后继续）。</p>
<p>将脚本中的锁定时间与交易的锁定时间相比较是一种非常聪明的实现，因为它是间接检查时间的。它将执行要求传递给 nlocktime 共识规则，同时仍然允许脚本指定多个不同的时间锁条件。它允许在任何适合检查解锁脚本的有效性并<a target="_blank" rel="noopener" href="https://bitcointechtalk.com/whats-new-in-bitcoin-core-v0-15-part-5-6a9cfa85821f">存入缓存</a>。缺点在于，一旦 OP_CLTV 又在了脚本中，<code>lock_time</code> 就必须在交易中指定，而输入中就必须存在 <code>sequence_no</code> 小于 <code>0xFFFFFFFF</code> 的输入。对于刚上手的开发者来说，这一点可能有点反直觉，所以要记在心上。</p>
<p><strong>OP_CLTV 案例</strong></p>
<pre><code class="java"># 交易的大部分结构都已省去，为便于阅读，使用十进制。
# 因为标签的存在，在序列号中使用十六进制。
    
# 只要区块高度达到 506391，任何人都能花费
tx_1:
  lock_time: 506391
  input_1:
    sequence_no: 0xFFFFFFFE
    script:
      506391 OP_CHECKLOCKTIMEVERIFY OP_DROP

# 这笔交易是无效的
# lock_time 以区块为单位，CLTV 却以秒为单位
# sequence_no 是 0xFFFFFFFF
tx_2:
  lock_time: 506391
  input_1:
    sequence_no: 0xFFFFFFFF
    script:
      1514764800 OP_CHECKLOCKTIMEVERIFY OP_DROP

# 这笔交易是无效的
# 栈顶元素的值大于 lock_time
tx_3:
  lock_time: 506391
  input_1:
    sequence_no: 0xFFFFFFFE
    script:
      600000 OP_CHECKLOCKTIMEVERIFY OP_DROP

# 这笔交易在区块高度达到 512462、且其输入所消耗的输出初次确认的 32 * 512 秒后才是有效的
# 可以构造另外的一笔交易，在区块高度 506391 和 512462 时间花掉这笔资金
tx_4:
  lock_time: 512462
  input_1:
    sequence_no: 0x00400020
    script:
      506391 OP_CHECKLOCKTIMEVERIFY OP_DROP

# 这笔交易从区块高度 506321 开始变成有效的
# 这个脚本允许一种使用 2-of-2 多签名的执行路径
# 可以用一个没有时间锁的交易来花费这笔资金
tx_5:
  lock_time: 506321
  input_1:
    sequence_no: 0xFFFFFFFE
    scriptsig:
      OP_TRUE
    script:
      OP_IF
        506321 OP_CHECKLOCKTIMEVERIFY OP_DROP
      OP_ELSE
        OP_2 &lt;pubkey_1&gt; &lt;pubkey_2&gt; OP_2 OP_CHECKMULTISIG
      OP_ENDIF

# 这是哈希时间锁合约的一个变种
# 给定下列条件，这笔交易在区块高度 507381 开始变成有效的：
# 1. 解锁脚本中的 secret 的哈希值与 input_2 脚本中的 hash 相同
# 2. 为 input_2 提供了有效的签名和公钥
# 3. input_2 的 nSequence 时间锁已解锁
tx_6:
  lock_time: 507381
  input_1:
    sequence_no: 0xFFFFFFFE
    script:
      507381 OP_CHECKLOCKTIMEVERIFY OP_DROP
  input_2:
    sequence_no: 0x000000A0
    scriptsig:
      &lt;signature&gt; &lt;pubkey&gt; &lt;secret&gt;
    script
      OP_HASH160 &lt;secret hash&gt; OP_EQUALVERIFY
      OP_DUP OP_HASH160 &lt;pub keyhash&gt; OP_EQUALVERIFY OP_CHECKSIGOP_CSV
</code></pre>
<h3 id="OP-CHECKSIGOP-CSV"><a href="#OP-CHECKSIGOP-CSV" class="headerlink" title="OP_CHECKSIGOP_CSV"></a><strong>OP_CHECKSIGOP_CSV</strong></h3><p>OP_CHECKSEQUENCEVERIFY（OP_CSV）是脚本层面的相对时间锁。它是在 <a target="_blank" rel="noopener" href="https://github.com/bitcoin/bips/blob/master/bip-0112.mediawiki">BIP 112</a> 中提出的，并与 nSequence 和 MTP 测量方法一同在 2016 年中段的软分叉中激活。</p>
<p>从功能上来说，OP_CSV 与 OP_CLTV 非常相似。它不是检查时间，是比较栈顶元素与输入的 <code>sequence_no</code> 字段。OP_CSV 解析栈顶元素的方法也与 nSequence 解析锁定时间的方法相同。它也会解析 nSequence 的禁用标签和类型标签，并从栈顶元素的后 16 位中读取 16 位的锁定时间描述。OP_CSV 会在下列情况下报错：</p>
<ol>
<li>栈是空的（没有指定目标时间）。</li>
<li>栈顶的元素小于 0（负数的时间锁是没有意义的）。</li>
<li>栈顶元素的禁用标签未设置且是下列情形的至少一种：<ul>
<li>交易的版本号小于 2（交易并未表示兼容 OP_CSV）</li>
<li>输入的 <code>sequence_no</code> 设置了禁用标签（禁用了相对时间锁）</li>
<li>输入的类型标签与栈顶元素的类型标签不同（使用了不同的度量）</li>
</ul>
</li>
</ol>
<p>OP_CSV 取代了 OP_NOP3；为了跟旧的客户端保持兼容，（跟 OP_CLTV）一样会留下未修改的栈顶元素。它可以读取栈顶元素，但并不能消耗它。所以它也一般要搭配 OP_DROP 使用。如果栈顶的元素设置了禁用标签，那 OP_CSV 的行动就跟 OP_NOP3 没有区别了。</p>
<p>就像我们前面讨论相对时间锁的时候说得，OP_CSV 是一个非常强大的工具，可以将多笔交易串联在一起。如果我们使用 OP_CLTV，整个交易链条将有一个绝对的解锁日期。OP_CSV 让你可以设置相对于第一笔广播交易的解锁时间。所以可以制作一个交易链条、存储无限笔交易，同时获得时间锁的保证。</p>
<p>交易，一旦确认，就无法被逆转，除非链重组。但通过 OP_CSV 相对时间锁实现的连锁交易，让我们可以通过创建脚本计算路径来提供相近的（撤销交易）功能，办法是创建相斥的路径。使用 OP_IF，我们可以创建多个使用同一个输出的交易（这个输出自身也可以来自一笔尚未确认的交易），并保证某些交易使用相对时间锁。这样一来，如果带锁的交易在锁定期内传播到了网络中，未锁定的版本就可以先上链并拿走这些钱。这就意味着我们可以给特定的交易设置优先级，并控制复杂智能合约的执行。闪电网络就利用了这个特性。</p>
<p><strong>OP_CSV 案例</strong></p>
<pre><code class="java"># 交易的大部分结构都已省去，为便于阅读，使用十进制。
# 因为标签的存在，在序列号中使用十六进制。
    
# 在 input_1 的前序交易上链的 255 个区块后，任何人都可以花费这笔资金。
tx_1:
  lock_time: 0
  input_1:
    sequence_no: 0x000000FF
    script:
      0x000000FF OP_CHECKSEQUENCEVERIFY OP_DROP

# 只要下面两个条件都满足，这笔钱的任何人都可以花：
# a) input_1 所用的输出确认的 16,384 秒后
# b) input_2 所用的输出确认的 255 个区块后
tx_2:
  lock_time: 0
  input_1:
    sequence_no: 0x00400020
    script:
      0x00400020 OP_CHECKSEQUENCEVERIFY OP_DROP
  input_2:
    sequence_no: 0x000000FF
    script:
      0x000000FF OP_CHECKSEQUENCEVERIFY OP_DROP

# input_1 所用输出确认的 256 个区块后
# 注意，可以创建另外一笔交易来花费这些币
# 另一种使用路径至少要等区块高度 506321 后才行
# 这个脚本使用户可以自选使用相对时间锁还是绝对时间锁，哪个比较短就可以用哪个
tx_3:
  lock_time: 0
  input_1:
    sequence_no: 0x00000100
    scriptsig:
      OP_FALSE
    script:
      OP_IF
        506321 OP_CHECKLOCKTIMEVERIFY
      OP_ELSE
        0x00000100 OP_CHECKSEQUENCEVERIFY
      OP_ENDIF
      OP_DROP

# 这笔交易在 1/1/2020 前是无效的，
# 在前序输出确认后的 31457280 秒内也是无效的
# 它还用公钥指定了一个可以花费它的人
tx_4:
  lock_time: 1577836800
  input_1:
    sequence_no: 0x0004F000  # type flag is set
    scriptsig:
      &lt;signature&gt; &lt;pubkey&gt;
    script:
      1577836800 OP_CHECKLOCKTIMEVERIFY OP_DROP
      0x0004F000 OP_CHECKSEQUENCEVERIFY OP_DROP
      OP_DUP OP_HASH160 &lt;pubkey hash&gt; OP_EQUALVERIFY
      OP_CHECKSIGVERIFY

# 这笔交易是无效的，因为下面三种原因：
# 1) input_1 的脚本失败，因为其中的 16 位锁定时间大于 sequence_no 中指定的时间
# 2) input_2 的脚本失败因为 sequence_no 的类型标签未设置， 但栈中元素设置了类型标签
# 3) input_3 的脚本失败，因为最终栈中的元素不为空
tx_5:
  lock_time: 0
  input_1:
    sequence_no: 0x0004F000
    script:
      0x0004FFFF OP_CHECKSEQUENCEVERIFY OP_DROP
  input_2:
    sequence_no: 0x0000FFFF
    script:
      0x0004FFFF OP_CHECKSEQUENCEVERIFY OP_DROP
  input_3:
    sequence_no: 0x00000001
    script:
      0x00000001 OP_CHECKSEQUENCEVERIFYReview
</code></pre>
<p>比特币的时间锁是非常强大的工具，但容易让人误解。以下是重要事项的快速清单：</p>
<ul>
<li>带 OP 的都属于脚本层</li>
<li>“Locktime” 都表示绝对的时间锁</li>
<li>“Sequence” 都表示相对时间锁</li>
<li>所有的时间锁都可以用区块和秒数来度量，只不过表示的方式不同</li>
<li>不要一不小心把东西锁上几个世纪</li>
<li>脚本层的时间锁需要在花费交易中使用同样类型的交易层锁</li>
</ul>
<h2 id="延伸阅读"><a href="#延伸阅读" class="headerlink" title="延伸阅读"></a>延伸阅读</h2><ul>
<li><a target="_blank" rel="noopener" href="https://github.com/bitcoin/bips/blob/master/bip-0065.mediawiki">BIP 65 — CLTV</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/bitcoin/bips/blob/master/bip-0068.mediawiki">BIP 68 — nSequence locks</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/bitcoin/bips/blob/master/bip-0112.mediawiki">BIP 112 — CSV</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/bitcoin/bips/blob/master/bip-0113.mediawiki">BIP 113 — MTP measurement</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/bitcoin/bips/blob/master/bip-0125.mediawiki">BIP 125 — RBF signalling</a></li>
<li><a target="_blank" rel="noopener" href="https://z.cash/blog/htlc-bip.html">Zcash’s primer on HTLCs</a></li>
<li><a target="_blank" rel="noopener" href="https://lightning.network/lightning-network-paper.pdf">The Lightning Network Paper</a></li>
<li><a target="_blank" rel="noopener" href="https://bitcoin.stackexchange.com/a/2032">Theymos on sequence_no in 2011</a></li>
<li><a target="_blank" rel="noopener" href="https://www.reddit.com/r/Bitcoin/comments/47upgx/nsequence_and_optin_replacebyfee_difference/d0g612x/?context=5">nullc on fee sniping</a></li>
<li><a target="_blank" rel="noopener" href="https://bitcoin.stackexchange.com/a/40784">mulllhausen on nLocktime vs CLTV</a></li>
<li><a target="_blank" rel="noopener" href="https://en.bitcoin.it/wiki/Timelock">bitcoinwiki article on time locks</a></li>
<li><a target="_blank" rel="noopener" href="https://www.reddit.com/r/Bitcoin/comments/4p4klg/bitcoin_core_project_the_csv_soft_fork_has/d4i7rwl/?context=999">maaku7 on the CSV soft fork</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/bitcoin/bitcoin/blob/v0.12.0/src/script/interpreter.cpp#L334-L374">CLTV’s source</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/bitcoin/bitcoin/blob/v0.13.0/src/script/interpreter.cpp#L376-L411">CSV’s source</a></li>
</ul>
<p>（完）</p>
</article></div></div></main><script src="/js/post.js?v=1673690025615"></script><script src="/js/highlight.min.js?v=1673690025615"></script><script>var containerEl = document.querySelector('.post-container');
var postFontSize = localStorage.getItem('post-font-size') || '16';
var inputEl = document.querySelector('#size-change-input');
var inputEl2 = document.querySelector('#size-change-input2');
inputEl.value = postFontSize;
inputEl2.value = postFontSize;
containerEl.style.fontSize = postFontSize + 'px';
$(function(){
  function setSizeChangeInputValue(size) {
    $('.post-container').css('font-size', size + 'px');
    localStorage.setItem('post-font-size', size);
    $('#size-change-input').val(size);
    $('#size-change-input2').val(size);
  }
  $('#size-change-input').on('input propertychange', function(e) {
    const size = e.target.value;
    setSizeChangeInputValue(size);
  });
  $('#size-change-input2').on('input propertychange', function(e) {
    const size = e.target.value;
    setSizeChangeInputValue(size);
  });
});
</script><script>hljs.initHighlightingOnLoad();</script></main></div><footer class="is-flex is-flex-direction-column is-align-items-center is-flex-shrink-0"><section class="sns-container"><a title="twitter" target="_blank" rel="noopener nofollow" href="//twitter.com/btcstudy">Twitter</a><!-- Github--><!-- Ins--><!-- RSS--><a title="rss" target="_blank" rel="noopener nofollow" href="/atom.xml">rss</a><!-- 知乎--><!-- 领英--><!-- 脸书--><!-- Telegram--><a title="telegram" target="_blank" rel="noopener nofollow" href="//t.me/btcstudyorg">Telegram</a></section></footer><script async src="/js/buttons.js?v=1673690025615"></script><script async src="/js/index.js?v=1673690025615"></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-JVCJ9XXG1Z"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());

gtag('config', 'G-JVCJ9XXG1Z');</script><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?c92c073c85be5be8d9b1b76f62a7e306";
  hm.async = true;
  hm.defer = true;
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
  </script></body></html>