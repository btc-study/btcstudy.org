<!DOCTYPE html><html lang=zh-CN><head><meta charset=UTF-8><title>Schnorr 签名系列：最优轮次的灵活 Schnorr 门限签名（FROST）</title><meta name=keywords content="比特币, 中本聪, 比特币区块链, 闪电网络, 比特币 layer 2, 健全货币, 密码货币, 密码朋克, 学习比特币, BTC, BTC Study, Bitcoin, bitcoin, proof of work"><meta name=description content=比特币思想的中文集结地><meta name=viewport content="width=device-width,minimum-scale=1,maximum-scale=1,initial-scale=1"><link rel=icon href=/favicon.ico><link rel=stylesheet href="/style/common/bulma.css?v=1682773100887"><link rel=preload as=style onload='this.onload=null,this.rel="stylesheet"' href="/style/common/iconfont.css?v=1682773100887"><link rel=stylesheet href="/style/base.css?v=1682773100887"><link rel=stylesheet href="/style/common/helper.css?v=1682773100887"><link rel=stylesheet href="/style/themes/animation.css?v=1682773100887"><script>function ready(){var e=document.querySelector(".body-container"),t=localStorage.getItem("theme")||"light";["light","dark"].includes(t)||(t="light",localStorage.setItem("theme","light")),e.classList.remove("appearance-auto"),e.classList.add("appearance-"+t),quickInitialTheme()}function quickInitialTheme(){var e=localStorage.getItem("theme")||"light",t=document.querySelector(".logo-light"),o=document.querySelector(".logo-dark"),d=document.querySelector("#mobile-header-logo > .logo-light"),l=document.querySelector("#mobile-header-logo > .logo-dark"),a=document.getElementById("theme-btn"),i=document.querySelector(".slide-theme-light"),c=document.querySelector(".slide-theme-dark");document.body.classList.add(e),("dark"===e?(t.classList.add("hidden"),o.classList.remove("hidden"),d.classList.add("hidden"),l.classList.remove("hidden"),a.classList.remove("icon-icon_dark"),a.classList.add("icon-icon_light"),i):c).classList.remove("hidden")}document.addEventListener("DOMContentLoaded",ready)</script><script src="/js/common.js?v=1682773100887"></script><script src=/js/libs/zepto.min.js></script><link rel=stylesheet href="/style/post.css?v=1682773100887"><link rel=stylesheet href="/style/themes/highlight.css?v=1682773100887"><meta name=generator content="Hexo 6.3.0"><link rel=alternate href=/atom.xml title="BTC Study" type=application/atom+xml></head><body class="is-flex is-flex-direction-column" onload=initialTheme()><div class=clip></div><div class="body-container appearance-auto"><header class="header-widget is-hidden-mobile is-flex is-flex-shrink-0 is-align-items-center is-justify-content-center" id=header><div class="is-flex header-widget-container is-flex-shrink-0 is-align-items-center"><section class="is-hidden-mobile is-flex-shrink-0"><h1><a href=/ ><svg class=logo-light width=125px height=23px viewBox="0 0 125 23" version=1.1 xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink><title>BTCStudy</title><g id=页面-1 stroke=none stroke-width=1 fill=none fill-rule=evenodd><g id=首页-响应式 transform="translate(-249.000000, -23.000000)" fill-rule=nonzero><g id=BTCStudy transform="translate(249.680000, 23.192000)"><path d="M9.072,17.808 C11.312,17.808 13.024,17.408 14.208,16.608 C15.392,15.808 15.984,14.672 15.984,13.2 C15.984,12.192 15.712,11.332 15.168,10.62 C14.624,9.908 13.872,9.384 12.912,9.048 C13.632,8.68 14.188,8.18 14.58,7.548 C14.972,6.916 15.168,6.2 15.168,5.4 C15.168,4.056 14.608,2.988 13.488,2.196 C12.368,1.404 10.736,1.008 8.592,1.008 L8.592,1.008 L-5.68434189e-14,1.008 L-5.68434189e-14,17.808 L9.072,17.808 Z M7.968,7.68 L4.704,7.68 L4.704,4.44 L7.968,4.44 C9.568,4.44 10.368,4.976 10.368,6.048 C10.368,7.136 9.568,7.68 7.968,7.68 L7.968,7.68 Z M8.688,14.376 L4.704,14.376 L4.704,10.968 L8.688,10.968 C10.352,10.968 11.184,11.536 11.184,12.672 C11.184,13.808 10.352,14.376 8.688,14.376 L8.688,14.376 Z M26.544,17.808 L26.544,4.776 L31.68,4.776 L31.68,1.008 L16.632,1.008 L16.632,4.776 L21.792,4.776 L21.792,17.808 L26.544,17.808 Z M41.592,18.144 C43.128,18.144 44.512,17.872 45.744,17.328 C46.976,16.784 48,16 48.816,14.976 L48.816,14.976 L45.792,12.24 C44.704,13.552 43.384,14.208 41.832,14.208 C40.92,14.208 40.108,14.008 39.396,13.608 C38.684,13.208 38.132,12.644 37.74,11.916 C37.348,11.188 37.152,10.352 37.152,9.408 C37.152,8.464 37.348,7.628 37.74,6.9 C38.132,6.172 38.684,5.608 39.396,5.208 C40.108,4.808 40.92,4.608 41.832,4.608 C43.384,4.608 44.704,5.264 45.792,6.576 L45.792,6.576 L48.816,3.84 C48,2.816 46.976,2.032 45.744,1.488 C44.512,0.944 43.128,0.672 41.592,0.672 C39.832,0.672 38.252,1.044 36.852,1.788 C35.452,2.532 34.352,3.568 33.552,4.896 C32.752,6.224 32.352,7.728 32.352,9.408 C32.352,11.088 32.752,12.592 33.552,13.92 C34.352,15.248 35.452,16.284 36.852,17.028 C38.252,17.772 39.832,18.144 41.592,18.144 Z" id=BTC fill=#F2A900></path><path d="M56.64,18.144 C58.24,18.144 59.6,17.9 60.72,17.412 C61.84,16.924 62.68,16.272 63.24,15.456 C63.8,14.64 64.08,13.728 64.08,12.72 C64.08,11.552 63.772,10.628 63.156,9.948 C62.54,9.268 61.812,8.772 60.972,8.46 C60.132,8.148 59.072,7.856 57.792,7.584 C56.656,7.344 55.832,7.112 55.32,6.888 C54.808,6.664 54.552,6.328 54.552,5.88 C54.552,5.432 54.768,5.068 55.2,4.788 C55.632,4.508 56.32,4.368 57.264,4.368 C58.768,4.368 60.32,4.8 61.92,5.664 L61.92,5.664 L63.384,2.136 C62.568,1.656 61.624,1.292 60.552,1.044 C59.48,0.796 58.392,0.672 57.288,0.672 C55.672,0.672 54.308,0.912 53.196,1.392 C52.084,1.872 51.248,2.524 50.688,3.348 C50.128,4.172 49.848,5.096 49.848,6.12 C49.848,7.288 50.152,8.216 50.76,8.904 C51.368,9.592 52.096,10.092 52.944,10.404 C53.792,10.716 54.848,11.008 56.112,11.28 C57.264,11.536 58.1,11.78 58.62,12.012 C59.14,12.244 59.4,12.6 59.4,13.08 C59.4,13.992 58.488,14.448 56.664,14.448 C55.704,14.448 54.728,14.296 53.736,13.992 C52.744,13.688 51.872,13.288 51.12,12.792 L51.12,12.792 L49.56,16.296 C50.36,16.856 51.4,17.304 52.68,17.64 C53.96,17.976 55.28,18.144 56.64,18.144 Z M71.856,18.024 C72.48,18.024 73.068,17.96 73.62,17.832 C74.172,17.704 74.64,17.52 75.024,17.28 L75.024,17.28 L73.896,14.088 C73.496,14.36 73.032,14.496 72.504,14.496 C72.088,14.496 71.756,14.364 71.508,14.1 C71.26,13.836 71.136,13.472 71.136,13.008 L71.136,13.008 L71.136,8.688 L74.112,8.688 L74.112,5.28 L71.136,5.28 L71.136,1.896 L66.576,1.896 L66.576,5.28 L64.68,5.28 L64.68,8.688 L66.576,8.688 L66.576,13.056 C66.576,14.704 67.032,15.944 67.944,16.776 C68.856,17.608 70.16,18.024 71.856,18.024 Z M82.248,18.024 C83,18.024 83.712,17.888 84.384,17.616 C85.056,17.344 85.632,16.944 86.112,16.416 L86.112,16.416 L86.112,17.808 L90.456,17.808 L90.456,4.8 L85.896,4.8 L85.896,11.064 C85.896,12.104 85.668,12.876 85.212,13.38 C84.756,13.884 84.168,14.136 83.448,14.136 C82.744,14.136 82.208,13.912 81.84,13.464 C81.472,13.016 81.288,12.304 81.288,11.328 L81.288,11.328 L81.288,4.8 L76.728,4.8 L76.728,12.072 C76.728,14.056 77.228,15.544 78.228,16.536 C79.228,17.528 80.568,18.024 82.248,18.024 Z M99.048,18.024 C100.744,18.024 102.016,17.52 102.864,16.512 L102.864,16.512 L102.864,17.808 L107.208,17.808 L107.208,0 L102.648,0 L102.648,5.928 C101.8,5.032 100.6,4.584 99.048,4.584 C97.864,4.584 96.784,4.856 95.808,5.4 C94.832,5.944 94.06,6.724 93.492,7.74 C92.924,8.756 92.64,9.936 92.64,11.28 C92.64,12.624 92.924,13.808 93.492,14.832 C94.06,15.856 94.832,16.644 95.808,17.196 C96.784,17.748 97.864,18.024 99.048,18.024 Z M100.008,14.4 C99.208,14.4 98.552,14.124 98.04,13.572 C97.528,13.02 97.272,12.256 97.272,11.28 C97.272,10.32 97.528,9.568 98.04,9.024 C98.552,8.48 99.208,8.208 100.008,8.208 C100.808,8.208 101.46,8.48 101.964,9.024 C102.468,9.568 102.72,10.32 102.72,11.28 C102.72,12.256 102.464,13.02 101.952,13.572 C101.44,14.124 100.792,14.4 100.008,14.4 Z M112.368,22.68 C113.728,22.68 114.88,22.356 115.824,21.708 C116.768,21.06 117.568,19.936 118.224,18.336 L118.224,18.336 L123.84,4.8 L119.496,4.8 L116.28,12.744 L113.088,4.8 L108.408,4.8 L113.976,17.976 C113.784,18.36 113.548,18.64 113.268,18.816 C112.988,18.992 112.632,19.08 112.2,19.08 C111.832,19.08 111.468,19.012 111.108,18.876 C110.748,18.74 110.44,18.552 110.184,18.312 L110.184,18.312 L108.6,21.504 C109.032,21.856 109.596,22.14 110.292,22.356 C110.988,22.572 111.68,22.68 112.368,22.68 Z" id=Study fill-opacity=0.85 fill=#000000></path></g></g></g></svg><svg class="logo-dark hidden" width=125px height=23px viewBox="0 0 125 23" version=1.1 xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink><title>BTCStudy</title><g id=页面-1 stroke=none stroke-width=1 fill=none fill-rule=evenodd><g id=首页-响应式 transform="translate(-249.000000, -23.000000)" fill-rule=nonzero><g id=BTCStudy transform="translate(249.680000, 23.192000)"><path d="M9.072,17.808 C11.312,17.808 13.024,17.408 14.208,16.608 C15.392,15.808 15.984,14.672 15.984,13.2 C15.984,12.192 15.712,11.332 15.168,10.62 C14.624,9.908 13.872,9.384 12.912,9.048 C13.632,8.68 14.188,8.18 14.58,7.548 C14.972,6.916 15.168,6.2 15.168,5.4 C15.168,4.056 14.608,2.988 13.488,2.196 C12.368,1.404 10.736,1.008 8.592,1.008 L8.592,1.008 L-5.68434189e-14,1.008 L-5.68434189e-14,17.808 L9.072,17.808 Z M7.968,7.68 L4.704,7.68 L4.704,4.44 L7.968,4.44 C9.568,4.44 10.368,4.976 10.368,6.048 C10.368,7.136 9.568,7.68 7.968,7.68 L7.968,7.68 Z M8.688,14.376 L4.704,14.376 L4.704,10.968 L8.688,10.968 C10.352,10.968 11.184,11.536 11.184,12.672 C11.184,13.808 10.352,14.376 8.688,14.376 L8.688,14.376 Z M26.544,17.808 L26.544,4.776 L31.68,4.776 L31.68,1.008 L16.632,1.008 L16.632,4.776 L21.792,4.776 L21.792,17.808 L26.544,17.808 Z M41.592,18.144 C43.128,18.144 44.512,17.872 45.744,17.328 C46.976,16.784 48,16 48.816,14.976 L48.816,14.976 L45.792,12.24 C44.704,13.552 43.384,14.208 41.832,14.208 C40.92,14.208 40.108,14.008 39.396,13.608 C38.684,13.208 38.132,12.644 37.74,11.916 C37.348,11.188 37.152,10.352 37.152,9.408 C37.152,8.464 37.348,7.628 37.74,6.9 C38.132,6.172 38.684,5.608 39.396,5.208 C40.108,4.808 40.92,4.608 41.832,4.608 C43.384,4.608 44.704,5.264 45.792,6.576 L45.792,6.576 L48.816,3.84 C48,2.816 46.976,2.032 45.744,1.488 C44.512,0.944 43.128,0.672 41.592,0.672 C39.832,0.672 38.252,1.044 36.852,1.788 C35.452,2.532 34.352,3.568 33.552,4.896 C32.752,6.224 32.352,7.728 32.352,9.408 C32.352,11.088 32.752,12.592 33.552,13.92 C34.352,15.248 35.452,16.284 36.852,17.028 C38.252,17.772 39.832,18.144 41.592,18.144 Z" id=BTC fill=#F2A900></path><path d="M56.64,18.144 C58.24,18.144 59.6,17.9 60.72,17.412 C61.84,16.924 62.68,16.272 63.24,15.456 C63.8,14.64 64.08,13.728 64.08,12.72 C64.08,11.552 63.772,10.628 63.156,9.948 C62.54,9.268 61.812,8.772 60.972,8.46 C60.132,8.148 59.072,7.856 57.792,7.584 C56.656,7.344 55.832,7.112 55.32,6.888 C54.808,6.664 54.552,6.328 54.552,5.88 C54.552,5.432 54.768,5.068 55.2,4.788 C55.632,4.508 56.32,4.368 57.264,4.368 C58.768,4.368 60.32,4.8 61.92,5.664 L61.92,5.664 L63.384,2.136 C62.568,1.656 61.624,1.292 60.552,1.044 C59.48,0.796 58.392,0.672 57.288,0.672 C55.672,0.672 54.308,0.912 53.196,1.392 C52.084,1.872 51.248,2.524 50.688,3.348 C50.128,4.172 49.848,5.096 49.848,6.12 C49.848,7.288 50.152,8.216 50.76,8.904 C51.368,9.592 52.096,10.092 52.944,10.404 C53.792,10.716 54.848,11.008 56.112,11.28 C57.264,11.536 58.1,11.78 58.62,12.012 C59.14,12.244 59.4,12.6 59.4,13.08 C59.4,13.992 58.488,14.448 56.664,14.448 C55.704,14.448 54.728,14.296 53.736,13.992 C52.744,13.688 51.872,13.288 51.12,12.792 L51.12,12.792 L49.56,16.296 C50.36,16.856 51.4,17.304 52.68,17.64 C53.96,17.976 55.28,18.144 56.64,18.144 Z M71.856,18.024 C72.48,18.024 73.068,17.96 73.62,17.832 C74.172,17.704 74.64,17.52 75.024,17.28 L75.024,17.28 L73.896,14.088 C73.496,14.36 73.032,14.496 72.504,14.496 C72.088,14.496 71.756,14.364 71.508,14.1 C71.26,13.836 71.136,13.472 71.136,13.008 L71.136,13.008 L71.136,8.688 L74.112,8.688 L74.112,5.28 L71.136,5.28 L71.136,1.896 L66.576,1.896 L66.576,5.28 L64.68,5.28 L64.68,8.688 L66.576,8.688 L66.576,13.056 C66.576,14.704 67.032,15.944 67.944,16.776 C68.856,17.608 70.16,18.024 71.856,18.024 Z M82.248,18.024 C83,18.024 83.712,17.888 84.384,17.616 C85.056,17.344 85.632,16.944 86.112,16.416 L86.112,16.416 L86.112,17.808 L90.456,17.808 L90.456,4.8 L85.896,4.8 L85.896,11.064 C85.896,12.104 85.668,12.876 85.212,13.38 C84.756,13.884 84.168,14.136 83.448,14.136 C82.744,14.136 82.208,13.912 81.84,13.464 C81.472,13.016 81.288,12.304 81.288,11.328 L81.288,11.328 L81.288,4.8 L76.728,4.8 L76.728,12.072 C76.728,14.056 77.228,15.544 78.228,16.536 C79.228,17.528 80.568,18.024 82.248,18.024 Z M99.048,18.024 C100.744,18.024 102.016,17.52 102.864,16.512 L102.864,16.512 L102.864,17.808 L107.208,17.808 L107.208,0 L102.648,0 L102.648,5.928 C101.8,5.032 100.6,4.584 99.048,4.584 C97.864,4.584 96.784,4.856 95.808,5.4 C94.832,5.944 94.06,6.724 93.492,7.74 C92.924,8.756 92.64,9.936 92.64,11.28 C92.64,12.624 92.924,13.808 93.492,14.832 C94.06,15.856 94.832,16.644 95.808,17.196 C96.784,17.748 97.864,18.024 99.048,18.024 Z M100.008,14.4 C99.208,14.4 98.552,14.124 98.04,13.572 C97.528,13.02 97.272,12.256 97.272,11.28 C97.272,10.32 97.528,9.568 98.04,9.024 C98.552,8.48 99.208,8.208 100.008,8.208 C100.808,8.208 101.46,8.48 101.964,9.024 C102.468,9.568 102.72,10.32 102.72,11.28 C102.72,12.256 102.464,13.02 101.952,13.572 C101.44,14.124 100.792,14.4 100.008,14.4 Z M112.368,22.68 C113.728,22.68 114.88,22.356 115.824,21.708 C116.768,21.06 117.568,19.936 118.224,18.336 L118.224,18.336 L123.84,4.8 L119.496,4.8 L116.28,12.744 L113.088,4.8 L108.408,4.8 L113.976,17.976 C113.784,18.36 113.548,18.64 113.268,18.816 C112.988,18.992 112.632,19.08 112.2,19.08 C111.832,19.08 111.468,19.012 111.108,18.876 C110.748,18.74 110.44,18.552 110.184,18.312 L110.184,18.312 L108.6,21.504 C109.032,21.856 109.596,22.14 110.292,22.356 C110.988,22.572 111.68,22.68 112.368,22.68 Z" id=Study fill-opacity=0.85 fill=#FFFFFF></path></g></g></g></svg></a></h1></section><div class="is-flex is-flex-direction-column header-menu-wrap"><aside class="is-flex-shrink-0 is-flex is-flex-direction-row is-align-items-center" id=header-menu><a class="is-inline-block header-activity mr-4" href=/ >首页</a><a class="is-inline-block mr-4" href=/archives>全站目录</a><a class="is-inline-block mr-4" href=/tags>标签</a><a class="is-inline-block mr-4" href=/maps>地图</a><a class="is-inline-block mr-4" href=/mempool>mempool</a><a class="is-inline-block mr-4" target=_blank rel=noopener href=https://123btc.org/ >123btc</a><div class="right-content is-flex is-flex-direction-row is-align-items-center"><div class="size-wrap mr-1"><i class="iconfont icon-a-bianzu5" id=change-size-btn></i><div class=size-input-wrap><div class=input-wrap><input id=size-change-input type=range min=12 max=32 step=2></div></div></div><i class="iconfont icon-icon_dark mr-1" id=theme-btn></i><div class=search-wrap><input class=pl-3 id=search-input placeholder=请输入搜索关键词><i class="iconfont icon-icon_search" id=search-input-btn></i></div></div></aside><div class="header-title is-hidden-mobile is-full-height is-flex is-align-items-center is-flex-shrink-0"><div class="is-full-height hidden" id=postTopic><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">Schnorr 签名系列：最优轮次的灵活 Schnorr 门限签名（FROST）</p><div class="size-wrap mr-1"><i class="iconfont icon-a-bianzu5" id=change-size-btn2></i><div class=size-input-wrap><div class=input-wrap><input id=size-change-input2 type=range min=12 max=32 step=2></div></div></div></div></div></div></div></header><header class="is-flex header-widget is-flex-shrink-0 is-align-items-center is-justify-content-space-between is-hidden-tablet" id=mobile-header><div class="is-flex is-flex-direction-row is-align-items-center"><i class="iconfont icon-icon_bar mobile-header-menu"></i><div id=mobile-header-logo><svg class=logo-light width=125px height=23px viewBox="0 0 125 23" version=1.1 xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink><title>BTCStudy</title><g id=页面-1 stroke=none stroke-width=1 fill=none fill-rule=evenodd><g id=首页-响应式 transform="translate(-249.000000, -23.000000)" fill-rule=nonzero><g id=BTCStudy transform="translate(249.680000, 23.192000)"><path d="M9.072,17.808 C11.312,17.808 13.024,17.408 14.208,16.608 C15.392,15.808 15.984,14.672 15.984,13.2 C15.984,12.192 15.712,11.332 15.168,10.62 C14.624,9.908 13.872,9.384 12.912,9.048 C13.632,8.68 14.188,8.18 14.58,7.548 C14.972,6.916 15.168,6.2 15.168,5.4 C15.168,4.056 14.608,2.988 13.488,2.196 C12.368,1.404 10.736,1.008 8.592,1.008 L8.592,1.008 L-5.68434189e-14,1.008 L-5.68434189e-14,17.808 L9.072,17.808 Z M7.968,7.68 L4.704,7.68 L4.704,4.44 L7.968,4.44 C9.568,4.44 10.368,4.976 10.368,6.048 C10.368,7.136 9.568,7.68 7.968,7.68 L7.968,7.68 Z M8.688,14.376 L4.704,14.376 L4.704,10.968 L8.688,10.968 C10.352,10.968 11.184,11.536 11.184,12.672 C11.184,13.808 10.352,14.376 8.688,14.376 L8.688,14.376 Z M26.544,17.808 L26.544,4.776 L31.68,4.776 L31.68,1.008 L16.632,1.008 L16.632,4.776 L21.792,4.776 L21.792,17.808 L26.544,17.808 Z M41.592,18.144 C43.128,18.144 44.512,17.872 45.744,17.328 C46.976,16.784 48,16 48.816,14.976 L48.816,14.976 L45.792,12.24 C44.704,13.552 43.384,14.208 41.832,14.208 C40.92,14.208 40.108,14.008 39.396,13.608 C38.684,13.208 38.132,12.644 37.74,11.916 C37.348,11.188 37.152,10.352 37.152,9.408 C37.152,8.464 37.348,7.628 37.74,6.9 C38.132,6.172 38.684,5.608 39.396,5.208 C40.108,4.808 40.92,4.608 41.832,4.608 C43.384,4.608 44.704,5.264 45.792,6.576 L45.792,6.576 L48.816,3.84 C48,2.816 46.976,2.032 45.744,1.488 C44.512,0.944 43.128,0.672 41.592,0.672 C39.832,0.672 38.252,1.044 36.852,1.788 C35.452,2.532 34.352,3.568 33.552,4.896 C32.752,6.224 32.352,7.728 32.352,9.408 C32.352,11.088 32.752,12.592 33.552,13.92 C34.352,15.248 35.452,16.284 36.852,17.028 C38.252,17.772 39.832,18.144 41.592,18.144 Z" id=BTC fill=#F2A900></path><path d="M56.64,18.144 C58.24,18.144 59.6,17.9 60.72,17.412 C61.84,16.924 62.68,16.272 63.24,15.456 C63.8,14.64 64.08,13.728 64.08,12.72 C64.08,11.552 63.772,10.628 63.156,9.948 C62.54,9.268 61.812,8.772 60.972,8.46 C60.132,8.148 59.072,7.856 57.792,7.584 C56.656,7.344 55.832,7.112 55.32,6.888 C54.808,6.664 54.552,6.328 54.552,5.88 C54.552,5.432 54.768,5.068 55.2,4.788 C55.632,4.508 56.32,4.368 57.264,4.368 C58.768,4.368 60.32,4.8 61.92,5.664 L61.92,5.664 L63.384,2.136 C62.568,1.656 61.624,1.292 60.552,1.044 C59.48,0.796 58.392,0.672 57.288,0.672 C55.672,0.672 54.308,0.912 53.196,1.392 C52.084,1.872 51.248,2.524 50.688,3.348 C50.128,4.172 49.848,5.096 49.848,6.12 C49.848,7.288 50.152,8.216 50.76,8.904 C51.368,9.592 52.096,10.092 52.944,10.404 C53.792,10.716 54.848,11.008 56.112,11.28 C57.264,11.536 58.1,11.78 58.62,12.012 C59.14,12.244 59.4,12.6 59.4,13.08 C59.4,13.992 58.488,14.448 56.664,14.448 C55.704,14.448 54.728,14.296 53.736,13.992 C52.744,13.688 51.872,13.288 51.12,12.792 L51.12,12.792 L49.56,16.296 C50.36,16.856 51.4,17.304 52.68,17.64 C53.96,17.976 55.28,18.144 56.64,18.144 Z M71.856,18.024 C72.48,18.024 73.068,17.96 73.62,17.832 C74.172,17.704 74.64,17.52 75.024,17.28 L75.024,17.28 L73.896,14.088 C73.496,14.36 73.032,14.496 72.504,14.496 C72.088,14.496 71.756,14.364 71.508,14.1 C71.26,13.836 71.136,13.472 71.136,13.008 L71.136,13.008 L71.136,8.688 L74.112,8.688 L74.112,5.28 L71.136,5.28 L71.136,1.896 L66.576,1.896 L66.576,5.28 L64.68,5.28 L64.68,8.688 L66.576,8.688 L66.576,13.056 C66.576,14.704 67.032,15.944 67.944,16.776 C68.856,17.608 70.16,18.024 71.856,18.024 Z M82.248,18.024 C83,18.024 83.712,17.888 84.384,17.616 C85.056,17.344 85.632,16.944 86.112,16.416 L86.112,16.416 L86.112,17.808 L90.456,17.808 L90.456,4.8 L85.896,4.8 L85.896,11.064 C85.896,12.104 85.668,12.876 85.212,13.38 C84.756,13.884 84.168,14.136 83.448,14.136 C82.744,14.136 82.208,13.912 81.84,13.464 C81.472,13.016 81.288,12.304 81.288,11.328 L81.288,11.328 L81.288,4.8 L76.728,4.8 L76.728,12.072 C76.728,14.056 77.228,15.544 78.228,16.536 C79.228,17.528 80.568,18.024 82.248,18.024 Z M99.048,18.024 C100.744,18.024 102.016,17.52 102.864,16.512 L102.864,16.512 L102.864,17.808 L107.208,17.808 L107.208,0 L102.648,0 L102.648,5.928 C101.8,5.032 100.6,4.584 99.048,4.584 C97.864,4.584 96.784,4.856 95.808,5.4 C94.832,5.944 94.06,6.724 93.492,7.74 C92.924,8.756 92.64,9.936 92.64,11.28 C92.64,12.624 92.924,13.808 93.492,14.832 C94.06,15.856 94.832,16.644 95.808,17.196 C96.784,17.748 97.864,18.024 99.048,18.024 Z M100.008,14.4 C99.208,14.4 98.552,14.124 98.04,13.572 C97.528,13.02 97.272,12.256 97.272,11.28 C97.272,10.32 97.528,9.568 98.04,9.024 C98.552,8.48 99.208,8.208 100.008,8.208 C100.808,8.208 101.46,8.48 101.964,9.024 C102.468,9.568 102.72,10.32 102.72,11.28 C102.72,12.256 102.464,13.02 101.952,13.572 C101.44,14.124 100.792,14.4 100.008,14.4 Z M112.368,22.68 C113.728,22.68 114.88,22.356 115.824,21.708 C116.768,21.06 117.568,19.936 118.224,18.336 L118.224,18.336 L123.84,4.8 L119.496,4.8 L116.28,12.744 L113.088,4.8 L108.408,4.8 L113.976,17.976 C113.784,18.36 113.548,18.64 113.268,18.816 C112.988,18.992 112.632,19.08 112.2,19.08 C111.832,19.08 111.468,19.012 111.108,18.876 C110.748,18.74 110.44,18.552 110.184,18.312 L110.184,18.312 L108.6,21.504 C109.032,21.856 109.596,22.14 110.292,22.356 C110.988,22.572 111.68,22.68 112.368,22.68 Z" id=Study fill-opacity=0.85 fill=#000000></path></g></g></g></svg><svg class="logo-dark hidden" width=125px height=23px viewBox="0 0 125 23" version=1.1 xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink><title>BTCStudy</title><g id=页面-1 stroke=none stroke-width=1 fill=none fill-rule=evenodd><g id=首页-响应式 transform="translate(-249.000000, -23.000000)" fill-rule=nonzero><g id=BTCStudy transform="translate(249.680000, 23.192000)"><path d="M9.072,17.808 C11.312,17.808 13.024,17.408 14.208,16.608 C15.392,15.808 15.984,14.672 15.984,13.2 C15.984,12.192 15.712,11.332 15.168,10.62 C14.624,9.908 13.872,9.384 12.912,9.048 C13.632,8.68 14.188,8.18 14.58,7.548 C14.972,6.916 15.168,6.2 15.168,5.4 C15.168,4.056 14.608,2.988 13.488,2.196 C12.368,1.404 10.736,1.008 8.592,1.008 L8.592,1.008 L-5.68434189e-14,1.008 L-5.68434189e-14,17.808 L9.072,17.808 Z M7.968,7.68 L4.704,7.68 L4.704,4.44 L7.968,4.44 C9.568,4.44 10.368,4.976 10.368,6.048 C10.368,7.136 9.568,7.68 7.968,7.68 L7.968,7.68 Z M8.688,14.376 L4.704,14.376 L4.704,10.968 L8.688,10.968 C10.352,10.968 11.184,11.536 11.184,12.672 C11.184,13.808 10.352,14.376 8.688,14.376 L8.688,14.376 Z M26.544,17.808 L26.544,4.776 L31.68,4.776 L31.68,1.008 L16.632,1.008 L16.632,4.776 L21.792,4.776 L21.792,17.808 L26.544,17.808 Z M41.592,18.144 C43.128,18.144 44.512,17.872 45.744,17.328 C46.976,16.784 48,16 48.816,14.976 L48.816,14.976 L45.792,12.24 C44.704,13.552 43.384,14.208 41.832,14.208 C40.92,14.208 40.108,14.008 39.396,13.608 C38.684,13.208 38.132,12.644 37.74,11.916 C37.348,11.188 37.152,10.352 37.152,9.408 C37.152,8.464 37.348,7.628 37.74,6.9 C38.132,6.172 38.684,5.608 39.396,5.208 C40.108,4.808 40.92,4.608 41.832,4.608 C43.384,4.608 44.704,5.264 45.792,6.576 L45.792,6.576 L48.816,3.84 C48,2.816 46.976,2.032 45.744,1.488 C44.512,0.944 43.128,0.672 41.592,0.672 C39.832,0.672 38.252,1.044 36.852,1.788 C35.452,2.532 34.352,3.568 33.552,4.896 C32.752,6.224 32.352,7.728 32.352,9.408 C32.352,11.088 32.752,12.592 33.552,13.92 C34.352,15.248 35.452,16.284 36.852,17.028 C38.252,17.772 39.832,18.144 41.592,18.144 Z" id=BTC fill=#F2A900></path><path d="M56.64,18.144 C58.24,18.144 59.6,17.9 60.72,17.412 C61.84,16.924 62.68,16.272 63.24,15.456 C63.8,14.64 64.08,13.728 64.08,12.72 C64.08,11.552 63.772,10.628 63.156,9.948 C62.54,9.268 61.812,8.772 60.972,8.46 C60.132,8.148 59.072,7.856 57.792,7.584 C56.656,7.344 55.832,7.112 55.32,6.888 C54.808,6.664 54.552,6.328 54.552,5.88 C54.552,5.432 54.768,5.068 55.2,4.788 C55.632,4.508 56.32,4.368 57.264,4.368 C58.768,4.368 60.32,4.8 61.92,5.664 L61.92,5.664 L63.384,2.136 C62.568,1.656 61.624,1.292 60.552,1.044 C59.48,0.796 58.392,0.672 57.288,0.672 C55.672,0.672 54.308,0.912 53.196,1.392 C52.084,1.872 51.248,2.524 50.688,3.348 C50.128,4.172 49.848,5.096 49.848,6.12 C49.848,7.288 50.152,8.216 50.76,8.904 C51.368,9.592 52.096,10.092 52.944,10.404 C53.792,10.716 54.848,11.008 56.112,11.28 C57.264,11.536 58.1,11.78 58.62,12.012 C59.14,12.244 59.4,12.6 59.4,13.08 C59.4,13.992 58.488,14.448 56.664,14.448 C55.704,14.448 54.728,14.296 53.736,13.992 C52.744,13.688 51.872,13.288 51.12,12.792 L51.12,12.792 L49.56,16.296 C50.36,16.856 51.4,17.304 52.68,17.64 C53.96,17.976 55.28,18.144 56.64,18.144 Z M71.856,18.024 C72.48,18.024 73.068,17.96 73.62,17.832 C74.172,17.704 74.64,17.52 75.024,17.28 L75.024,17.28 L73.896,14.088 C73.496,14.36 73.032,14.496 72.504,14.496 C72.088,14.496 71.756,14.364 71.508,14.1 C71.26,13.836 71.136,13.472 71.136,13.008 L71.136,13.008 L71.136,8.688 L74.112,8.688 L74.112,5.28 L71.136,5.28 L71.136,1.896 L66.576,1.896 L66.576,5.28 L64.68,5.28 L64.68,8.688 L66.576,8.688 L66.576,13.056 C66.576,14.704 67.032,15.944 67.944,16.776 C68.856,17.608 70.16,18.024 71.856,18.024 Z M82.248,18.024 C83,18.024 83.712,17.888 84.384,17.616 C85.056,17.344 85.632,16.944 86.112,16.416 L86.112,16.416 L86.112,17.808 L90.456,17.808 L90.456,4.8 L85.896,4.8 L85.896,11.064 C85.896,12.104 85.668,12.876 85.212,13.38 C84.756,13.884 84.168,14.136 83.448,14.136 C82.744,14.136 82.208,13.912 81.84,13.464 C81.472,13.016 81.288,12.304 81.288,11.328 L81.288,11.328 L81.288,4.8 L76.728,4.8 L76.728,12.072 C76.728,14.056 77.228,15.544 78.228,16.536 C79.228,17.528 80.568,18.024 82.248,18.024 Z M99.048,18.024 C100.744,18.024 102.016,17.52 102.864,16.512 L102.864,16.512 L102.864,17.808 L107.208,17.808 L107.208,0 L102.648,0 L102.648,5.928 C101.8,5.032 100.6,4.584 99.048,4.584 C97.864,4.584 96.784,4.856 95.808,5.4 C94.832,5.944 94.06,6.724 93.492,7.74 C92.924,8.756 92.64,9.936 92.64,11.28 C92.64,12.624 92.924,13.808 93.492,14.832 C94.06,15.856 94.832,16.644 95.808,17.196 C96.784,17.748 97.864,18.024 99.048,18.024 Z M100.008,14.4 C99.208,14.4 98.552,14.124 98.04,13.572 C97.528,13.02 97.272,12.256 97.272,11.28 C97.272,10.32 97.528,9.568 98.04,9.024 C98.552,8.48 99.208,8.208 100.008,8.208 C100.808,8.208 101.46,8.48 101.964,9.024 C102.468,9.568 102.72,10.32 102.72,11.28 C102.72,12.256 102.464,13.02 101.952,13.572 C101.44,14.124 100.792,14.4 100.008,14.4 Z M112.368,22.68 C113.728,22.68 114.88,22.356 115.824,21.708 C116.768,21.06 117.568,19.936 118.224,18.336 L118.224,18.336 L123.84,4.8 L119.496,4.8 L116.28,12.744 L113.088,4.8 L108.408,4.8 L113.976,17.976 C113.784,18.36 113.548,18.64 113.268,18.816 C112.988,18.992 112.632,19.08 112.2,19.08 C111.832,19.08 111.468,19.012 111.108,18.876 C110.748,18.74 110.44,18.552 110.184,18.312 L110.184,18.312 L108.6,21.504 C109.032,21.856 109.596,22.14 110.292,22.356 C110.988,22.572 111.68,22.68 112.368,22.68 Z" id=Study fill-opacity=0.85 fill=#FFFFFF></path></g></g></g></svg></div><div class="mobile-header-title is-full-height is-flex is-align-items-center is-flex-shrink-0"><div class="is-full-height hidden" id=postTopicMobile><p class=is-full-height>Schnorr 签名系列：最优轮次的灵活 Schnorr 门限签名（FROST）</p></div></div></div><i class="iconfont icon-icon_search mobile-header-searchIcon"></i><div class=mobile-search-wrap><div class=search-input><input class=pl-3 id=mobile-search-input placeholder=请输入搜索关键词><i class="iconfont icon-icon_search mobile-search-input-btn"></i><button class=mobile-search-input-btn>搜 索</button></div></div></header><div class=mobile-slide-menu><a class=header-activity href=/ >首页</a><a href=/archives>全站目录</a><a href=/tags>标签</a><a href=/maps>地图</a><a href=/mempool>mempool</a><a target=_blank rel=noopener href=https://123btc.org/ >123btc</a><div><p class="slide-menu-theme is-flex is-flex-direction-row is-justify-content-space-between is-align-items-center"><span>主题设置</span><span><i class="iconfont icon-icon_light slide-theme-light hidden"></i><i class="iconfont icon-icon_dark slide-theme-dark hidden"></i></span></p><p class=slide-menu-fontsize><span>字体设置</span><span><i class="iconfont icon-bianzubeifen"></i><i class="iconfont icon-bianzu"></i></span></p></div></div><div class="search-mask hidden"><script src="/js/header.js?v=1682773100887"></script></div><main><main class="container is-max-widescreen content section post-page pt-4"><div class="columns is-flex-desktop is-justify-content-center"><div class="column is-3 silde-bar is-hidden-mobile"><ol class=toc><li class="toc-item toc-level-2"><a class=toc-link href=#%E5%AE%9E%E7%8E%B0-FROST><span class=toc-text>实现 FROST</span></a><ol class=toc-child><li class="toc-item toc-level-3"><a class=toc-link href=#%E5%85%83%E4%BB%B6-1%EF%BC%9A%E5%A4%9A%E9%A1%B9%E5%BC%8F%E6%8F%92%E5%80%BC%E6%B3%95%EF%BC%88Polynomial-Interpolation%EF%BC%89><span class=toc-text>元件 1：多项式插值法（Polynomial Interpolation）</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E5%85%83%E4%BB%B6-2%EF%BC%9AShamir-%E7%A7%81%E9%92%A5%E5%88%86%E4%BA%AB%EF%BC%88Secret-Sharing%EF%BC%89><span class=toc-text>元件 2：Shamir 私钥分享（Secret Sharing）</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E5%85%83%E4%BB%B6-3%EF%BC%9A%E5%88%86%E5%B8%83%E5%BC%8F%E5%AF%86%E9%92%A5%E7%94%9F%E6%88%90><span class=toc-text>元件 3：分布式密钥生成</span></a></li></ol></li><li class="toc-item toc-level-2"><a class=toc-link href=#FROST-%E7%AD%BE%E5%90%8D%E6%B5%81%E7%A8%8B><span class=toc-text>FROST 签名流程</span></a></li></ol></div><div class="column is-9 post-container"><h1 class="mt-0 mb-2" id=postTitle>Schnorr 签名系列：最优轮次的灵活 Schnorr 门限签名（FROST）</h1><div class=page-author><div class="is-flex is-flex-direction-row page-data mr-6"><img class=mr-1 src=/images/default_avatar.png alt="Nadav Kohen"><div class=page-author-info><strong>Nadav Kohen</strong><time class=has-text-grey datetime=2021-12-09T09:52:12.000Z>2021-12-09</time></div></div><div class=is-flex><a href=/tags/ROAST><i class="page-tag mr-1 px-1">ROAST</i></a></div></div><article class="mt-4 post-content"><blockquote><p><em>作者：Nadav Kohen</em></p><p><em>来源：<a target=_blank rel=noopener href=https://suredbits.com/schnorr-applications-frost/ >https://suredbits.com/schnorr-applications-frost/</a></em></p><p><em><a href=https://www.btcstudy.org/2021/12/08/schnorr-applications-threshold-signatures/ >前篇中文译本</a></em></p></blockquote><p>在本系列的上一篇文章中，我们讨论了门限签名方案和用法，这一期我们延续上文的话题，解释 FROST。FROST 可以被认为是 <a target=_blank rel=noopener href=https://suredbits.com/schnorr-applications-musig/ >MuSig</a>（<a href=https://www.btcstudy.org/2021/11/29/schnorr-applications-musig/ >中文译本</a>）利用分布式的密钥生成（distributed key generation）延伸成了门限签名（从 n-n 变成了 t-n）。FROST 在某种意义上是迄今我们所知的最通用的门限签名，因为它有令人惊艳的特点：它所生成的密钥和签名与普通的 Schnorr 单一密钥和签名（在链上）是无法区别的！本文会用非常技术化的语言讲解 FROST，先建立分布式密钥生成的概念，再把它应用到 Schnorr 签名上。</p><details><summary><strong>Schnorr 签名系列</strong></summary><a hef=https://suredbits.com/introduction-to-schnorr-signatures/ >What are Schnorr Signatures – Introduction</a><br><a target=_blank rel=noopener href=https://suredbits.com/schnorr-security-part-1-schnorr-id-protocol/ >Schnorr Signature Security: Part 1 – Schnorr ID Protocol</a><br><a target=_blank rel=noopener href=https://suredbits.com/schnorr-security-part-2-from-id-to-signature/ >Schnorr Signature Security: Part 2 – From IDs to Signatures</a><br><a target=_blank rel=noopener href=https://suredbits.com/schnorr-applications-musig/ >Schnorr Multi-Signatures – MuSig</a><br><a target=_blank rel=noopener href=https://suredbits.com/schnorr-applications-scriptless-scripts/ >Scriptless Scripts – Adaptor Signatures</a><br><a target=_blank rel=noopener href=https://suredbits.com/schnorr-applications-batch-verification/ >Batch Verification</a><br><a target=_blank rel=noopener href=https://suredbits.com/schnorr-applications-threshold-signatures/ >Schnorr Threshold Sigantures</a><br><a target=_blank rel=noopener href=https://suredbits.com/schnorr-applications-frost/ >Flexible Round-Optimized Schnorr Threshold – FROST</a><br><a target=_blank rel=noopener href=https://suredbits.com/schnorr-applications-blind-signatures/ >Schnorr Blind Signatures</a><br><a target=_blank rel=noopener href=https://suredbits.com/the-taproot-upgrade/ >Taproot Upgrade – Activating Schnorr</a></details><br><h2 id=实现-FROST><a href=#实现-FROST class=headerlink title="实现 FROST"></a>实现 FROST</h2><p><a target=_blank rel=noopener href=https://eprint.iacr.org/2020/852.pdf>最优轮次的灵活 Schnorr 门限签名（FROST）</a>的构造是非常优雅的，并且依赖于我们本系列还没讲过的一些密码学和数学元件。我准备一点一点构造出 FROST（或者说其简化的版本），不要求读者熟悉这里的任何一个概念。但还是要说一句，如果你还不熟悉这里的数学，请读慢一点，花点时间来理解它们。</p><h3 id=元件-1：多项式插值法（Polynomial-Interpolation）><a href=#元件-1：多项式插值法（Polynomial-Interpolation） class=headerlink title="元件 1：多项式插值法（Polynomial Interpolation）"></a>元件 1：多项式插值法（Polynomial Interpolation）</h3><p>MuSig 这样的 n-n 方案可以使用公有密钥的加法碎片（即，聚合密钥就是各参与者密钥的加法和），但 t-n 的门限方案必须使用一些构造来让任意 t 方都可以控制共有密钥。我们没法使用把参与者的密钥直接加起来的方案，因为这样一来，要想控制总和密钥并签名就必须每个人都参与了。具体来说，我们需要一种数学对象，n 个参与者各自持有一部分消息，但只要其中任意 t 个参与者一起，就可以计算出这个对象。</p><p>事实证明，我们总是可以使用多项式来实现这种对象。所谓多项式，就是一条平面上的一条曲线，包含了所有满足等式 $y &#x3D; a_nx^n + a_{n-1}x^{n-1} + … + a_2x^2 + a_1x + a_0$ 的 （x, y)，其中系数 a<sub>n</sub>, … , a<sub>0</sub> 都是一些定值（模 p）。给定 a<sub>n</sub> 不为 0，我们称 n 为这个多项式的阶数。那么一个阶数为 1 e多项式可以写成 $y &#x3D; a_1x + a_0$ 。<a target=_blank rel=noopener href=https://www.desmos.com/calculator/nproi7ulnj>这里有一个绘图网站</a>，你可以输入多项式来观察其图像，感受一下。事实上，任何一个 n 阶多项式，都可以由 n+1 个点来唯一确定（如果你感兴趣，<a target=_blank rel=noopener href=https://math.stackexchange.com/questions/837902/prove-there-exists-a-unique-n-th-degree-polynomial-that-passes-through-n1-p>这里有许多证明</a>）。因此，给定 n+1 个点 $(1, y_1), … , (n+1, y_{n+1})$ ，我们就能确定唯一一个包含了这些点的 n 阶多项式，方法如下：</p><ol><li><p>对于 i &#x3D; 1, … , n+1，令<br>$$P_i(x) &#x3D; \prod ^{n+1} _ {j&#x3D;1, j\neq i} (x - j)&#x3D; (x - 1)(x - 2)…(x - (i-1))(x - (i+1))…(x - (n+1))$$<br>也就是对所有不等于 i 的 j，(x - j) 的乘积</p></li><li><p>定义</p></li></ol><p>$$P(x) &#x3D; \sum_{i &#x3D; 1}^{n+1} y_i \prod ^{n+1} _ {j&#x3D;1, j\neq i} \frac{x - j}{i - j} &#x3D; \sum_ {i &#x3D; 1}^{n+1} y_i \frac{P_ i(x)}{P_i(i)}$$</p><p>$$ &#x3D; y_1\frac{P_1(x)}{P_1(1)} + y_2\frac{P_2(x)}{P_2(2)} + … + y _ {n+1}\frac{P_{n+1}(x)}{P _ {n+1}(n+1)}$$</p><p>注意，对于等于 1, … , n + 1 的任一 i，都有 $P(i) &#x3D; 0 + 0 + 0 + … + 0 + y_i\frac{P_i(i)}{P_i(i)} + 0 + … + 0 &#x3D; y_i$ ，这就意味着 P(x) 必定是个独一无二的多项式。</p><p>我们已经知道了，如何根据给定 n+1 个点，构造出完整的 n 阶多项式。这个过程叫做多项式插值法。值得注意的是，我们可以在上述共识中代入 0 从而计算出 P(0)</p><p>$$P(0) &#x3D; \sum_{i&#x3D;1}^{n+1}y_i λ _ i &#x3D; y_1λ _ 1 + y_2λ _ 2 + … + y _ {n+1}λ _ {n+1}$$</p><p>这里的 $λ _ i &#x3D; \prod ^{n+1} _ {j&#x3D;1, j\neq i} \frac{j}{j-i} &#x3D; (\frac{1}{1-i})(\frac{2}{2-i})…(\frac{n+1}{n+1-i})$（跳过了第 i 项）是一个常数。</p><h3 id=元件-2：Shamir-私钥分享（Secret-Sharing）><a href=#元件-2：Shamir-私钥分享（Secret-Sharing） class=headerlink title="元件 2：Shamir 私钥分享（Secret Sharing）"></a>元件 2：Shamir 私钥分享（Secret Sharing）</h3><p>就像我上面所说的，私钥分享（也即私钥分割）就是让 n 个参与者每人都拥有私钥的一些 “碎片（份额）”，而参与者可以按某种方式计算出底层的共有私钥。举个例子，假如我在手机上存放着私钥 x，但我担心手机会丢，于是我找了三个信得过的朋友，给了他们每人一个我的私钥的碎片：我分别给了两给朋友 a 和 b，都是随机数（模 p），而第三个朋友我给了他 (x - a - b)，看起来也像无意义的随机数。现在，即使我的朋友串通了起来，也无法知道关于 x 的信息，而假如我真的弄丢了手机，需要找回私钥时，我可以让他们把手上的随机数交回给我，三者相加即是我原来的私钥。</p><p>上面这个例子演示的方案通常被称为相加型私钥分割。它可能是最简单的私钥分割方案，但它有个缺点，它只能用于 n-n 的密钥分享，不支持门限设置。而且，只要有一个人弄丢了手上的碎片，其他人手上的也就失效了。</p><p>反过来，我可以构造一条直线 f，其 y 轴截距就是我的私钥，f(0) &#x3D; x。我可以给我的朋友们 3 个点：( 1, f(1) )，( 2, f(2) )，( 3, f(3) )。相应地，我只需要请求两个朋友给我他们手上的碎片，即可使用上面的插值法计算出我的私钥！更一般化地来说，假设我需要给 n 个朋友分享私钥并希望设置 t &lt; n 的门限，我们可以构造出一个 t-1 阶的多项式，并给每个朋友一个（多项式曲线上的）点。这个多项式的诸系数 a<sub>i</sub> 可以都使用随机数，除了 a<sub>0</sub> 要设置成你的私钥。这种方案叫做 “Shamir 密钥分割”。</p><p>属于参与者集合的任意子集 S &#x3D; {k<sub>1</sub>, … , k<sub>t</sub>} 的相应 Shamir 碎片 y<sub>k1</sub>, … , y<sub>kt</sub>，令 y<sub>ki</sub> 与 $λ _ i &#x3D; \prod ^{n+1} _ {j&#x3D;1, j\neq i} \frac{j}{j-i}$ 相乘得出相加型碎片，因为共有密钥</p><p>$$f(0) &#x3D; y _ {k1}λ _ {k1} + y _ {k2}λ _ {k2} + … + y _ {kt}λ _ {k1t}$$</p><p>迄今为止，我们只考虑到了有可信发起者（trusted dealer）的私钥分割情形，但我们还需要一种分割方案，在我们希望恢复出共有私钥时不那么需要信任。这样的方案叫做 “可验证的私钥分割方案”。假设我是个不可信的发起者（untrusted dealer），我要跟 n 个不信任我的参与者形成一个 t-n 的私钥分割。我像上面那样做了 Shamir 私钥分割（给了每个参与者 t-1 阶的多项式曲线上的一个点），此外，我还向所有人都广播了我的多项式的每个系数的公钥，即 A<sub>0</sub> &#x3D; a<sub>0</sub> * G，…，A<sub>t-1</sub> &#x3D; a<sub>t-1</sub> * G。在收到一个碎片( i, f(i) ) 之后，每个人都可以检查 f(i) * G 是否等于 $i^{t-1} * A_{t-1} + … + i * A_1 + A_0$ 来验证自己的碎片。任何一方，如果发现这个验证不通过，他们就可以告诉所有其他人并公开自己的碎片。其他所有人也都公开自己的份额，这样就可以计算出那个多项式，以及各系数的公钥。要么发起者搞了鬼，以后大家再也不带他玩；要么那个参与者撒谎了，大家一起排挤他。无论如何，只有所有人都是诚实的，这个过程才继续；任何人尝试欺诈，过程就终止。</p><h3 id=元件-3：分布式密钥生成><a href=#元件-3：分布式密钥生成 class=headerlink title="元件 3：分布式密钥生成"></a>元件 3：分布式密钥生成</h3><p>现在，最有意思的部分来啦！我们已经有了可验证的门限私钥分割方案，可以通过一个叫做 “分布式密钥生成” 的流程来创建一个共有私钥了。注意，迄今为止，我们讲的都是如何把发起者已经知道的私钥 x 分割给多方，现在，我们要讨论的是如何构造一个没有任何一方完整掌握的私钥。</p><p>可以这样来实现：所有 n 方异步地生成一个随机秘密值，所有 n 方都对自己的秘密值做一次可验证的密钥分割。完成之后，所有的碎片都得到了验证，每一方都可以把自己手上所有碎片的 y 值加总起来，获得聚合多项式的一个碎片。注意，如果 f(x) 和 g(x) 是两个多项式，那么 (f+g)(x) 就是两个多项式的和，并且 f(i) + g(i) &#x3D; (f+g)(i)；所以，各碎片的总和就是多项式总和的一个碎片。因此，在整个流程结束之后，各方都拥有了聚合多项式的一个碎片；这个聚合多项式就存储着所有人秘密值的和，因为 $f_1(0) + f_2(0) + … + f_n(0) &#x3D; (f_1 + f_2 + … + f_n)(0)$。更进一步地，只要每一方的多项式都是 t-1 阶的，聚合多项式也会拥有相同的阶数，所以聚合多项式将支持 t-n 门限方案！</p><p>我们再用更多细节来过一遍。每一个参与者都有唯一的身份号码，从 1 到 n。参与者 i 通过生成 t 个随机秘密值 $a _ {i0}, … , a _ {i(t-1)}$ 作为系数来生成一个随机的、t-1 阶的多项式。下一步，每一方都被要求提供对 a<sub>i0</sub> 的知识证明，因为这是他们对共有私钥的贡献。这是使用<a target=_blank rel=noopener href=https://suredbits.com/schnorr-security-part-1-schnorr-id-protocol/ >非交互式 Schnorr ID 协议</a>来证明的，使用一个随机 nonce 值 k<sub>i</sub>，并使用其个人 ID（i）、公钥 a<sub>i0</sub> * G ， k<sub>i</sub> * G 和所有其它与分布式密钥生成协议相关的语境的哈希值来作为挑战值 c<sub>i</sub> 。即，$sig_i &#x3D; (k_i * G, k_i + c _ ia _ {i0})$。每一个参与者都向其他所有人广播自己的签名以及自己的多项式所有系数的公钥 $a _ {i0} * G, … , a _ {i(t-1)} * G$。收到这些值后，所有参与者都验证其他人的签名。这是第一轮的交互。</p><p>在第二轮交互中，每一个参与者都安全地向其他每一位参与者发送碎片 (i, f<sub>k</sub>(i))，这里的 k 是发送方的 id，而 k 是接收方的 id。这样，i 就可以使用 k 在上一轮中公开的系数公钥来验证得到的碎片。接收完所有对手方的碎片之后，每一个参与者都计算 $s_i &#x3D; f_1(i) + … + f_n(i)$，这个 s<sub>i</sub> 就是 TA 所掌握的聚合私钥的碎片。</p><p>这个分布式密钥生成（DKG）协议只要求两轮的交互，交互完之后，每一方都有了这个持久的（门限）聚合私钥的一个有效碎片（而且，因为有了第一轮中各参与者公布的自己的多项式系数的公钥，每个人都能计算其他人的公钥 s<sub>i</sub> * G，并相应得到聚合公钥，就是这些公钥的和）。</p><h2 id=FROST-签名流程><a href=#FROST-签名流程 class=headerlink title="FROST 签名流程"></a>FROST 签名流程</h2><p>现在，我们已经准备好构造一些门限签名了！我们假设 n 各参与方在过去已经根据上面的流程，创建了一个 t-n 的门限共有私钥，且每个人都拥有一个有效碎片。</p><p>我们从一个预备轮开始，这一轮可以预先完成（比如在密钥生成的时候），但也可以作为额外的一轮，在签名之前完成。在这一轮中，参与者 i 创建一个随机的一次性 nonce 对 $(d _ {i1}, e _ {i1}), (d _ {i2}, e _ {i2}), … , (d _ {iπ}, e _ {iπ})$，其中 π 是这个参与者再次执行预处理轮之前可以参与生成签名的次数；然后为这些一次性秘密值发布相应的公钥 $(D _ {ij}, E _ {ij})$。</p><p>假设一个分布式密钥已经生成，预处理也做完了，我们已经完成了签名消息 m 的准备工作。一些参与者（比如其中一个签名者）要扮演签名聚合人（SA）的角色，选出一组 t 个签名者（一般来说也包括他们自己），记这个 id 列表为 S。这个 SA 也要负责为每个签名者检索尚未使用的公钥 $(D_{ij}, E_{ij})$，我们把这个列表记为 B。SA 会把 B 和 m 发给 S 中的每个人。对于 S 中的每个 k，一个绑定值 ρ<sub>i</sub> 定义成 i、B 和消息的哈希值（使用 B 是为了承诺这个人和所有其他人的 nonce）。这些绑定值是所有签名者都要计算的。而这次签名的聚合 nonce 值 R，等于 S 中的每个 k 的点 $D _ {ki} + ρ _ k * E _ {kj}$ 的和，而相应地，被签名的挑战哈希值就是聚合公钥、R 和消息三者的哈希值。</p><p>此时，每一个签名者在使用手上的持久私钥碎片 s<sub>i</sub>（来自 DKG）来创建碎片签名（partial signature）。因为 s<sub>i</sub> 在上面已经用了（代表私钥），我们使用 z<sub>i</sub> 来表示碎片签名：</p><p>$$z_i &#x3D; d _ {ij} + ρ _ i * e _ {ij} + H(X, R, m) * s_i * λ _ i$$</p><p>注意，这是一个 Schnorr 碎片签名，是使用一次性私钥 $d _ {ij} + ρ _ i * e _ {ij}$ 和私钥 $s_i * λ _ i$ 对消息 m 签出来的。你应该记得，$λ _ i$ 是一个常数，是为了让任何可能的 S 将 Shamir 私钥碎片转化成相加碎片（即，聚合私钥就等于 t 个 $s_i * λ _ i$ 的和）（在多项式插值法一节里）。</p><p>签名聚合者 SA 收到所有这些碎片签名后一一验证。假设所有碎片签名都能通过验证，SA 就把所有签名简单加总：</p><p>$$z &#x3D; z_1 + … + z_t$$</p><p>最终的 (R, z) 就是一个有效的 Schnorr 签名，是属于从最开始的 DKG 中生成的（门限）聚合密钥的签名。</p><p>好了，我们对 Schnorr 门限签名的讨论就结束了。敬请期待未来关于 Schnorr 盲签名和 Taproot 的篇章。</p><p>（完）</p><blockquote><p><em><a href=https://www.btcstudy.org/2021/12/13/schnorr-applications-blind-signatures/ >后篇中文译本</a></em></p></blockquote></article></div></div></main><script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.8/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><script>MathJax.Hub.Config({tex2jax:{inlineMath:[["$","$"],["\\(","\\)"]],processEscapes:!0,skipTags:["script","noscript","style","textarea","pre","code"]}}),MathJax.Hub.Queue(function(){for(var a=MathJax.Hub.getAllJax(),e=0;e<a.length;e+=1)a[e].SourceElement().parentNode.className+=" has-jax"})</script><script src="/js/post.js?v=1682773100887"></script><script src="/js/highlight.min.js?v=1682773100887"></script><script>var containerEl=document.querySelector(".post-container"),postFontSize=localStorage.getItem("post-font-size")||"16",inputEl=document.querySelector("#size-change-input"),inputEl2=document.querySelector("#size-change-input2");inputEl.value=postFontSize,inputEl2.value=postFontSize,containerEl.style.fontSize=postFontSize+"px",$(function(){function e(t){$(".post-container").css("font-size",t+"px"),localStorage.setItem("post-font-size",t),$("#size-change-input").val(t),$("#size-change-input2").val(t)}$("#size-change-input").on("input propertychange",function(t){e(t.target.value)}),$("#size-change-input2").on("input propertychange",function(t){e(t.target.value)})})</script><script>hljs.initHighlightingOnLoad()</script></main></div><footer class="is-flex is-flex-direction-column is-align-items-center is-flex-shrink-0"><section class=sns-container><a title=nostr target=_blank rel="noopener nofollow" href=https://iris.to/npub1g2qs0ca5kpwlrcfug2em4jelmh65clk3yccwjxrs6hvdpd9qj80q022j4m>Nostr</a><a title=rss target=_blank rel="noopener nofollow" href=/atom.xml>rss</a><a title=telegram target=_blank rel="noopener nofollow" href=//t.me/btcstudyorg>Telegram</a></section></footer><script async src="/js/buttons.js?v=1682773100887"></script><script async src="/js/index.js?v=1682773100887"></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-JVCJ9XXG1Z"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-JVCJ9XXG1Z")</script><script>var _hmt=_hmt||[];(()=>{var e=document.createElement("script"),t=(e.src="https://hm.baidu.com/hm.js?c92c073c85be5be8d9b1b76f62a7e306",e.async=!0,e.defer=!0,document.getElementsByTagName("script")[0]);t.parentNode.insertBefore(e,t)})()</script></body></html>