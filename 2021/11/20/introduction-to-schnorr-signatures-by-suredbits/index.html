<!DOCTYPE html><html lang=zh-CN><head><meta charset=UTF-8><title>Schnorr 签名系列：简介</title><meta name=keywords content="比特币, 中本聪, 比特币区块链, 闪电网络, 比特币 layer 2, 健全货币, 密码货币, 密码朋克, 学习比特币, BTC, BTC Study, Bitcoin, bitcoin, proof of work"><meta name=description content=比特币思想的中文集结地><meta name=viewport content="width=device-width,minimum-scale=1,maximum-scale=1,initial-scale=1"><link rel=icon href=/favicon.ico><link rel=stylesheet href="/style/common/bulma.css?v=1682773100887"><link rel=preload as=style onload='this.onload=null,this.rel="stylesheet"' href="/style/common/iconfont.css?v=1682773100887"><link rel=stylesheet href="/style/base.css?v=1682773100887"><link rel=stylesheet href="/style/common/helper.css?v=1682773100887"><link rel=stylesheet href="/style/themes/animation.css?v=1682773100887"><script>function ready(){var e=document.querySelector(".body-container"),t=localStorage.getItem("theme")||"light";["light","dark"].includes(t)||(t="light",localStorage.setItem("theme","light")),e.classList.remove("appearance-auto"),e.classList.add("appearance-"+t),quickInitialTheme()}function quickInitialTheme(){var e=localStorage.getItem("theme")||"light",t=document.querySelector(".logo-light"),o=document.querySelector(".logo-dark"),d=document.querySelector("#mobile-header-logo > .logo-light"),l=document.querySelector("#mobile-header-logo > .logo-dark"),a=document.getElementById("theme-btn"),i=document.querySelector(".slide-theme-light"),c=document.querySelector(".slide-theme-dark");document.body.classList.add(e),("dark"===e?(t.classList.add("hidden"),o.classList.remove("hidden"),d.classList.add("hidden"),l.classList.remove("hidden"),a.classList.remove("icon-icon_dark"),a.classList.add("icon-icon_light"),i):c).classList.remove("hidden")}document.addEventListener("DOMContentLoaded",ready)</script><script src="/js/common.js?v=1682773100887"></script><script src=/js/libs/zepto.min.js></script><link rel=stylesheet href="/style/post.css?v=1682773100887"><link rel=stylesheet href="/style/themes/highlight.css?v=1682773100887"><meta name=generator content="Hexo 6.3.0"><link rel=alternate href=/atom.xml title="BTC Study" type=application/atom+xml></head><body class="is-flex is-flex-direction-column" onload=initialTheme()><div class=clip></div><div class="body-container appearance-auto"><header class="header-widget is-hidden-mobile is-flex is-flex-shrink-0 is-align-items-center is-justify-content-center" id=header><div class="is-flex header-widget-container is-flex-shrink-0 is-align-items-center"><section class="is-hidden-mobile is-flex-shrink-0"><h1><a href=/ ><svg class=logo-light width=125px height=23px viewBox="0 0 125 23" version=1.1 xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink><title>BTCStudy</title><g id=页面-1 stroke=none stroke-width=1 fill=none fill-rule=evenodd><g id=首页-响应式 transform="translate(-249.000000, -23.000000)" fill-rule=nonzero><g id=BTCStudy transform="translate(249.680000, 23.192000)"><path d="M9.072,17.808 C11.312,17.808 13.024,17.408 14.208,16.608 C15.392,15.808 15.984,14.672 15.984,13.2 C15.984,12.192 15.712,11.332 15.168,10.62 C14.624,9.908 13.872,9.384 12.912,9.048 C13.632,8.68 14.188,8.18 14.58,7.548 C14.972,6.916 15.168,6.2 15.168,5.4 C15.168,4.056 14.608,2.988 13.488,2.196 C12.368,1.404 10.736,1.008 8.592,1.008 L8.592,1.008 L-5.68434189e-14,1.008 L-5.68434189e-14,17.808 L9.072,17.808 Z M7.968,7.68 L4.704,7.68 L4.704,4.44 L7.968,4.44 C9.568,4.44 10.368,4.976 10.368,6.048 C10.368,7.136 9.568,7.68 7.968,7.68 L7.968,7.68 Z M8.688,14.376 L4.704,14.376 L4.704,10.968 L8.688,10.968 C10.352,10.968 11.184,11.536 11.184,12.672 C11.184,13.808 10.352,14.376 8.688,14.376 L8.688,14.376 Z M26.544,17.808 L26.544,4.776 L31.68,4.776 L31.68,1.008 L16.632,1.008 L16.632,4.776 L21.792,4.776 L21.792,17.808 L26.544,17.808 Z M41.592,18.144 C43.128,18.144 44.512,17.872 45.744,17.328 C46.976,16.784 48,16 48.816,14.976 L48.816,14.976 L45.792,12.24 C44.704,13.552 43.384,14.208 41.832,14.208 C40.92,14.208 40.108,14.008 39.396,13.608 C38.684,13.208 38.132,12.644 37.74,11.916 C37.348,11.188 37.152,10.352 37.152,9.408 C37.152,8.464 37.348,7.628 37.74,6.9 C38.132,6.172 38.684,5.608 39.396,5.208 C40.108,4.808 40.92,4.608 41.832,4.608 C43.384,4.608 44.704,5.264 45.792,6.576 L45.792,6.576 L48.816,3.84 C48,2.816 46.976,2.032 45.744,1.488 C44.512,0.944 43.128,0.672 41.592,0.672 C39.832,0.672 38.252,1.044 36.852,1.788 C35.452,2.532 34.352,3.568 33.552,4.896 C32.752,6.224 32.352,7.728 32.352,9.408 C32.352,11.088 32.752,12.592 33.552,13.92 C34.352,15.248 35.452,16.284 36.852,17.028 C38.252,17.772 39.832,18.144 41.592,18.144 Z" id=BTC fill=#F2A900></path><path d="M56.64,18.144 C58.24,18.144 59.6,17.9 60.72,17.412 C61.84,16.924 62.68,16.272 63.24,15.456 C63.8,14.64 64.08,13.728 64.08,12.72 C64.08,11.552 63.772,10.628 63.156,9.948 C62.54,9.268 61.812,8.772 60.972,8.46 C60.132,8.148 59.072,7.856 57.792,7.584 C56.656,7.344 55.832,7.112 55.32,6.888 C54.808,6.664 54.552,6.328 54.552,5.88 C54.552,5.432 54.768,5.068 55.2,4.788 C55.632,4.508 56.32,4.368 57.264,4.368 C58.768,4.368 60.32,4.8 61.92,5.664 L61.92,5.664 L63.384,2.136 C62.568,1.656 61.624,1.292 60.552,1.044 C59.48,0.796 58.392,0.672 57.288,0.672 C55.672,0.672 54.308,0.912 53.196,1.392 C52.084,1.872 51.248,2.524 50.688,3.348 C50.128,4.172 49.848,5.096 49.848,6.12 C49.848,7.288 50.152,8.216 50.76,8.904 C51.368,9.592 52.096,10.092 52.944,10.404 C53.792,10.716 54.848,11.008 56.112,11.28 C57.264,11.536 58.1,11.78 58.62,12.012 C59.14,12.244 59.4,12.6 59.4,13.08 C59.4,13.992 58.488,14.448 56.664,14.448 C55.704,14.448 54.728,14.296 53.736,13.992 C52.744,13.688 51.872,13.288 51.12,12.792 L51.12,12.792 L49.56,16.296 C50.36,16.856 51.4,17.304 52.68,17.64 C53.96,17.976 55.28,18.144 56.64,18.144 Z M71.856,18.024 C72.48,18.024 73.068,17.96 73.62,17.832 C74.172,17.704 74.64,17.52 75.024,17.28 L75.024,17.28 L73.896,14.088 C73.496,14.36 73.032,14.496 72.504,14.496 C72.088,14.496 71.756,14.364 71.508,14.1 C71.26,13.836 71.136,13.472 71.136,13.008 L71.136,13.008 L71.136,8.688 L74.112,8.688 L74.112,5.28 L71.136,5.28 L71.136,1.896 L66.576,1.896 L66.576,5.28 L64.68,5.28 L64.68,8.688 L66.576,8.688 L66.576,13.056 C66.576,14.704 67.032,15.944 67.944,16.776 C68.856,17.608 70.16,18.024 71.856,18.024 Z M82.248,18.024 C83,18.024 83.712,17.888 84.384,17.616 C85.056,17.344 85.632,16.944 86.112,16.416 L86.112,16.416 L86.112,17.808 L90.456,17.808 L90.456,4.8 L85.896,4.8 L85.896,11.064 C85.896,12.104 85.668,12.876 85.212,13.38 C84.756,13.884 84.168,14.136 83.448,14.136 C82.744,14.136 82.208,13.912 81.84,13.464 C81.472,13.016 81.288,12.304 81.288,11.328 L81.288,11.328 L81.288,4.8 L76.728,4.8 L76.728,12.072 C76.728,14.056 77.228,15.544 78.228,16.536 C79.228,17.528 80.568,18.024 82.248,18.024 Z M99.048,18.024 C100.744,18.024 102.016,17.52 102.864,16.512 L102.864,16.512 L102.864,17.808 L107.208,17.808 L107.208,0 L102.648,0 L102.648,5.928 C101.8,5.032 100.6,4.584 99.048,4.584 C97.864,4.584 96.784,4.856 95.808,5.4 C94.832,5.944 94.06,6.724 93.492,7.74 C92.924,8.756 92.64,9.936 92.64,11.28 C92.64,12.624 92.924,13.808 93.492,14.832 C94.06,15.856 94.832,16.644 95.808,17.196 C96.784,17.748 97.864,18.024 99.048,18.024 Z M100.008,14.4 C99.208,14.4 98.552,14.124 98.04,13.572 C97.528,13.02 97.272,12.256 97.272,11.28 C97.272,10.32 97.528,9.568 98.04,9.024 C98.552,8.48 99.208,8.208 100.008,8.208 C100.808,8.208 101.46,8.48 101.964,9.024 C102.468,9.568 102.72,10.32 102.72,11.28 C102.72,12.256 102.464,13.02 101.952,13.572 C101.44,14.124 100.792,14.4 100.008,14.4 Z M112.368,22.68 C113.728,22.68 114.88,22.356 115.824,21.708 C116.768,21.06 117.568,19.936 118.224,18.336 L118.224,18.336 L123.84,4.8 L119.496,4.8 L116.28,12.744 L113.088,4.8 L108.408,4.8 L113.976,17.976 C113.784,18.36 113.548,18.64 113.268,18.816 C112.988,18.992 112.632,19.08 112.2,19.08 C111.832,19.08 111.468,19.012 111.108,18.876 C110.748,18.74 110.44,18.552 110.184,18.312 L110.184,18.312 L108.6,21.504 C109.032,21.856 109.596,22.14 110.292,22.356 C110.988,22.572 111.68,22.68 112.368,22.68 Z" id=Study fill-opacity=0.85 fill=#000000></path></g></g></g></svg><svg class="logo-dark hidden" width=125px height=23px viewBox="0 0 125 23" version=1.1 xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink><title>BTCStudy</title><g id=页面-1 stroke=none stroke-width=1 fill=none fill-rule=evenodd><g id=首页-响应式 transform="translate(-249.000000, -23.000000)" fill-rule=nonzero><g id=BTCStudy transform="translate(249.680000, 23.192000)"><path d="M9.072,17.808 C11.312,17.808 13.024,17.408 14.208,16.608 C15.392,15.808 15.984,14.672 15.984,13.2 C15.984,12.192 15.712,11.332 15.168,10.62 C14.624,9.908 13.872,9.384 12.912,9.048 C13.632,8.68 14.188,8.18 14.58,7.548 C14.972,6.916 15.168,6.2 15.168,5.4 C15.168,4.056 14.608,2.988 13.488,2.196 C12.368,1.404 10.736,1.008 8.592,1.008 L8.592,1.008 L-5.68434189e-14,1.008 L-5.68434189e-14,17.808 L9.072,17.808 Z M7.968,7.68 L4.704,7.68 L4.704,4.44 L7.968,4.44 C9.568,4.44 10.368,4.976 10.368,6.048 C10.368,7.136 9.568,7.68 7.968,7.68 L7.968,7.68 Z M8.688,14.376 L4.704,14.376 L4.704,10.968 L8.688,10.968 C10.352,10.968 11.184,11.536 11.184,12.672 C11.184,13.808 10.352,14.376 8.688,14.376 L8.688,14.376 Z M26.544,17.808 L26.544,4.776 L31.68,4.776 L31.68,1.008 L16.632,1.008 L16.632,4.776 L21.792,4.776 L21.792,17.808 L26.544,17.808 Z M41.592,18.144 C43.128,18.144 44.512,17.872 45.744,17.328 C46.976,16.784 48,16 48.816,14.976 L48.816,14.976 L45.792,12.24 C44.704,13.552 43.384,14.208 41.832,14.208 C40.92,14.208 40.108,14.008 39.396,13.608 C38.684,13.208 38.132,12.644 37.74,11.916 C37.348,11.188 37.152,10.352 37.152,9.408 C37.152,8.464 37.348,7.628 37.74,6.9 C38.132,6.172 38.684,5.608 39.396,5.208 C40.108,4.808 40.92,4.608 41.832,4.608 C43.384,4.608 44.704,5.264 45.792,6.576 L45.792,6.576 L48.816,3.84 C48,2.816 46.976,2.032 45.744,1.488 C44.512,0.944 43.128,0.672 41.592,0.672 C39.832,0.672 38.252,1.044 36.852,1.788 C35.452,2.532 34.352,3.568 33.552,4.896 C32.752,6.224 32.352,7.728 32.352,9.408 C32.352,11.088 32.752,12.592 33.552,13.92 C34.352,15.248 35.452,16.284 36.852,17.028 C38.252,17.772 39.832,18.144 41.592,18.144 Z" id=BTC fill=#F2A900></path><path d="M56.64,18.144 C58.24,18.144 59.6,17.9 60.72,17.412 C61.84,16.924 62.68,16.272 63.24,15.456 C63.8,14.64 64.08,13.728 64.08,12.72 C64.08,11.552 63.772,10.628 63.156,9.948 C62.54,9.268 61.812,8.772 60.972,8.46 C60.132,8.148 59.072,7.856 57.792,7.584 C56.656,7.344 55.832,7.112 55.32,6.888 C54.808,6.664 54.552,6.328 54.552,5.88 C54.552,5.432 54.768,5.068 55.2,4.788 C55.632,4.508 56.32,4.368 57.264,4.368 C58.768,4.368 60.32,4.8 61.92,5.664 L61.92,5.664 L63.384,2.136 C62.568,1.656 61.624,1.292 60.552,1.044 C59.48,0.796 58.392,0.672 57.288,0.672 C55.672,0.672 54.308,0.912 53.196,1.392 C52.084,1.872 51.248,2.524 50.688,3.348 C50.128,4.172 49.848,5.096 49.848,6.12 C49.848,7.288 50.152,8.216 50.76,8.904 C51.368,9.592 52.096,10.092 52.944,10.404 C53.792,10.716 54.848,11.008 56.112,11.28 C57.264,11.536 58.1,11.78 58.62,12.012 C59.14,12.244 59.4,12.6 59.4,13.08 C59.4,13.992 58.488,14.448 56.664,14.448 C55.704,14.448 54.728,14.296 53.736,13.992 C52.744,13.688 51.872,13.288 51.12,12.792 L51.12,12.792 L49.56,16.296 C50.36,16.856 51.4,17.304 52.68,17.64 C53.96,17.976 55.28,18.144 56.64,18.144 Z M71.856,18.024 C72.48,18.024 73.068,17.96 73.62,17.832 C74.172,17.704 74.64,17.52 75.024,17.28 L75.024,17.28 L73.896,14.088 C73.496,14.36 73.032,14.496 72.504,14.496 C72.088,14.496 71.756,14.364 71.508,14.1 C71.26,13.836 71.136,13.472 71.136,13.008 L71.136,13.008 L71.136,8.688 L74.112,8.688 L74.112,5.28 L71.136,5.28 L71.136,1.896 L66.576,1.896 L66.576,5.28 L64.68,5.28 L64.68,8.688 L66.576,8.688 L66.576,13.056 C66.576,14.704 67.032,15.944 67.944,16.776 C68.856,17.608 70.16,18.024 71.856,18.024 Z M82.248,18.024 C83,18.024 83.712,17.888 84.384,17.616 C85.056,17.344 85.632,16.944 86.112,16.416 L86.112,16.416 L86.112,17.808 L90.456,17.808 L90.456,4.8 L85.896,4.8 L85.896,11.064 C85.896,12.104 85.668,12.876 85.212,13.38 C84.756,13.884 84.168,14.136 83.448,14.136 C82.744,14.136 82.208,13.912 81.84,13.464 C81.472,13.016 81.288,12.304 81.288,11.328 L81.288,11.328 L81.288,4.8 L76.728,4.8 L76.728,12.072 C76.728,14.056 77.228,15.544 78.228,16.536 C79.228,17.528 80.568,18.024 82.248,18.024 Z M99.048,18.024 C100.744,18.024 102.016,17.52 102.864,16.512 L102.864,16.512 L102.864,17.808 L107.208,17.808 L107.208,0 L102.648,0 L102.648,5.928 C101.8,5.032 100.6,4.584 99.048,4.584 C97.864,4.584 96.784,4.856 95.808,5.4 C94.832,5.944 94.06,6.724 93.492,7.74 C92.924,8.756 92.64,9.936 92.64,11.28 C92.64,12.624 92.924,13.808 93.492,14.832 C94.06,15.856 94.832,16.644 95.808,17.196 C96.784,17.748 97.864,18.024 99.048,18.024 Z M100.008,14.4 C99.208,14.4 98.552,14.124 98.04,13.572 C97.528,13.02 97.272,12.256 97.272,11.28 C97.272,10.32 97.528,9.568 98.04,9.024 C98.552,8.48 99.208,8.208 100.008,8.208 C100.808,8.208 101.46,8.48 101.964,9.024 C102.468,9.568 102.72,10.32 102.72,11.28 C102.72,12.256 102.464,13.02 101.952,13.572 C101.44,14.124 100.792,14.4 100.008,14.4 Z M112.368,22.68 C113.728,22.68 114.88,22.356 115.824,21.708 C116.768,21.06 117.568,19.936 118.224,18.336 L118.224,18.336 L123.84,4.8 L119.496,4.8 L116.28,12.744 L113.088,4.8 L108.408,4.8 L113.976,17.976 C113.784,18.36 113.548,18.64 113.268,18.816 C112.988,18.992 112.632,19.08 112.2,19.08 C111.832,19.08 111.468,19.012 111.108,18.876 C110.748,18.74 110.44,18.552 110.184,18.312 L110.184,18.312 L108.6,21.504 C109.032,21.856 109.596,22.14 110.292,22.356 C110.988,22.572 111.68,22.68 112.368,22.68 Z" id=Study fill-opacity=0.85 fill=#FFFFFF></path></g></g></g></svg></a></h1></section><div class="is-flex is-flex-direction-column header-menu-wrap"><aside class="is-flex-shrink-0 is-flex is-flex-direction-row is-align-items-center" id=header-menu><a class="is-inline-block header-activity mr-4" href=/ >首页</a><a class="is-inline-block mr-4" href=/archives>全站目录</a><a class="is-inline-block mr-4" href=/tags>标签</a><a class="is-inline-block mr-4" href=/maps>地图</a><a class="is-inline-block mr-4" href=/mempool>mempool</a><a class="is-inline-block mr-4" target=_blank rel=noopener href=https://123btc.org/ >123btc</a><div class="right-content is-flex is-flex-direction-row is-align-items-center"><div class="size-wrap mr-1"><i class="iconfont icon-a-bianzu5" id=change-size-btn></i><div class=size-input-wrap><div class=input-wrap><input id=size-change-input type=range min=12 max=32 step=2></div></div></div><i class="iconfont icon-icon_dark mr-1" id=theme-btn></i><div class=search-wrap><input class=pl-3 id=search-input placeholder=请输入搜索关键词><i class="iconfont icon-icon_search" id=search-input-btn></i></div></div></aside><div class="header-title is-hidden-mobile is-full-height is-flex is-align-items-center is-flex-shrink-0"><div class="is-full-height hidden" id=postTopic><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">Schnorr 签名系列：简介</p><div class="size-wrap mr-1"><i class="iconfont icon-a-bianzu5" id=change-size-btn2></i><div class=size-input-wrap><div class=input-wrap><input id=size-change-input2 type=range min=12 max=32 step=2></div></div></div></div></div></div></div></header><header class="is-flex header-widget is-flex-shrink-0 is-align-items-center is-justify-content-space-between is-hidden-tablet" id=mobile-header><div class="is-flex is-flex-direction-row is-align-items-center"><i class="iconfont icon-icon_bar mobile-header-menu"></i><div id=mobile-header-logo><svg class=logo-light width=125px height=23px viewBox="0 0 125 23" version=1.1 xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink><title>BTCStudy</title><g id=页面-1 stroke=none stroke-width=1 fill=none fill-rule=evenodd><g id=首页-响应式 transform="translate(-249.000000, -23.000000)" fill-rule=nonzero><g id=BTCStudy transform="translate(249.680000, 23.192000)"><path d="M9.072,17.808 C11.312,17.808 13.024,17.408 14.208,16.608 C15.392,15.808 15.984,14.672 15.984,13.2 C15.984,12.192 15.712,11.332 15.168,10.62 C14.624,9.908 13.872,9.384 12.912,9.048 C13.632,8.68 14.188,8.18 14.58,7.548 C14.972,6.916 15.168,6.2 15.168,5.4 C15.168,4.056 14.608,2.988 13.488,2.196 C12.368,1.404 10.736,1.008 8.592,1.008 L8.592,1.008 L-5.68434189e-14,1.008 L-5.68434189e-14,17.808 L9.072,17.808 Z M7.968,7.68 L4.704,7.68 L4.704,4.44 L7.968,4.44 C9.568,4.44 10.368,4.976 10.368,6.048 C10.368,7.136 9.568,7.68 7.968,7.68 L7.968,7.68 Z M8.688,14.376 L4.704,14.376 L4.704,10.968 L8.688,10.968 C10.352,10.968 11.184,11.536 11.184,12.672 C11.184,13.808 10.352,14.376 8.688,14.376 L8.688,14.376 Z M26.544,17.808 L26.544,4.776 L31.68,4.776 L31.68,1.008 L16.632,1.008 L16.632,4.776 L21.792,4.776 L21.792,17.808 L26.544,17.808 Z M41.592,18.144 C43.128,18.144 44.512,17.872 45.744,17.328 C46.976,16.784 48,16 48.816,14.976 L48.816,14.976 L45.792,12.24 C44.704,13.552 43.384,14.208 41.832,14.208 C40.92,14.208 40.108,14.008 39.396,13.608 C38.684,13.208 38.132,12.644 37.74,11.916 C37.348,11.188 37.152,10.352 37.152,9.408 C37.152,8.464 37.348,7.628 37.74,6.9 C38.132,6.172 38.684,5.608 39.396,5.208 C40.108,4.808 40.92,4.608 41.832,4.608 C43.384,4.608 44.704,5.264 45.792,6.576 L45.792,6.576 L48.816,3.84 C48,2.816 46.976,2.032 45.744,1.488 C44.512,0.944 43.128,0.672 41.592,0.672 C39.832,0.672 38.252,1.044 36.852,1.788 C35.452,2.532 34.352,3.568 33.552,4.896 C32.752,6.224 32.352,7.728 32.352,9.408 C32.352,11.088 32.752,12.592 33.552,13.92 C34.352,15.248 35.452,16.284 36.852,17.028 C38.252,17.772 39.832,18.144 41.592,18.144 Z" id=BTC fill=#F2A900></path><path d="M56.64,18.144 C58.24,18.144 59.6,17.9 60.72,17.412 C61.84,16.924 62.68,16.272 63.24,15.456 C63.8,14.64 64.08,13.728 64.08,12.72 C64.08,11.552 63.772,10.628 63.156,9.948 C62.54,9.268 61.812,8.772 60.972,8.46 C60.132,8.148 59.072,7.856 57.792,7.584 C56.656,7.344 55.832,7.112 55.32,6.888 C54.808,6.664 54.552,6.328 54.552,5.88 C54.552,5.432 54.768,5.068 55.2,4.788 C55.632,4.508 56.32,4.368 57.264,4.368 C58.768,4.368 60.32,4.8 61.92,5.664 L61.92,5.664 L63.384,2.136 C62.568,1.656 61.624,1.292 60.552,1.044 C59.48,0.796 58.392,0.672 57.288,0.672 C55.672,0.672 54.308,0.912 53.196,1.392 C52.084,1.872 51.248,2.524 50.688,3.348 C50.128,4.172 49.848,5.096 49.848,6.12 C49.848,7.288 50.152,8.216 50.76,8.904 C51.368,9.592 52.096,10.092 52.944,10.404 C53.792,10.716 54.848,11.008 56.112,11.28 C57.264,11.536 58.1,11.78 58.62,12.012 C59.14,12.244 59.4,12.6 59.4,13.08 C59.4,13.992 58.488,14.448 56.664,14.448 C55.704,14.448 54.728,14.296 53.736,13.992 C52.744,13.688 51.872,13.288 51.12,12.792 L51.12,12.792 L49.56,16.296 C50.36,16.856 51.4,17.304 52.68,17.64 C53.96,17.976 55.28,18.144 56.64,18.144 Z M71.856,18.024 C72.48,18.024 73.068,17.96 73.62,17.832 C74.172,17.704 74.64,17.52 75.024,17.28 L75.024,17.28 L73.896,14.088 C73.496,14.36 73.032,14.496 72.504,14.496 C72.088,14.496 71.756,14.364 71.508,14.1 C71.26,13.836 71.136,13.472 71.136,13.008 L71.136,13.008 L71.136,8.688 L74.112,8.688 L74.112,5.28 L71.136,5.28 L71.136,1.896 L66.576,1.896 L66.576,5.28 L64.68,5.28 L64.68,8.688 L66.576,8.688 L66.576,13.056 C66.576,14.704 67.032,15.944 67.944,16.776 C68.856,17.608 70.16,18.024 71.856,18.024 Z M82.248,18.024 C83,18.024 83.712,17.888 84.384,17.616 C85.056,17.344 85.632,16.944 86.112,16.416 L86.112,16.416 L86.112,17.808 L90.456,17.808 L90.456,4.8 L85.896,4.8 L85.896,11.064 C85.896,12.104 85.668,12.876 85.212,13.38 C84.756,13.884 84.168,14.136 83.448,14.136 C82.744,14.136 82.208,13.912 81.84,13.464 C81.472,13.016 81.288,12.304 81.288,11.328 L81.288,11.328 L81.288,4.8 L76.728,4.8 L76.728,12.072 C76.728,14.056 77.228,15.544 78.228,16.536 C79.228,17.528 80.568,18.024 82.248,18.024 Z M99.048,18.024 C100.744,18.024 102.016,17.52 102.864,16.512 L102.864,16.512 L102.864,17.808 L107.208,17.808 L107.208,0 L102.648,0 L102.648,5.928 C101.8,5.032 100.6,4.584 99.048,4.584 C97.864,4.584 96.784,4.856 95.808,5.4 C94.832,5.944 94.06,6.724 93.492,7.74 C92.924,8.756 92.64,9.936 92.64,11.28 C92.64,12.624 92.924,13.808 93.492,14.832 C94.06,15.856 94.832,16.644 95.808,17.196 C96.784,17.748 97.864,18.024 99.048,18.024 Z M100.008,14.4 C99.208,14.4 98.552,14.124 98.04,13.572 C97.528,13.02 97.272,12.256 97.272,11.28 C97.272,10.32 97.528,9.568 98.04,9.024 C98.552,8.48 99.208,8.208 100.008,8.208 C100.808,8.208 101.46,8.48 101.964,9.024 C102.468,9.568 102.72,10.32 102.72,11.28 C102.72,12.256 102.464,13.02 101.952,13.572 C101.44,14.124 100.792,14.4 100.008,14.4 Z M112.368,22.68 C113.728,22.68 114.88,22.356 115.824,21.708 C116.768,21.06 117.568,19.936 118.224,18.336 L118.224,18.336 L123.84,4.8 L119.496,4.8 L116.28,12.744 L113.088,4.8 L108.408,4.8 L113.976,17.976 C113.784,18.36 113.548,18.64 113.268,18.816 C112.988,18.992 112.632,19.08 112.2,19.08 C111.832,19.08 111.468,19.012 111.108,18.876 C110.748,18.74 110.44,18.552 110.184,18.312 L110.184,18.312 L108.6,21.504 C109.032,21.856 109.596,22.14 110.292,22.356 C110.988,22.572 111.68,22.68 112.368,22.68 Z" id=Study fill-opacity=0.85 fill=#000000></path></g></g></g></svg><svg class="logo-dark hidden" width=125px height=23px viewBox="0 0 125 23" version=1.1 xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink><title>BTCStudy</title><g id=页面-1 stroke=none stroke-width=1 fill=none fill-rule=evenodd><g id=首页-响应式 transform="translate(-249.000000, -23.000000)" fill-rule=nonzero><g id=BTCStudy transform="translate(249.680000, 23.192000)"><path d="M9.072,17.808 C11.312,17.808 13.024,17.408 14.208,16.608 C15.392,15.808 15.984,14.672 15.984,13.2 C15.984,12.192 15.712,11.332 15.168,10.62 C14.624,9.908 13.872,9.384 12.912,9.048 C13.632,8.68 14.188,8.18 14.58,7.548 C14.972,6.916 15.168,6.2 15.168,5.4 C15.168,4.056 14.608,2.988 13.488,2.196 C12.368,1.404 10.736,1.008 8.592,1.008 L8.592,1.008 L-5.68434189e-14,1.008 L-5.68434189e-14,17.808 L9.072,17.808 Z M7.968,7.68 L4.704,7.68 L4.704,4.44 L7.968,4.44 C9.568,4.44 10.368,4.976 10.368,6.048 C10.368,7.136 9.568,7.68 7.968,7.68 L7.968,7.68 Z M8.688,14.376 L4.704,14.376 L4.704,10.968 L8.688,10.968 C10.352,10.968 11.184,11.536 11.184,12.672 C11.184,13.808 10.352,14.376 8.688,14.376 L8.688,14.376 Z M26.544,17.808 L26.544,4.776 L31.68,4.776 L31.68,1.008 L16.632,1.008 L16.632,4.776 L21.792,4.776 L21.792,17.808 L26.544,17.808 Z M41.592,18.144 C43.128,18.144 44.512,17.872 45.744,17.328 C46.976,16.784 48,16 48.816,14.976 L48.816,14.976 L45.792,12.24 C44.704,13.552 43.384,14.208 41.832,14.208 C40.92,14.208 40.108,14.008 39.396,13.608 C38.684,13.208 38.132,12.644 37.74,11.916 C37.348,11.188 37.152,10.352 37.152,9.408 C37.152,8.464 37.348,7.628 37.74,6.9 C38.132,6.172 38.684,5.608 39.396,5.208 C40.108,4.808 40.92,4.608 41.832,4.608 C43.384,4.608 44.704,5.264 45.792,6.576 L45.792,6.576 L48.816,3.84 C48,2.816 46.976,2.032 45.744,1.488 C44.512,0.944 43.128,0.672 41.592,0.672 C39.832,0.672 38.252,1.044 36.852,1.788 C35.452,2.532 34.352,3.568 33.552,4.896 C32.752,6.224 32.352,7.728 32.352,9.408 C32.352,11.088 32.752,12.592 33.552,13.92 C34.352,15.248 35.452,16.284 36.852,17.028 C38.252,17.772 39.832,18.144 41.592,18.144 Z" id=BTC fill=#F2A900></path><path d="M56.64,18.144 C58.24,18.144 59.6,17.9 60.72,17.412 C61.84,16.924 62.68,16.272 63.24,15.456 C63.8,14.64 64.08,13.728 64.08,12.72 C64.08,11.552 63.772,10.628 63.156,9.948 C62.54,9.268 61.812,8.772 60.972,8.46 C60.132,8.148 59.072,7.856 57.792,7.584 C56.656,7.344 55.832,7.112 55.32,6.888 C54.808,6.664 54.552,6.328 54.552,5.88 C54.552,5.432 54.768,5.068 55.2,4.788 C55.632,4.508 56.32,4.368 57.264,4.368 C58.768,4.368 60.32,4.8 61.92,5.664 L61.92,5.664 L63.384,2.136 C62.568,1.656 61.624,1.292 60.552,1.044 C59.48,0.796 58.392,0.672 57.288,0.672 C55.672,0.672 54.308,0.912 53.196,1.392 C52.084,1.872 51.248,2.524 50.688,3.348 C50.128,4.172 49.848,5.096 49.848,6.12 C49.848,7.288 50.152,8.216 50.76,8.904 C51.368,9.592 52.096,10.092 52.944,10.404 C53.792,10.716 54.848,11.008 56.112,11.28 C57.264,11.536 58.1,11.78 58.62,12.012 C59.14,12.244 59.4,12.6 59.4,13.08 C59.4,13.992 58.488,14.448 56.664,14.448 C55.704,14.448 54.728,14.296 53.736,13.992 C52.744,13.688 51.872,13.288 51.12,12.792 L51.12,12.792 L49.56,16.296 C50.36,16.856 51.4,17.304 52.68,17.64 C53.96,17.976 55.28,18.144 56.64,18.144 Z M71.856,18.024 C72.48,18.024 73.068,17.96 73.62,17.832 C74.172,17.704 74.64,17.52 75.024,17.28 L75.024,17.28 L73.896,14.088 C73.496,14.36 73.032,14.496 72.504,14.496 C72.088,14.496 71.756,14.364 71.508,14.1 C71.26,13.836 71.136,13.472 71.136,13.008 L71.136,13.008 L71.136,8.688 L74.112,8.688 L74.112,5.28 L71.136,5.28 L71.136,1.896 L66.576,1.896 L66.576,5.28 L64.68,5.28 L64.68,8.688 L66.576,8.688 L66.576,13.056 C66.576,14.704 67.032,15.944 67.944,16.776 C68.856,17.608 70.16,18.024 71.856,18.024 Z M82.248,18.024 C83,18.024 83.712,17.888 84.384,17.616 C85.056,17.344 85.632,16.944 86.112,16.416 L86.112,16.416 L86.112,17.808 L90.456,17.808 L90.456,4.8 L85.896,4.8 L85.896,11.064 C85.896,12.104 85.668,12.876 85.212,13.38 C84.756,13.884 84.168,14.136 83.448,14.136 C82.744,14.136 82.208,13.912 81.84,13.464 C81.472,13.016 81.288,12.304 81.288,11.328 L81.288,11.328 L81.288,4.8 L76.728,4.8 L76.728,12.072 C76.728,14.056 77.228,15.544 78.228,16.536 C79.228,17.528 80.568,18.024 82.248,18.024 Z M99.048,18.024 C100.744,18.024 102.016,17.52 102.864,16.512 L102.864,16.512 L102.864,17.808 L107.208,17.808 L107.208,0 L102.648,0 L102.648,5.928 C101.8,5.032 100.6,4.584 99.048,4.584 C97.864,4.584 96.784,4.856 95.808,5.4 C94.832,5.944 94.06,6.724 93.492,7.74 C92.924,8.756 92.64,9.936 92.64,11.28 C92.64,12.624 92.924,13.808 93.492,14.832 C94.06,15.856 94.832,16.644 95.808,17.196 C96.784,17.748 97.864,18.024 99.048,18.024 Z M100.008,14.4 C99.208,14.4 98.552,14.124 98.04,13.572 C97.528,13.02 97.272,12.256 97.272,11.28 C97.272,10.32 97.528,9.568 98.04,9.024 C98.552,8.48 99.208,8.208 100.008,8.208 C100.808,8.208 101.46,8.48 101.964,9.024 C102.468,9.568 102.72,10.32 102.72,11.28 C102.72,12.256 102.464,13.02 101.952,13.572 C101.44,14.124 100.792,14.4 100.008,14.4 Z M112.368,22.68 C113.728,22.68 114.88,22.356 115.824,21.708 C116.768,21.06 117.568,19.936 118.224,18.336 L118.224,18.336 L123.84,4.8 L119.496,4.8 L116.28,12.744 L113.088,4.8 L108.408,4.8 L113.976,17.976 C113.784,18.36 113.548,18.64 113.268,18.816 C112.988,18.992 112.632,19.08 112.2,19.08 C111.832,19.08 111.468,19.012 111.108,18.876 C110.748,18.74 110.44,18.552 110.184,18.312 L110.184,18.312 L108.6,21.504 C109.032,21.856 109.596,22.14 110.292,22.356 C110.988,22.572 111.68,22.68 112.368,22.68 Z" id=Study fill-opacity=0.85 fill=#FFFFFF></path></g></g></g></svg></div><div class="mobile-header-title is-full-height is-flex is-align-items-center is-flex-shrink-0"><div class="is-full-height hidden" id=postTopicMobile><p class=is-full-height>Schnorr 签名系列：简介</p></div></div></div><i class="iconfont icon-icon_search mobile-header-searchIcon"></i><div class=mobile-search-wrap><div class=search-input><input class=pl-3 id=mobile-search-input placeholder=请输入搜索关键词><i class="iconfont icon-icon_search mobile-search-input-btn"></i><button class=mobile-search-input-btn>搜 索</button></div></div></header><div class=mobile-slide-menu><a class=header-activity href=/ >首页</a><a href=/archives>全站目录</a><a href=/tags>标签</a><a href=/maps>地图</a><a href=/mempool>mempool</a><a target=_blank rel=noopener href=https://123btc.org/ >123btc</a><div><p class="slide-menu-theme is-flex is-flex-direction-row is-justify-content-space-between is-align-items-center"><span>主题设置</span><span><i class="iconfont icon-icon_light slide-theme-light hidden"></i><i class="iconfont icon-icon_dark slide-theme-dark hidden"></i></span></p><p class=slide-menu-fontsize><span>字体设置</span><span><i class="iconfont icon-bianzubeifen"></i><i class="iconfont icon-bianzu"></i></span></p></div></div><div class="search-mask hidden"><script src="/js/header.js?v=1682773100887"></script></div><main><main class="container is-max-widescreen content section post-page pt-4"><div class="columns is-flex-desktop is-justify-content-center"><div class="column is-3 silde-bar is-hidden-mobile"><ol class=toc><li class="toc-item toc-level-2"><a class=toc-link href=#%E7%9B%B4%E8%A7%82%E6%9D%A5%E8%AF%B4%EF%BC%8CSchnorr-%E7%AD%BE%E5%90%8D%E6%98%AF%E5%A6%82%E4%BD%95%E5%B7%A5%E4%BD%9C%E7%9A%84%EF%BC%9F><span class=toc-text>直观来说，Schnorr 签名是如何工作的？</span></a></li><li class="toc-item toc-level-2"><a class=toc-link href=#Schnorr-%E7%AD%BE%E5%90%8D%E7%9A%84%E5%AE%9A%E4%B9%89><span class=toc-text>Schnorr 签名的定义</span></a></li><li class="toc-item toc-level-2"><a class=toc-link href=#Schnorr-%E7%AD%BE%E5%90%8D%E7%9A%84%E7%89%B9%E6%80%A7><span class=toc-text>Schnorr 签名的特性</span></a></li><li class="toc-item toc-level-2"><a class=toc-link href=#%E7%BB%93%E8%AE%BA><span class=toc-text>结论</span></a></li></ol></div><div class="column is-9 post-container"><h1 class="mt-0 mb-2" id=postTitle>Schnorr 签名系列：简介</h1><div class=page-author><div class="is-flex is-flex-direction-row page-data mr-6"><img class=mr-1 src=/images/default_avatar.png alt="Nadav Kohen"><div class=page-author-info><strong>Nadav Kohen</strong><time class=has-text-grey datetime=2021-11-20T15:45:29.000Z>2021-11-20</time></div></div><div class=is-flex><a href=/tags/Schnorr-%E7%AD%BE%E5%90%8D><i class="page-tag mr-1 px-1">Schnorr 签名</i></a></div></div><article class="mt-4 post-content"><blockquote><p><em>作者：Nadav Kohen</em></p><p><em>来源：<a target=_blank rel=noopener href=https://suredbits.com/introduction-to-schnorr-signatures/ >https://suredbits.com/introduction-to-schnorr-signatures/</a></em></p></blockquote><p><img src=/images/the-taproot-upgrade-explainer-from-Suredbits/es_logo.png alt=img></p><p>欢迎阅读 Suredbits 撰写的 Schnorr 签名系列博客！</p><p>本文中我会解释 Schnorr 签名是什么、直观上它是如何工作的。到了下一篇文章，我会给出证据，证明这种方案是安全而且正确的。除了这两部分，本系列博客剩下的文章会介绍 Schnorr 签名能够支持的多种签名方案以及它们的应用场景。</p><p>在开始阅读之前，建议你先检查一下自己是否熟悉下列几个概念，因为我的讲解预设了读者具备有关它们的一些基础知识：</p><ol><li><a target=_blank rel=noopener href=https://www.khanacademy.org/computing/computer-science/cryptography/modarithmetic/a/what-is-modular-arithmetic>求模运算</a> —— 也就是只关心余数的数学（译者注：对正数来说，“模 n” 或 “对 n 求模” 即求除以 n 的余数，故求模运算的结果必定小于 n）</li><li><a target=_blank rel=noopener href=https://nakamoto.com/hash-functions/ >哈希函数</a> —— 密码学领域的这部分</li><li><a target=_blank rel=noopener href=https://hackernoon.com/what-is-the-math-behind-elliptic-curve-cryptography-f61b25253da3>公钥和椭圆曲线</a> —— 只需 阅读&#x2F;略读 至 “How to prove you know x” 部分即可，因为后续的部分在本文中都有讲解</li></ol><p>虽然本系列博客的主旨是一般化地讲解 Schnorr 签名，但本系列的主要动机是 Schnorr 签名即将引入比特币区块链；比特币区块链当前使用着一种名为 ECDSA 的签名算法，我们会经常比较这两者。</p><details><summary><strong>Schnorr 签名系列</strong></summary><a hef=https://suredbits.com/introduction-to-schnorr-signatures/ >What are Schnorr Signatures – Introduction</a><br><a target=_blank rel=noopener href=https://suredbits.com/schnorr-security-part-1-schnorr-id-protocol/ >Schnorr Signature Security: Part 1 – Schnorr ID Protocol</a><br><a target=_blank rel=noopener href=https://suredbits.com/schnorr-security-part-2-from-id-to-signature/ >Schnorr Signature Security: Part 2 – From IDs to Signatures</a><br><a target=_blank rel=noopener href=https://suredbits.com/schnorr-applications-musig/ >Schnorr Multi-Signatures – MuSig</a><br><a target=_blank rel=noopener href=https://suredbits.com/schnorr-applications-scriptless-scripts/ >Scriptless Scripts – Adaptor Signatures</a><br><a target=_blank rel=noopener href=https://suredbits.com/schnorr-applications-batch-verification/ >Batch Verification</a><br><a target=_blank rel=noopener href=https://suredbits.com/schnorr-applications-threshold-signatures/ >Schnorr Threshold Sigantures</a><br><a target=_blank rel=noopener href=https://suredbits.com/schnorr-applications-frost/ >Flexible Round-Optimized Schnorr Threshold – FROST</a><br><a target=_blank rel=noopener href=https://suredbits.com/schnorr-applications-blind-signatures/ >Schnorr Blind Signatures</a><br><a target=_blank rel=noopener href=https://suredbits.com/the-taproot-upgrade/ >Taproot Upgrade – Activating Schnorr</a></details><br><h2 id=直观来说，Schnorr-签名是如何工作的？><a href=#直观来说，Schnorr-签名是如何工作的？ class=headerlink title="直观来说，Schnorr 签名是如何工作的？"></a>直观来说，Schnorr 签名是如何工作的？</h2><p>免责声明：本章节不是安全性证明或相关的具有严格含义的内容，只是尝试讲解有关 Schnorr 签名工作方式的一些直觉。</p><p>那么，先假设我们生已经发现，在我们这个世界里，离散对数问题在椭圆曲线上是难解的 —— 即，假设 x 是一个很大的数，而 G 是椭圆曲线上的一个点，仅知道 <code>x * G</code> 我们很难反推出 x。所以，我们可以使用 <code>x * G = X</code> 来作为私钥 x 的公钥。已经明确了我们想利用这一事实来创造一种数字签名方案，但还没开发出来。那我们可以尝试什么思路呢？</p><p>我们先想一想，我们的签名方案要实现什么样的目标？我们希望一个数字签名同时承诺了一个人的私钥和被签名的那条消息。我们也希望，签名不会泄露关于签名者私钥的任何信息。最后，我们希望有一种办法，只需使用公开的信息就能验证签名的正确性。</p><p>把我们的私钥和消息都看成是编码为数字的数据；我首先想到的将它们结合在一起从而能承诺它们两者的两种办法：加法 <code>(x + m)</code> 和乘法 <code>(x * m)</code>。注意，两种操作最后都会对某个数字 p 求模，因为我们不想让签名的体积很大，而且希望密钥只需是 256 位（二进制位），所以我们在稍小于 2<sup>256</sup> 的数字中选出一个吉利的作为 p（参见 secp256k1 的 p 值定义）。这两种结合的办法当然满足我们想要的第一种属性（承诺），但都不满足我们想要的第二种属性，因为无论是加法后模 p 还是乘法后模 p，都是可以反推的，这样就会泄露我们的私钥！不过，也许我们仍然可以通过添加一个额外的混淆步骤来保存这两种方法之一，那么，给定加法 <code>(x + m)</code> 或乘法 <code>(x * m)</code>，我们能做什么 “调整” 来隐藏我们的私钥呢？我们可以生成一个完全随机的数 k，使之与我们的 x 和 m 相结合。现在，到底该用哪种方法，就变成了一个可以用试错来解决的问题了，因为不论如何它都能提供可靠的计算方法来满足我们想要的前两种属性，但不是所有的结合方法都能让签名可以验证。</p><p>在尝试了这三个数字的多种加法乘法苏荷之后，我们选中了 <code>s = k + m * x</code>，它既使用 <code>m * x</code> 承诺了消息和密钥，又使用随机的密钥 k 隐藏起了这些信息。这种结合方式与其它方式相比，最大的区别在于：只要把这个数字转化为（椭圆曲线上的）一个点，我们就得到了一种很棒的结构，只需使用公钥就可以验证签名：给定椭圆曲线上的一个标准点 G 用于生成公钥（需要所有参与者都知晓；见 secp256k1 曲线的 G 值定义）；我们可以用 G 乘上我们的签名，得到：</p><p>$$s*G &#x3D; (k + m * x) * G &#x3D; k * G + (m * x) * G$$</p><p>这里 <code>R = k * G</code> 就是 k 的公钥，而 <code>X = x * G</code> 是 x 的公钥。所以只需要公开的信息就能验证我们的签名（假设 R 已经公开）！</p><p>我们要做的最后一个事情是优化，使用 H(m) （就是 m 的哈希值）来替代 m，因为 m（要签名的消息）可能非常大。这个替换式可以接受的，因为 H(m) 仍然承诺了 m，所以我们的签名也是（承诺了 m）。</p><p>因此，我们现在的签名方案，在给定私钥 x 和消息 m 时，是生成一个随机数 k，并公开 <code>s = k + H(m) * x</code> 和 <code>R = k * G</code>。验证者可以通过检查 <code>s * G = R + H(m) * X</code> 是否成立来验证签名的有效性（如前所述，s 和 R 是签名的内容，而 m 是被签名的消息，X 是签名者的公钥）。</p><p>至此，我觉得我们已经没有问题了，但在我们尝试正式分析和证明这个方案的安全性之前，我们先来尝试攻击它。我想到的第一种攻击是伪造攻击：不知道这个私钥的人，想伪造这个私钥的签名。作为这种类型的攻击者，我们知道 X（x 的公钥）和 m（待签名的消息），尝试生成一个能够通过验证的有效签名。换句话来说，仅知 X 和 m，我们想搞出一组（R, s）来通过签名验证。回想我们的验证等式 <code>s * G = R + H(m) * X</code>，我们知道它等价于：<code>R = s * G – H(m) * X</code>（这是通过在等式两边都减去 <code>H(m) * X</code> 得到的）。但是，且慢，我们已经知道了 <code>H(m) * X</code> ，那只需要选出 s（就能凑出这个等式来了） —— 那么，我们只需选出一个随机数作为 s，再根据算式 <code>s*G – H(m) * X</code> 的结果来设定 R，就成了。也就是说，我们可以生成任意的 s 值，然后根据这个值来计算 R 值；只用到了公开的信息，就可以任意创建有效的数字签名 …… 大事不妙啊。</p><p>跟前面一样，我们发现，这个方案还是可以挽救的，我们只需要调整一些东西来打破这种攻击。从目前来看，要说显然可以哪种办法会有点牵强，但我们会在证明 Schnorr 签名安全性的讨论（下一篇文章）中介绍它的真正起源，也许能让下一个选择理解起来更加自然。</p><p>可以尝试的其中一种思路是使得 s 依赖于 R，从而打破等式 <code>R = s * G – H(m) * X</code>。办法之一是在我们哈希那条消息时使用 R，也就是让 <code>s = k + H(R, m) * x</code>，此处的 H(R, m) 就是拿 R 作为消息 m 的前缀，一起去做哈希计算（有时候会写成 H(R||m)，这里的 <code>||</code> 表示拼接）。这就打破了我们的伪造攻击，因为现在，给定一个随机的 s，找出一个 R 使得 <code>R = s * G – H(R, m) * X</code> 成立是很难的，因为 R 也参与了哈希值的生成，除了暴力破解之外，没有更好的办法来找出合适的 R。</p><p>我想重申，这不是 Schnorr 签名实际上的安全形态，因为仍有其它方式可以伪造签名。但它确实看起来能应对明显的攻击，可以证明是安全的。我们成功地 “发明” 了 Schnorr 签名！</p><h2 id=Schnorr-签名的定义><a href=#Schnorr-签名的定义 class=headerlink title="Schnorr 签名的定义"></a>Schnorr 签名的定义</h2><p>如果你有一个公私钥对 <code>(x, X = x * G)</code>，那么该私钥对一条消息 m 的 Schnorr 签名是一对数值 (R, s)，其中 k 是一个随机的密钥：</p><p>$$ R &#x3D; k * G$$</p><p>$$s &#x3D; k + H(R, m) * x$$</p><p>分析一下，对每一个签名，签名者都生成一个随机的数值作为 k 的值，k 本质上就是这个签名的一次性私钥。签名者计算出 R，也就是 k 的公钥，一般我们称之为 nonce。接下来，我们取 R 和 m 一起的哈希值。这个哈希值才是实际上被签名的东西：被哈希的对象包括消息和一个公开的数值，所以这个哈希值是对这条消息和 R 的承诺。后面我们会看到，我们需要对 R 的承诺来保证这种签名方案是安全的。最后，签名者使用私钥与这个哈希值执行乘法（模 p）运算；得出的结果再与一次性私钥 k 做加法（模 p）运算，得出的结果就是 s。R 与 s 一道构成了签名的内容，这个签名本质上就是证明，知道 x 的某人签名了消息 m，而 R 是一次性公钥，与普通的公钥 X 一样都是验证这个签名所需的数据。在比特币中，签名 (R, s) 会被编码成 64 个字节，前面 32 个字节表示 R， 后面 32 个字节表示 s。</p><p>这只是故事的一半：签名的生成。签名生成之后，任何知道消息 m 和公钥 X 的人都应该能够验证这个签名。签名的验证就是检查下列等式是否成立：</p><p>$$s * G &#x3D;? R + H(R, m) * X$$</p><p>你可以看出， m 和 X 必须是验证者已知的，而 R 和 s 就是签名。</p><p>这些就是围绕 “山寨” Schnorr 签名的全部计算了！生成一个签名要用到一个（一次性）的私钥、一次哈希计算、一次乘法和一次加法。而验证签名只需要得到一个哈希值，运用两次点乘法和一次点加法。有了这些知识，你现在应该能够自己阅读和理解 BIP-340 的主要内容了：它基本上就是我在这里讲述的方案的更详细的版本，它会更关心这些数据是如何编码的、 k 值是如何生成的，等等。</p><p>虽然多了解一些 Schnorr 签名以便实现它们是很棒的事，但我们还想挖得更深一些！Schnorr 签名有一些什么样的特点呢？它跟（比特币现在使用的）ECDSA 签名相比如何？在它们的工作原理背后，有一些什么样的直觉？我们怎么知道它们是安全的？甚至于，对这些东西来说，“安全性” 到底意味着什么？我们一个一个来回答这些问题。</p><h2 id=Schnorr-签名的特性><a href=#Schnorr-签名的特性 class=headerlink title="Schnorr 签名的特性"></a>Schnorr 签名的特性</h2><p>首先，我们来列举一下大部分签名方案都有的一些共同特点。</p><p><strong>Schnorr 签名看起来就像随机数</strong>。具体来说，k 合 x 都是随机数，而 H(R, m) 应该也是个随机数，因为它是哈希函数的一个输出；不严格地来说，把一堆随机数组合在一起也会给我么一个随机数。这里的意思，无论被签名的消息实际是什么样的、签名者是谁，（这些因素都不会使签名的值产生明显的偏差），s 看起来都差不多。注意，这只是一个说法，并不能证明 Schnorr 签名不会泄露有关签名者私钥的任何信息。不过，我们后面详解其安全性时，还会讲到这个属性。</p><p><strong>Nonce 绝对不可以重复使用</strong>！我把密钥对 (k, R) 称为一次性密钥是有理由的：如果你在签名两条不同的消息时用上了同一个 (k, R) 密钥对，你就会完全泄露你的私钥。我们来看看你要是犯了这个错误，攻击者可以如何获得你的私钥：攻击者一开始获得了 X（你的公钥），R（被重用的 nonce 值），m<sub>1</sub> （第一条消息），s<sub>1</sub>（第一个签名），m<sub>2</sub> （第二条消息），s<sub>1</sub>（第二个签名）；回想一下，s 值是对某条消息和私钥 x 的承诺，但经过了随机数 k 的调整。因此，如果攻击者把两个 s 值相减，那用来隐藏私钥 x 的随机数调整，就完全没有效果了（因为 nonce 重用意味着两个调整的效果是相同的）！攻击者可以依次计算：</p><pre><code class=python>s_1 – s_2 = (k + H(R, m_1) * x) – (k + H(R, m_2) * x) （根据定义）
        = H(R, m_1) * x – H(R, m_2) * x             （因为 k - k）
        = (H(R, m_1) – H(R, m_2)) * x             （有相同乘数）
</code></pre><p>让我所说，k 的调整（隐藏）效果没有了之后，两个签名的差值就只剩下了 <code>H(...)*x</code>，也就是两个哈希值的差值乘以 x。最后，因为这两个哈希值都是已知的（它们是公开信息的哈希值），所以我们可以利用这个等式：</p><p>$$s_1 – s_2 &#x3D; (H(R, m_1) – H(R, m_2)) * x$$</p><p>这个式子中只有 x 是不公开的了。攻击者可以根据下面的式子解出 x：</p><p>$$x &#x3D; \frac{(s1 – s2)}{H(R, m1) – H(R, m2)}$$</p><p>任何人只要看到了你重用了一个 nonce ，就知道了你的私钥，可以拿走你所有的比特币！BIP 340 试图通过在生成 k 时使用消息作为密钥生成函数的其中一个输入，来保证 nonce 不会被重用：如果消息改变了，那 nonce 也会跟着改变。</p><p>这两种属性对 ECDSA 和许多其它类型的签名协议也是一样的，实际上我们会看到，这两种属性实际上也是 Schnorr 签名安全性的一部分。现在，我们来看看 ECDSA 与 Schnorr 的两个最主要的区别，这些区别使得 Schnorr 更为独特和优秀。</p><p><strong>Schnorr 签名体积比 ECDSA 更小，计算和验证起来更快</strong>。在比特币现在使用的 ECDSA 签名方案中，一个签名（DER 编码）是 70 或 71 字节长；而 Schnorr 签名的长度是 64 字节。此外，计算和验证 Schnorr 签名都比 ECDSA 签名快得多。</p><p><strong>Schnorr 签名是线性的</strong>。这是 Schnorr 与众不同的关键之处，使之能支持我们将在这系列博客中介绍的大部分方案。线性是签名函数的属性（签名函数以密钥和一条消息作为输入，输出签名），也就是说：</p><p>$$Sign(x_1, k_1, m) + Sign(x_2, k_2, m) &#x3D; Sign(x_1 + x_2, k_1 + k_2, m)$$</p><p>这个等式的意思是，如果有两方签名同一条消息，并将他们的签名加起来，就可以得到他们的聚合密钥的一条有效签名！使之成真需要一个略微改动过的 Schnorr 签名版本：令总 nonce 值 R &#x3D; R<sub>1</sub> + R<sub>2</sub> （也就是每一个 nonce 值的和），并在生成消息哈希值时使用 R（而非参与方各自的 nonce 值），由此可得：</p><pre><code class=python>    SchnorrSign(x_1, k_1, m) + SchnorrSign(x_2, k_2, m)
= (k_1 + H(R, m) * x_1) + (k_2 + H(R, m) * x_2)
= (k_1 + k_2) + H(R, m) * (x_1 + x_2)
= SchnorrSign(x_1 + x_2, k_1 + k_2, m)
</code></pre><p>换句话说，因为我们把签名方案修改成使用同一条哈希值，加总两个签名的结果相当于把两个随机数相加以及把两个私钥相加，这就给了我们一个很棒的线性签名函数。</p><p>而 ECDSA 并没有同样的属性。我们会在本系列博客的后续篇章中探究这种线性属性的用场。</p><p>最后，如 BIP 340 所说，“在取得所有这些好处时，它几乎没有缺点”。Schnorr 是最简单的基于椭圆曲线的签名方案，而比特币只会从中获益，别无所失。</p><h2 id=结论><a href=#结论 class=headerlink title=结论></a>结论</h2><p>本文中我们定义了 Schnorr 签名，讨论了它的一些属性，拿它跟 ECDSA 作了比较，甚至还搞出了一段我们凭直觉为自己发明了（大部分）Schnorr 签名的 “假历史”。此外，我还偷偷塞进了我们将用来证明 Schnorr 是一种安全签名方案的许多线索：nonce 重用会泄露私钥、我们的幼稚方案 <code>k + H(m) * x</code> 无法抵御伪造攻击。我们会使用这些事实和其它的一些事实来证明 Schnorr 是安全的，就在下一篇文章；然后我们会讨论如何利用 Schnorr 和它的线性属性做出许多很酷的事情，敬请期待！</p><p>（完）</p><blockquote><p><em><a href=https://www.btcstudy.org/2021/11/22/schnorr-security-part-1-schnorr-id-protocol/ >续篇中文译本</a></em></p></blockquote></article></div></div></main><script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.8/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><script>MathJax.Hub.Config({tex2jax:{inlineMath:[["$","$"],["\\(","\\)"]],processEscapes:!0,skipTags:["script","noscript","style","textarea","pre","code"]}}),MathJax.Hub.Queue(function(){for(var a=MathJax.Hub.getAllJax(),e=0;e<a.length;e+=1)a[e].SourceElement().parentNode.className+=" has-jax"})</script><script src="/js/post.js?v=1682773100887"></script><script src="/js/highlight.min.js?v=1682773100887"></script><script>var containerEl=document.querySelector(".post-container"),postFontSize=localStorage.getItem("post-font-size")||"16",inputEl=document.querySelector("#size-change-input"),inputEl2=document.querySelector("#size-change-input2");inputEl.value=postFontSize,inputEl2.value=postFontSize,containerEl.style.fontSize=postFontSize+"px",$(function(){function e(t){$(".post-container").css("font-size",t+"px"),localStorage.setItem("post-font-size",t),$("#size-change-input").val(t),$("#size-change-input2").val(t)}$("#size-change-input").on("input propertychange",function(t){e(t.target.value)}),$("#size-change-input2").on("input propertychange",function(t){e(t.target.value)})})</script><script>hljs.initHighlightingOnLoad()</script></main></div><footer class="is-flex is-flex-direction-column is-align-items-center is-flex-shrink-0"><section class=sns-container><a title=nostr target=_blank rel="noopener nofollow" href=https://iris.to/npub1g2qs0ca5kpwlrcfug2em4jelmh65clk3yccwjxrs6hvdpd9qj80q022j4m>Nostr</a><a title=rss target=_blank rel="noopener nofollow" href=/atom.xml>rss</a><a title=telegram target=_blank rel="noopener nofollow" href=//t.me/btcstudyorg>Telegram</a></section></footer><script async src="/js/buttons.js?v=1682773100887"></script><script async src="/js/index.js?v=1682773100887"></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-JVCJ9XXG1Z"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-JVCJ9XXG1Z")</script><script>var _hmt=_hmt||[];(()=>{var e=document.createElement("script"),t=(e.src="https://hm.baidu.com/hm.js?c92c073c85be5be8d9b1b76f62a7e306",e.async=!0,e.defer=!0,document.getElementsByTagName("script")[0]);t.parentNode.insertBefore(e,t)})()</script></body></html>