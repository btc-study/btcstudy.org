<!DOCTYPE html><html lang=zh-CN><head><meta charset=UTF-8><title>Bitcoin Core 对输出描述符的支持</title><meta name=keywords content="比特币, 中本聪, 比特币区块链, 闪电网络, 比特币 layer 2, 健全货币, 密码货币, 密码朋克, 学习比特币, BTC, BTC Study, Bitcoin, bitcoin, proof of work"><meta name=description content=比特币思想的中文集结地><meta name=viewport content="width=device-width,minimum-scale=1,maximum-scale=1,initial-scale=1"><link rel=icon href=/favicon.ico><link rel=stylesheet href="/style/common/bulma.css?v=1682773100887"><link rel=preload as=style onload='this.onload=null,this.rel="stylesheet"' href="/style/common/iconfont.css?v=1682773100887"><link rel=stylesheet href="/style/base.css?v=1682773100887"><link rel=stylesheet href="/style/common/helper.css?v=1682773100887"><link rel=stylesheet href="/style/themes/animation.css?v=1682773100887"><script>function ready(){var e=document.querySelector(".body-container"),t=localStorage.getItem("theme")||"light";["light","dark"].includes(t)||(t="light",localStorage.setItem("theme","light")),e.classList.remove("appearance-auto"),e.classList.add("appearance-"+t),quickInitialTheme()}function quickInitialTheme(){var e=localStorage.getItem("theme")||"light",t=document.querySelector(".logo-light"),o=document.querySelector(".logo-dark"),d=document.querySelector("#mobile-header-logo > .logo-light"),l=document.querySelector("#mobile-header-logo > .logo-dark"),a=document.getElementById("theme-btn"),i=document.querySelector(".slide-theme-light"),c=document.querySelector(".slide-theme-dark");document.body.classList.add(e),("dark"===e?(t.classList.add("hidden"),o.classList.remove("hidden"),d.classList.add("hidden"),l.classList.remove("hidden"),a.classList.remove("icon-icon_dark"),a.classList.add("icon-icon_light"),i):c).classList.remove("hidden")}document.addEventListener("DOMContentLoaded",ready)</script><script src="/js/common.js?v=1682773100887"></script><script src=/js/libs/zepto.min.js></script><link rel=stylesheet href="/style/post.css?v=1682773100887"><link rel=stylesheet href="/style/themes/highlight.css?v=1682773100887"><meta name=generator content="Hexo 6.3.0"><link rel=alternate href=/atom.xml title="BTC Study" type=application/atom+xml></head><body class="is-flex is-flex-direction-column" onload=initialTheme()><div class=clip></div><div class="body-container appearance-auto"><header class="header-widget is-hidden-mobile is-flex is-flex-shrink-0 is-align-items-center is-justify-content-center" id=header><div class="is-flex header-widget-container is-flex-shrink-0 is-align-items-center"><section class="is-hidden-mobile is-flex-shrink-0"><h1><a href=/ ><svg class=logo-light width=125px height=23px viewBox="0 0 125 23" version=1.1 xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink><title>BTCStudy</title><g id=页面-1 stroke=none stroke-width=1 fill=none fill-rule=evenodd><g id=首页-响应式 transform="translate(-249.000000, -23.000000)" fill-rule=nonzero><g id=BTCStudy transform="translate(249.680000, 23.192000)"><path d="M9.072,17.808 C11.312,17.808 13.024,17.408 14.208,16.608 C15.392,15.808 15.984,14.672 15.984,13.2 C15.984,12.192 15.712,11.332 15.168,10.62 C14.624,9.908 13.872,9.384 12.912,9.048 C13.632,8.68 14.188,8.18 14.58,7.548 C14.972,6.916 15.168,6.2 15.168,5.4 C15.168,4.056 14.608,2.988 13.488,2.196 C12.368,1.404 10.736,1.008 8.592,1.008 L8.592,1.008 L-5.68434189e-14,1.008 L-5.68434189e-14,17.808 L9.072,17.808 Z M7.968,7.68 L4.704,7.68 L4.704,4.44 L7.968,4.44 C9.568,4.44 10.368,4.976 10.368,6.048 C10.368,7.136 9.568,7.68 7.968,7.68 L7.968,7.68 Z M8.688,14.376 L4.704,14.376 L4.704,10.968 L8.688,10.968 C10.352,10.968 11.184,11.536 11.184,12.672 C11.184,13.808 10.352,14.376 8.688,14.376 L8.688,14.376 Z M26.544,17.808 L26.544,4.776 L31.68,4.776 L31.68,1.008 L16.632,1.008 L16.632,4.776 L21.792,4.776 L21.792,17.808 L26.544,17.808 Z M41.592,18.144 C43.128,18.144 44.512,17.872 45.744,17.328 C46.976,16.784 48,16 48.816,14.976 L48.816,14.976 L45.792,12.24 C44.704,13.552 43.384,14.208 41.832,14.208 C40.92,14.208 40.108,14.008 39.396,13.608 C38.684,13.208 38.132,12.644 37.74,11.916 C37.348,11.188 37.152,10.352 37.152,9.408 C37.152,8.464 37.348,7.628 37.74,6.9 C38.132,6.172 38.684,5.608 39.396,5.208 C40.108,4.808 40.92,4.608 41.832,4.608 C43.384,4.608 44.704,5.264 45.792,6.576 L45.792,6.576 L48.816,3.84 C48,2.816 46.976,2.032 45.744,1.488 C44.512,0.944 43.128,0.672 41.592,0.672 C39.832,0.672 38.252,1.044 36.852,1.788 C35.452,2.532 34.352,3.568 33.552,4.896 C32.752,6.224 32.352,7.728 32.352,9.408 C32.352,11.088 32.752,12.592 33.552,13.92 C34.352,15.248 35.452,16.284 36.852,17.028 C38.252,17.772 39.832,18.144 41.592,18.144 Z" id=BTC fill=#F2A900></path><path d="M56.64,18.144 C58.24,18.144 59.6,17.9 60.72,17.412 C61.84,16.924 62.68,16.272 63.24,15.456 C63.8,14.64 64.08,13.728 64.08,12.72 C64.08,11.552 63.772,10.628 63.156,9.948 C62.54,9.268 61.812,8.772 60.972,8.46 C60.132,8.148 59.072,7.856 57.792,7.584 C56.656,7.344 55.832,7.112 55.32,6.888 C54.808,6.664 54.552,6.328 54.552,5.88 C54.552,5.432 54.768,5.068 55.2,4.788 C55.632,4.508 56.32,4.368 57.264,4.368 C58.768,4.368 60.32,4.8 61.92,5.664 L61.92,5.664 L63.384,2.136 C62.568,1.656 61.624,1.292 60.552,1.044 C59.48,0.796 58.392,0.672 57.288,0.672 C55.672,0.672 54.308,0.912 53.196,1.392 C52.084,1.872 51.248,2.524 50.688,3.348 C50.128,4.172 49.848,5.096 49.848,6.12 C49.848,7.288 50.152,8.216 50.76,8.904 C51.368,9.592 52.096,10.092 52.944,10.404 C53.792,10.716 54.848,11.008 56.112,11.28 C57.264,11.536 58.1,11.78 58.62,12.012 C59.14,12.244 59.4,12.6 59.4,13.08 C59.4,13.992 58.488,14.448 56.664,14.448 C55.704,14.448 54.728,14.296 53.736,13.992 C52.744,13.688 51.872,13.288 51.12,12.792 L51.12,12.792 L49.56,16.296 C50.36,16.856 51.4,17.304 52.68,17.64 C53.96,17.976 55.28,18.144 56.64,18.144 Z M71.856,18.024 C72.48,18.024 73.068,17.96 73.62,17.832 C74.172,17.704 74.64,17.52 75.024,17.28 L75.024,17.28 L73.896,14.088 C73.496,14.36 73.032,14.496 72.504,14.496 C72.088,14.496 71.756,14.364 71.508,14.1 C71.26,13.836 71.136,13.472 71.136,13.008 L71.136,13.008 L71.136,8.688 L74.112,8.688 L74.112,5.28 L71.136,5.28 L71.136,1.896 L66.576,1.896 L66.576,5.28 L64.68,5.28 L64.68,8.688 L66.576,8.688 L66.576,13.056 C66.576,14.704 67.032,15.944 67.944,16.776 C68.856,17.608 70.16,18.024 71.856,18.024 Z M82.248,18.024 C83,18.024 83.712,17.888 84.384,17.616 C85.056,17.344 85.632,16.944 86.112,16.416 L86.112,16.416 L86.112,17.808 L90.456,17.808 L90.456,4.8 L85.896,4.8 L85.896,11.064 C85.896,12.104 85.668,12.876 85.212,13.38 C84.756,13.884 84.168,14.136 83.448,14.136 C82.744,14.136 82.208,13.912 81.84,13.464 C81.472,13.016 81.288,12.304 81.288,11.328 L81.288,11.328 L81.288,4.8 L76.728,4.8 L76.728,12.072 C76.728,14.056 77.228,15.544 78.228,16.536 C79.228,17.528 80.568,18.024 82.248,18.024 Z M99.048,18.024 C100.744,18.024 102.016,17.52 102.864,16.512 L102.864,16.512 L102.864,17.808 L107.208,17.808 L107.208,0 L102.648,0 L102.648,5.928 C101.8,5.032 100.6,4.584 99.048,4.584 C97.864,4.584 96.784,4.856 95.808,5.4 C94.832,5.944 94.06,6.724 93.492,7.74 C92.924,8.756 92.64,9.936 92.64,11.28 C92.64,12.624 92.924,13.808 93.492,14.832 C94.06,15.856 94.832,16.644 95.808,17.196 C96.784,17.748 97.864,18.024 99.048,18.024 Z M100.008,14.4 C99.208,14.4 98.552,14.124 98.04,13.572 C97.528,13.02 97.272,12.256 97.272,11.28 C97.272,10.32 97.528,9.568 98.04,9.024 C98.552,8.48 99.208,8.208 100.008,8.208 C100.808,8.208 101.46,8.48 101.964,9.024 C102.468,9.568 102.72,10.32 102.72,11.28 C102.72,12.256 102.464,13.02 101.952,13.572 C101.44,14.124 100.792,14.4 100.008,14.4 Z M112.368,22.68 C113.728,22.68 114.88,22.356 115.824,21.708 C116.768,21.06 117.568,19.936 118.224,18.336 L118.224,18.336 L123.84,4.8 L119.496,4.8 L116.28,12.744 L113.088,4.8 L108.408,4.8 L113.976,17.976 C113.784,18.36 113.548,18.64 113.268,18.816 C112.988,18.992 112.632,19.08 112.2,19.08 C111.832,19.08 111.468,19.012 111.108,18.876 C110.748,18.74 110.44,18.552 110.184,18.312 L110.184,18.312 L108.6,21.504 C109.032,21.856 109.596,22.14 110.292,22.356 C110.988,22.572 111.68,22.68 112.368,22.68 Z" id=Study fill-opacity=0.85 fill=#000000></path></g></g></g></svg><svg class="logo-dark hidden" width=125px height=23px viewBox="0 0 125 23" version=1.1 xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink><title>BTCStudy</title><g id=页面-1 stroke=none stroke-width=1 fill=none fill-rule=evenodd><g id=首页-响应式 transform="translate(-249.000000, -23.000000)" fill-rule=nonzero><g id=BTCStudy transform="translate(249.680000, 23.192000)"><path d="M9.072,17.808 C11.312,17.808 13.024,17.408 14.208,16.608 C15.392,15.808 15.984,14.672 15.984,13.2 C15.984,12.192 15.712,11.332 15.168,10.62 C14.624,9.908 13.872,9.384 12.912,9.048 C13.632,8.68 14.188,8.18 14.58,7.548 C14.972,6.916 15.168,6.2 15.168,5.4 C15.168,4.056 14.608,2.988 13.488,2.196 C12.368,1.404 10.736,1.008 8.592,1.008 L8.592,1.008 L-5.68434189e-14,1.008 L-5.68434189e-14,17.808 L9.072,17.808 Z M7.968,7.68 L4.704,7.68 L4.704,4.44 L7.968,4.44 C9.568,4.44 10.368,4.976 10.368,6.048 C10.368,7.136 9.568,7.68 7.968,7.68 L7.968,7.68 Z M8.688,14.376 L4.704,14.376 L4.704,10.968 L8.688,10.968 C10.352,10.968 11.184,11.536 11.184,12.672 C11.184,13.808 10.352,14.376 8.688,14.376 L8.688,14.376 Z M26.544,17.808 L26.544,4.776 L31.68,4.776 L31.68,1.008 L16.632,1.008 L16.632,4.776 L21.792,4.776 L21.792,17.808 L26.544,17.808 Z M41.592,18.144 C43.128,18.144 44.512,17.872 45.744,17.328 C46.976,16.784 48,16 48.816,14.976 L48.816,14.976 L45.792,12.24 C44.704,13.552 43.384,14.208 41.832,14.208 C40.92,14.208 40.108,14.008 39.396,13.608 C38.684,13.208 38.132,12.644 37.74,11.916 C37.348,11.188 37.152,10.352 37.152,9.408 C37.152,8.464 37.348,7.628 37.74,6.9 C38.132,6.172 38.684,5.608 39.396,5.208 C40.108,4.808 40.92,4.608 41.832,4.608 C43.384,4.608 44.704,5.264 45.792,6.576 L45.792,6.576 L48.816,3.84 C48,2.816 46.976,2.032 45.744,1.488 C44.512,0.944 43.128,0.672 41.592,0.672 C39.832,0.672 38.252,1.044 36.852,1.788 C35.452,2.532 34.352,3.568 33.552,4.896 C32.752,6.224 32.352,7.728 32.352,9.408 C32.352,11.088 32.752,12.592 33.552,13.92 C34.352,15.248 35.452,16.284 36.852,17.028 C38.252,17.772 39.832,18.144 41.592,18.144 Z" id=BTC fill=#F2A900></path><path d="M56.64,18.144 C58.24,18.144 59.6,17.9 60.72,17.412 C61.84,16.924 62.68,16.272 63.24,15.456 C63.8,14.64 64.08,13.728 64.08,12.72 C64.08,11.552 63.772,10.628 63.156,9.948 C62.54,9.268 61.812,8.772 60.972,8.46 C60.132,8.148 59.072,7.856 57.792,7.584 C56.656,7.344 55.832,7.112 55.32,6.888 C54.808,6.664 54.552,6.328 54.552,5.88 C54.552,5.432 54.768,5.068 55.2,4.788 C55.632,4.508 56.32,4.368 57.264,4.368 C58.768,4.368 60.32,4.8 61.92,5.664 L61.92,5.664 L63.384,2.136 C62.568,1.656 61.624,1.292 60.552,1.044 C59.48,0.796 58.392,0.672 57.288,0.672 C55.672,0.672 54.308,0.912 53.196,1.392 C52.084,1.872 51.248,2.524 50.688,3.348 C50.128,4.172 49.848,5.096 49.848,6.12 C49.848,7.288 50.152,8.216 50.76,8.904 C51.368,9.592 52.096,10.092 52.944,10.404 C53.792,10.716 54.848,11.008 56.112,11.28 C57.264,11.536 58.1,11.78 58.62,12.012 C59.14,12.244 59.4,12.6 59.4,13.08 C59.4,13.992 58.488,14.448 56.664,14.448 C55.704,14.448 54.728,14.296 53.736,13.992 C52.744,13.688 51.872,13.288 51.12,12.792 L51.12,12.792 L49.56,16.296 C50.36,16.856 51.4,17.304 52.68,17.64 C53.96,17.976 55.28,18.144 56.64,18.144 Z M71.856,18.024 C72.48,18.024 73.068,17.96 73.62,17.832 C74.172,17.704 74.64,17.52 75.024,17.28 L75.024,17.28 L73.896,14.088 C73.496,14.36 73.032,14.496 72.504,14.496 C72.088,14.496 71.756,14.364 71.508,14.1 C71.26,13.836 71.136,13.472 71.136,13.008 L71.136,13.008 L71.136,8.688 L74.112,8.688 L74.112,5.28 L71.136,5.28 L71.136,1.896 L66.576,1.896 L66.576,5.28 L64.68,5.28 L64.68,8.688 L66.576,8.688 L66.576,13.056 C66.576,14.704 67.032,15.944 67.944,16.776 C68.856,17.608 70.16,18.024 71.856,18.024 Z M82.248,18.024 C83,18.024 83.712,17.888 84.384,17.616 C85.056,17.344 85.632,16.944 86.112,16.416 L86.112,16.416 L86.112,17.808 L90.456,17.808 L90.456,4.8 L85.896,4.8 L85.896,11.064 C85.896,12.104 85.668,12.876 85.212,13.38 C84.756,13.884 84.168,14.136 83.448,14.136 C82.744,14.136 82.208,13.912 81.84,13.464 C81.472,13.016 81.288,12.304 81.288,11.328 L81.288,11.328 L81.288,4.8 L76.728,4.8 L76.728,12.072 C76.728,14.056 77.228,15.544 78.228,16.536 C79.228,17.528 80.568,18.024 82.248,18.024 Z M99.048,18.024 C100.744,18.024 102.016,17.52 102.864,16.512 L102.864,16.512 L102.864,17.808 L107.208,17.808 L107.208,0 L102.648,0 L102.648,5.928 C101.8,5.032 100.6,4.584 99.048,4.584 C97.864,4.584 96.784,4.856 95.808,5.4 C94.832,5.944 94.06,6.724 93.492,7.74 C92.924,8.756 92.64,9.936 92.64,11.28 C92.64,12.624 92.924,13.808 93.492,14.832 C94.06,15.856 94.832,16.644 95.808,17.196 C96.784,17.748 97.864,18.024 99.048,18.024 Z M100.008,14.4 C99.208,14.4 98.552,14.124 98.04,13.572 C97.528,13.02 97.272,12.256 97.272,11.28 C97.272,10.32 97.528,9.568 98.04,9.024 C98.552,8.48 99.208,8.208 100.008,8.208 C100.808,8.208 101.46,8.48 101.964,9.024 C102.468,9.568 102.72,10.32 102.72,11.28 C102.72,12.256 102.464,13.02 101.952,13.572 C101.44,14.124 100.792,14.4 100.008,14.4 Z M112.368,22.68 C113.728,22.68 114.88,22.356 115.824,21.708 C116.768,21.06 117.568,19.936 118.224,18.336 L118.224,18.336 L123.84,4.8 L119.496,4.8 L116.28,12.744 L113.088,4.8 L108.408,4.8 L113.976,17.976 C113.784,18.36 113.548,18.64 113.268,18.816 C112.988,18.992 112.632,19.08 112.2,19.08 C111.832,19.08 111.468,19.012 111.108,18.876 C110.748,18.74 110.44,18.552 110.184,18.312 L110.184,18.312 L108.6,21.504 C109.032,21.856 109.596,22.14 110.292,22.356 C110.988,22.572 111.68,22.68 112.368,22.68 Z" id=Study fill-opacity=0.85 fill=#FFFFFF></path></g></g></g></svg></a></h1></section><div class="is-flex is-flex-direction-column header-menu-wrap"><aside class="is-flex-shrink-0 is-flex is-flex-direction-row is-align-items-center" id=header-menu><a class="is-inline-block header-activity mr-4" href=/ >首页</a><a class="is-inline-block mr-4" href=/archives>全站目录</a><a class="is-inline-block mr-4" href=/tags>标签</a><a class="is-inline-block mr-4" href=/maps>地图</a><a class="is-inline-block mr-4" href=/mempool>mempool</a><a class="is-inline-block mr-4" target=_blank rel=noopener href=https://123btc.org/ >123btc</a><div class="right-content is-flex is-flex-direction-row is-align-items-center"><div class="size-wrap mr-1"><i class="iconfont icon-a-bianzu5" id=change-size-btn></i><div class=size-input-wrap><div class=input-wrap><input id=size-change-input type=range min=12 max=32 step=2></div></div></div><i class="iconfont icon-icon_dark mr-1" id=theme-btn></i><div class=search-wrap><input class=pl-3 id=search-input placeholder=请输入搜索关键词><i class="iconfont icon-icon_search" id=search-input-btn></i></div></div></aside><div class="header-title is-hidden-mobile is-full-height is-flex is-align-items-center is-flex-shrink-0"><div class="is-full-height hidden" id=postTopic><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">Bitcoin Core 对输出描述符的支持</p><div class="size-wrap mr-1"><i class="iconfont icon-a-bianzu5" id=change-size-btn2></i><div class=size-input-wrap><div class=input-wrap><input id=size-change-input2 type=range min=12 max=32 step=2></div></div></div></div></div></div></div></header><header class="is-flex header-widget is-flex-shrink-0 is-align-items-center is-justify-content-space-between is-hidden-tablet" id=mobile-header><div class="is-flex is-flex-direction-row is-align-items-center"><i class="iconfont icon-icon_bar mobile-header-menu"></i><div id=mobile-header-logo><svg class=logo-light width=125px height=23px viewBox="0 0 125 23" version=1.1 xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink><title>BTCStudy</title><g id=页面-1 stroke=none stroke-width=1 fill=none fill-rule=evenodd><g id=首页-响应式 transform="translate(-249.000000, -23.000000)" fill-rule=nonzero><g id=BTCStudy transform="translate(249.680000, 23.192000)"><path d="M9.072,17.808 C11.312,17.808 13.024,17.408 14.208,16.608 C15.392,15.808 15.984,14.672 15.984,13.2 C15.984,12.192 15.712,11.332 15.168,10.62 C14.624,9.908 13.872,9.384 12.912,9.048 C13.632,8.68 14.188,8.18 14.58,7.548 C14.972,6.916 15.168,6.2 15.168,5.4 C15.168,4.056 14.608,2.988 13.488,2.196 C12.368,1.404 10.736,1.008 8.592,1.008 L8.592,1.008 L-5.68434189e-14,1.008 L-5.68434189e-14,17.808 L9.072,17.808 Z M7.968,7.68 L4.704,7.68 L4.704,4.44 L7.968,4.44 C9.568,4.44 10.368,4.976 10.368,6.048 C10.368,7.136 9.568,7.68 7.968,7.68 L7.968,7.68 Z M8.688,14.376 L4.704,14.376 L4.704,10.968 L8.688,10.968 C10.352,10.968 11.184,11.536 11.184,12.672 C11.184,13.808 10.352,14.376 8.688,14.376 L8.688,14.376 Z M26.544,17.808 L26.544,4.776 L31.68,4.776 L31.68,1.008 L16.632,1.008 L16.632,4.776 L21.792,4.776 L21.792,17.808 L26.544,17.808 Z M41.592,18.144 C43.128,18.144 44.512,17.872 45.744,17.328 C46.976,16.784 48,16 48.816,14.976 L48.816,14.976 L45.792,12.24 C44.704,13.552 43.384,14.208 41.832,14.208 C40.92,14.208 40.108,14.008 39.396,13.608 C38.684,13.208 38.132,12.644 37.74,11.916 C37.348,11.188 37.152,10.352 37.152,9.408 C37.152,8.464 37.348,7.628 37.74,6.9 C38.132,6.172 38.684,5.608 39.396,5.208 C40.108,4.808 40.92,4.608 41.832,4.608 C43.384,4.608 44.704,5.264 45.792,6.576 L45.792,6.576 L48.816,3.84 C48,2.816 46.976,2.032 45.744,1.488 C44.512,0.944 43.128,0.672 41.592,0.672 C39.832,0.672 38.252,1.044 36.852,1.788 C35.452,2.532 34.352,3.568 33.552,4.896 C32.752,6.224 32.352,7.728 32.352,9.408 C32.352,11.088 32.752,12.592 33.552,13.92 C34.352,15.248 35.452,16.284 36.852,17.028 C38.252,17.772 39.832,18.144 41.592,18.144 Z" id=BTC fill=#F2A900></path><path d="M56.64,18.144 C58.24,18.144 59.6,17.9 60.72,17.412 C61.84,16.924 62.68,16.272 63.24,15.456 C63.8,14.64 64.08,13.728 64.08,12.72 C64.08,11.552 63.772,10.628 63.156,9.948 C62.54,9.268 61.812,8.772 60.972,8.46 C60.132,8.148 59.072,7.856 57.792,7.584 C56.656,7.344 55.832,7.112 55.32,6.888 C54.808,6.664 54.552,6.328 54.552,5.88 C54.552,5.432 54.768,5.068 55.2,4.788 C55.632,4.508 56.32,4.368 57.264,4.368 C58.768,4.368 60.32,4.8 61.92,5.664 L61.92,5.664 L63.384,2.136 C62.568,1.656 61.624,1.292 60.552,1.044 C59.48,0.796 58.392,0.672 57.288,0.672 C55.672,0.672 54.308,0.912 53.196,1.392 C52.084,1.872 51.248,2.524 50.688,3.348 C50.128,4.172 49.848,5.096 49.848,6.12 C49.848,7.288 50.152,8.216 50.76,8.904 C51.368,9.592 52.096,10.092 52.944,10.404 C53.792,10.716 54.848,11.008 56.112,11.28 C57.264,11.536 58.1,11.78 58.62,12.012 C59.14,12.244 59.4,12.6 59.4,13.08 C59.4,13.992 58.488,14.448 56.664,14.448 C55.704,14.448 54.728,14.296 53.736,13.992 C52.744,13.688 51.872,13.288 51.12,12.792 L51.12,12.792 L49.56,16.296 C50.36,16.856 51.4,17.304 52.68,17.64 C53.96,17.976 55.28,18.144 56.64,18.144 Z M71.856,18.024 C72.48,18.024 73.068,17.96 73.62,17.832 C74.172,17.704 74.64,17.52 75.024,17.28 L75.024,17.28 L73.896,14.088 C73.496,14.36 73.032,14.496 72.504,14.496 C72.088,14.496 71.756,14.364 71.508,14.1 C71.26,13.836 71.136,13.472 71.136,13.008 L71.136,13.008 L71.136,8.688 L74.112,8.688 L74.112,5.28 L71.136,5.28 L71.136,1.896 L66.576,1.896 L66.576,5.28 L64.68,5.28 L64.68,8.688 L66.576,8.688 L66.576,13.056 C66.576,14.704 67.032,15.944 67.944,16.776 C68.856,17.608 70.16,18.024 71.856,18.024 Z M82.248,18.024 C83,18.024 83.712,17.888 84.384,17.616 C85.056,17.344 85.632,16.944 86.112,16.416 L86.112,16.416 L86.112,17.808 L90.456,17.808 L90.456,4.8 L85.896,4.8 L85.896,11.064 C85.896,12.104 85.668,12.876 85.212,13.38 C84.756,13.884 84.168,14.136 83.448,14.136 C82.744,14.136 82.208,13.912 81.84,13.464 C81.472,13.016 81.288,12.304 81.288,11.328 L81.288,11.328 L81.288,4.8 L76.728,4.8 L76.728,12.072 C76.728,14.056 77.228,15.544 78.228,16.536 C79.228,17.528 80.568,18.024 82.248,18.024 Z M99.048,18.024 C100.744,18.024 102.016,17.52 102.864,16.512 L102.864,16.512 L102.864,17.808 L107.208,17.808 L107.208,0 L102.648,0 L102.648,5.928 C101.8,5.032 100.6,4.584 99.048,4.584 C97.864,4.584 96.784,4.856 95.808,5.4 C94.832,5.944 94.06,6.724 93.492,7.74 C92.924,8.756 92.64,9.936 92.64,11.28 C92.64,12.624 92.924,13.808 93.492,14.832 C94.06,15.856 94.832,16.644 95.808,17.196 C96.784,17.748 97.864,18.024 99.048,18.024 Z M100.008,14.4 C99.208,14.4 98.552,14.124 98.04,13.572 C97.528,13.02 97.272,12.256 97.272,11.28 C97.272,10.32 97.528,9.568 98.04,9.024 C98.552,8.48 99.208,8.208 100.008,8.208 C100.808,8.208 101.46,8.48 101.964,9.024 C102.468,9.568 102.72,10.32 102.72,11.28 C102.72,12.256 102.464,13.02 101.952,13.572 C101.44,14.124 100.792,14.4 100.008,14.4 Z M112.368,22.68 C113.728,22.68 114.88,22.356 115.824,21.708 C116.768,21.06 117.568,19.936 118.224,18.336 L118.224,18.336 L123.84,4.8 L119.496,4.8 L116.28,12.744 L113.088,4.8 L108.408,4.8 L113.976,17.976 C113.784,18.36 113.548,18.64 113.268,18.816 C112.988,18.992 112.632,19.08 112.2,19.08 C111.832,19.08 111.468,19.012 111.108,18.876 C110.748,18.74 110.44,18.552 110.184,18.312 L110.184,18.312 L108.6,21.504 C109.032,21.856 109.596,22.14 110.292,22.356 C110.988,22.572 111.68,22.68 112.368,22.68 Z" id=Study fill-opacity=0.85 fill=#000000></path></g></g></g></svg><svg class="logo-dark hidden" width=125px height=23px viewBox="0 0 125 23" version=1.1 xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink><title>BTCStudy</title><g id=页面-1 stroke=none stroke-width=1 fill=none fill-rule=evenodd><g id=首页-响应式 transform="translate(-249.000000, -23.000000)" fill-rule=nonzero><g id=BTCStudy transform="translate(249.680000, 23.192000)"><path d="M9.072,17.808 C11.312,17.808 13.024,17.408 14.208,16.608 C15.392,15.808 15.984,14.672 15.984,13.2 C15.984,12.192 15.712,11.332 15.168,10.62 C14.624,9.908 13.872,9.384 12.912,9.048 C13.632,8.68 14.188,8.18 14.58,7.548 C14.972,6.916 15.168,6.2 15.168,5.4 C15.168,4.056 14.608,2.988 13.488,2.196 C12.368,1.404 10.736,1.008 8.592,1.008 L8.592,1.008 L-5.68434189e-14,1.008 L-5.68434189e-14,17.808 L9.072,17.808 Z M7.968,7.68 L4.704,7.68 L4.704,4.44 L7.968,4.44 C9.568,4.44 10.368,4.976 10.368,6.048 C10.368,7.136 9.568,7.68 7.968,7.68 L7.968,7.68 Z M8.688,14.376 L4.704,14.376 L4.704,10.968 L8.688,10.968 C10.352,10.968 11.184,11.536 11.184,12.672 C11.184,13.808 10.352,14.376 8.688,14.376 L8.688,14.376 Z M26.544,17.808 L26.544,4.776 L31.68,4.776 L31.68,1.008 L16.632,1.008 L16.632,4.776 L21.792,4.776 L21.792,17.808 L26.544,17.808 Z M41.592,18.144 C43.128,18.144 44.512,17.872 45.744,17.328 C46.976,16.784 48,16 48.816,14.976 L48.816,14.976 L45.792,12.24 C44.704,13.552 43.384,14.208 41.832,14.208 C40.92,14.208 40.108,14.008 39.396,13.608 C38.684,13.208 38.132,12.644 37.74,11.916 C37.348,11.188 37.152,10.352 37.152,9.408 C37.152,8.464 37.348,7.628 37.74,6.9 C38.132,6.172 38.684,5.608 39.396,5.208 C40.108,4.808 40.92,4.608 41.832,4.608 C43.384,4.608 44.704,5.264 45.792,6.576 L45.792,6.576 L48.816,3.84 C48,2.816 46.976,2.032 45.744,1.488 C44.512,0.944 43.128,0.672 41.592,0.672 C39.832,0.672 38.252,1.044 36.852,1.788 C35.452,2.532 34.352,3.568 33.552,4.896 C32.752,6.224 32.352,7.728 32.352,9.408 C32.352,11.088 32.752,12.592 33.552,13.92 C34.352,15.248 35.452,16.284 36.852,17.028 C38.252,17.772 39.832,18.144 41.592,18.144 Z" id=BTC fill=#F2A900></path><path d="M56.64,18.144 C58.24,18.144 59.6,17.9 60.72,17.412 C61.84,16.924 62.68,16.272 63.24,15.456 C63.8,14.64 64.08,13.728 64.08,12.72 C64.08,11.552 63.772,10.628 63.156,9.948 C62.54,9.268 61.812,8.772 60.972,8.46 C60.132,8.148 59.072,7.856 57.792,7.584 C56.656,7.344 55.832,7.112 55.32,6.888 C54.808,6.664 54.552,6.328 54.552,5.88 C54.552,5.432 54.768,5.068 55.2,4.788 C55.632,4.508 56.32,4.368 57.264,4.368 C58.768,4.368 60.32,4.8 61.92,5.664 L61.92,5.664 L63.384,2.136 C62.568,1.656 61.624,1.292 60.552,1.044 C59.48,0.796 58.392,0.672 57.288,0.672 C55.672,0.672 54.308,0.912 53.196,1.392 C52.084,1.872 51.248,2.524 50.688,3.348 C50.128,4.172 49.848,5.096 49.848,6.12 C49.848,7.288 50.152,8.216 50.76,8.904 C51.368,9.592 52.096,10.092 52.944,10.404 C53.792,10.716 54.848,11.008 56.112,11.28 C57.264,11.536 58.1,11.78 58.62,12.012 C59.14,12.244 59.4,12.6 59.4,13.08 C59.4,13.992 58.488,14.448 56.664,14.448 C55.704,14.448 54.728,14.296 53.736,13.992 C52.744,13.688 51.872,13.288 51.12,12.792 L51.12,12.792 L49.56,16.296 C50.36,16.856 51.4,17.304 52.68,17.64 C53.96,17.976 55.28,18.144 56.64,18.144 Z M71.856,18.024 C72.48,18.024 73.068,17.96 73.62,17.832 C74.172,17.704 74.64,17.52 75.024,17.28 L75.024,17.28 L73.896,14.088 C73.496,14.36 73.032,14.496 72.504,14.496 C72.088,14.496 71.756,14.364 71.508,14.1 C71.26,13.836 71.136,13.472 71.136,13.008 L71.136,13.008 L71.136,8.688 L74.112,8.688 L74.112,5.28 L71.136,5.28 L71.136,1.896 L66.576,1.896 L66.576,5.28 L64.68,5.28 L64.68,8.688 L66.576,8.688 L66.576,13.056 C66.576,14.704 67.032,15.944 67.944,16.776 C68.856,17.608 70.16,18.024 71.856,18.024 Z M82.248,18.024 C83,18.024 83.712,17.888 84.384,17.616 C85.056,17.344 85.632,16.944 86.112,16.416 L86.112,16.416 L86.112,17.808 L90.456,17.808 L90.456,4.8 L85.896,4.8 L85.896,11.064 C85.896,12.104 85.668,12.876 85.212,13.38 C84.756,13.884 84.168,14.136 83.448,14.136 C82.744,14.136 82.208,13.912 81.84,13.464 C81.472,13.016 81.288,12.304 81.288,11.328 L81.288,11.328 L81.288,4.8 L76.728,4.8 L76.728,12.072 C76.728,14.056 77.228,15.544 78.228,16.536 C79.228,17.528 80.568,18.024 82.248,18.024 Z M99.048,18.024 C100.744,18.024 102.016,17.52 102.864,16.512 L102.864,16.512 L102.864,17.808 L107.208,17.808 L107.208,0 L102.648,0 L102.648,5.928 C101.8,5.032 100.6,4.584 99.048,4.584 C97.864,4.584 96.784,4.856 95.808,5.4 C94.832,5.944 94.06,6.724 93.492,7.74 C92.924,8.756 92.64,9.936 92.64,11.28 C92.64,12.624 92.924,13.808 93.492,14.832 C94.06,15.856 94.832,16.644 95.808,17.196 C96.784,17.748 97.864,18.024 99.048,18.024 Z M100.008,14.4 C99.208,14.4 98.552,14.124 98.04,13.572 C97.528,13.02 97.272,12.256 97.272,11.28 C97.272,10.32 97.528,9.568 98.04,9.024 C98.552,8.48 99.208,8.208 100.008,8.208 C100.808,8.208 101.46,8.48 101.964,9.024 C102.468,9.568 102.72,10.32 102.72,11.28 C102.72,12.256 102.464,13.02 101.952,13.572 C101.44,14.124 100.792,14.4 100.008,14.4 Z M112.368,22.68 C113.728,22.68 114.88,22.356 115.824,21.708 C116.768,21.06 117.568,19.936 118.224,18.336 L118.224,18.336 L123.84,4.8 L119.496,4.8 L116.28,12.744 L113.088,4.8 L108.408,4.8 L113.976,17.976 C113.784,18.36 113.548,18.64 113.268,18.816 C112.988,18.992 112.632,19.08 112.2,19.08 C111.832,19.08 111.468,19.012 111.108,18.876 C110.748,18.74 110.44,18.552 110.184,18.312 L110.184,18.312 L108.6,21.504 C109.032,21.856 109.596,22.14 110.292,22.356 C110.988,22.572 111.68,22.68 112.368,22.68 Z" id=Study fill-opacity=0.85 fill=#FFFFFF></path></g></g></g></svg></div><div class="mobile-header-title is-full-height is-flex is-align-items-center is-flex-shrink-0"><div class="is-full-height hidden" id=postTopicMobile><p class=is-full-height>Bitcoin Core 对输出描述符的支持</p></div></div></div><i class="iconfont icon-icon_search mobile-header-searchIcon"></i><div class=mobile-search-wrap><div class=search-input><input class=pl-3 id=mobile-search-input placeholder=请输入搜索关键词><i class="iconfont icon-icon_search mobile-search-input-btn"></i><button class=mobile-search-input-btn>搜 索</button></div></div></header><div class=mobile-slide-menu><a class=header-activity href=/ >首页</a><a href=/archives>全站目录</a><a href=/tags>标签</a><a href=/maps>地图</a><a href=/mempool>mempool</a><a target=_blank rel=noopener href=https://123btc.org/ >123btc</a><div><p class="slide-menu-theme is-flex is-flex-direction-row is-justify-content-space-between is-align-items-center"><span>主题设置</span><span><i class="iconfont icon-icon_light slide-theme-light hidden"></i><i class="iconfont icon-icon_dark slide-theme-dark hidden"></i></span></p><p class=slide-menu-fontsize><span>字体设置</span><span><i class="iconfont icon-bianzubeifen"></i><i class="iconfont icon-bianzu"></i></span></p></div></div><div class="search-mask hidden"><script src="/js/header.js?v=1682773100887"></script></div><main><main class="container is-max-widescreen content section post-page pt-4"><div class="columns is-flex-desktop is-justify-content-center"><div class="column is-3 silde-bar is-hidden-mobile"><ol class=toc><li class="toc-item toc-level-2"><a class=toc-link href=#%E7%89%B9%E6%80%A7><span class=toc-text>特性</span></a></li><li class="toc-item toc-level-2"><a class=toc-link href=#%E4%BE%8B%E5%AD%90><span class=toc-text>例子</span></a></li><li class="toc-item toc-level-2"><a class=toc-link href=#%E5%8F%82%E8%80%83><span class=toc-text>参考</span></a></li><li class="toc-item toc-level-2"><a class=toc-link href=#%E8%A7%A3%E9%87%8A><span class=toc-text>解释</span></a><ol class=toc-child><li class="toc-item toc-level-3"><a class=toc-link href=#%E5%8D%95%E5%85%AC%E9%92%A5%EF%BC%88single-key%EF%BC%89%E8%84%9A%E6%9C%AC><span class=toc-text>单公钥（single-key）脚本</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E5%A4%9A%E7%AD%BE%E5%90%8D%EF%BC%88Multisig%EF%BC%89><span class=toc-text>多签名（Multisig）</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#BIP32-%E6%B4%BE%E7%94%9F%E5%AF%86%E9%92%A5%E5%92%8C%E9%93%BE%E6%9D%A1><span class=toc-text>BIP32 派生密钥和链条</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E5%AF%86%E9%92%A5%E8%B5%B7%E6%BA%90%E8%BE%A8%E8%AF%86><span class=toc-text>密钥起源辨识</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E5%8C%85%E5%90%AB%E7%A7%81%E9%92%A5><span class=toc-text>包含私钥</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E4%B8%8E%E6%97%A7%E9%92%B1%E5%8C%85%E7%9A%84%E5%85%BC%E5%AE%B9%E6%80%A7><span class=toc-text>与旧钱包的兼容性</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E6%A0%A1%E9%AA%8C%E5%92%8C><span class=toc-text>校验和</span></a></li></ol></li></ol></div><div class="column is-9 post-container"><h1 class="mt-0 mb-2" id=postTitle>Bitcoin Core 对输出描述符的支持</h1><div class=page-author><div class="is-flex is-flex-direction-row page-data mr-6"><img class=mr-1 src=/images/default_avatar.png alt=achow101><div class=page-author-info><strong>achow101</strong><time class=has-text-grey datetime=2022-05-15T15:44:34.000Z>2022-05-15</time></div></div><div class=is-flex><a href=/tags/%E6%8F%8F%E8%BF%B0%E7%AC%A6><i class="page-tag mr-1 px-1">描述符</i></a></div></div><article class="mt-4 post-content"><blockquote><p><em>作者：achow101</em></p><p><em>来源：<a target=_blank rel=noopener href=https://github.com/bitcoin/bitcoin/blob/master/doc/descriptors.md>https://github.com/bitcoin/bitcoin/blob/master/doc/descriptors.md</a></em></p></blockquote><p>自 Bitcoin Core 软件的 0.17 版本开始，它就支持输出描述符（Output Descriptors）。这是一种简单的语言，可以用来描述输出脚本的集合。相关的 RPC 方法包括：</p><ul><li><code>scantxoutset</code> 以描述符为输入，开展扫描；也将播报相匹配的 UTXO 的专门描述符</li><li><code>getdescriptorinfo</code> 分析一个描述符，并报告一个规范化的、带有校验和的版本</li><li><code>deriveaddresses</code> 以一个描述符为输入，计算出相应的地址</li><li><code>listunspent</code> 为被报告的未花费输出产生一个专门的描述符</li><li><code>getaddressinfo</code> 为可被解决的地址产生一个描述符（从 0.18 版本开始可用）</li><li><code>importmulti</code> 以描述符为输入，导入到钱包中（从 0.18 版本开始可用）</li><li><code>generatetodescriptor</code> 以描述符为输入，并为之生成资金（仅限于 <code>regtest</code> ，从 0.19 版本开始可用）</li><li><code>utxoupdatepsbt</code> 以描述符为输入，添加信息到某 psbt 中（从 0.19 版本开始可用</li><li><code>createmultisig</code> 和 <code>addmultisigaddress</code> 都会返回描述符（从 0.20 版本开始可用）</li></ul><p>本文档的目的是介绍这门语言。想要了解正在使用的规范，请看 RPC 文档来了解上述的函数。</p><h2 id=特性><a href=#特性 class=headerlink title=特性></a>特性</h2><p>输出描述符当前支持：</p><ul><li>支付到公钥型脚本（P2PK），通过 <code>pk</code> 函数</li><li>支付到公钥哈希值型脚本（P2PKH），通过 <code>pkh</code> 函数</li><li>支付到隔离见证公钥哈希值型脚本（P2WPKH），通过 <code>wpkh</code> 函数</li><li>支付到脚本哈希值型脚本（P2SH），通过 <code>sh</code> 函数</li><li>支付到隔离见证脚本哈希值型脚本（P2WSH），通过 <code>wsh</code> 函数</li><li>支付到 taproot 型输出（P2TR），通过 <code>tr</code> 函数</li><li>多签名输出，通过 <code>multi</code> 函数</li><li>多签名脚本，并且其中的公钥是按字典顺序排列的，通过 <code>sortedmulti</code> 函数</li><li>内置于 taproot 脚本树的多签名脚本，通过 <code>multi_a</code> （以及 <code>sortedmulti_a</code> ）函数</li><li>任意类型的已经得到支持的地址，通过 <code>addr</code> 函数</li><li>原始的十六进制字符串，通过 <code>raw</code> 函数</li><li>十六进制形式的公钥（压缩的和未压缩的），或者带有派生路径的 BIP32 扩展公钥（extended public key）</li></ul><h2 id=例子><a href=#例子 class=headerlink title=例子></a>例子</h2><ul><li><code>pk(0279be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798)</code> 描述了这个公钥的 P2PK 输出</li><li><code>pkh(02c6047f9441ed7d6d3045406e95c07cd85c778e4b8cef3ca7abac09b95c709ee5)</code> 描述了这个公钥的 P2PKH 输出</li><li><code>wpkh(02f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9)</code>描述了这个公钥的 P2WPKH（隔离见证公钥哈希值）输出</li><li><code>sh(wpkh(03fff97bd5755eeea420453a14355235d382f6472f8568a18b2f057a1460297556))</code> 描述了这个公钥的 P2SH-P2WPKH 输出（用脚本哈希值封装的隔离见证公钥哈希值输出）</li><li><code>combo(0279be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798)</code> 描述了这个公钥的任意 P2PK、P2PKH、P2WPKH 和 P2SH-P2WPKH 输出</li><li><code>sh(wsh(pkh(02e493dbf1c10d80f3581e4904930b1404cc6c13900ee0758474fa94abe8c4cd13)))</code> 描述了这个公钥的（过于复杂的） P2SH-P2WSH-P2PKH 输出（使用 P2SH 封装的隔离见证脚本哈希值，而这个隔离见证脚本哈希值又封装了这个公钥哈希值）</li><li><code>multi(1,022f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4,025cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc)</code> 描述了带有裸露 <em>1-of-2</em> 多签名脚本的输出，并且公钥的顺序已由描述符指明</li><li><code>sh(multi(2,022f01e5e15cca351daff3843fb70f3c2f0a1bdd05e5af888a67784ef3e10a2a01,03acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe))</code> 描述了 P2SH 的 <em>2-of-2</em> 多签名脚本输出，并且公钥的顺序如此处所载</li><li><code>sh(sortedmulti(2,03acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe,022f01e5e15cca351daff3843fb70f3c2f0a1bdd05e5af888a67784ef3e10a2a01))</code> 描述了 P2SH 的 <em>2-of-2</em> 多签名脚本输出，并且赎回脚本（redeemScript）中的这 2 个公钥是按字典顺序排序的</li><li><code>wsh(multi(2,03a0434d9e47f3c86235477c7b1ae6ae5d3442d49b1943c2b752a68e2a47e247c7,03774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb,03d01115d548e7561b15c38f004d734633687cf4419620095bc5b0f47070afe85a))</code> 描述了 P2WSH（隔离见证的脚本哈希值）的 <em>2-of-3</em> 多签名脚本输出，并且这 3 个公钥是按这里的顺序排序的</li><li><code>sh(wsh(multi(1,03f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8,03499fdf9e895e719cfd64e67f07d38e3226aa7b63678949e6e49b241a60e823e4,02d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e)))</code> 描述了 P2SH 的 P2WSH 的 <em>1-of-3</em> 的多签名输出，并且这 3 个公钥是按这里的顺序排序的</li><li><code>pk(xpub661MyMwAqRbcFtXgS5sYJABqqG9YLmC4Q1Rdap9gSE8NqtwybGhePY2gZ29ESFjqJoCu1Rupje8YtGqsefD265TMg7usUDFdp6W1EGMcet8)</code> 描述了以该 xpub 形式表示的公钥的 P2PK 输出</li><li><code>pkh(xpub68Gmy5EdvgibQVfPdqkBBCHxA5htiqg55crXYuXoQRKfDBFA1WEjWgP6LHhwBZeNK1VTsfTFUHCdrfp1bgwQ9xv5ski8PX9rL2dZXvgGDnw/1/2)</code> 描述了以该 xpub 形式表示的公钥的 <em>1&#x2F;2</em> 代子密钥的 P2PKH 输出</li><li><code>pkh([d34db33f/44&#39;/0&#39;/0&#39;]xpub6ERApfZwUNrhLCkDtcHTcxd75RbzS1ed54G1LkBUHQVHQKqhMkhgbmJbZRkrgZw4koxb5JaHWkY4ALHY2grBGRjaDMzQLcgJvLJuZZvRcEL/1/*)</code> 描述了一组 P2PKH 输出，但额外指明了，这个公钥是指纹为 <code>d34db33f</code> 的主密钥的 <code>44&#39;/0/0&#39;</code> 代子密钥</li><li><code>wsh(multi(1,xpub661MyMwAqRbcFW31YEwpkMuc5THy2PSt5bDMsktWQcFF8syAmRUapSCGu8ED9W6oDMSgv6Zz8idoc4a6mr8BDzTJY47LJhkJ8UB7WEGuduB/1/0/*,xpub69H7F5d8KSRgmmdJg2KhpAK8SR3DjMwAdkxj3ZuxV27CprR9LgpeyGmXUbC6wb7ERfvrnKZjXoUmmDznezpbZb7ap6r1D3tgFxHmwMkQTPH/0/0/*))</code> 描述了一组 P2WSH 的 <em>1-of-2</em> 多签名输出，其中，第一个多签名公钥是描述符中第一个 xpub 形式公钥的 <em>1&#x2F;0&#x2F;</em><code>i</code> 个子密钥，而第二多签名公钥是描述符中第二个形式公钥的第 <em>0&#x2F;0&#x2F;</em><code>i</code> 个子密钥，而 <code>i</code> 是一个可配置的区间（默认为 <code>0-1000</code> ）内的任意数字</li><li><code>wsh(sortedmulti(1,xpub661MyMwAqRbcFW31YEwpkMuc5THy2PSt5bDMsktWQcFF8syAmRUapSCGu8ED9W6oDMSgv6Zz8idoc4a6mr8BDzTJY47LJhkJ8UB7WEGuduB/1/0/*,xpub69H7F5d8KSRgmmdJg2KhpAK8SR3DjMwAdkxj3ZuxV27CprR9LgpeyGmXUbC6wb7ERfvrnKZjXoUmmDznezpbZb7ap6r1D3tgFxHmwMkQTPH/0/0/*))</code> 面熟了一组 P2WSH 的 <em>1-of-2</em> 多签名输出，其中第一个多签名公钥是描述符中第一个 xpub 形式公钥的 <em>1&#x2F;0&#x2F;</em> <code>i</code> 个子密钥 ，另一个多签名公钥则是描述符中第二个 xpub 定时公钥的 <em>0&#x2F;0&#x2F;</em> <code>i</code> 个子密钥； <code>i</code> 是一个可配置的区间（默认为 <code>0-1000</code> ）内的任意数字。最终的 witenessScript（见证）脚本中的公钥的顺序由具体索引号下的公钥的字典顺序决定</li><li><code>tr(c6047f9441ed7d6d3045406e95c07cd85c778e4b8cef3ca7abac09b95c709ee5,&#123;pk(fff97bd5755eeea420453a14355235d382f6472f8568a18b2f057a1460297556),pk(e493dbf1c10d80f3581e4904930b1404cc6c13900ee0758474fa94abe8c4cd13)&#125;)</code> 描述了一个 P2TR 输出，该输出以 <code>c6……</code> 这个 x-only 公钥作为内部密钥（internal key），并带有两个脚本花费路径</li><li><code>tr(c6047f9441ed7d6d3045406e95c07cd85c778e4b8cef3ca7abac09b95c709ee5,sortedmulti_a(2,2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4,5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc))</code>描述了一个 P2TR 输出，该输出以 <code>c6……</code> 这个 x-only 公钥作为内部密钥，并带有一个 <code>multi_a</code> 脚本，该脚本需要这两个 x-only 公钥的签名，并且公钥是按字典顺序排列的</li></ul><h2 id=参考><a href=#参考 class=headerlink title=参考></a>参考</h2><p>描述符由多种表达式组成。顶级的表达式要么是一个 <code>SCRIPT</code> ，要么是 <code>SCRIPT#CHECKSUM</code> ，其中 <code>CHECKSUM</code> 是一个 8 字符长的描述符校验和，包含字母和数字。</p><p><code>SERIPT</code> 表达式：</p><ul><li><code>sh(SCRIPT)</code> （只能用在顶层）：嵌入参数中的 P2SH</li><li><code>wsh(SCRIPT)</code> （要么用于顶层，要么内置于 <code>sh</code> 函数中）：嵌入参数中的 P2WSH</li><li><code>pk(KEY)</code> （可用在任何地方）：给定公钥的 P2PK 输出</li><li><code>pkh(KEY)</code> （不可放置于 <code>tr</code> 函数中）：给定公钥的 P2PKH 输出（如果你只知道公钥的哈希值，则应使用 <code>addr</code> 函数）</li><li><code>wpkh(KEY)</code> （要么用在顶层，要么内置于 <code>sh</code> 函数）：这个压缩公钥（compressed pubkey）的 P2WPKH 输出</li><li><code>combo(KEY)</code>（只能用在顶层）：<code>pk(KEY)</code> 和 <code>pkh(KEY)</code> 集合的缩写。如果这是一个压缩公钥，则该集合还包括 <code>wpkh(KEY)</code> 和 <code>sh(wpkh(KEY))</code>。</li><li><code>multi(k,KEY_1,KEY_2,...,KEY_n)</code> （不能放置于 <code>tr</code> 中）：使用 OP_CHECKMULTISIG 的 k-of-n 多签名脚本。</li><li><code>sortedmulti(k,KEY_1,KEY_2,...,KEY_n)</code> （不能放置于 <code>tr</code> 中）：所示公钥在最终脚本中以字典顺序排序的多签名脚本。</li><li><code>multi_a(k,KEY_1,KEY_2,...,KEY_N)</code> （只能用在 <code>tr</code> 中）：使用 OP_CHECKSIG、OP_CHECKSIGADD 和 OP_NUMEQUAL 实现的多签名脚本。</li><li><code>sortedmulti_a(k,KEY_1,KEY_2,...,KEY_N)</code> （只能用在 <code>tr</code> 中）：类似于 <code>multi_a</code>，但脚本中的（x-only）公钥会按字典顺序排序。</li><li><code>tr(KEY)</code> 或者 <code>tr(KEY,TREE)</code> （只能用在顶层）：以所示公钥为内部密钥的 P2TR 输出，可选加入一个脚本花费路径树</li><li><code>addr(ADDR)</code> （只能用在顶层）：编码成所示 ADDR 的脚本</li><li><code>raw(HEX)</code>（只能用在顶层）：十六进制编码为所示 HEX 的脚本</li></ul><p><code>KEY</code> 表达式：</p><ul><li>可选加入，密钥的来源信息，由下列数据组成：<ul><li>起点方括号 <code>[</code></li><li>8 个 16 进制字符，表示作为密钥衍生的起点的密钥的指纹（详情见 BIP32）</li><li>接上 0 ，或多个 <code>/NUM</code> 路径元素来指明从指纹密钥到所示密钥所遵循的未强化派生路径（unhardened derivation），或多个 <code>/NUM&#39;</code> 路径元素来指明从指纹密钥到所示 xpub&#x2F;xprv 根值所遵循的强化派生路径（hardened derivation）</li><li>终点方括号 <code>]</code></li></ul></li><li>然后是实际的密钥，是下列其中之一：<ul><li>十六进制编码的公钥（要么是以 <code>02</code> 或 <code>03</code> 开头的 66 位字符，表示一个压缩公钥；要么是以 <code>04</code> 开头的 130 位字符，表示一个未压缩的公钥）<ul><li>在 <code>wpkh</code> 和 <code>wsh</code> 函数中，只能使用压缩公钥</li><li>在 <code>tr</code> 函数中，只能是由 x-only 公钥（64 位的十六进制数）</li></ul></li><li>可以使用 <a target=_blank rel=noopener href=https://en.bitcoin.it/wiki/Wallet_import_format>WIF</a> 编码的私钥而非对应的公钥，意思是相同的</li><li><code>xpub</code> 编码形式的扩展公钥或者 <code>xprv</code> 编码的扩展私钥（由 <a target=_blank rel=noopener href=https://github.com/bitcoin/bips/blob/master/bip-0032.mediawiki>BIP 32</a> 定义）</li><li>接上 0 或者多个 <code>/NUM</code> 或 <code>/NUM&#39;</code> 来表示未强化和强化的 BIP32 推导步骤</li><li>可选，接上一个 <code>/*</code> 或者 <code>/*&#39;</code> 最终步骤来指明来所有（直接）未强化或强化的子私钥</li><li>强化型派生路径需要提供私钥</li></ul></li></ul><p>（在任何使用 <code>&#39;</code> 后缀来指明使用强化派生路径的，都可以使用 <code>h</code> 作为替代）</p><p><code>TREE</code> 表达式：</p><ul><li>任何 <code>SCRIPT</code> 表达式</li><li>起点大括号 <code>&#123;</code> ，一个 <code>TREE</code> 表达式，一个逗号 <code>,</code> ，一个 <code>TREE</code> 表达式，以及一个终点大括号 <code>&#125;</code></li></ul><p><code>ADDR</code> 表达式表达任意得到支持的地址：</p><ul><li>P2PKH 地址（base58 编码，主网的地址以 <code>1...</code> 开头，测试网地址以 <code>[nm]...</code> 开头。注意，描述符中的 P2PKH 地址不能被用于 P2PK 输出（需要使用 <code>pk</code> 函数）</li><li>P2SH 地址（base58 编码，在主网以 <code>3...</code> 开头，在测试网以 <code>2...</code> 开头，由 <a target=_blank rel=noopener href=https://github.com/bitcoin/bips/blob/master/bip-0013.mediawiki>BIP 13</a> 定义）。</li><li>隔离见证地址（bech32 和 bech32m，在主网以 <code>bc1...</code> 开头，在测试网以 <code>tb1...</code> 开头，由 <a target=_blank rel=noopener href=https://github.com/bitcoin/bips/blob/master/bip-0173.mediawiki>BIP 173</a> 和 <a target=_blank rel=noopener href=https://github.com/bitcoin/bips/blob/master/bip-0350.mediawiki>BIP 350</a> 定义）</li></ul><h2 id=解释><a href=#解释 class=headerlink title=解释></a>解释</h2><h3 id=单公钥（single-key）脚本><a href=#单公钥（single-key）脚本 class=headerlink title=单公钥（single-key）脚本></a>单公钥（single-key）脚本</h3><p>人们习惯使用许多单公钥脚本构造，通常来说包括 P2PK、P2PKH、P2WPKH 和 P2SH-P2WPKH。还有许多可以想象出来的组合，尽管它们可能不是最优的：P2SH-P2PK、P2SH-P2PKH、P2WSH-P2PK、P2WSH-P2PKH、P2SH-P2WSH-P2PK、P2SH-P2WSH-P2PKH。</p><p>为了描述这些，我们将它们模型化为函数。函数 <code>pk</code> （描述 P2PK）、 <code>pkh</code> （描述 P2PKH）和 <code>wpkh</code> （描述 P2WPKH）以一个 <code>KEY</code> 表达式为输入，返回相应的 <em>scriptPubkey</em>（脚本公钥）。函数 <code>sh</code> （描述 P2SH）和 <code>wsh</code> （P2WSH）以一个 <code>SCRIPT</code> 表达式作为输入，返回以该输入作为嵌入脚本所生成的 P2SH 和 P2WSH 脚本。为了简洁，这些函数的名字都不包含 “p2”。</p><h3 id=多签名（Multisig）><a href=#多签名（Multisig） class=headerlink title=多签名（Multisig）></a>多签名（Multisig）</h3><p>许多软件使用基于比特币的 OP_CHECKMULTISIG 操作码的多签名脚本。为了支持这种输出，我们加入了 <code>multi(k,key_1,key_2,...,key_n)</code> 和 <code>sortedmulti(k,key_1,key_2,...,key_n)</code> 函数。它们代表一种 <em>k-of-n</em> 的多签名花费条件，在花费这样的输出时，n 个所提供的 <code>KEY</code> 表达式中必须有至少 k 个参与签名。</p><p>密钥的顺序对 <code>multi()</code> 是非常重要的。一个 <code>multi()</code> 表达式中的密钥的顺序，与所描述的多签名脚本中的密钥顺序一致；在用来搜索交易输出（TXO）时，它将不会匹配密钥相同但允许不同的多签名 scriptPubkey。同样地，为了防止搜索空间组合式膨胀，如果一个 <code>multi()</code> 中超过一个密钥参数是以 <code>/*</code> 或 <code>*&#39;</code> 结尾的通配符，这个 <code>multi()</code> 表达式只会匹配各带通配符 <code>KEY</code> 的第 <code>i</code> 个子密钥所形成的多签名脚本，而不会匹配这许多子密钥的任意组合。</p><p>密钥的顺序对 <code>sortedmulti()</code> 就不重要。 <code>sortedmulti()</code> 的行为跟 <code>multi()</code> 是一样的，但最终脚本中的密钥会重新排序，按 BIP67 的定义形成字典排序。</p><p><strong>基本的多签名例子</strong></p><p>想获得多个参与者之间的 M-of-N 多签名脚本使用描述符钱包和 PSBT 的例子（以及签名流程），请看<a target=_blank rel=noopener href=https://github.com/bitcoin/bitcoin/blob/master/test/functional/wallet_multisig_descriptor_psbt.py>这个功能性测试</a>。</p><p>免责声明：请注意，这个例子只用作入门介绍，并且为了好读易懂而做得比较基础。此处所列方法的一个缺点是每个参与者都必须保管（和备份）两个钱包：一个签名器和相应的多签名脚本。还应该说明的是，此处的 “默认” 并不是隐私上最好的习惯 —— 参与者应该留心，这个签名器只应用来签名跟这个多签名脚本有关的交易。最后，不建议使用 Bitcoin Core 描述符钱包以外的工具来作为签名器。其它钱包，不论是软件的还是硬件的，可能会加入额外的检查和安全措施来防止用户签名可能导致资金损失或被视为安全隐患的交易。符合各种第三方检查和验证并不在本例的意图之内。</p><p>基本步骤有：</p><ol><li>每个参与者都生成一个 xpub。最直接的办法就是创建一个新的描述符钱包，这个钱包我们称为该参与者的签名器钱包。请避免在签名来自相应多签名脚本的交易以外的用途中使用这个钱包。提示：使用 <code>listdescriptors</code> 抽取这个钱包的 xpub 公钥，然后从 <code>pkh</code> 描述符中选出一个；之所以要使用 <code>pkh</code> 是因为这是最不可能被意外使用的（传统地址）</li><li>创建一个仅可观察（watch-only）的描述符钱包（空白的、禁用了私钥）。现在，可通过导入两个描述符来创建多签名脚本： <code>wsh(sortedmulti(,XPUB1/0/*,XPUB2/0/*,…,XPUBN/0/*))</code> 和 <code>wsh(sortedmulti(,XPUB1/1/*,XPUB2/1/*,…,XPUBN/1/*))</code> （前者使用 <code>0</code> 路径，用作收款地址，后者使用 <code>1</code> 路径，用作找零）。每一个参与者都这样做。</li><li>收款地址可从这个多签名脚本中生成出来。作为一个确保步骤 2 正确执行的检查，参与者们应该相互比对，验证大家得到了同样的地址。</li><li>资金发送到收款地址</li><li>使用 <code>walletcreatefundedpsbt</code> 创建从该多签名钱包发出的交易（任何一个参与者都可以发起）。如果有图形界面，只需跳到该多签名钱包的 <code>Send</code> （发送）栏，然后创建一个未签名的交易（PSBT）</li><li>至少 <code>M</code> 个参与者在自己的多签名钱包中使用 <code>decodepsbt</code> 检查这个 PSBT，以验证这笔交易是没问题的</li><li>（如果没问题）参与者们用自己的签名器钱包使用 <code>walletprocesspsbt</code> 签名这个 PSBT。如果有图形界面，则只需从文件中加载 PSBT 并签名即可</li><li>签好名的 PSBT 使用 <code>combinepsbt</code> 来收集并用 <code>finalizepsbt</code> 来定稿，然后这笔最终的交易就会广播到网络中。注意，任何钱包（任意一个签名器钱包或多签名钱包）都可以做这件事。</li><li>检查在交易被打包进区块后，钱包的余额发生了正确的变化</li></ol><p>你可能更喜欢串联式的签名流程，就是参与者们按顺序一个接一个地签名，直到这个 PSBT 得到了 <code>M</code> 个签名、可视为 “完成了”。两种签名流程的大部分步骤都相同，除了第 6、7 步：从各人并行签名最初的 PSBT ，变成了按顺序签名。在串联式签名中， <code>combinepsbt</code> 就不是必要的了，最后一个（第 <code>m</code> 个）签名者可以在签名后直接广播该 PSBT。注意，并行式签名在参与者较多的时候可能更好用。串联式签名在 测试&#x2F;Python 案例 中也收纳了。<a target=_blank rel=noopener href=https://github.com/bitcoin/bitcoin/blob/master/test/functional/wallet_multisig_descriptor_psbt.py>这个测试</a>既有意成为文档和功能性测试，所以它做得尽可能简单和易读。</p><h3 id=BIP32-派生密钥和链条><a href=#BIP32-派生密钥和链条 class=headerlink title="BIP32 派生密钥和链条"></a>BIP32 派生密钥和链条</h3><p>大部分先进的钱包软件和硬件都使用 BIP32（“层级式密钥”）来派生密钥。我们允许由一个扩展公钥（通常称为 <em>xpub</em> ）加上生成一个公钥所用的派生路径组成的字符串，从而直接支持这个协议。派生路径由一连串的 0 或更多整数（在 0 ~ 2 ^ 31 - 1 的范围内）组成，每个整数都可以选择接上 <code>&#39;</code> 或者 <code>h</code> ，并使用 <code>/</code> 字符分隔开。这串字符可以用字符 <code>/*</code> 或者 <code>/*&#39;</code> （或 <code>/*h</code> ）结尾，以指代一个可配置的范围（默认是 <code>0-1000</code> ，包含的）内所有未强化或强化的子密钥。</p><p>在使用强化派生步骤描述一个公钥时，如果没有相应的私钥，脚本就无法计算出来。</p><h3 id=密钥起源辨识><a href=#密钥起源辨识 class=headerlink title=密钥起源辨识></a>密钥起源辨识</h3><p>为了描述签名密钥驻留在另一台设备上的脚本，有必要定位主密钥（master key）和派生出一个 xpub 公钥的路径。</p><p>举个例子，遵循 BIP44，直接使用 <code>xpub.../44&#39;/0&#39;/0&#39;/1/*</code> （其中 <code>xpub...</code> 对应于主密钥 <code>m</code> ）来描述一串找零地址是很方便的。但是，因为这里面有强化派生路径，如果你不能访问到相应的私钥，单靠这个描述符是无法计算出脚本的。相反，它应该写成 <code>xpub.../1/*</code> ，而 <code>xpub...</code> 对应于 <code>m/11&#39;/0&#39;/0&#39;</code> 。</p><p>在跟硬件设备交互时，有必要包含从主密钥开始的完整路径。<a target=_blank rel=noopener href=https://github.com/bitcoin/bips/blob/master/bip-0174.mediawiki>BIP174</a> 标准化了这个流程：提供主密钥的 <em>指纹</em>（主密钥的 Hash 160 值的前 32 比特），再加上所有的派生步骤。为了支持这样的构造，我们允许在描述符语言中提供这一密钥起源信息，即使它并不会影响一个描述符所指代的 scriptPubKey。</p><p>每一个公钥都可以加上由方括号括起来的前缀，括号内是8 个十六进制字符的指纹以及（可选）派生路径（强化和未强化的），从而指明主密钥以及这个密钥（或 xpub）所遵循的派生路径。</p><p>注意，父密钥的指纹只用于在软件内快速检测父密钥和子密钥，软件自己要处理可能的冲突。</p><h3 id=包含私钥><a href=#包含私钥 class=headerlink title=包含私钥></a>包含私钥</h3><p>通常来说，传输一个脚本的描述时一并传输必要的私钥都是有用的。所以，在任何支持使用公钥或 xpub 公钥的地方，都可以提供 WIF 格式的私钥或 xprv 私钥作为替代。这在私钥是必要信息时都是有用的，比如在强化派生路径中推导强化派生公钥时，以及在转存储包含私钥材料的钱包描述符时。</p><h3 id=与旧钱包的兼容性><a href=#与旧钱包的兼容性 class=headerlink title=与旧钱包的兼容性></a>与旧钱包的兼容性</h3><p>为了易于表示在现有的 Bitcoin Core 钱包中得到支持的脚本集合，我们提供了一个便利的函数 <code>combo</code> ，它以一个公钥为输入，可以描述该公钥的一系列 P2PK、P2PKH、P2WPKH 和 P2SH-P2WPKH 脚本。在公钥未压缩的情况下，这个集合将仅包含 P2PK 和 P2PKH 脚本。</p><h3 id=校验和><a href=#校验和 class=headerlink title=校验和></a>校验和</h3><p>描述符可以加上一个校验和后缀，来防止误输入和复制粘贴错误。</p><p>这些校验和由 8 个字母数字字符构成。只要错误限制在将某一属于 <code>0123456789()[],&#39;/*abcdefgh@:$%&#123;&#125;</code> 集合的字符替换成了集合内的其他字符以及字母大小写的不同，在 501 字符长的描述符中最多可以检测到 4 个错误，在更长的描述符中最多能检测到 3 个。对于更大数量的错误或者其他类型的错误，检测不到错误的几率只有不到万亿分之一。</p><p>Bitcoin Core 的所有 RPC 都会在输出中包含校验和。只有特定的 RPC 需要在输入中添加校验和，包括 <code>deriveaddress</code> 和 <code>importmulti</code> 。尚未具有校验和的描述符的校验和可以使用 <code>getdescriptorinfo</code> RPC 计算出来。</p><p>（完）</p></article></div></div></main><script src="/js/post.js?v=1682773100887"></script><script src="/js/highlight.min.js?v=1682773100887"></script><script>var containerEl=document.querySelector(".post-container"),postFontSize=localStorage.getItem("post-font-size")||"16",inputEl=document.querySelector("#size-change-input"),inputEl2=document.querySelector("#size-change-input2");inputEl.value=postFontSize,inputEl2.value=postFontSize,containerEl.style.fontSize=postFontSize+"px",$(function(){function e(t){$(".post-container").css("font-size",t+"px"),localStorage.setItem("post-font-size",t),$("#size-change-input").val(t),$("#size-change-input2").val(t)}$("#size-change-input").on("input propertychange",function(t){e(t.target.value)}),$("#size-change-input2").on("input propertychange",function(t){e(t.target.value)})})</script><script>hljs.initHighlightingOnLoad()</script></main></div><footer class="is-flex is-flex-direction-column is-align-items-center is-flex-shrink-0"><section class=sns-container><a title=nostr target=_blank rel="noopener nofollow" href=https://iris.to/npub1g2qs0ca5kpwlrcfug2em4jelmh65clk3yccwjxrs6hvdpd9qj80q022j4m>Nostr</a><a title=rss target=_blank rel="noopener nofollow" href=/atom.xml>rss</a><a title=telegram target=_blank rel="noopener nofollow" href=//t.me/btcstudyorg>Telegram</a></section></footer><script async src="/js/buttons.js?v=1682773100887"></script><script async src="/js/index.js?v=1682773100887"></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-JVCJ9XXG1Z"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-JVCJ9XXG1Z")</script><script>var _hmt=_hmt||[];(()=>{var e=document.createElement("script"),t=(e.src="https://hm.baidu.com/hm.js?c92c073c85be5be8d9b1b76f62a7e306",e.async=!0,e.defer=!0,document.getElementsByTagName("script")[0]);t.parentNode.insertBefore(e,t)})()</script></body></html>