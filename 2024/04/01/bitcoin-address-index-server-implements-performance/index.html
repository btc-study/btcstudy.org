<!DOCTYPE html><html lang=zh-CN><head><meta charset=UTF-8><title>比特币地址浏览服务端实现的性能</title><meta name=keywords content="比特币, 中本聪, 比特币区块链, 闪电网络, 比特币 layer 2, 健全货币, 密码货币, 密码朋克, 学习比特币, BTC, BTC Study, Bitcoin, bitcoin, proof of work"><meta name=description content=比特币思想的中文集结地><meta name=viewport content="width=device-width,minimum-scale=1,maximum-scale=1,initial-scale=1"><link rel=icon href=/favicon.ico><link rel=stylesheet href="/style/common/bulma.css?v=1682773100887"><link rel=preload as=style onload='this.onload=null,this.rel="stylesheet"' href="/style/common/iconfont.css?v=1682773100887"><link rel=stylesheet href="/style/base.css?v=1682773100887"><link rel=stylesheet href="/style/common/helper.css?v=1682773100887"><link rel=stylesheet href="/style/themes/animation.css?v=1682773100887"><script>function ready(){var e=document.querySelector(".body-container"),t=localStorage.getItem("theme")||"light";["light","dark"].includes(t)||(t="light",localStorage.setItem("theme","light")),e.classList.remove("appearance-auto"),e.classList.add("appearance-"+t),quickInitialTheme()}function quickInitialTheme(){var e=localStorage.getItem("theme")||"light",t=document.querySelector(".logo-light"),o=document.querySelector(".logo-dark"),d=document.querySelector("#mobile-header-logo > .logo-light"),l=document.querySelector("#mobile-header-logo > .logo-dark"),a=document.getElementById("theme-btn"),i=document.querySelector(".slide-theme-light"),c=document.querySelector(".slide-theme-dark");document.body.classList.add(e),("dark"===e?(t.classList.add("hidden"),o.classList.remove("hidden"),d.classList.add("hidden"),l.classList.remove("hidden"),a.classList.remove("icon-icon_dark"),a.classList.add("icon-icon_light"),i):c).classList.remove("hidden")}document.addEventListener("DOMContentLoaded",ready)</script><script src="/js/common.js?v=1682773100887"></script><script src=/js/libs/zepto.min.js></script><link rel=stylesheet href="/style/post.css?v=1682773100887"><link rel=stylesheet href="/style/themes/highlight.css?v=1682773100887"><meta name=generator content="Hexo 6.3.0"><link rel=alternate href=/atom.xml title="BTC Study" type=application/atom+xml></head><body class="is-flex is-flex-direction-column" onload=initialTheme()><div class=clip></div><div class="body-container appearance-auto"><header class="header-widget is-hidden-mobile is-flex is-flex-shrink-0 is-align-items-center is-justify-content-center" id=header><div class="is-flex header-widget-container is-flex-shrink-0 is-align-items-center"><section class="is-hidden-mobile is-flex-shrink-0"><h1><a href=/ ><svg class=logo-light width=125px height=23px viewBox="0 0 125 23" version=1.1 xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink><title>BTCStudy</title><g id=页面-1 stroke=none stroke-width=1 fill=none fill-rule=evenodd><g id=首页-响应式 transform="translate(-249.000000, -23.000000)" fill-rule=nonzero><g id=BTCStudy transform="translate(249.680000, 23.192000)"><path d="M9.072,17.808 C11.312,17.808 13.024,17.408 14.208,16.608 C15.392,15.808 15.984,14.672 15.984,13.2 C15.984,12.192 15.712,11.332 15.168,10.62 C14.624,9.908 13.872,9.384 12.912,9.048 C13.632,8.68 14.188,8.18 14.58,7.548 C14.972,6.916 15.168,6.2 15.168,5.4 C15.168,4.056 14.608,2.988 13.488,2.196 C12.368,1.404 10.736,1.008 8.592,1.008 L8.592,1.008 L-5.68434189e-14,1.008 L-5.68434189e-14,17.808 L9.072,17.808 Z M7.968,7.68 L4.704,7.68 L4.704,4.44 L7.968,4.44 C9.568,4.44 10.368,4.976 10.368,6.048 C10.368,7.136 9.568,7.68 7.968,7.68 L7.968,7.68 Z M8.688,14.376 L4.704,14.376 L4.704,10.968 L8.688,10.968 C10.352,10.968 11.184,11.536 11.184,12.672 C11.184,13.808 10.352,14.376 8.688,14.376 L8.688,14.376 Z M26.544,17.808 L26.544,4.776 L31.68,4.776 L31.68,1.008 L16.632,1.008 L16.632,4.776 L21.792,4.776 L21.792,17.808 L26.544,17.808 Z M41.592,18.144 C43.128,18.144 44.512,17.872 45.744,17.328 C46.976,16.784 48,16 48.816,14.976 L48.816,14.976 L45.792,12.24 C44.704,13.552 43.384,14.208 41.832,14.208 C40.92,14.208 40.108,14.008 39.396,13.608 C38.684,13.208 38.132,12.644 37.74,11.916 C37.348,11.188 37.152,10.352 37.152,9.408 C37.152,8.464 37.348,7.628 37.74,6.9 C38.132,6.172 38.684,5.608 39.396,5.208 C40.108,4.808 40.92,4.608 41.832,4.608 C43.384,4.608 44.704,5.264 45.792,6.576 L45.792,6.576 L48.816,3.84 C48,2.816 46.976,2.032 45.744,1.488 C44.512,0.944 43.128,0.672 41.592,0.672 C39.832,0.672 38.252,1.044 36.852,1.788 C35.452,2.532 34.352,3.568 33.552,4.896 C32.752,6.224 32.352,7.728 32.352,9.408 C32.352,11.088 32.752,12.592 33.552,13.92 C34.352,15.248 35.452,16.284 36.852,17.028 C38.252,17.772 39.832,18.144 41.592,18.144 Z" id=BTC fill=#F2A900></path><path d="M56.64,18.144 C58.24,18.144 59.6,17.9 60.72,17.412 C61.84,16.924 62.68,16.272 63.24,15.456 C63.8,14.64 64.08,13.728 64.08,12.72 C64.08,11.552 63.772,10.628 63.156,9.948 C62.54,9.268 61.812,8.772 60.972,8.46 C60.132,8.148 59.072,7.856 57.792,7.584 C56.656,7.344 55.832,7.112 55.32,6.888 C54.808,6.664 54.552,6.328 54.552,5.88 C54.552,5.432 54.768,5.068 55.2,4.788 C55.632,4.508 56.32,4.368 57.264,4.368 C58.768,4.368 60.32,4.8 61.92,5.664 L61.92,5.664 L63.384,2.136 C62.568,1.656 61.624,1.292 60.552,1.044 C59.48,0.796 58.392,0.672 57.288,0.672 C55.672,0.672 54.308,0.912 53.196,1.392 C52.084,1.872 51.248,2.524 50.688,3.348 C50.128,4.172 49.848,5.096 49.848,6.12 C49.848,7.288 50.152,8.216 50.76,8.904 C51.368,9.592 52.096,10.092 52.944,10.404 C53.792,10.716 54.848,11.008 56.112,11.28 C57.264,11.536 58.1,11.78 58.62,12.012 C59.14,12.244 59.4,12.6 59.4,13.08 C59.4,13.992 58.488,14.448 56.664,14.448 C55.704,14.448 54.728,14.296 53.736,13.992 C52.744,13.688 51.872,13.288 51.12,12.792 L51.12,12.792 L49.56,16.296 C50.36,16.856 51.4,17.304 52.68,17.64 C53.96,17.976 55.28,18.144 56.64,18.144 Z M71.856,18.024 C72.48,18.024 73.068,17.96 73.62,17.832 C74.172,17.704 74.64,17.52 75.024,17.28 L75.024,17.28 L73.896,14.088 C73.496,14.36 73.032,14.496 72.504,14.496 C72.088,14.496 71.756,14.364 71.508,14.1 C71.26,13.836 71.136,13.472 71.136,13.008 L71.136,13.008 L71.136,8.688 L74.112,8.688 L74.112,5.28 L71.136,5.28 L71.136,1.896 L66.576,1.896 L66.576,5.28 L64.68,5.28 L64.68,8.688 L66.576,8.688 L66.576,13.056 C66.576,14.704 67.032,15.944 67.944,16.776 C68.856,17.608 70.16,18.024 71.856,18.024 Z M82.248,18.024 C83,18.024 83.712,17.888 84.384,17.616 C85.056,17.344 85.632,16.944 86.112,16.416 L86.112,16.416 L86.112,17.808 L90.456,17.808 L90.456,4.8 L85.896,4.8 L85.896,11.064 C85.896,12.104 85.668,12.876 85.212,13.38 C84.756,13.884 84.168,14.136 83.448,14.136 C82.744,14.136 82.208,13.912 81.84,13.464 C81.472,13.016 81.288,12.304 81.288,11.328 L81.288,11.328 L81.288,4.8 L76.728,4.8 L76.728,12.072 C76.728,14.056 77.228,15.544 78.228,16.536 C79.228,17.528 80.568,18.024 82.248,18.024 Z M99.048,18.024 C100.744,18.024 102.016,17.52 102.864,16.512 L102.864,16.512 L102.864,17.808 L107.208,17.808 L107.208,0 L102.648,0 L102.648,5.928 C101.8,5.032 100.6,4.584 99.048,4.584 C97.864,4.584 96.784,4.856 95.808,5.4 C94.832,5.944 94.06,6.724 93.492,7.74 C92.924,8.756 92.64,9.936 92.64,11.28 C92.64,12.624 92.924,13.808 93.492,14.832 C94.06,15.856 94.832,16.644 95.808,17.196 C96.784,17.748 97.864,18.024 99.048,18.024 Z M100.008,14.4 C99.208,14.4 98.552,14.124 98.04,13.572 C97.528,13.02 97.272,12.256 97.272,11.28 C97.272,10.32 97.528,9.568 98.04,9.024 C98.552,8.48 99.208,8.208 100.008,8.208 C100.808,8.208 101.46,8.48 101.964,9.024 C102.468,9.568 102.72,10.32 102.72,11.28 C102.72,12.256 102.464,13.02 101.952,13.572 C101.44,14.124 100.792,14.4 100.008,14.4 Z M112.368,22.68 C113.728,22.68 114.88,22.356 115.824,21.708 C116.768,21.06 117.568,19.936 118.224,18.336 L118.224,18.336 L123.84,4.8 L119.496,4.8 L116.28,12.744 L113.088,4.8 L108.408,4.8 L113.976,17.976 C113.784,18.36 113.548,18.64 113.268,18.816 C112.988,18.992 112.632,19.08 112.2,19.08 C111.832,19.08 111.468,19.012 111.108,18.876 C110.748,18.74 110.44,18.552 110.184,18.312 L110.184,18.312 L108.6,21.504 C109.032,21.856 109.596,22.14 110.292,22.356 C110.988,22.572 111.68,22.68 112.368,22.68 Z" id=Study fill-opacity=0.85 fill=#000000></path></g></g></g></svg><svg class="logo-dark hidden" width=125px height=23px viewBox="0 0 125 23" version=1.1 xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink><title>BTCStudy</title><g id=页面-1 stroke=none stroke-width=1 fill=none fill-rule=evenodd><g id=首页-响应式 transform="translate(-249.000000, -23.000000)" fill-rule=nonzero><g id=BTCStudy transform="translate(249.680000, 23.192000)"><path d="M9.072,17.808 C11.312,17.808 13.024,17.408 14.208,16.608 C15.392,15.808 15.984,14.672 15.984,13.2 C15.984,12.192 15.712,11.332 15.168,10.62 C14.624,9.908 13.872,9.384 12.912,9.048 C13.632,8.68 14.188,8.18 14.58,7.548 C14.972,6.916 15.168,6.2 15.168,5.4 C15.168,4.056 14.608,2.988 13.488,2.196 C12.368,1.404 10.736,1.008 8.592,1.008 L8.592,1.008 L-5.68434189e-14,1.008 L-5.68434189e-14,17.808 L9.072,17.808 Z M7.968,7.68 L4.704,7.68 L4.704,4.44 L7.968,4.44 C9.568,4.44 10.368,4.976 10.368,6.048 C10.368,7.136 9.568,7.68 7.968,7.68 L7.968,7.68 Z M8.688,14.376 L4.704,14.376 L4.704,10.968 L8.688,10.968 C10.352,10.968 11.184,11.536 11.184,12.672 C11.184,13.808 10.352,14.376 8.688,14.376 L8.688,14.376 Z M26.544,17.808 L26.544,4.776 L31.68,4.776 L31.68,1.008 L16.632,1.008 L16.632,4.776 L21.792,4.776 L21.792,17.808 L26.544,17.808 Z M41.592,18.144 C43.128,18.144 44.512,17.872 45.744,17.328 C46.976,16.784 48,16 48.816,14.976 L48.816,14.976 L45.792,12.24 C44.704,13.552 43.384,14.208 41.832,14.208 C40.92,14.208 40.108,14.008 39.396,13.608 C38.684,13.208 38.132,12.644 37.74,11.916 C37.348,11.188 37.152,10.352 37.152,9.408 C37.152,8.464 37.348,7.628 37.74,6.9 C38.132,6.172 38.684,5.608 39.396,5.208 C40.108,4.808 40.92,4.608 41.832,4.608 C43.384,4.608 44.704,5.264 45.792,6.576 L45.792,6.576 L48.816,3.84 C48,2.816 46.976,2.032 45.744,1.488 C44.512,0.944 43.128,0.672 41.592,0.672 C39.832,0.672 38.252,1.044 36.852,1.788 C35.452,2.532 34.352,3.568 33.552,4.896 C32.752,6.224 32.352,7.728 32.352,9.408 C32.352,11.088 32.752,12.592 33.552,13.92 C34.352,15.248 35.452,16.284 36.852,17.028 C38.252,17.772 39.832,18.144 41.592,18.144 Z" id=BTC fill=#F2A900></path><path d="M56.64,18.144 C58.24,18.144 59.6,17.9 60.72,17.412 C61.84,16.924 62.68,16.272 63.24,15.456 C63.8,14.64 64.08,13.728 64.08,12.72 C64.08,11.552 63.772,10.628 63.156,9.948 C62.54,9.268 61.812,8.772 60.972,8.46 C60.132,8.148 59.072,7.856 57.792,7.584 C56.656,7.344 55.832,7.112 55.32,6.888 C54.808,6.664 54.552,6.328 54.552,5.88 C54.552,5.432 54.768,5.068 55.2,4.788 C55.632,4.508 56.32,4.368 57.264,4.368 C58.768,4.368 60.32,4.8 61.92,5.664 L61.92,5.664 L63.384,2.136 C62.568,1.656 61.624,1.292 60.552,1.044 C59.48,0.796 58.392,0.672 57.288,0.672 C55.672,0.672 54.308,0.912 53.196,1.392 C52.084,1.872 51.248,2.524 50.688,3.348 C50.128,4.172 49.848,5.096 49.848,6.12 C49.848,7.288 50.152,8.216 50.76,8.904 C51.368,9.592 52.096,10.092 52.944,10.404 C53.792,10.716 54.848,11.008 56.112,11.28 C57.264,11.536 58.1,11.78 58.62,12.012 C59.14,12.244 59.4,12.6 59.4,13.08 C59.4,13.992 58.488,14.448 56.664,14.448 C55.704,14.448 54.728,14.296 53.736,13.992 C52.744,13.688 51.872,13.288 51.12,12.792 L51.12,12.792 L49.56,16.296 C50.36,16.856 51.4,17.304 52.68,17.64 C53.96,17.976 55.28,18.144 56.64,18.144 Z M71.856,18.024 C72.48,18.024 73.068,17.96 73.62,17.832 C74.172,17.704 74.64,17.52 75.024,17.28 L75.024,17.28 L73.896,14.088 C73.496,14.36 73.032,14.496 72.504,14.496 C72.088,14.496 71.756,14.364 71.508,14.1 C71.26,13.836 71.136,13.472 71.136,13.008 L71.136,13.008 L71.136,8.688 L74.112,8.688 L74.112,5.28 L71.136,5.28 L71.136,1.896 L66.576,1.896 L66.576,5.28 L64.68,5.28 L64.68,8.688 L66.576,8.688 L66.576,13.056 C66.576,14.704 67.032,15.944 67.944,16.776 C68.856,17.608 70.16,18.024 71.856,18.024 Z M82.248,18.024 C83,18.024 83.712,17.888 84.384,17.616 C85.056,17.344 85.632,16.944 86.112,16.416 L86.112,16.416 L86.112,17.808 L90.456,17.808 L90.456,4.8 L85.896,4.8 L85.896,11.064 C85.896,12.104 85.668,12.876 85.212,13.38 C84.756,13.884 84.168,14.136 83.448,14.136 C82.744,14.136 82.208,13.912 81.84,13.464 C81.472,13.016 81.288,12.304 81.288,11.328 L81.288,11.328 L81.288,4.8 L76.728,4.8 L76.728,12.072 C76.728,14.056 77.228,15.544 78.228,16.536 C79.228,17.528 80.568,18.024 82.248,18.024 Z M99.048,18.024 C100.744,18.024 102.016,17.52 102.864,16.512 L102.864,16.512 L102.864,17.808 L107.208,17.808 L107.208,0 L102.648,0 L102.648,5.928 C101.8,5.032 100.6,4.584 99.048,4.584 C97.864,4.584 96.784,4.856 95.808,5.4 C94.832,5.944 94.06,6.724 93.492,7.74 C92.924,8.756 92.64,9.936 92.64,11.28 C92.64,12.624 92.924,13.808 93.492,14.832 C94.06,15.856 94.832,16.644 95.808,17.196 C96.784,17.748 97.864,18.024 99.048,18.024 Z M100.008,14.4 C99.208,14.4 98.552,14.124 98.04,13.572 C97.528,13.02 97.272,12.256 97.272,11.28 C97.272,10.32 97.528,9.568 98.04,9.024 C98.552,8.48 99.208,8.208 100.008,8.208 C100.808,8.208 101.46,8.48 101.964,9.024 C102.468,9.568 102.72,10.32 102.72,11.28 C102.72,12.256 102.464,13.02 101.952,13.572 C101.44,14.124 100.792,14.4 100.008,14.4 Z M112.368,22.68 C113.728,22.68 114.88,22.356 115.824,21.708 C116.768,21.06 117.568,19.936 118.224,18.336 L118.224,18.336 L123.84,4.8 L119.496,4.8 L116.28,12.744 L113.088,4.8 L108.408,4.8 L113.976,17.976 C113.784,18.36 113.548,18.64 113.268,18.816 C112.988,18.992 112.632,19.08 112.2,19.08 C111.832,19.08 111.468,19.012 111.108,18.876 C110.748,18.74 110.44,18.552 110.184,18.312 L110.184,18.312 L108.6,21.504 C109.032,21.856 109.596,22.14 110.292,22.356 C110.988,22.572 111.68,22.68 112.368,22.68 Z" id=Study fill-opacity=0.85 fill=#FFFFFF></path></g></g></g></svg></a></h1></section><div class="is-flex is-flex-direction-column header-menu-wrap"><aside class="is-flex-shrink-0 is-flex is-flex-direction-row is-align-items-center" id=header-menu><a class="is-inline-block header-activity mr-4" href=/ >首页</a><a class="is-inline-block mr-4" href=/archives>全站目录</a><a class="is-inline-block mr-4" href=/tags>标签</a><a class="is-inline-block mr-4" href=/maps>地图</a><a class="is-inline-block mr-4" href=/mempool>mempool</a><a class="is-inline-block mr-4" target=_blank rel=noopener href=https://123btc.org/ >123btc</a><div class="right-content is-flex is-flex-direction-row is-align-items-center"><div class="size-wrap mr-1"><i class="iconfont icon-a-bianzu5" id=change-size-btn></i><div class=size-input-wrap><div class=input-wrap><input id=size-change-input type=range min=12 max=32 step=2></div></div></div><i class="iconfont icon-icon_dark mr-1" id=theme-btn></i><div class=search-wrap><input class=pl-3 id=search-input placeholder=请输入搜索关键词><i class="iconfont icon-icon_search" id=search-input-btn></i></div></div></aside><div class="header-title is-hidden-mobile is-full-height is-flex is-align-items-center is-flex-shrink-0"><div class="is-full-height hidden" id=postTopic><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">比特币地址浏览服务端实现的性能</p><div class="size-wrap mr-1"><i class="iconfont icon-a-bianzu5" id=change-size-btn2></i><div class=size-input-wrap><div class=input-wrap><input id=size-change-input2 type=range min=12 max=32 step=2></div></div></div></div></div></div></div></header><header class="is-flex header-widget is-flex-shrink-0 is-align-items-center is-justify-content-space-between is-hidden-tablet" id=mobile-header><div class="is-flex is-flex-direction-row is-align-items-center"><i class="iconfont icon-icon_bar mobile-header-menu"></i><div id=mobile-header-logo><svg class=logo-light width=125px height=23px viewBox="0 0 125 23" version=1.1 xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink><title>BTCStudy</title><g id=页面-1 stroke=none stroke-width=1 fill=none fill-rule=evenodd><g id=首页-响应式 transform="translate(-249.000000, -23.000000)" fill-rule=nonzero><g id=BTCStudy transform="translate(249.680000, 23.192000)"><path d="M9.072,17.808 C11.312,17.808 13.024,17.408 14.208,16.608 C15.392,15.808 15.984,14.672 15.984,13.2 C15.984,12.192 15.712,11.332 15.168,10.62 C14.624,9.908 13.872,9.384 12.912,9.048 C13.632,8.68 14.188,8.18 14.58,7.548 C14.972,6.916 15.168,6.2 15.168,5.4 C15.168,4.056 14.608,2.988 13.488,2.196 C12.368,1.404 10.736,1.008 8.592,1.008 L8.592,1.008 L-5.68434189e-14,1.008 L-5.68434189e-14,17.808 L9.072,17.808 Z M7.968,7.68 L4.704,7.68 L4.704,4.44 L7.968,4.44 C9.568,4.44 10.368,4.976 10.368,6.048 C10.368,7.136 9.568,7.68 7.968,7.68 L7.968,7.68 Z M8.688,14.376 L4.704,14.376 L4.704,10.968 L8.688,10.968 C10.352,10.968 11.184,11.536 11.184,12.672 C11.184,13.808 10.352,14.376 8.688,14.376 L8.688,14.376 Z M26.544,17.808 L26.544,4.776 L31.68,4.776 L31.68,1.008 L16.632,1.008 L16.632,4.776 L21.792,4.776 L21.792,17.808 L26.544,17.808 Z M41.592,18.144 C43.128,18.144 44.512,17.872 45.744,17.328 C46.976,16.784 48,16 48.816,14.976 L48.816,14.976 L45.792,12.24 C44.704,13.552 43.384,14.208 41.832,14.208 C40.92,14.208 40.108,14.008 39.396,13.608 C38.684,13.208 38.132,12.644 37.74,11.916 C37.348,11.188 37.152,10.352 37.152,9.408 C37.152,8.464 37.348,7.628 37.74,6.9 C38.132,6.172 38.684,5.608 39.396,5.208 C40.108,4.808 40.92,4.608 41.832,4.608 C43.384,4.608 44.704,5.264 45.792,6.576 L45.792,6.576 L48.816,3.84 C48,2.816 46.976,2.032 45.744,1.488 C44.512,0.944 43.128,0.672 41.592,0.672 C39.832,0.672 38.252,1.044 36.852,1.788 C35.452,2.532 34.352,3.568 33.552,4.896 C32.752,6.224 32.352,7.728 32.352,9.408 C32.352,11.088 32.752,12.592 33.552,13.92 C34.352,15.248 35.452,16.284 36.852,17.028 C38.252,17.772 39.832,18.144 41.592,18.144 Z" id=BTC fill=#F2A900></path><path d="M56.64,18.144 C58.24,18.144 59.6,17.9 60.72,17.412 C61.84,16.924 62.68,16.272 63.24,15.456 C63.8,14.64 64.08,13.728 64.08,12.72 C64.08,11.552 63.772,10.628 63.156,9.948 C62.54,9.268 61.812,8.772 60.972,8.46 C60.132,8.148 59.072,7.856 57.792,7.584 C56.656,7.344 55.832,7.112 55.32,6.888 C54.808,6.664 54.552,6.328 54.552,5.88 C54.552,5.432 54.768,5.068 55.2,4.788 C55.632,4.508 56.32,4.368 57.264,4.368 C58.768,4.368 60.32,4.8 61.92,5.664 L61.92,5.664 L63.384,2.136 C62.568,1.656 61.624,1.292 60.552,1.044 C59.48,0.796 58.392,0.672 57.288,0.672 C55.672,0.672 54.308,0.912 53.196,1.392 C52.084,1.872 51.248,2.524 50.688,3.348 C50.128,4.172 49.848,5.096 49.848,6.12 C49.848,7.288 50.152,8.216 50.76,8.904 C51.368,9.592 52.096,10.092 52.944,10.404 C53.792,10.716 54.848,11.008 56.112,11.28 C57.264,11.536 58.1,11.78 58.62,12.012 C59.14,12.244 59.4,12.6 59.4,13.08 C59.4,13.992 58.488,14.448 56.664,14.448 C55.704,14.448 54.728,14.296 53.736,13.992 C52.744,13.688 51.872,13.288 51.12,12.792 L51.12,12.792 L49.56,16.296 C50.36,16.856 51.4,17.304 52.68,17.64 C53.96,17.976 55.28,18.144 56.64,18.144 Z M71.856,18.024 C72.48,18.024 73.068,17.96 73.62,17.832 C74.172,17.704 74.64,17.52 75.024,17.28 L75.024,17.28 L73.896,14.088 C73.496,14.36 73.032,14.496 72.504,14.496 C72.088,14.496 71.756,14.364 71.508,14.1 C71.26,13.836 71.136,13.472 71.136,13.008 L71.136,13.008 L71.136,8.688 L74.112,8.688 L74.112,5.28 L71.136,5.28 L71.136,1.896 L66.576,1.896 L66.576,5.28 L64.68,5.28 L64.68,8.688 L66.576,8.688 L66.576,13.056 C66.576,14.704 67.032,15.944 67.944,16.776 C68.856,17.608 70.16,18.024 71.856,18.024 Z M82.248,18.024 C83,18.024 83.712,17.888 84.384,17.616 C85.056,17.344 85.632,16.944 86.112,16.416 L86.112,16.416 L86.112,17.808 L90.456,17.808 L90.456,4.8 L85.896,4.8 L85.896,11.064 C85.896,12.104 85.668,12.876 85.212,13.38 C84.756,13.884 84.168,14.136 83.448,14.136 C82.744,14.136 82.208,13.912 81.84,13.464 C81.472,13.016 81.288,12.304 81.288,11.328 L81.288,11.328 L81.288,4.8 L76.728,4.8 L76.728,12.072 C76.728,14.056 77.228,15.544 78.228,16.536 C79.228,17.528 80.568,18.024 82.248,18.024 Z M99.048,18.024 C100.744,18.024 102.016,17.52 102.864,16.512 L102.864,16.512 L102.864,17.808 L107.208,17.808 L107.208,0 L102.648,0 L102.648,5.928 C101.8,5.032 100.6,4.584 99.048,4.584 C97.864,4.584 96.784,4.856 95.808,5.4 C94.832,5.944 94.06,6.724 93.492,7.74 C92.924,8.756 92.64,9.936 92.64,11.28 C92.64,12.624 92.924,13.808 93.492,14.832 C94.06,15.856 94.832,16.644 95.808,17.196 C96.784,17.748 97.864,18.024 99.048,18.024 Z M100.008,14.4 C99.208,14.4 98.552,14.124 98.04,13.572 C97.528,13.02 97.272,12.256 97.272,11.28 C97.272,10.32 97.528,9.568 98.04,9.024 C98.552,8.48 99.208,8.208 100.008,8.208 C100.808,8.208 101.46,8.48 101.964,9.024 C102.468,9.568 102.72,10.32 102.72,11.28 C102.72,12.256 102.464,13.02 101.952,13.572 C101.44,14.124 100.792,14.4 100.008,14.4 Z M112.368,22.68 C113.728,22.68 114.88,22.356 115.824,21.708 C116.768,21.06 117.568,19.936 118.224,18.336 L118.224,18.336 L123.84,4.8 L119.496,4.8 L116.28,12.744 L113.088,4.8 L108.408,4.8 L113.976,17.976 C113.784,18.36 113.548,18.64 113.268,18.816 C112.988,18.992 112.632,19.08 112.2,19.08 C111.832,19.08 111.468,19.012 111.108,18.876 C110.748,18.74 110.44,18.552 110.184,18.312 L110.184,18.312 L108.6,21.504 C109.032,21.856 109.596,22.14 110.292,22.356 C110.988,22.572 111.68,22.68 112.368,22.68 Z" id=Study fill-opacity=0.85 fill=#000000></path></g></g></g></svg><svg class="logo-dark hidden" width=125px height=23px viewBox="0 0 125 23" version=1.1 xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink><title>BTCStudy</title><g id=页面-1 stroke=none stroke-width=1 fill=none fill-rule=evenodd><g id=首页-响应式 transform="translate(-249.000000, -23.000000)" fill-rule=nonzero><g id=BTCStudy transform="translate(249.680000, 23.192000)"><path d="M9.072,17.808 C11.312,17.808 13.024,17.408 14.208,16.608 C15.392,15.808 15.984,14.672 15.984,13.2 C15.984,12.192 15.712,11.332 15.168,10.62 C14.624,9.908 13.872,9.384 12.912,9.048 C13.632,8.68 14.188,8.18 14.58,7.548 C14.972,6.916 15.168,6.2 15.168,5.4 C15.168,4.056 14.608,2.988 13.488,2.196 C12.368,1.404 10.736,1.008 8.592,1.008 L8.592,1.008 L-5.68434189e-14,1.008 L-5.68434189e-14,17.808 L9.072,17.808 Z M7.968,7.68 L4.704,7.68 L4.704,4.44 L7.968,4.44 C9.568,4.44 10.368,4.976 10.368,6.048 C10.368,7.136 9.568,7.68 7.968,7.68 L7.968,7.68 Z M8.688,14.376 L4.704,14.376 L4.704,10.968 L8.688,10.968 C10.352,10.968 11.184,11.536 11.184,12.672 C11.184,13.808 10.352,14.376 8.688,14.376 L8.688,14.376 Z M26.544,17.808 L26.544,4.776 L31.68,4.776 L31.68,1.008 L16.632,1.008 L16.632,4.776 L21.792,4.776 L21.792,17.808 L26.544,17.808 Z M41.592,18.144 C43.128,18.144 44.512,17.872 45.744,17.328 C46.976,16.784 48,16 48.816,14.976 L48.816,14.976 L45.792,12.24 C44.704,13.552 43.384,14.208 41.832,14.208 C40.92,14.208 40.108,14.008 39.396,13.608 C38.684,13.208 38.132,12.644 37.74,11.916 C37.348,11.188 37.152,10.352 37.152,9.408 C37.152,8.464 37.348,7.628 37.74,6.9 C38.132,6.172 38.684,5.608 39.396,5.208 C40.108,4.808 40.92,4.608 41.832,4.608 C43.384,4.608 44.704,5.264 45.792,6.576 L45.792,6.576 L48.816,3.84 C48,2.816 46.976,2.032 45.744,1.488 C44.512,0.944 43.128,0.672 41.592,0.672 C39.832,0.672 38.252,1.044 36.852,1.788 C35.452,2.532 34.352,3.568 33.552,4.896 C32.752,6.224 32.352,7.728 32.352,9.408 C32.352,11.088 32.752,12.592 33.552,13.92 C34.352,15.248 35.452,16.284 36.852,17.028 C38.252,17.772 39.832,18.144 41.592,18.144 Z" id=BTC fill=#F2A900></path><path d="M56.64,18.144 C58.24,18.144 59.6,17.9 60.72,17.412 C61.84,16.924 62.68,16.272 63.24,15.456 C63.8,14.64 64.08,13.728 64.08,12.72 C64.08,11.552 63.772,10.628 63.156,9.948 C62.54,9.268 61.812,8.772 60.972,8.46 C60.132,8.148 59.072,7.856 57.792,7.584 C56.656,7.344 55.832,7.112 55.32,6.888 C54.808,6.664 54.552,6.328 54.552,5.88 C54.552,5.432 54.768,5.068 55.2,4.788 C55.632,4.508 56.32,4.368 57.264,4.368 C58.768,4.368 60.32,4.8 61.92,5.664 L61.92,5.664 L63.384,2.136 C62.568,1.656 61.624,1.292 60.552,1.044 C59.48,0.796 58.392,0.672 57.288,0.672 C55.672,0.672 54.308,0.912 53.196,1.392 C52.084,1.872 51.248,2.524 50.688,3.348 C50.128,4.172 49.848,5.096 49.848,6.12 C49.848,7.288 50.152,8.216 50.76,8.904 C51.368,9.592 52.096,10.092 52.944,10.404 C53.792,10.716 54.848,11.008 56.112,11.28 C57.264,11.536 58.1,11.78 58.62,12.012 C59.14,12.244 59.4,12.6 59.4,13.08 C59.4,13.992 58.488,14.448 56.664,14.448 C55.704,14.448 54.728,14.296 53.736,13.992 C52.744,13.688 51.872,13.288 51.12,12.792 L51.12,12.792 L49.56,16.296 C50.36,16.856 51.4,17.304 52.68,17.64 C53.96,17.976 55.28,18.144 56.64,18.144 Z M71.856,18.024 C72.48,18.024 73.068,17.96 73.62,17.832 C74.172,17.704 74.64,17.52 75.024,17.28 L75.024,17.28 L73.896,14.088 C73.496,14.36 73.032,14.496 72.504,14.496 C72.088,14.496 71.756,14.364 71.508,14.1 C71.26,13.836 71.136,13.472 71.136,13.008 L71.136,13.008 L71.136,8.688 L74.112,8.688 L74.112,5.28 L71.136,5.28 L71.136,1.896 L66.576,1.896 L66.576,5.28 L64.68,5.28 L64.68,8.688 L66.576,8.688 L66.576,13.056 C66.576,14.704 67.032,15.944 67.944,16.776 C68.856,17.608 70.16,18.024 71.856,18.024 Z M82.248,18.024 C83,18.024 83.712,17.888 84.384,17.616 C85.056,17.344 85.632,16.944 86.112,16.416 L86.112,16.416 L86.112,17.808 L90.456,17.808 L90.456,4.8 L85.896,4.8 L85.896,11.064 C85.896,12.104 85.668,12.876 85.212,13.38 C84.756,13.884 84.168,14.136 83.448,14.136 C82.744,14.136 82.208,13.912 81.84,13.464 C81.472,13.016 81.288,12.304 81.288,11.328 L81.288,11.328 L81.288,4.8 L76.728,4.8 L76.728,12.072 C76.728,14.056 77.228,15.544 78.228,16.536 C79.228,17.528 80.568,18.024 82.248,18.024 Z M99.048,18.024 C100.744,18.024 102.016,17.52 102.864,16.512 L102.864,16.512 L102.864,17.808 L107.208,17.808 L107.208,0 L102.648,0 L102.648,5.928 C101.8,5.032 100.6,4.584 99.048,4.584 C97.864,4.584 96.784,4.856 95.808,5.4 C94.832,5.944 94.06,6.724 93.492,7.74 C92.924,8.756 92.64,9.936 92.64,11.28 C92.64,12.624 92.924,13.808 93.492,14.832 C94.06,15.856 94.832,16.644 95.808,17.196 C96.784,17.748 97.864,18.024 99.048,18.024 Z M100.008,14.4 C99.208,14.4 98.552,14.124 98.04,13.572 C97.528,13.02 97.272,12.256 97.272,11.28 C97.272,10.32 97.528,9.568 98.04,9.024 C98.552,8.48 99.208,8.208 100.008,8.208 C100.808,8.208 101.46,8.48 101.964,9.024 C102.468,9.568 102.72,10.32 102.72,11.28 C102.72,12.256 102.464,13.02 101.952,13.572 C101.44,14.124 100.792,14.4 100.008,14.4 Z M112.368,22.68 C113.728,22.68 114.88,22.356 115.824,21.708 C116.768,21.06 117.568,19.936 118.224,18.336 L118.224,18.336 L123.84,4.8 L119.496,4.8 L116.28,12.744 L113.088,4.8 L108.408,4.8 L113.976,17.976 C113.784,18.36 113.548,18.64 113.268,18.816 C112.988,18.992 112.632,19.08 112.2,19.08 C111.832,19.08 111.468,19.012 111.108,18.876 C110.748,18.74 110.44,18.552 110.184,18.312 L110.184,18.312 L108.6,21.504 C109.032,21.856 109.596,22.14 110.292,22.356 C110.988,22.572 111.68,22.68 112.368,22.68 Z" id=Study fill-opacity=0.85 fill=#FFFFFF></path></g></g></g></svg></div><div class="mobile-header-title is-full-height is-flex is-align-items-center is-flex-shrink-0"><div class="is-full-height hidden" id=postTopicMobile><p class=is-full-height>比特币地址浏览服务端实现的性能</p></div></div></div><i class="iconfont icon-icon_search mobile-header-searchIcon"></i><div class=mobile-search-wrap><div class=search-input><input class=pl-3 id=mobile-search-input placeholder=请输入搜索关键词><i class="iconfont icon-icon_search mobile-search-input-btn"></i><button class=mobile-search-input-btn>搜 索</button></div></div></header><div class=mobile-slide-menu><a class=header-activity href=/ >首页</a><a href=/archives>全站目录</a><a href=/tags>标签</a><a href=/maps>地图</a><a href=/mempool>mempool</a><a target=_blank rel=noopener href=https://123btc.org/ >123btc</a><div><p class="slide-menu-theme is-flex is-flex-direction-row is-justify-content-space-between is-align-items-center"><span>主题设置</span><span><i class="iconfont icon-icon_light slide-theme-light hidden"></i><i class="iconfont icon-icon_dark slide-theme-dark hidden"></i></span></p><p class=slide-menu-fontsize><span>字体设置</span><span><i class="iconfont icon-bianzubeifen"></i><i class="iconfont icon-bianzu"></i></span></p></div></div><div class="search-mask hidden"><script src="/js/header.js?v=1682773100887"></script></div><main><main class="container is-max-widescreen content section post-page pt-4"><div class="columns is-flex-desktop is-justify-content-center"><div class="column is-3 silde-bar is-hidden-mobile"><ol class=toc><li class="toc-item toc-level-2"><a class=toc-link href=#%E8%83%8C%E6%99%AF><span class=toc-text>背景</span></a></li><li class="toc-item toc-level-2"><a class=toc-link href=#%E5%8A%A8%E6%9C%BA><span class=toc-text>动机</span></a></li><li class="toc-item toc-level-2"><a class=toc-link href=#%E7%A1%AC%E4%BB%B6><span class=toc-text>硬件</span></a></li><li class="toc-item toc-level-2"><a class=toc-link href=#%E5%8F%82%E4%B8%8E%E6%AF%94%E8%BE%83%E7%9A%84%E9%A1%B9%E7%9B%AE><span class=toc-text>参与比较的项目</span></a><ol class=toc-child><li class="toc-item toc-level-3"><a class=toc-link href=#ElectrumX><span class=toc-text>ElectrumX</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#Electrs><span class=toc-text>Electrs</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#Fulcrum><span class=toc-text>Fulcrum</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#Electrs-esplora><span class=toc-text>Electrs-esplora</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#addrindexrs><span class=toc-text>addrindexrs</span></a></li></ol></li><li class="toc-item toc-level-2"><a class=toc-link href=#%E7%B4%A2%E5%BC%95%E7%BC%96%E5%88%B6><span class=toc-text>索引编制</span></a></li><li class="toc-item toc-level-2"><a class=toc-link href=#%E6%B5%8B%E8%AF%95><span class=toc-text>测试</span></a></li><li class="toc-item toc-level-2"><a class=toc-link href=#%E7%BB%93%E6%9E%9C><span class=toc-text>结果</span></a><ol class=toc-child><li class="toc-item toc-level-3"><a class=toc-link href=#%E6%B5%8B%E8%AF%95-1%EF%BC%9A%E5%88%9D%E5%A7%8B%E5%8C%96%E8%BD%BD%E8%8D%B7><span class=toc-text>测试 1：初始化载荷</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E6%B5%8B%E8%AF%95-2%EF%BC%9A%E9%92%B1%E5%8C%85%E5%88%B7%E6%96%B0><span class=toc-text>测试 2：钱包刷新</span></a></li></ol></li><li class="toc-item toc-level-2"><a class=toc-link href=#%E8%AE%A8%E8%AE%BA><span class=toc-text>讨论</span></a></li><li class="toc-item toc-level-2"><a class=toc-link href=#%E7%BB%93%E8%AE%BA><span class=toc-text>结论</span></a></li></ol></div><div class="column is-9 post-container"><h1 class="mt-0 mb-2" id=postTitle>比特币地址浏览服务端实现的性能</h1><div class=page-author><div class="is-flex is-flex-direction-row page-data mr-6"><img class=mr-1 src=/images/default_avatar.png alt=Sparrow><div class=page-author-info><strong>Sparrow</strong><time class=has-text-grey datetime=2024-04-01T10:20:03.000Z>2024-04-01</time></div></div><div class=is-flex><a href=/tags/%E5%BC%80%E5%8F%91><i class="page-tag mr-1 px-1">开发</i></a></div></div><article class="mt-4 post-content"><blockquote><p><em>作者：Sparrow</em></p><p><em>来源：<a target=_blank rel=noopener href=https://sparrowwallet.com/docs/server-performance.html>https://sparrowwallet.com/docs/server-performance.html</a></em></p><p><em>本文最近一次更新时间是 2022 年 2 月 1 日。</em></p></blockquote><p>Sparrow Wallet 依赖于 “Electrum 服务端协议” 来检索和发送交易的信息。本文档致力于为不同的完全索引 Electrum 服务端实现在常用硬件上的表现提供一个合理的、及时的基准比较。本文还基于这些发现，讨论了这些实现所采取的两种不同方法。</p><h2 id=背景><a href=#背景 class=headerlink title=背景></a>背景</h2><p>Electrum 服务端是一种比特币地址索引。简单来说，你给服务端提供随便一个地址，它就会返回跟这个地址相关的交易。比特币的参考实现（译者注：指 <code>Bitcoin Core</code>）并不支持这种功能（<a target=_blank rel=noopener href=https://bitcoin.stackexchange.com/questions/107619/why-does-bitcoin-core-support-a-transaction-index-but-not-an-address-index>可能永远不会支持</a>）。注意，你也可以使用 “<a target=_blank rel=noopener href=https://github.com/bitcoin/bips/blob/master/bip-0157.mediawiki>致密区块过滤器</a>” 获得这种信息，但这种方法并不支持交易池中的交易，<a target=_blank rel=noopener href=https://github.com/bitcoin/bitcoin/pull/20702#issuecomment-753480327>性能表现也差得多</a>。</p><p>当然也有别的类型的地址索引器，但 Electrum 服务端协议是目前为止最广泛使用的比特币地址索引协议。本基准测试针对的是完全地址索引。从隐私性角度看，完全地址索引是重要的，因为它不会在服务端存储任何一个钱包的细节。对于真正的冷存储来说，所有关于钱包的细节都应该仅存储在钱包文件中，一旦连接中止，就不应在服务端留下任何信息。这就将 <a target=_blank rel=noopener href=http://github.com/bwt-dev/bwt>BWT</a> 和 <a target=_blank rel=noopener href=https://github.com/chris-belcher/electrum-personal-server>EPS</a> 这样的必须存储向它提供的钱包的地址的项目排除在外。</p><h2 id=动机><a href=#动机 class=headerlink title=动机></a>动机</h2><p>早前由 Jameson Lopp 撰写的一份性能报告是在 2020 年 7 月出版的，<a target=_blank rel=noopener href=https://blog.keys.casa/electrum-server-performance-report/ >也值得一看</a>。</p><p>本文档以两个元素为基础：</p><ol><li>运行在树莓派 4 型上，而不是运行在 AWS 服务器上</li><li>使用这些项目的最新版本，并且每当增加一个重要变更，都重新测试</li></ol><p>因此，希望在单主板电脑上运行自己的 Electrum 服务端的 Sparrow 用户会发现本文档的优点：可以出于自己的需要，对比不同的实现。</p><h2 id=硬件><a href=#硬件 class=headerlink title=硬件></a>硬件</h2><p>为了模拟大部分关心隐私的 Sparrow 用户的情况，我们在所有测试中都使用单主板电脑（SBC）。目前，最常见的 SBC 是树莓派 4 型。本基准测试使用的是其 8 GB 内存的版本，操作系统是 Ubuntu 21.10 64 位版。</p><p>比特币区块链以及任何建立在它基础上的索引，在数据体积上都非常大（当前大约是 0.5 TB）。因此，人们常常推荐使用固态硬盘（而非常见的机械硬盘）作为存储媒介。本测试使用了一个容量为 1 TB 的外置固态硬盘，以 USB 连接。</p><h2 id=参与比较的项目><a href=#参与比较的项目 class=headerlink title=参与比较的项目></a>参与比较的项目</h2><h3 id=ElectrumX><a href=#ElectrumX class=headerlink title=ElectrumX></a>ElectrumX</h3><p>ElectrumX 是最初的 Electrum 服务端项目为走向 ElectrumX 而在 2017 年停止后推出的第二代 Electrum 服务端实现。在 ElectrumX 的原作者决定不再支持比特币区块链之后，Electrum 的开发者们复刻了这个项目。现在，它在这里维护：<a target=_blank rel=noopener href=https://github.com/spesmilo/electrumx>https://github.com/spesmilo/electrumx</a> 。</p><p>运行 ElectrumX 的一个显著困难出现在初次建构索引的时候。在我们这次测试所用的硬件上，建构索引花费了<a target=_blank rel=noopener href=https://twitter.com/openoms/status/1487099572694437892>大约一周的时间</a>。不过，请注意，这样的索引可以在更强大的计算机上建构出来，再迁移到 SBC 上。</p><ul><li>当前的数据库大小：75 GB</li><li>要求在 Bitcoin Core 中启用 <code>txindex（交易索引）</code></li><li>不提供二进制文件</li><li>测试版本：ElectrumX 1.16</li></ul><h3 id=Electrs><a href=#Electrs class=headerlink title=Electrs></a>Electrs</h3><p>ElectrumX 的设计初衷是放在公开服务端上，而 Electrs 的设计场景是个人用户。因此，它的存储要求更低（但 CPU 用量更高，我们后面会看到）。它的代码现在在这里维护：<a target=_blank rel=noopener href=https://github.com/romanz/electrs>https://github.com/romanz/electrs</a> 。</p><p>与 ElectrumX 相反，建构索引在我们这次测试所用的硬件上只花费了 12 ~ 24 小时。这也使它成为了所有预先构建的节点软件包的首选。</p><ul><li>当前的数据库大小：32 GB</li><li>不要求在 Bitcoin Core 上启用 <code>txindex</code></li><li>不提供二进制文件</li><li>测试版本：Electrs 0.9.4</li></ul><h3 id=Fulcrum><a href=#Fulcrum class=headerlink title=Fulcrum></a>Fulcrum</h3><p>Fulcrum 是一个使用现代 C++ 语言编写的新实现。虽然它比 ElectrumX 和 Electrs 占用了更多的硬盘，但它的性能好得多。它的代码库在：<a target=_blank rel=noopener href=https://github.com/cculianu/Fulcrum>https://github.com/cculianu/Fulcrum</a> 。</p><p>Fulcrum 的索引可以在测试所用的设备上用 2 ~ 3 天建构出来，具体取决于你的配置。这介于 Electrs 和 ElectrumX 之间，但是，一旦索引建构好之后，其性能是可圈可点的。</p><ul><li>当前的数据库大小：102 GB</li><li>要求在 Bitcoin Core 上启用 <code>txindex</code></li><li>给 Linux（x86-64 和 arm64）和 Windows 提供了二进制文件</li><li>测试版本：Fulcrum 1.6.0</li></ul><h3 id=Electrs-esplora><a href=#Electrs-esplora class=headerlink title=Electrs-esplora></a>Electrs-esplora</h3><p>这是 Electrs 项目的一个复刻，建构了额外的索引，以为企业用户提供更好的性能。不过，因为其空间需求（约 800 GB），这个实现对我们的测试来说是不合适的。注意，它可以使用 <code>--lightmode</code> 标签来运行，硬盘空间要求会减少一半。不过，即使如此，1 TB 的容量也几乎要用光了，因为光区块链自身就有 420 GB 了。</p><h3 id=addrindexrs><a href=#addrindexrs class=headerlink title=addrindexrs></a>addrindexrs</h3><p>这是 Electrs 项目的另一个复刻，被 Samourai Dojo 的后台使用，用来检索历史交易数据。从性能上看，没有重大的提升，不值得当成一个单独的实现。</p><h2 id=索引编制><a href=#索引编制 class=headerlink title=索引编制></a>索引编制</h2><p>在运行性能测试之前，我们要更深入地考虑索引初始化过程。这三个参加测试的实现的初始化用时在 1 天到 1 周之间。我们逐个来看：</p><p>ElectrumX 的编制索引的速度是最慢的，有可能是因为其编程语言是 Python，它是单线程的，而且解析区块的速度较慢。不过，它所建立的索引可以在不触及 Bitcoin Core 的前提下响应常见的请求，这使它成了可扩展性更好的服务端。在使用 ElectrumX 时，请一定使用 64 位的操作系统 —— 不然编制索引的速度还会慢得多。</p><p>Electrs 编制索引的速度更快，因为其索引也没有那么复杂，而且因为区块检索和解析都是高度优化的。需要这样做，因为 Electrs 不会在索引中存储足以响应大多数请求的信息 —— 相反，它需要在正常操作期间重新索引区块。这个取舍在钱包的深度增加时就变成了问题的来源，我们后面会说。</p><p>Fulcrum 编制出来的索引稍大于 ElectrumX 的，但速度快得多。因为非常消耗资源，索引编制的性能得益于其更加底层的编程语言。注意，通过使用 “<a target=_blank rel=noopener href=https://github.com/cculianu/Fulcrum/blob/master/doc/fulcrum-example-config.conf#L685>fast sync</a>” 配置选项，编制索引的速度可以提高。后面我们会知道，这套综合的索引会在操作时提供令人惊讶的性能。</p><h2 id=测试><a href=#测试 class=headerlink title=测试></a>测试</h2><p>为了提供有意义的数据，我们用了一个很大的钱包（使用过大约 3000 个地址）。</p><p>这个基准测试致力于测试来自 Sparrow 钱包的两种常见（但完全不同）的服务端载荷：</p><ol><li>初次加载一个钱包。因为加载过的 Sparrow 钱包已经包含了许多钱包数据（交易和区块），不需要完全重新检索，这个测试针对的是地址订阅。地址订阅让 Sparrow 可以 “订阅” 一个地址，让服务端在地址有动作时提供更新。<strong>此外，订阅请求会返回一个影响该地址的所有交易 id（txid）以及区块高度的哈希值</strong>。这第二项要求是理解服务端性能的关键。这个测试度量了订阅钱包中的所有地址要多长时间。</li><li>刷新钱包。理想情况下，钱包永远不需要刷新 —— 钱包应该只需要增量更新。但是，通信问题和服务端问题可能产生坏数据，这就需要通过在 Sparrow（视图菜单）中刷新钱包来解决。这个测试度量了仅仅检索所有钱包数据（交易和区块）所需的时间，因为在刷新的时候，地址已经订阅了。</li></ol><p>所有参加测试的服务端时间都支持批量请求。在本次测试中，单个批次的请求数量是 50 个。</p><h2 id=结果><a href=#结果 class=headerlink title=结果></a>结果</h2><h3 id=测试-1：初始化载荷><a href=#测试-1：初始化载荷 class=headerlink title="测试 1：初始化载荷"></a>测试 1：初始化载荷</h3><table><thead><tr><th align=left>测试对象</th><th align=left>冷启动</th><th align=left>第一轮</th><th align=left>第二轮</th><th align=left>第三轮</th></tr></thead><tbody><tr><td align=left>ElectrumX</td><td align=left>52655 ms</td><td align=left>40721 ms</td><td align=left>54143 ms</td><td align=left>49011 ms</td></tr><tr><td align=left>Electrs</td><td align=left>322386 ms</td><td align=left>393303 ms</td><td align=left>384036 ms</td><td align=left>427722 ms</td></tr><tr><td align=left>Fulcrum</td><td align=left>2333 ms</td><td align=left>1413 ms</td><td align=left>1472 ms</td><td align=left>1413 ms</td></tr></tbody></table><blockquote><p><strong>一句话总结</strong>：Fulcrum 比 ElectrumX 快 22 倍，比 Electrs 快 300 倍。</p></blockquote><h3 id=测试-2：钱包刷新><a href=#测试-2：钱包刷新 class=headerlink title="测试 2：钱包刷新"></a>测试 2：钱包刷新</h3><table><thead><tr><th align=left>测试对象</th><th align=left>冷启动</th><th align=left>第一轮</th><th align=left>第二轮</th><th align=left>第三轮</th></tr></thead><tbody><tr><td align=left>ElectrumX</td><td align=left>114466 ms</td><td align=left>66175 ms</td><td align=left>80133 ms</td><td align=left>75489 ms</td></tr><tr><td align=left>Electrs</td><td align=left>17562 ms</td><td align=left>11621 ms</td><td align=left>11219 ms</td><td align=left>11521 ms</td></tr><tr><td align=left>Fulcrum</td><td align=left>14152 ms</td><td align=left>7854 ms</td><td align=left>7382 ms</td><td align=left>7442 ms</td></tr></tbody></table><blockquote><p><strong>一句话总结</strong>：Fulcrum 比 ElectrumX 快 8 倍，比 Electrs 快 1.5 倍。</p></blockquote><h2 id=讨论><a href=#讨论 class=headerlink title=讨论></a>讨论</h2><p>测试 1 的结果一开始让我们非常惊讶。因为 Fulcrum 和 Electrs 的性能差距非常大（1.4 秒 vs. 6 分钟，处理的是相同的数据！）。这主要是因为 Electrs 并不存储找到跟一个地址相关的交易的所有数据。</p><p>可以从文档《<a target=_blank rel=noopener href=https://github.com/romanz/electrs/blob/master/doc/schema.md>Electrs 数据库方案</a>》中看出，它只会存储跟一个地址有关的区块高度。更具体一些，交易的<a target=_blank rel=noopener href=https://electrumx-spesmilo.readthedocs.io/en/latest/protocol-basics.html#script-hashes>脚本公钥会被哈希</a>，然后取这个 <code>script hash</code> 的前 8 个字节，作为一个关键字，而其值就是跟这个 script hash 相关的交易的已确认区块高度。这意味着，区块必须通过 P2P 接口从 Bitcoin Core 中检索出来，然后解析得到匹配这个地址的输出的交易。对于一个重度使用的钱包，比如我们用在测试中的这个，每次载入都会有大量的交易必须重新解析出来。<strong>具体到我们这个钱包，这需要从 Bitcoin Core 中拉取 3.5 GB 的数据，然后解析出来；每次载入这个钱包都需要这样的拉取和解析哦！</strong></p><p>这给 SBC 带来了巨大的 CPU 负担，无论是 Bitcoin Core 还是 Electrs 的进程。最大的问题是，有时候，Electrs 会应接不暇，完全无法处理任何别的请求，也无法在此期间为 Sparrow 提供已订阅的地址有新交易的通知。这可能会导致具有相当深度的钱包在加载时出现过时的或者坏的数据。如果有你曾在使用 Electrs 时被迫使用 Sparrow 的 “刷新钱包” 功能，可能就是这个原因。</p><p>ElectrumX 和 Fulctrum 则相反，存储了完全地址索引查找所需的数据。更具体来说，在给服务端提供一个地址时，它能返回跟这个地址有关的所有交易的 ID，以及相应的区块高度。这让 Sparrow 这样的钱包可以高效地检查是否已经知晓了影响这个钱包的所有现存交易，然后只请求自己还不知晓的交易。在跟 Bitcoin Core 的交易索引（<code>txindex=1</code>）相结合时，这个办法可以非常高效，就像 Fulcrum 的测试结果那样。</p><p>即使知道了这些，Fulcrum 的性能也让人印象深刻。显然，使用最先的 <code>c++17</code> 语言是非常有好处的，不仅因为它更快，而且因为它在不同平台上的性能是一致的。而在 ElectrumX 中， Python 似乎不那么适合这个应用。不仅因为它更慢，而且因为编制索引和查询的性能都会因底层的硬件架构而变化 —— 这个基准测试的上一个版本使用了 32 位的操作系统，显示出更快的查询性能，但索引速度慢得多。值得指出的是，在查询的时候，ElectrumX 的 CPU 用量比 Fulcrum 更高（持续时间也更长）。</p><h2 id=结论><a href=#结论 class=headerlink title=结论></a>结论</h2><p>我们可以在一定程度上确认，未来会继续的两种趋势：钱包的深度会增加，存储的成本会降低。</p><p><strong>因此，Fulcrum 成为了这次基准测试的显然胜出者</strong>。虽然它编制索引的速度稍慢于 Electrs，然而，一旦索引编制完成，可扩展和强大性能的好处会显著盖过这个一次性的成本，不仅在查询的速度和可靠性方面，也在硬件的生命长度上。</p><p>虽然 Electrs 在硬件空间非常有限、钱包深度也有限时有一些好处，Fulcrum 是我们认为与 Sparrow 配对的理想服务端实现。</p><blockquote><p><em><strong>技术注释</strong></em></p><p>理解如何开发一套高效的地址索引也是有趣的事。我们来看看 Fulcrum 和 ElectrumX 是如何存储数据的。在 ElectrumX 中，类似于 Electrs，历史数据存储 script hash 的前 11 个字节作为关键字（关键字的长度稍长，使存储负担增加，但也会降低不正确查找的 “假阳性” 概率）。Fulcrum 存储每个 script hash 的全部 32 字节，这意味着更大的数据库体积，但完全没有假阳性问题（译者注：“假阳性” 在这里的意思是被检测手段命中，但找出的交易并不是我们需要的）。</p><p>与 Electrs 相反（将 script hash 匹配到一个区块高度），ElectrumX 中存储的、跟 script hash 对应的值是一个列表，包含的是区块链上与其有关的交易的有序数字（叫做 <code>tx_num</code>）。<code>tx_num</code> 可以这样解释：每一笔交易在一个区块中都是有序的（有位置的），所以可以通过查找一笔交易在整条区块链中的位置来为它确定一个累加数字。它本质上是 txid 的一个简写，但它不仅减少了要存储的数据，而且允许快速查找区块高度。</p><p>举个例子，txid 是从一个包含了按照区块链排序的所有 txid 的逻辑文件决定的，而文件中的偏移量就是 <code>tx_num</code> 乘以 32 字节（一个 SHA256 哈希值的字节长度）。类似地，Fulcrum 和 ElectrumX 都在内存中维护一个元组，每个索引号都对应着区块高度，而索引的数值包含了存在于该高度的区块内的交易的累加数字。这意味着，从一个 script hash 检索得到 <code>tx_nums</code> 之后，就可以为每一个 <code>tx_num</code> 快速搜索 txid 和区块高度。这就是它们实现对比 Electrs 的性能优势的原因。这部分性能的代价是更大的磁盘占用 —— Electrum 多占用了 21 GB 的空间来存放逻辑文件、指行从 <code>tx_num</code> 到 txid 的查找。软件工程通常都涉及取舍，而在这里，舍弃换来的是查询性能上的显著优化。</p></blockquote><p>（完）</p></article></div></div></main><script src="/js/post.js?v=1682773100887"></script><script src="/js/highlight.min.js?v=1682773100887"></script><script>var containerEl=document.querySelector(".post-container"),postFontSize=localStorage.getItem("post-font-size")||"16",inputEl=document.querySelector("#size-change-input"),inputEl2=document.querySelector("#size-change-input2");inputEl.value=postFontSize,inputEl2.value=postFontSize,containerEl.style.fontSize=postFontSize+"px",$(function(){function e(t){$(".post-container").css("font-size",t+"px"),localStorage.setItem("post-font-size",t),$("#size-change-input").val(t),$("#size-change-input2").val(t)}$("#size-change-input").on("input propertychange",function(t){e(t.target.value)}),$("#size-change-input2").on("input propertychange",function(t){e(t.target.value)})})</script><script>hljs.initHighlightingOnLoad()</script></main></div><footer class="is-flex is-flex-direction-column is-align-items-center is-flex-shrink-0"><section class=sns-container><a title=nostr target=_blank rel="noopener nofollow" href=https://iris.to/npub1g2qs0ca5kpwlrcfug2em4jelmh65clk3yccwjxrs6hvdpd9qj80q022j4m>Nostr</a><a title=rss target=_blank rel="noopener nofollow" href=/atom.xml>rss</a><a title=telegram target=_blank rel="noopener nofollow" href=//t.me/btcstudyorg>Telegram</a></section></footer><script async src="/js/buttons.js?v=1682773100887"></script><script async src="/js/index.js?v=1682773100887"></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-JVCJ9XXG1Z"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-JVCJ9XXG1Z")</script><script>var _hmt=_hmt||[];(()=>{var e=document.createElement("script"),t=(e.src="https://hm.baidu.com/hm.js?c92c073c85be5be8d9b1b76f62a7e306",e.async=!0,e.defer=!0,document.getElementsByTagName("script")[0]);t.parentNode.insertBefore(e,t)})()</script></body></html>