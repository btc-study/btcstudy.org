<!DOCTYPE html><html lang=zh-CN><head><meta charset=UTF-8><title>使用秘密的 BIP32 路径来遮掩一个种子</title><meta name=keywords content="比特币, 中本聪, 比特币区块链, 闪电网络, 比特币 layer 2, 健全货币, 密码货币, 密码朋克, 学习比特币, BTC, BTC Study, Bitcoin, bitcoin, proof of work"><meta name=description content=比特币思想的中文集结地><meta name=viewport content="width=device-width,minimum-scale=1,maximum-scale=1,initial-scale=1"><link rel=icon href=/favicon.ico><link rel=stylesheet href="/style/common/bulma.css?v=1682773100887"><link rel=preload as=style onload='this.onload=null,this.rel="stylesheet"' href="/style/common/iconfont.css?v=1682773100887"><link rel=stylesheet href="/style/base.css?v=1682773100887"><link rel=stylesheet href="/style/common/helper.css?v=1682773100887"><link rel=stylesheet href="/style/themes/animation.css?v=1682773100887"><script>function ready(){var e=document.querySelector(".body-container"),t=localStorage.getItem("theme")||"light";["light","dark"].includes(t)||(t="light",localStorage.setItem("theme","light")),e.classList.remove("appearance-auto"),e.classList.add("appearance-"+t),quickInitialTheme()}function quickInitialTheme(){var e=localStorage.getItem("theme")||"light",t=document.querySelector(".logo-light"),o=document.querySelector(".logo-dark"),d=document.querySelector("#mobile-header-logo > .logo-light"),l=document.querySelector("#mobile-header-logo > .logo-dark"),a=document.getElementById("theme-btn"),i=document.querySelector(".slide-theme-light"),c=document.querySelector(".slide-theme-dark");document.body.classList.add(e),("dark"===e?(t.classList.add("hidden"),o.classList.remove("hidden"),d.classList.add("hidden"),l.classList.remove("hidden"),a.classList.remove("icon-icon_dark"),a.classList.add("icon-icon_light"),i):c).classList.remove("hidden")}document.addEventListener("DOMContentLoaded",ready)</script><script src="/js/common.js?v=1682773100887"></script><script src=/js/libs/zepto.min.js></script><link rel=stylesheet href="/style/post.css?v=1682773100887"><link rel=stylesheet href="/style/themes/highlight.css?v=1682773100887"><meta name=generator content="Hexo 6.3.0"><link rel=alternate href=/atom.xml title="BTC Study" type=application/atom+xml></head><body class="is-flex is-flex-direction-column" onload=initialTheme()><div class=clip></div><div class="body-container appearance-auto"><header class="header-widget is-hidden-mobile is-flex is-flex-shrink-0 is-align-items-center is-justify-content-center" id=header><div class="is-flex header-widget-container is-flex-shrink-0 is-align-items-center"><section class="is-hidden-mobile is-flex-shrink-0"><h1><a href=/ ><svg class=logo-light width=125px height=23px viewBox="0 0 125 23" version=1.1 xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink><title>BTCStudy</title><g id=页面-1 stroke=none stroke-width=1 fill=none fill-rule=evenodd><g id=首页-响应式 transform="translate(-249.000000, -23.000000)" fill-rule=nonzero><g id=BTCStudy transform="translate(249.680000, 23.192000)"><path d="M9.072,17.808 C11.312,17.808 13.024,17.408 14.208,16.608 C15.392,15.808 15.984,14.672 15.984,13.2 C15.984,12.192 15.712,11.332 15.168,10.62 C14.624,9.908 13.872,9.384 12.912,9.048 C13.632,8.68 14.188,8.18 14.58,7.548 C14.972,6.916 15.168,6.2 15.168,5.4 C15.168,4.056 14.608,2.988 13.488,2.196 C12.368,1.404 10.736,1.008 8.592,1.008 L8.592,1.008 L-5.68434189e-14,1.008 L-5.68434189e-14,17.808 L9.072,17.808 Z M7.968,7.68 L4.704,7.68 L4.704,4.44 L7.968,4.44 C9.568,4.44 10.368,4.976 10.368,6.048 C10.368,7.136 9.568,7.68 7.968,7.68 L7.968,7.68 Z M8.688,14.376 L4.704,14.376 L4.704,10.968 L8.688,10.968 C10.352,10.968 11.184,11.536 11.184,12.672 C11.184,13.808 10.352,14.376 8.688,14.376 L8.688,14.376 Z M26.544,17.808 L26.544,4.776 L31.68,4.776 L31.68,1.008 L16.632,1.008 L16.632,4.776 L21.792,4.776 L21.792,17.808 L26.544,17.808 Z M41.592,18.144 C43.128,18.144 44.512,17.872 45.744,17.328 C46.976,16.784 48,16 48.816,14.976 L48.816,14.976 L45.792,12.24 C44.704,13.552 43.384,14.208 41.832,14.208 C40.92,14.208 40.108,14.008 39.396,13.608 C38.684,13.208 38.132,12.644 37.74,11.916 C37.348,11.188 37.152,10.352 37.152,9.408 C37.152,8.464 37.348,7.628 37.74,6.9 C38.132,6.172 38.684,5.608 39.396,5.208 C40.108,4.808 40.92,4.608 41.832,4.608 C43.384,4.608 44.704,5.264 45.792,6.576 L45.792,6.576 L48.816,3.84 C48,2.816 46.976,2.032 45.744,1.488 C44.512,0.944 43.128,0.672 41.592,0.672 C39.832,0.672 38.252,1.044 36.852,1.788 C35.452,2.532 34.352,3.568 33.552,4.896 C32.752,6.224 32.352,7.728 32.352,9.408 C32.352,11.088 32.752,12.592 33.552,13.92 C34.352,15.248 35.452,16.284 36.852,17.028 C38.252,17.772 39.832,18.144 41.592,18.144 Z" id=BTC fill=#F2A900></path><path d="M56.64,18.144 C58.24,18.144 59.6,17.9 60.72,17.412 C61.84,16.924 62.68,16.272 63.24,15.456 C63.8,14.64 64.08,13.728 64.08,12.72 C64.08,11.552 63.772,10.628 63.156,9.948 C62.54,9.268 61.812,8.772 60.972,8.46 C60.132,8.148 59.072,7.856 57.792,7.584 C56.656,7.344 55.832,7.112 55.32,6.888 C54.808,6.664 54.552,6.328 54.552,5.88 C54.552,5.432 54.768,5.068 55.2,4.788 C55.632,4.508 56.32,4.368 57.264,4.368 C58.768,4.368 60.32,4.8 61.92,5.664 L61.92,5.664 L63.384,2.136 C62.568,1.656 61.624,1.292 60.552,1.044 C59.48,0.796 58.392,0.672 57.288,0.672 C55.672,0.672 54.308,0.912 53.196,1.392 C52.084,1.872 51.248,2.524 50.688,3.348 C50.128,4.172 49.848,5.096 49.848,6.12 C49.848,7.288 50.152,8.216 50.76,8.904 C51.368,9.592 52.096,10.092 52.944,10.404 C53.792,10.716 54.848,11.008 56.112,11.28 C57.264,11.536 58.1,11.78 58.62,12.012 C59.14,12.244 59.4,12.6 59.4,13.08 C59.4,13.992 58.488,14.448 56.664,14.448 C55.704,14.448 54.728,14.296 53.736,13.992 C52.744,13.688 51.872,13.288 51.12,12.792 L51.12,12.792 L49.56,16.296 C50.36,16.856 51.4,17.304 52.68,17.64 C53.96,17.976 55.28,18.144 56.64,18.144 Z M71.856,18.024 C72.48,18.024 73.068,17.96 73.62,17.832 C74.172,17.704 74.64,17.52 75.024,17.28 L75.024,17.28 L73.896,14.088 C73.496,14.36 73.032,14.496 72.504,14.496 C72.088,14.496 71.756,14.364 71.508,14.1 C71.26,13.836 71.136,13.472 71.136,13.008 L71.136,13.008 L71.136,8.688 L74.112,8.688 L74.112,5.28 L71.136,5.28 L71.136,1.896 L66.576,1.896 L66.576,5.28 L64.68,5.28 L64.68,8.688 L66.576,8.688 L66.576,13.056 C66.576,14.704 67.032,15.944 67.944,16.776 C68.856,17.608 70.16,18.024 71.856,18.024 Z M82.248,18.024 C83,18.024 83.712,17.888 84.384,17.616 C85.056,17.344 85.632,16.944 86.112,16.416 L86.112,16.416 L86.112,17.808 L90.456,17.808 L90.456,4.8 L85.896,4.8 L85.896,11.064 C85.896,12.104 85.668,12.876 85.212,13.38 C84.756,13.884 84.168,14.136 83.448,14.136 C82.744,14.136 82.208,13.912 81.84,13.464 C81.472,13.016 81.288,12.304 81.288,11.328 L81.288,11.328 L81.288,4.8 L76.728,4.8 L76.728,12.072 C76.728,14.056 77.228,15.544 78.228,16.536 C79.228,17.528 80.568,18.024 82.248,18.024 Z M99.048,18.024 C100.744,18.024 102.016,17.52 102.864,16.512 L102.864,16.512 L102.864,17.808 L107.208,17.808 L107.208,0 L102.648,0 L102.648,5.928 C101.8,5.032 100.6,4.584 99.048,4.584 C97.864,4.584 96.784,4.856 95.808,5.4 C94.832,5.944 94.06,6.724 93.492,7.74 C92.924,8.756 92.64,9.936 92.64,11.28 C92.64,12.624 92.924,13.808 93.492,14.832 C94.06,15.856 94.832,16.644 95.808,17.196 C96.784,17.748 97.864,18.024 99.048,18.024 Z M100.008,14.4 C99.208,14.4 98.552,14.124 98.04,13.572 C97.528,13.02 97.272,12.256 97.272,11.28 C97.272,10.32 97.528,9.568 98.04,9.024 C98.552,8.48 99.208,8.208 100.008,8.208 C100.808,8.208 101.46,8.48 101.964,9.024 C102.468,9.568 102.72,10.32 102.72,11.28 C102.72,12.256 102.464,13.02 101.952,13.572 C101.44,14.124 100.792,14.4 100.008,14.4 Z M112.368,22.68 C113.728,22.68 114.88,22.356 115.824,21.708 C116.768,21.06 117.568,19.936 118.224,18.336 L118.224,18.336 L123.84,4.8 L119.496,4.8 L116.28,12.744 L113.088,4.8 L108.408,4.8 L113.976,17.976 C113.784,18.36 113.548,18.64 113.268,18.816 C112.988,18.992 112.632,19.08 112.2,19.08 C111.832,19.08 111.468,19.012 111.108,18.876 C110.748,18.74 110.44,18.552 110.184,18.312 L110.184,18.312 L108.6,21.504 C109.032,21.856 109.596,22.14 110.292,22.356 C110.988,22.572 111.68,22.68 112.368,22.68 Z" id=Study fill-opacity=0.85 fill=#000000></path></g></g></g></svg><svg class="logo-dark hidden" width=125px height=23px viewBox="0 0 125 23" version=1.1 xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink><title>BTCStudy</title><g id=页面-1 stroke=none stroke-width=1 fill=none fill-rule=evenodd><g id=首页-响应式 transform="translate(-249.000000, -23.000000)" fill-rule=nonzero><g id=BTCStudy transform="translate(249.680000, 23.192000)"><path d="M9.072,17.808 C11.312,17.808 13.024,17.408 14.208,16.608 C15.392,15.808 15.984,14.672 15.984,13.2 C15.984,12.192 15.712,11.332 15.168,10.62 C14.624,9.908 13.872,9.384 12.912,9.048 C13.632,8.68 14.188,8.18 14.58,7.548 C14.972,6.916 15.168,6.2 15.168,5.4 C15.168,4.056 14.608,2.988 13.488,2.196 C12.368,1.404 10.736,1.008 8.592,1.008 L8.592,1.008 L-5.68434189e-14,1.008 L-5.68434189e-14,17.808 L9.072,17.808 Z M7.968,7.68 L4.704,7.68 L4.704,4.44 L7.968,4.44 C9.568,4.44 10.368,4.976 10.368,6.048 C10.368,7.136 9.568,7.68 7.968,7.68 L7.968,7.68 Z M8.688,14.376 L4.704,14.376 L4.704,10.968 L8.688,10.968 C10.352,10.968 11.184,11.536 11.184,12.672 C11.184,13.808 10.352,14.376 8.688,14.376 L8.688,14.376 Z M26.544,17.808 L26.544,4.776 L31.68,4.776 L31.68,1.008 L16.632,1.008 L16.632,4.776 L21.792,4.776 L21.792,17.808 L26.544,17.808 Z M41.592,18.144 C43.128,18.144 44.512,17.872 45.744,17.328 C46.976,16.784 48,16 48.816,14.976 L48.816,14.976 L45.792,12.24 C44.704,13.552 43.384,14.208 41.832,14.208 C40.92,14.208 40.108,14.008 39.396,13.608 C38.684,13.208 38.132,12.644 37.74,11.916 C37.348,11.188 37.152,10.352 37.152,9.408 C37.152,8.464 37.348,7.628 37.74,6.9 C38.132,6.172 38.684,5.608 39.396,5.208 C40.108,4.808 40.92,4.608 41.832,4.608 C43.384,4.608 44.704,5.264 45.792,6.576 L45.792,6.576 L48.816,3.84 C48,2.816 46.976,2.032 45.744,1.488 C44.512,0.944 43.128,0.672 41.592,0.672 C39.832,0.672 38.252,1.044 36.852,1.788 C35.452,2.532 34.352,3.568 33.552,4.896 C32.752,6.224 32.352,7.728 32.352,9.408 C32.352,11.088 32.752,12.592 33.552,13.92 C34.352,15.248 35.452,16.284 36.852,17.028 C38.252,17.772 39.832,18.144 41.592,18.144 Z" id=BTC fill=#F2A900></path><path d="M56.64,18.144 C58.24,18.144 59.6,17.9 60.72,17.412 C61.84,16.924 62.68,16.272 63.24,15.456 C63.8,14.64 64.08,13.728 64.08,12.72 C64.08,11.552 63.772,10.628 63.156,9.948 C62.54,9.268 61.812,8.772 60.972,8.46 C60.132,8.148 59.072,7.856 57.792,7.584 C56.656,7.344 55.832,7.112 55.32,6.888 C54.808,6.664 54.552,6.328 54.552,5.88 C54.552,5.432 54.768,5.068 55.2,4.788 C55.632,4.508 56.32,4.368 57.264,4.368 C58.768,4.368 60.32,4.8 61.92,5.664 L61.92,5.664 L63.384,2.136 C62.568,1.656 61.624,1.292 60.552,1.044 C59.48,0.796 58.392,0.672 57.288,0.672 C55.672,0.672 54.308,0.912 53.196,1.392 C52.084,1.872 51.248,2.524 50.688,3.348 C50.128,4.172 49.848,5.096 49.848,6.12 C49.848,7.288 50.152,8.216 50.76,8.904 C51.368,9.592 52.096,10.092 52.944,10.404 C53.792,10.716 54.848,11.008 56.112,11.28 C57.264,11.536 58.1,11.78 58.62,12.012 C59.14,12.244 59.4,12.6 59.4,13.08 C59.4,13.992 58.488,14.448 56.664,14.448 C55.704,14.448 54.728,14.296 53.736,13.992 C52.744,13.688 51.872,13.288 51.12,12.792 L51.12,12.792 L49.56,16.296 C50.36,16.856 51.4,17.304 52.68,17.64 C53.96,17.976 55.28,18.144 56.64,18.144 Z M71.856,18.024 C72.48,18.024 73.068,17.96 73.62,17.832 C74.172,17.704 74.64,17.52 75.024,17.28 L75.024,17.28 L73.896,14.088 C73.496,14.36 73.032,14.496 72.504,14.496 C72.088,14.496 71.756,14.364 71.508,14.1 C71.26,13.836 71.136,13.472 71.136,13.008 L71.136,13.008 L71.136,8.688 L74.112,8.688 L74.112,5.28 L71.136,5.28 L71.136,1.896 L66.576,1.896 L66.576,5.28 L64.68,5.28 L64.68,8.688 L66.576,8.688 L66.576,13.056 C66.576,14.704 67.032,15.944 67.944,16.776 C68.856,17.608 70.16,18.024 71.856,18.024 Z M82.248,18.024 C83,18.024 83.712,17.888 84.384,17.616 C85.056,17.344 85.632,16.944 86.112,16.416 L86.112,16.416 L86.112,17.808 L90.456,17.808 L90.456,4.8 L85.896,4.8 L85.896,11.064 C85.896,12.104 85.668,12.876 85.212,13.38 C84.756,13.884 84.168,14.136 83.448,14.136 C82.744,14.136 82.208,13.912 81.84,13.464 C81.472,13.016 81.288,12.304 81.288,11.328 L81.288,11.328 L81.288,4.8 L76.728,4.8 L76.728,12.072 C76.728,14.056 77.228,15.544 78.228,16.536 C79.228,17.528 80.568,18.024 82.248,18.024 Z M99.048,18.024 C100.744,18.024 102.016,17.52 102.864,16.512 L102.864,16.512 L102.864,17.808 L107.208,17.808 L107.208,0 L102.648,0 L102.648,5.928 C101.8,5.032 100.6,4.584 99.048,4.584 C97.864,4.584 96.784,4.856 95.808,5.4 C94.832,5.944 94.06,6.724 93.492,7.74 C92.924,8.756 92.64,9.936 92.64,11.28 C92.64,12.624 92.924,13.808 93.492,14.832 C94.06,15.856 94.832,16.644 95.808,17.196 C96.784,17.748 97.864,18.024 99.048,18.024 Z M100.008,14.4 C99.208,14.4 98.552,14.124 98.04,13.572 C97.528,13.02 97.272,12.256 97.272,11.28 C97.272,10.32 97.528,9.568 98.04,9.024 C98.552,8.48 99.208,8.208 100.008,8.208 C100.808,8.208 101.46,8.48 101.964,9.024 C102.468,9.568 102.72,10.32 102.72,11.28 C102.72,12.256 102.464,13.02 101.952,13.572 C101.44,14.124 100.792,14.4 100.008,14.4 Z M112.368,22.68 C113.728,22.68 114.88,22.356 115.824,21.708 C116.768,21.06 117.568,19.936 118.224,18.336 L118.224,18.336 L123.84,4.8 L119.496,4.8 L116.28,12.744 L113.088,4.8 L108.408,4.8 L113.976,17.976 C113.784,18.36 113.548,18.64 113.268,18.816 C112.988,18.992 112.632,19.08 112.2,19.08 C111.832,19.08 111.468,19.012 111.108,18.876 C110.748,18.74 110.44,18.552 110.184,18.312 L110.184,18.312 L108.6,21.504 C109.032,21.856 109.596,22.14 110.292,22.356 C110.988,22.572 111.68,22.68 112.368,22.68 Z" id=Study fill-opacity=0.85 fill=#FFFFFF></path></g></g></g></svg></a></h1></section><div class="is-flex is-flex-direction-column header-menu-wrap"><aside class="is-flex-shrink-0 is-flex is-flex-direction-row is-align-items-center" id=header-menu><a class="is-inline-block header-activity mr-4" href=/ >首页</a><a class="is-inline-block mr-4" href=/archives>全站目录</a><a class="is-inline-block mr-4" href=/tags>标签</a><a class="is-inline-block mr-4" href=/maps>地图</a><a class="is-inline-block mr-4" href=/tools>工具</a><a class="is-inline-block mr-4" target=_blank rel=noopener href=https://123btc.org/ >123btc</a><div class="right-content is-flex is-flex-direction-row is-align-items-center"><div class="size-wrap mr-1"><i class="iconfont icon-a-bianzu5" id=change-size-btn></i><div class=size-input-wrap><div class=input-wrap><input id=size-change-input type=range min=12 max=32 step=2></div></div></div><i class="iconfont icon-icon_dark mr-1" id=theme-btn></i><div class=search-wrap><input class=pl-3 id=search-input placeholder=请输入搜索关键词><i class="iconfont icon-icon_search" id=search-input-btn></i></div></div></aside><div class="header-title is-hidden-mobile is-full-height is-flex is-align-items-center is-flex-shrink-0"><div class="is-full-height hidden" id=postTopic><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">使用秘密的 BIP32 路径来遮掩一个种子</p><div class="size-wrap mr-1"><i class="iconfont icon-a-bianzu5" id=change-size-btn2></i><div class=size-input-wrap><div class=input-wrap><input id=size-change-input2 type=range min=12 max=32 step=2></div></div></div></div></div></div></div></header><header class="is-flex header-widget is-flex-shrink-0 is-align-items-center is-justify-content-space-between is-hidden-tablet" id=mobile-header><div class="is-flex is-flex-direction-row is-align-items-center"><i class="iconfont icon-icon_bar mobile-header-menu"></i><div id=mobile-header-logo><svg class=logo-light width=125px height=23px viewBox="0 0 125 23" version=1.1 xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink><title>BTCStudy</title><g id=页面-1 stroke=none stroke-width=1 fill=none fill-rule=evenodd><g id=首页-响应式 transform="translate(-249.000000, -23.000000)" fill-rule=nonzero><g id=BTCStudy transform="translate(249.680000, 23.192000)"><path d="M9.072,17.808 C11.312,17.808 13.024,17.408 14.208,16.608 C15.392,15.808 15.984,14.672 15.984,13.2 C15.984,12.192 15.712,11.332 15.168,10.62 C14.624,9.908 13.872,9.384 12.912,9.048 C13.632,8.68 14.188,8.18 14.58,7.548 C14.972,6.916 15.168,6.2 15.168,5.4 C15.168,4.056 14.608,2.988 13.488,2.196 C12.368,1.404 10.736,1.008 8.592,1.008 L8.592,1.008 L-5.68434189e-14,1.008 L-5.68434189e-14,17.808 L9.072,17.808 Z M7.968,7.68 L4.704,7.68 L4.704,4.44 L7.968,4.44 C9.568,4.44 10.368,4.976 10.368,6.048 C10.368,7.136 9.568,7.68 7.968,7.68 L7.968,7.68 Z M8.688,14.376 L4.704,14.376 L4.704,10.968 L8.688,10.968 C10.352,10.968 11.184,11.536 11.184,12.672 C11.184,13.808 10.352,14.376 8.688,14.376 L8.688,14.376 Z M26.544,17.808 L26.544,4.776 L31.68,4.776 L31.68,1.008 L16.632,1.008 L16.632,4.776 L21.792,4.776 L21.792,17.808 L26.544,17.808 Z M41.592,18.144 C43.128,18.144 44.512,17.872 45.744,17.328 C46.976,16.784 48,16 48.816,14.976 L48.816,14.976 L45.792,12.24 C44.704,13.552 43.384,14.208 41.832,14.208 C40.92,14.208 40.108,14.008 39.396,13.608 C38.684,13.208 38.132,12.644 37.74,11.916 C37.348,11.188 37.152,10.352 37.152,9.408 C37.152,8.464 37.348,7.628 37.74,6.9 C38.132,6.172 38.684,5.608 39.396,5.208 C40.108,4.808 40.92,4.608 41.832,4.608 C43.384,4.608 44.704,5.264 45.792,6.576 L45.792,6.576 L48.816,3.84 C48,2.816 46.976,2.032 45.744,1.488 C44.512,0.944 43.128,0.672 41.592,0.672 C39.832,0.672 38.252,1.044 36.852,1.788 C35.452,2.532 34.352,3.568 33.552,4.896 C32.752,6.224 32.352,7.728 32.352,9.408 C32.352,11.088 32.752,12.592 33.552,13.92 C34.352,15.248 35.452,16.284 36.852,17.028 C38.252,17.772 39.832,18.144 41.592,18.144 Z" id=BTC fill=#F2A900></path><path d="M56.64,18.144 C58.24,18.144 59.6,17.9 60.72,17.412 C61.84,16.924 62.68,16.272 63.24,15.456 C63.8,14.64 64.08,13.728 64.08,12.72 C64.08,11.552 63.772,10.628 63.156,9.948 C62.54,9.268 61.812,8.772 60.972,8.46 C60.132,8.148 59.072,7.856 57.792,7.584 C56.656,7.344 55.832,7.112 55.32,6.888 C54.808,6.664 54.552,6.328 54.552,5.88 C54.552,5.432 54.768,5.068 55.2,4.788 C55.632,4.508 56.32,4.368 57.264,4.368 C58.768,4.368 60.32,4.8 61.92,5.664 L61.92,5.664 L63.384,2.136 C62.568,1.656 61.624,1.292 60.552,1.044 C59.48,0.796 58.392,0.672 57.288,0.672 C55.672,0.672 54.308,0.912 53.196,1.392 C52.084,1.872 51.248,2.524 50.688,3.348 C50.128,4.172 49.848,5.096 49.848,6.12 C49.848,7.288 50.152,8.216 50.76,8.904 C51.368,9.592 52.096,10.092 52.944,10.404 C53.792,10.716 54.848,11.008 56.112,11.28 C57.264,11.536 58.1,11.78 58.62,12.012 C59.14,12.244 59.4,12.6 59.4,13.08 C59.4,13.992 58.488,14.448 56.664,14.448 C55.704,14.448 54.728,14.296 53.736,13.992 C52.744,13.688 51.872,13.288 51.12,12.792 L51.12,12.792 L49.56,16.296 C50.36,16.856 51.4,17.304 52.68,17.64 C53.96,17.976 55.28,18.144 56.64,18.144 Z M71.856,18.024 C72.48,18.024 73.068,17.96 73.62,17.832 C74.172,17.704 74.64,17.52 75.024,17.28 L75.024,17.28 L73.896,14.088 C73.496,14.36 73.032,14.496 72.504,14.496 C72.088,14.496 71.756,14.364 71.508,14.1 C71.26,13.836 71.136,13.472 71.136,13.008 L71.136,13.008 L71.136,8.688 L74.112,8.688 L74.112,5.28 L71.136,5.28 L71.136,1.896 L66.576,1.896 L66.576,5.28 L64.68,5.28 L64.68,8.688 L66.576,8.688 L66.576,13.056 C66.576,14.704 67.032,15.944 67.944,16.776 C68.856,17.608 70.16,18.024 71.856,18.024 Z M82.248,18.024 C83,18.024 83.712,17.888 84.384,17.616 C85.056,17.344 85.632,16.944 86.112,16.416 L86.112,16.416 L86.112,17.808 L90.456,17.808 L90.456,4.8 L85.896,4.8 L85.896,11.064 C85.896,12.104 85.668,12.876 85.212,13.38 C84.756,13.884 84.168,14.136 83.448,14.136 C82.744,14.136 82.208,13.912 81.84,13.464 C81.472,13.016 81.288,12.304 81.288,11.328 L81.288,11.328 L81.288,4.8 L76.728,4.8 L76.728,12.072 C76.728,14.056 77.228,15.544 78.228,16.536 C79.228,17.528 80.568,18.024 82.248,18.024 Z M99.048,18.024 C100.744,18.024 102.016,17.52 102.864,16.512 L102.864,16.512 L102.864,17.808 L107.208,17.808 L107.208,0 L102.648,0 L102.648,5.928 C101.8,5.032 100.6,4.584 99.048,4.584 C97.864,4.584 96.784,4.856 95.808,5.4 C94.832,5.944 94.06,6.724 93.492,7.74 C92.924,8.756 92.64,9.936 92.64,11.28 C92.64,12.624 92.924,13.808 93.492,14.832 C94.06,15.856 94.832,16.644 95.808,17.196 C96.784,17.748 97.864,18.024 99.048,18.024 Z M100.008,14.4 C99.208,14.4 98.552,14.124 98.04,13.572 C97.528,13.02 97.272,12.256 97.272,11.28 C97.272,10.32 97.528,9.568 98.04,9.024 C98.552,8.48 99.208,8.208 100.008,8.208 C100.808,8.208 101.46,8.48 101.964,9.024 C102.468,9.568 102.72,10.32 102.72,11.28 C102.72,12.256 102.464,13.02 101.952,13.572 C101.44,14.124 100.792,14.4 100.008,14.4 Z M112.368,22.68 C113.728,22.68 114.88,22.356 115.824,21.708 C116.768,21.06 117.568,19.936 118.224,18.336 L118.224,18.336 L123.84,4.8 L119.496,4.8 L116.28,12.744 L113.088,4.8 L108.408,4.8 L113.976,17.976 C113.784,18.36 113.548,18.64 113.268,18.816 C112.988,18.992 112.632,19.08 112.2,19.08 C111.832,19.08 111.468,19.012 111.108,18.876 C110.748,18.74 110.44,18.552 110.184,18.312 L110.184,18.312 L108.6,21.504 C109.032,21.856 109.596,22.14 110.292,22.356 C110.988,22.572 111.68,22.68 112.368,22.68 Z" id=Study fill-opacity=0.85 fill=#000000></path></g></g></g></svg><svg class="logo-dark hidden" width=125px height=23px viewBox="0 0 125 23" version=1.1 xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink><title>BTCStudy</title><g id=页面-1 stroke=none stroke-width=1 fill=none fill-rule=evenodd><g id=首页-响应式 transform="translate(-249.000000, -23.000000)" fill-rule=nonzero><g id=BTCStudy transform="translate(249.680000, 23.192000)"><path d="M9.072,17.808 C11.312,17.808 13.024,17.408 14.208,16.608 C15.392,15.808 15.984,14.672 15.984,13.2 C15.984,12.192 15.712,11.332 15.168,10.62 C14.624,9.908 13.872,9.384 12.912,9.048 C13.632,8.68 14.188,8.18 14.58,7.548 C14.972,6.916 15.168,6.2 15.168,5.4 C15.168,4.056 14.608,2.988 13.488,2.196 C12.368,1.404 10.736,1.008 8.592,1.008 L8.592,1.008 L-5.68434189e-14,1.008 L-5.68434189e-14,17.808 L9.072,17.808 Z M7.968,7.68 L4.704,7.68 L4.704,4.44 L7.968,4.44 C9.568,4.44 10.368,4.976 10.368,6.048 C10.368,7.136 9.568,7.68 7.968,7.68 L7.968,7.68 Z M8.688,14.376 L4.704,14.376 L4.704,10.968 L8.688,10.968 C10.352,10.968 11.184,11.536 11.184,12.672 C11.184,13.808 10.352,14.376 8.688,14.376 L8.688,14.376 Z M26.544,17.808 L26.544,4.776 L31.68,4.776 L31.68,1.008 L16.632,1.008 L16.632,4.776 L21.792,4.776 L21.792,17.808 L26.544,17.808 Z M41.592,18.144 C43.128,18.144 44.512,17.872 45.744,17.328 C46.976,16.784 48,16 48.816,14.976 L48.816,14.976 L45.792,12.24 C44.704,13.552 43.384,14.208 41.832,14.208 C40.92,14.208 40.108,14.008 39.396,13.608 C38.684,13.208 38.132,12.644 37.74,11.916 C37.348,11.188 37.152,10.352 37.152,9.408 C37.152,8.464 37.348,7.628 37.74,6.9 C38.132,6.172 38.684,5.608 39.396,5.208 C40.108,4.808 40.92,4.608 41.832,4.608 C43.384,4.608 44.704,5.264 45.792,6.576 L45.792,6.576 L48.816,3.84 C48,2.816 46.976,2.032 45.744,1.488 C44.512,0.944 43.128,0.672 41.592,0.672 C39.832,0.672 38.252,1.044 36.852,1.788 C35.452,2.532 34.352,3.568 33.552,4.896 C32.752,6.224 32.352,7.728 32.352,9.408 C32.352,11.088 32.752,12.592 33.552,13.92 C34.352,15.248 35.452,16.284 36.852,17.028 C38.252,17.772 39.832,18.144 41.592,18.144 Z" id=BTC fill=#F2A900></path><path d="M56.64,18.144 C58.24,18.144 59.6,17.9 60.72,17.412 C61.84,16.924 62.68,16.272 63.24,15.456 C63.8,14.64 64.08,13.728 64.08,12.72 C64.08,11.552 63.772,10.628 63.156,9.948 C62.54,9.268 61.812,8.772 60.972,8.46 C60.132,8.148 59.072,7.856 57.792,7.584 C56.656,7.344 55.832,7.112 55.32,6.888 C54.808,6.664 54.552,6.328 54.552,5.88 C54.552,5.432 54.768,5.068 55.2,4.788 C55.632,4.508 56.32,4.368 57.264,4.368 C58.768,4.368 60.32,4.8 61.92,5.664 L61.92,5.664 L63.384,2.136 C62.568,1.656 61.624,1.292 60.552,1.044 C59.48,0.796 58.392,0.672 57.288,0.672 C55.672,0.672 54.308,0.912 53.196,1.392 C52.084,1.872 51.248,2.524 50.688,3.348 C50.128,4.172 49.848,5.096 49.848,6.12 C49.848,7.288 50.152,8.216 50.76,8.904 C51.368,9.592 52.096,10.092 52.944,10.404 C53.792,10.716 54.848,11.008 56.112,11.28 C57.264,11.536 58.1,11.78 58.62,12.012 C59.14,12.244 59.4,12.6 59.4,13.08 C59.4,13.992 58.488,14.448 56.664,14.448 C55.704,14.448 54.728,14.296 53.736,13.992 C52.744,13.688 51.872,13.288 51.12,12.792 L51.12,12.792 L49.56,16.296 C50.36,16.856 51.4,17.304 52.68,17.64 C53.96,17.976 55.28,18.144 56.64,18.144 Z M71.856,18.024 C72.48,18.024 73.068,17.96 73.62,17.832 C74.172,17.704 74.64,17.52 75.024,17.28 L75.024,17.28 L73.896,14.088 C73.496,14.36 73.032,14.496 72.504,14.496 C72.088,14.496 71.756,14.364 71.508,14.1 C71.26,13.836 71.136,13.472 71.136,13.008 L71.136,13.008 L71.136,8.688 L74.112,8.688 L74.112,5.28 L71.136,5.28 L71.136,1.896 L66.576,1.896 L66.576,5.28 L64.68,5.28 L64.68,8.688 L66.576,8.688 L66.576,13.056 C66.576,14.704 67.032,15.944 67.944,16.776 C68.856,17.608 70.16,18.024 71.856,18.024 Z M82.248,18.024 C83,18.024 83.712,17.888 84.384,17.616 C85.056,17.344 85.632,16.944 86.112,16.416 L86.112,16.416 L86.112,17.808 L90.456,17.808 L90.456,4.8 L85.896,4.8 L85.896,11.064 C85.896,12.104 85.668,12.876 85.212,13.38 C84.756,13.884 84.168,14.136 83.448,14.136 C82.744,14.136 82.208,13.912 81.84,13.464 C81.472,13.016 81.288,12.304 81.288,11.328 L81.288,11.328 L81.288,4.8 L76.728,4.8 L76.728,12.072 C76.728,14.056 77.228,15.544 78.228,16.536 C79.228,17.528 80.568,18.024 82.248,18.024 Z M99.048,18.024 C100.744,18.024 102.016,17.52 102.864,16.512 L102.864,16.512 L102.864,17.808 L107.208,17.808 L107.208,0 L102.648,0 L102.648,5.928 C101.8,5.032 100.6,4.584 99.048,4.584 C97.864,4.584 96.784,4.856 95.808,5.4 C94.832,5.944 94.06,6.724 93.492,7.74 C92.924,8.756 92.64,9.936 92.64,11.28 C92.64,12.624 92.924,13.808 93.492,14.832 C94.06,15.856 94.832,16.644 95.808,17.196 C96.784,17.748 97.864,18.024 99.048,18.024 Z M100.008,14.4 C99.208,14.4 98.552,14.124 98.04,13.572 C97.528,13.02 97.272,12.256 97.272,11.28 C97.272,10.32 97.528,9.568 98.04,9.024 C98.552,8.48 99.208,8.208 100.008,8.208 C100.808,8.208 101.46,8.48 101.964,9.024 C102.468,9.568 102.72,10.32 102.72,11.28 C102.72,12.256 102.464,13.02 101.952,13.572 C101.44,14.124 100.792,14.4 100.008,14.4 Z M112.368,22.68 C113.728,22.68 114.88,22.356 115.824,21.708 C116.768,21.06 117.568,19.936 118.224,18.336 L118.224,18.336 L123.84,4.8 L119.496,4.8 L116.28,12.744 L113.088,4.8 L108.408,4.8 L113.976,17.976 C113.784,18.36 113.548,18.64 113.268,18.816 C112.988,18.992 112.632,19.08 112.2,19.08 C111.832,19.08 111.468,19.012 111.108,18.876 C110.748,18.74 110.44,18.552 110.184,18.312 L110.184,18.312 L108.6,21.504 C109.032,21.856 109.596,22.14 110.292,22.356 C110.988,22.572 111.68,22.68 112.368,22.68 Z" id=Study fill-opacity=0.85 fill=#FFFFFF></path></g></g></g></svg></div><div class="mobile-header-title is-full-height is-flex is-align-items-center is-flex-shrink-0"><div class="is-full-height hidden" id=postTopicMobile><p class=is-full-height>使用秘密的 BIP32 路径来遮掩一个种子</p></div></div></div><i class="iconfont icon-icon_search mobile-header-searchIcon"></i><div class=mobile-search-wrap><div class=search-input><input class=pl-3 id=mobile-search-input placeholder=请输入搜索关键词><i class="iconfont icon-icon_search mobile-search-input-btn"></i><button class=mobile-search-input-btn>搜 索</button></div></div></header><div class=mobile-slide-menu><a class=header-activity href=/ >首页</a><a href=/archives>全站目录</a><a href=/tags>标签</a><a href=/maps>地图</a><a href=/tools>工具</a><a target=_blank rel=noopener href=https://123btc.org/ >123btc</a><div><p class="slide-menu-theme is-flex is-flex-direction-row is-justify-content-space-between is-align-items-center"><span>主题设置</span><span><i class="iconfont icon-icon_light slide-theme-light hidden"></i><i class="iconfont icon-icon_dark slide-theme-dark hidden"></i></span></p><p class=slide-menu-fontsize><span>字体设置</span><span><i class="iconfont icon-bianzubeifen"></i><i class="iconfont icon-bianzu"></i></span></p></div></div><div class="search-mask hidden"><script src="/js/header.js?v=1682773100887"></script></div><main><main class="container is-max-widescreen content section post-page pt-4"><div class="columns is-flex-desktop is-justify-content-center"><div class="column is-3 silde-bar is-hidden-mobile"><ol class=toc><li class="toc-item toc-level-2"><a class=toc-link href=#%E5%BC%95%E8%A8%80><span class=toc-text>引言</span></a><ol class=toc-child><li class="toc-item toc-level-3"><a class=toc-link href=#%E9%9A%90%E7%A7%81%E6%B3%84%E9%9C%B2><span class=toc-text>隐私泄露</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88><span class=toc-text>解决方案</span></a></li></ol></li><li class="toc-item toc-level-2"><a class=toc-link href=#%E6%B5%81%E7%A8%8B><span class=toc-text>流程</span></a><ol class=toc-child><li class="toc-item toc-level-3"><a class=toc-link href=#%E5%90%AF%E5%8A%A8-Buidl-%E4%BB%A5%E9%AA%8C%E8%AF%81%EF%BC%88%E9%9D%9E%E5%BF%85%E8%A6%81%EF%BC%89><span class=toc-text>启动 Buidl 以验证（非必要）</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E7%94%9F%E6%88%90-2-%E4%B8%AA%E7%A7%8D%E5%AD%90%E8%AF%8D><span class=toc-text>生成 2 个种子词</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E7%9B%B2%E5%8C%96-1-%E4%B8%AA%E7%A7%8D%E5%AD%90%E8%AF%8D><span class=toc-text>盲化 1 个种子词</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E5%88%9B%E5%BB%BA%E8%BE%93%E5%87%BA%E6%8F%8F%E8%BF%B0%E7%AC%A6><span class=toc-text>创建输出描述符</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E8%8E%B7%E5%8F%96%E6%94%B6%E6%AC%BE%E5%9C%B0%E5%9D%80><span class=toc-text>获取收款地址</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E7%AD%BE%E5%90%8D%E4%BA%A4%E6%98%93><span class=toc-text>签名交易</span></a></li></ol></li><li class="toc-item toc-level-2"><a class=toc-link href=#%E6%88%91%E4%BB%AC%E5%AE%9E%E7%8E%B0%E4%BA%86%E4%BB%80%E4%B9%88><span class=toc-text>我们实现了什么</span></a></li><li class="toc-item toc-level-2"><a class=toc-link href=#%E5%85%BC%E5%AE%B9%E6%80%A7><span class=toc-text>兼容性</span></a><ol class=toc-child><li class="toc-item toc-level-3"><a class=toc-link href=#%E7%AD%BE%E5%90%8D%E5%99%A8><span class=toc-text>签名器</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E5%8D%8F%E8%B0%83%E5%99%A8%E8%BD%AF%E4%BB%B6><span class=toc-text>协调器软件</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E7%9B%B2%E5%8C%96%E5%A4%9A%E4%B8%AA%E7%A7%8D%E5%AD%90><span class=toc-text>盲化多个种子</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E7%A7%8D%E5%AD%90%E8%AF%8D%E7%9A%84%E5%A4%8D%E7%94%A8><span class=toc-text>种子词的复用</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E7%B4%A7%E6%80%A5-%E5%A4%8D%E5%8E%9F-%E5%AF%86%E9%92%A5><span class=toc-text>紧急&#x2F;复原 密钥</span></a></li></ol></li><li class="toc-item toc-level-2"><a class=toc-link href=#%E5%A4%87%E4%BB%BD%E8%BE%93%E5%87%BA%E6%8F%8F%E8%BF%B0%E7%AC%A6><span class=toc-text>备份输出描述符</span></a><ol class=toc-child><li class="toc-item toc-level-3"><a class=toc-link href=#%E7%A1%AE%E5%AE%9A%E6%80%A7%E8%B7%AF%E5%BE%84><span class=toc-text>确定性路径</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E8%BE%93%E5%87%BA%E6%8F%8F%E8%BF%B0%E7%AC%A6%E7%9A%84-SSSS><span class=toc-text>输出描述符的 SSSS</span></a></li></ol></li><li class="toc-item toc-level-2"><a class=toc-link href=#%E4%B8%8E%E5%85%B6%E5%AE%83%E5%8D%8F%E8%AE%AE%E7%9A%84%E6%AF%94%E8%BE%83><span class=toc-text>与其它协议的比较</span></a><ol class=toc-child><li class="toc-item toc-level-3"><a class=toc-link href=#%E5%B8%B8%E8%A7%84-%E4%BC%A0%E7%BB%9F-%E9%9D%9E%E7%9B%B2%E5%8C%96-%E7%9A%84%E7%A7%8D%E5%AD%90%E8%AF%8D><span class=toc-text>常规&#x2F;传统&#x2F;非盲化 的种子词</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E7%A7%98%E5%AF%86%E7%9A%84-BIP39-%E5%AF%86%E8%AF%AD><span class=toc-text>秘密的 BIP39 密语</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#Taproot><span class=toc-text>Taproot</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#Shamir-%E7%A7%98%E5%AF%86%E5%80%BC%E5%88%86%E5%89%B2%E6%96%B9%E6%A1%88><span class=toc-text>Shamir 秘密值分割方案</span></a></li></ol></li><li class="toc-item toc-level-2"><a class=toc-link href=#%E5%8F%82%E8%80%83><span class=toc-text>参考</span></a></li></ol></div><div class="column is-9 post-container"><h1 class="mt-0 mb-2" id=postTitle>使用秘密的 BIP32 路径来遮掩一个种子</h1><div class=page-author><div class="is-flex is-flex-direction-row page-data mr-6"><img class=mr-1 src=/images/default_avatar.png alt=mflaxman><div class=page-author-info><strong>mflaxman</strong><time class=has-text-grey datetime=2024-05-21T15:15:38.000Z>2024-05-21</time></div></div><div class=is-flex><a href=/tags/%E8%81%94%E5%90%88%E4%BF%9D%E7%AE%A1><i class="page-tag mr-1 px-1">联合保管</i></a></div></div><article class="mt-4 post-content"><blockquote><p><em>作者：mflaxman</em></p><p><em>来源：<a target=_blank rel=noopener href=https://github.com/mflaxman/blind-xpub/blob/main/README.md>https://github.com/mflaxman/blind-xpub/blob/main/README.md</a></em></p></blockquote><h2 id=引言><a href=#引言 class=headerlink title=引言></a>引言</h2><p>比特币的多签名安全模式是人类自主保管能力上的重大突破。相比之下，你不可能用 <code>3-of-5</code> 装置来保护你的黄金。多签名保管的采用有望减少比特币世界里的 黑客爆破&#x2F;失盗&#x2F;丢失，因为保管者可以犯下 1 个（甚至更多）致命性的错误而不会置资金于风险之中。</p><p>然而，当前的多签名装置却也引来一个令人痛苦的新问题：使用 <code>m-of-n</code> 装置（比如 <code>2-of-3</code>） 来保护你的资金 ，意味着你有 <code>n</code> 个种子词，每一个都会让你的隐私置于风险之中。</p><h3 id=隐私泄露><a href=#隐私泄露 class=headerlink title=隐私泄露></a>隐私泄露</h3><p>标准&#x2F;默认的 BIP32 派生路径的用法，使得如果坏人拿到了你的 BIP39 种子词，他们就可以扫描区块链上的交易输入的 见证&#x2F;赎回 脚本，从而知晓这个种子词保护过哪些资金。举个例子，他们有可能知晓这些信息：</p><ul><li>这个被盗的种子词是昨天转移的一笔大额比特币资金的保管装置的一部分。注意，即使这个种子词并未在交易中提供签名、只是安静地躺在冷存储媒介中，也依然会暴露。（译者注：这是因为 P2SH&#x2F;P2WSH 在花费时会让整个脚本完全暴露，因此装置中的公钥会全部暴露。Taproot 可以缓解这种情形。）</li><li>这笔交易似乎将一大笔找零转回给了自己，所以这个种子可能还在用于保护（至少）这么多的比特币。</li><li>这笔交易的输入是 <code>2-of-3</code> 的 <code>P2WSH</code>，所以只需要再找出 1 个种子词（以及相关的输出描述符），就可以花费这个装置所保管的资金。</li><li>这个钱包在当地时间每个星期五的下午 4 点都会发起类似的交易。</li></ul><p>尽管隐私泄露的结果不能直接用来抢劫，这些信息依然可以用在其它不法用途中：</p><ul><li>执法机构可以传唤银行，要求打开保险柜、检查里面有没有 BIP39 种子词（例如刻在金属板上）。</li><li>联合保管人（例如，律师、审计员、继承人、密友、“爷叔”、联合保管服务商，等等）可以知道你的储蓄金额，而且可能泄露这些信息（因为被黑客攻击、商业决策，或被执法打击）。</li><li>心急的继承人可能迫不及待想继承财产。</li></ul><h3 id=解决方案><a href=#解决方案 class=headerlink title=解决方案></a>解决方案</h3><p>在这个方案中，我们会演示使用一个大且随机生成的 BIP32 路径，来遮掩（“盲化”）多签名装置中的一个 BIP39 种子词（更具体来说，是其对应的 “拓展公钥（xpub）”）。如果坏人在你不知情时拿到了这个 BIP39 种子词（及其密语（passphrase），如果有的话），对于该种子到底用在了哪里，他们将 <em>一无所知</em>。这个方案也让 1 个（乃至多个）准-受信任的联合保管人可以保管你的多签名装置中的一个紧急复原密钥，而 <em>无法</em> 知晓这个装置到底在保护哪一笔资金；这就使我们更为容易地实现密钥在空间、司法辖区 以及&#x2F;或者 组织的分散性。</p><p>这个方案在当前的比特币主网上已经可用了，也兼容现有的多签名硬件签名器和用作协调器的软件（见下文的 “兼容性” 一节），而且对隐私性、钱包复原、联合保管人的信任最小化都有正向作用。</p><h2 id=流程><a href=#流程 class=headerlink title=流程></a>流程</h2><p>在这个样品中，我们将使用 <a target=_blank rel=noopener href=https://github.com/cryptoadvance/specter-desktop/ >Specter-Desktop</a>（以 Bitcoin Core 为支持），因为绝大多数新的自主保管的多签名用户都使用它。对任何支持新一代多签名标准（<a target=_blank rel=noopener href=https://github.com/bitcoin/bitcoin/blob/master/doc/descriptors.md>输出描述符</a>和 <a target=_blank rel=noopener href=https://github.com/bitcoin/bips/blob/master/bip-0174.mediawiki>PSBT</a>）的协调器软件来说，应该都是可以开箱即用的。我们也将代码复制到了 <a target=_blank rel=noopener href=https://github.com/buidl-bitcoin/buidl-python>buidl</a>，因为它是一个无依赖的 FOSS 比特币实现，为了这个盲化协议的每一步都提供了完整的支持。为了简洁，我们仅仅遮掩一个 <code>1-of-2</code> 装置中的 1 个种子词，但应该容易看出，扩展到 <code>2-of-3</code>、<code>3-of-5</code> 乃至更大的装置也不会是什么问题。最后，我们会讨论盲化所有 <code>n</code> 个种子词将带来的影响。</p><h3 id=启动-Buidl-以验证（非必要）><a href=#启动-Buidl-以验证（非必要） class=headerlink title="启动 Buidl 以验证（非必要）"></a>启动 Buidl 以验证（非必要）</h3><p>最简单的安装和测试其正常工作的方法：</p><pre><code>$ pip3 install buidl &amp;&amp; python3
&gt;&gt;&gt; from buidl import *
</code></pre><p><strong>更安全的方法</strong></p><p>因为 <code>buidl</code> 没有依赖，而且是为了 “隔空交互（air-gap）” 体验而设计的， 你并不真的需要安装它：</p><pre><code>$ git clone https://github.com/buidl-bitcoin/buidl-python.git &amp;&amp; cd buidl-python &amp;&amp; python3
&gt;&gt;&gt; from buidl import *
</code></pre><p>这些验证步骤可以用其它的开源库来执行，所以在下文我也会提到它们。</p><h3 id=生成-2-个种子词><a href=#生成-2-个种子词 class=headerlink title="生成 2 个种子词"></a>生成 2 个种子词</h3><p>假设种子 A 是由我（生成并）持有的，而种子 B 是由一个信任最小化的第三方（生成并）持有的（这样的第三方可能是：律师、审计员、继承人、密友、“爷叔”、联合保管服务商，等等），仅仅用在紧急复原中。</p><p><strong>生成种子 A</strong></p><pre><code>BIP39 Seed Phrase (invest repeated 12x):
invest invest invest invest invest invest invest invest invest invest invest invest

Public Key Record (from hardware wallet):
[aa917e75/48h/1h/0h/2h]tpubDEZRP2dRKoGRJnR9zn6EoLouYKbYyjFsxywgG7wMQwCDVkwNvoLhcX1rTQipYajmTAF82kJoKDiNCgD4wUPahACE7n1trMSm7QS8B3S1fdy
</code></pre><p><strong>生成种子 B</strong></p><pre><code>BIP39 Seed Phrase (sell repeated x12):
sell sell sell sell sell sell sell sell sell sell sell sell

Public Key Record (from hardware wallet):
[2553c4b8/48h/1h/0h/2h]tpubDEiNuxUt4pKjKk7khdv9jfcS92R1WQD6Z3dwjyMFrYj2iMrYbk3xB5kjg6kL4P8SoWsQHpd378RCTrM7fsw4chnJKhE2kfbfc4BCPkVh6g9
</code></pre><p><strong>用 buidl 验证</strong></p><p>可以在 buidl 中生成，如下：</p><pre><code>$ python3
&gt;&gt;&gt; from buidl.hd import HDPrivateKey
&gt;&gt;&gt; HDPrivateKey.from_mnemonic(&quot;invest &quot; * 12, network=&quot;testnet&quot;).generate_p2wsh_key_record()
&#39;[aa917e75/48h/1h/0h/2h]tpubDEZRP2dRKoGRJnR9zn6EoLouYKbYyjFsxywgG7wMQwCDVkwNvoLhcX1rTQipYajmTAF82kJoKDiNCgD4wUPahACE7n1trMSm7QS8B3S1fdy&#39;
&gt;&gt;&gt; HDPrivateKey.from_mnemonic(&quot;sell &quot; * 12, network=&quot;testnet&quot;).generate_p2wsh_key_record()
&#39;[2553c4b8/48h/1h/0h/2h]tpubDEiNuxUt4pKjKk7khdv9jfcS92R1WQD6Z3dwjyMFrYj2iMrYbk3xB5kjg6kL4P8SoWsQHpd378RCTrM7fsw4chnJKhE2kfbfc4BCPkVh6g9&#39;
</code></pre><p>我们忽略 <a target=_blank rel=noopener href=https://github.com/satoshilabs/slips/blob/master/slip-0132.md>SLIP132</a> 版本字节编码，但如果你的协调器软件需要它，那就向 <code>generate_p2wsh_key_record()</code> 传入 <code>use_slip132_version_byte=True</code> 或使用 <a target=_blank rel=noopener href=https://jlopp.github.io/xpub-converter/ >Jameson Lopp 的便利 xpub 转换器</a>。</p><p>如果你一头雾水，让我来告诉你，它们都是<a target=_blank rel=noopener href=https://twitter.com/mflaxman/status/1386833296668102659>有效的种子词</a>（虽然是非常不安全的）。</p><h3 id=盲化-1-个种子词><a href=#盲化-1-个种子词 class=headerlink title="盲化 1 个种子词"></a>盲化 1 个种子词</h3><p>请记住，种子词 B 是由我们的信任最小化第三方持有的。</p><p>我们使用 <code>buidl</code> 内置的 <a target=_blank rel=noopener href=https://twitter.com/mflaxman/status/1321503036724989952>multiwallet.py</a> 来盲化种子 B 的 xpub。对 4 层的 BIP32 路径，我们在每一层中都使用默认的熵设定，也就是说，<code>(2^31)^4 ≈ 124 bits</code>。这会让暴力搜索（brute-forcing）变得不可能。</p><p><img src=/images/blinding-a-seed-using-secret-bip-32-paths/blinding.png alt=image></p><p><strong>文字版本</strong></p><p>以下是运行该工具的完整文本，只是，它跟上图不是完全对应的：</p><pre><code>$ python3 multiwallet.py 
Welcome to multiwallet, the stateless multisig bitcoin wallet.
This tool is free and there is NO WARRANTY OF ANY KIND.
You are currently in SAFE mode.
Type help or ? to list commands.

(₿) advanced_mode
ADVANCED mode set, don&#39;t mess up!
(₿) blind_xpub
Enter an xpub key record to blind in the format [deadbeef/path]xpub (any path will do): [2553c4b8/48h/1h/0h/2h]tpubDEiNuxUt4pKjKk7khdv9jfcS92R1WQD6Z3dwjyMFrYj2iMrYbk3xB5kjg6kL4P8SoWsQHpd378RCTrM7fsw4chnJKhE2kfbfc4BCPkVh6g9
Use standard entropy parameters for blinding? [Y/n]: 
Generating BIP32 path with 124 bits of good entropy...
Here is a blinded xpub key record to upload to your Coordinator.
Create a multisig wallet with this blinded xpub and it will become a part of your account map (output descriptors).

[2553c4b8/48h/1h/0h/2h/2046266013/1945465733/1801020214/1402692941]tpubDNVvpMhdGTmQg1AT6muju2eUWPXWWAtUSyc1EQ2MxJ2s97fMqFZQbpzQM4gU8bwzfFM7KBpSXRJ5v2Wu8sY2GF5ZpXm3qy8GLArZZNM1Wru

Important notes:
  - Do NOT share this record with the holder of the seed phrase, or they will be able to unblind their key (potentially leaking privacy info about what it controls).
  - Possession of this blinded xpub key record has privacy implications, but it CANNOT alone be used to sign bitcoin transactions.
  - Possession of the original seed phrase (used to create the original xpub key record), CANNOT alone be used to sign bitcoin transactions.
  - In order to spend from this blinded xpub, you must have BOTH the seed phrase AND the blinded xpub key record (which will be included in your account map before you can receive funds).
</code></pre><p><strong>Ian Coleman BIP39 验证</strong></p><p>你可以在一台隔空交互的电脑熵使用 <a target=_blank rel=noopener href=https://iancoleman.io/bip39/ >Ian Coleman 的开源工具</a>来验证它的正确性。</p><img src=https://github.com/mflaxman/blind-xpub/raw/main/blinding_from_tpub.png><h3 id=创建输出描述符><a href=#创建输出描述符 class=headerlink title=创建输出描述符></a>创建输出描述符</h3><p>在我们这个案例中，我们取得常规的种子词 A 的 xpub，以及我们刚刚计算出来的盲化的种子词 B 的 xpub，（通过 Specter-Desktop）使用 Bitcoin Core 结合成一个 <code>1-of-2 p2wsh sortedmulti</code> 输出描述符：</p><p><img src=/../images/blinding-a-seed-using-secret-bip-32-paths/sh_sortedmulti.png alt=image></p><p>这也可以生成 <a target=_blank rel=noopener href=https://github.com/mflaxman/blind-xpub/blob/main/investx12_sellx12_blinded_backup.pdf>pdf</a>、<a target=_blank rel=noopener href=https://github.com/mflaxman/blind-xpub/blob/main/investx12_sellx12BLINDED.json>json</a> 乃至 <a target=_blank rel=noopener href=https://github.com/mflaxman/blind-xpub/blob/main/account_map.png>QR 码</a>形式的输出描述符备份。</p><p><strong>用 buidl 验证</strong></p><p>我们在 python 中运行如下代码：</p><pre><code>from buidl.descriptor import P2WSHSortedMulti

quorum_m = 1
key_records = [
    &#123;
        # investx12 - regular path
        &quot;xfp&quot;: &quot;aa917e75&quot;,
        &quot;path&quot;: &quot;m/48h/1h/0h/2h&quot;,
        &quot;xpub_parent&quot;: &quot;tpubDEZRP2dRKoGRJnR9zn6EoLouYKbYyjFsxywgG7wMQwCDVkwNvoLhcX1rTQipYajmTAF82kJoKDiNCgD4wUPahACE7n1trMSm7QS8B3S1fdy&quot;,
        &quot;account_index&quot;: 0,
    &#125;,
    &#123;
        # sellx12 - BLINDED path
        &quot;xfp&quot;: &quot;2553c4b8&quot;,
        &quot;path&quot;: &quot;m/48h/1h/0h/2h/2046266013/1945465733/1801020214/1402692941&quot;,
        &quot;xpub_parent&quot;: &quot;tpubDNVvpMhdGTmQg1AT6muju2eUWPXWWAtUSyc1EQ2MxJ2s97fMqFZQbpzQM4gU8bwzfFM7KBpSXRJ5v2Wu8sY2GF5ZpXm3qy8GLArZZNM1Wru&quot;,
        &quot;account_index&quot;: 0,
    &#125;,
]
p2wsh_sortedmulti_obj = P2WSHSortedMulti(quorum_m, key_records)
print(p2wsh_sortedmulti_obj)
</code></pre><h3 id=获取收款地址><a href=#获取收款地址 class=headerlink title=获取收款地址></a>获取收款地址</h3><p><strong>Specter-Desktop</strong></p><p>（通过 Specter-Desktop）Bitcoin Core 提供了如下地址：</p><p><img src=/../images/blinding-a-seed-using-secret-bip-32-paths/address.png alt=image></p><p><strong>用 buidl 验证</strong></p><pre><code>&gt;&gt;&gt; p2wsh_sortedmulti_obj.get_address(0)
&#39;tb1q6d6frh07dl8djmnv48aqelp6r0mejzh7qgauw7yx5qcjehvcfnsqxc6lly&#39;
</code></pre><p><strong>用 Caravan 验证</strong></p><p>你可以在 <a target=_blank rel=noopener href=https://unchained-capital.github.io/caravan/ >Caravan</a> 中使用<a target=_blank rel=noopener href=https://github.com/mflaxman/blind-xpub/blob/main/bitcoin-1-of-2-P2WSH-testing.json>这个钱包配置文件</a>生成观察地址（这个配置文件是从上面生成的输出描述符中推导出来的）：</p><p><img src=/../images/blinding-a-seed-using-secret-bip-32-paths/caravan_receive_address.png alt=image></p><p><strong>Sparrow 验证</strong></p><p>你可以在 <a target=_blank rel=noopener href=https://sparrowwallet.com/ >Sparrow</a> 钱包中使用这个输出描述符（就是 <code>wsh(sortedmulti(</code> 开头的字符串，见上文的 “创建输出描述符” 一节）创建观察地址：</p><p><img src=/../images/blinding-a-seed-using-secret-bip-32-paths/eceive_address.png alt=image></p><p><strong>接收比特币</strong></p><p>使用一个测试网水龙头，我们向这个地址发送了一些 tBTC：<a target=_blank rel=noopener href=https://blockstream.info/testnet/tx/67eed0727a639f214b3da3ee206b2a27ed8cd8aca6ccd795972da5bc33dc4d35>https://blockstream.info/testnet/tx/67eed0727a639f214b3da3ee206b2a27ed8cd8aca6ccd795972da5bc33dc4d35</a></p><h3 id=签名交易><a href=#签名交易 class=headerlink title=签名交易></a>签名交易</h3><p>为了从这个多签名装置中花费资金，以下两个条件 <em>都要</em> 满足：</p><ol><li>持有其中一个种子词 —— 种子 A 或种子 B</li><li>知晓完整的输出描述符 —— 这个描述符介绍了用在这个多签名钱包中的<strong>所有</strong>种子，即使当前并未使用某个种子来签名某笔交易</li></ol><p>我们将把资金打回测试网水龙头地址：<code>mkHS9ne12qx9pS9VojpwU5xtRd4T7X7ZUt</code> 。</p><p><strong>准备交易</strong></p><p>（通过 Specter-Desktop）Bitcoin Core 可以创建一个待签名的 PSBT 来清扫资金：</p><p><img src=/../images/blinding-a-seed-using-secret-bip-32-paths/sktop_unsigned.png alt=image></p><p>它所现显示的交易的对应 PSBT 是（用于隔空交互设备的图片版本可见<a target=_blank rel=noopener href=https://github.com/mflaxman/blind-xpub/blob/main/psbt.png>此处</a>）：</p><pre><code>cHNidP8BAFUCAAAAATVN3DO8pS2XldfMpqzYjO0nKmsg7qM9SyGfY3py0O5nAAAAAAD9////ASWGAQAAAAAAGXapFDRKD0jKFQ7CuQOBdmC5tosTpnAmiKwAAAAAAAEAlAIAAAABuyYafpgmVz6R0nydIwQhLhK9wyq+MdzpZ2eYwfXFb0sAAAAAFxYAFNeBq/yMVx5pEh75uUCeQEenBts2/v///wKghgEAAAAAACIAINN0kd3+b87Zbmyp+gz8Ohv3mQr+AjvHeIagMSzdmEzgRxk5AAAAAAAWABSximIn3PYA1OH6B/cCwK+yIu8LAFKOHgABASughgEAAAAAACIAINN0kd3+b87Zbmyp+gz8Ohv3mQr+AjvHeIagMSzdmEzgAQVHUSEDELg0dGMOr13U7TYY21H1qqau+SG9gzPtgUOqbqcdjU0hAz8uRBD7XX0++TpuqGBjHSbo0olYV8KAZj3e9ovghmHxUq4iBgMQuDR0Yw6vXdTtNhjbUfWqpq75Ib2DM+2BQ6pupx2NTSwlU8S4MAAAgAEAAIAAAACAAgAAgJ2K93mFc/VzNmNZa01lm1MAAAAAAAAAACIGAz8uRBD7XX0++TpuqGBjHSbo0olYV8KAZj3e9ovghmHxHKqRfnUwAACAAQAAgAAAAIACAACAAAAAAAAAAAAAAA==
</code></pre><p><strong>使用盲化密钥来签名</strong></p><p>这可以在 Specter-DIY 上执行，也可以使用任何其它原生基于 PSBT、不限制用户使用哪个 BIP32 路径的硬件签名器：</p><p><img src=/../images/blinding-a-seed-using-secret-bip-32-paths/blinded_spend.png alt=image></p><p><strong>文字版本</strong></p><pre><code>$ python3 multiwallet.py 
Welcome to multiwallet, the stateless multisig bitcoin wallet.
This tool is free and there is NO WARRANTY OF ANY KIND.
You are currently in SAFE mode.
Type help or ? to list commands.

(₿) send
Paste in your account map (AKA output record): wsh(sortedmulti(1,[aa917e75/48h/1h/0h/2h]tpubDEZRP2dRKoGRJnR9zn6EoLouYKbYyjFsxywgG7wMQwCDVkwNvoLhcX1rTQipYajmTAF82kJoKDiNCgD4wUPahACE7n1trMSm7QS8B3S1fdy/0/*,[2553c4b8/48h/1h/0h/2h/2046266013/1945465733/1801020214/1402692941]tpubDNVvpMhdGTmQg1AT6muju2eUWPXWWAtUSyc1EQ2MxJ2s97fMqFZQbpzQM4gU8bwzfFM7KBpSXRJ5v2Wu8sY2GF5ZpXm3qy8GLArZZNM1Wru/0/*))#0lfdttke
Paste partially signed bitcoin transaction (PSBT) in base64 form: cHNidP8BAFUCAAAAATVN3DO8pS2XldfMpqzYjO0nKmsg7qM9SyGfY3py0O5nAAAAAAD9////ASWGAQAAAAAAGXapFDRKD0jKFQ7CuQOBdmC5tosTpnAmiKwAAAAAAAEAlAIAAAABuyYafpgmVz6R0nydIwQhLhK9wyq+MdzpZ2eYwfXFb0sAAAAAFxYAFNeBq/yMVx5pEh75uUCeQEenBts2/v///wKghgEAAAAAACIAINN0kd3+b87Zbmyp+gz8Ohv3mQr+AjvHeIagMSzdmEzgRxk5AAAAAAAWABSximIn3PYA1OH6B/cCwK+yIu8LAFKOHgABASughgEAAAAAACIAINN0kd3+b87Zbmyp+gz8Ohv3mQr+AjvHeIagMSzdmEzgAQVHUSEDELg0dGMOr13U7TYY21H1qqau+SG9gzPtgUOqbqcdjU0hAz8uRBD7XX0++TpuqGBjHSbo0olYV8KAZj3e9ovghmHxUq4iBgMQuDR0Yw6vXdTtNhjbUfWqpq75Ib2DM+2BQ6pupx2NTSwlU8S4MAAAgAEAAIAAAACAAgAAgJ2K93mFc/VzNmNZa01lm1MAAAAAAAAAACIGAz8uRBD7XX0++TpuqGBjHSbo0olYV8KAZj3e9ovghmHxHKqRfnUwAACAAQAAgAAAAIACAACAAAAAAAAAAAAAAA==
Transaction appears to be a testnet transaction. Display as testnet? [Y/n]: 
PSBT sends 99,877 sats to mkHS9ne12qx9pS9VojpwU5xtRd4T7X7ZUt with a fee of 123 sats (0.12% of spend)
In Depth Transaction View? [y/N]: 
Sign this transaction? [Y/n]: 
Enter your full BIP39 seed phrase: sell sell sell sell sell sell sell sell sell sell sell sell
Use a passphrase (advanced users only)? [y/N]: 

Signed PSBT to broadcast:

cHNidP8BAFUCAAAAATVN3DO8pS2XldfMpqzYjO0nKmsg7qM9SyGfY3py0O5nAAAAAAD9////ASWGAQAAAAAAGXapFDRKD0jKFQ7CuQOBdmC5tosTpnAmiKwAAAAAAAEAlAIAAAABuyYafpgmVz6R0nydIwQhLhK9wyq+MdzpZ2eYwfXFb0sAAAAAFxYAFNeBq/yMVx5pEh75uUCeQEenBts2/v///wKghgEAAAAAACIAINN0kd3+b87Zbmyp+gz8Ohv3mQr+AjvHeIagMSzdmEzgRxk5AAAAAAAWABSximIn3PYA1OH6B/cCwK+yIu8LAFKOHgAiAgMQuDR0Yw6vXdTtNhjbUfWqpq75Ib2DM+2BQ6pupx2NTUcwRAIgXtCGNahJyDarwItTjAHVIzOs2DZeeGpdofBwLGmKJj0CIFA3+mNpLZ/c+KOcs41hRyY5w/08BH0ENzxEFWnIuhG4AQEFR1EhAxC4NHRjDq9d1O02GNtR9aqmrvkhvYMz7YFDqm6nHY1NIQM/LkQQ+119Pvk6bqhgYx0m6NKJWFfCgGY93vaL4IZh8VKuIgYDELg0dGMOr13U7TYY21H1qqau+SG9gzPtgUOqbqcdjU0sJVPEuDAAAIABAACAAAAAgAIAAICdivd5hXP1czZjWWtNZZtTAAAAAAAAAAAiBgM/LkQQ+119Pvk6bqhgYx0m6NKJWFfCgGY93vaL4IZh8RyqkX51MAAAgAEAAIAAAACAAgAAgAAAAAAAAAAAAAA=
</code></pre><p>然后这笔交易就广播到了测试网区块链上：<a target=_blank rel=noopener href=https://blockstream.info/testnet/tx/1ae50b064c72ab0d71207693814519016755a89444f3d42ea4d32dad3b307536>https://blockstream.info/testnet/tx/1ae50b064c72ab0d71207693814519016755a89444f3d42ea4d32dad3b307536</a></p><p><strong>使用常规密钥来签名</strong></p><p>这个密钥使用了标准路径，所以我们就用 <code>multiwallet.py</code> 快速过一下。你可以使用任何兼容性良好的硬件签名器来签名。</p><p><img src=/../images/blinding-a-seed-using-secret-bip-32-paths/regular_spend.png alt=image></p><p><strong>文字版本</strong></p><pre><code>$ python3 multiwallet.py 
Welcome to multiwallet, the stateless multisig bitcoin wallet.
This tool is free and there is NO WARRANTY OF ANY KIND.
You are currently in SAFE mode.
Type help or ? to list commands.

(₿) send
Paste in your account map (AKA output record): wsh(sortedmulti(1,[aa917e75/48h/1h/0h/2h]tpubDEZRP2dRKoGRJnR9zn6EoLouYKbYyjFsxywgG7wMQwCDVkwNvoLhcX1rTQipYajmTAF82kJoKDiNCgD4wUPahACE7n1trMSm7QS8B3S1fdy/0/*,[2553c4b8/48h/1h/0h/2h/2046266013/1945465733/1801020214/1402692941]tpubDNVvpMhdGTmQg1AT6muju2eUWPXWWAtUSyc1EQ2MxJ2s97fMqFZQbpzQM4gU8bwzfFM7KBpSXRJ5v2Wu8sY2GF5ZpXm3qy8GLArZZNM1Wru/0/*))#0lfdttke
Paste partially signed bitcoin transaction (PSBT) in base64 form: cHNidP8BAFUCAAAAATVN3DO8pS2XldfMpqzYjO0nKmsg7qM9SyGfY3py0O5nAAAAAAD9////ASWGAQAAAAAAGXapFDRKD0jKFQ7CuQOBdmC5tosTpnAmiKwAAAAAAAEAlAIAAAABuyYafpgmVz6R0nydIwQhLhK9wyq+MdzpZ2eYwfXFb0sAAAAAFxYAFNeBq/yMVx5pEh75uUCeQEenBts2/v///wKghgEAAAAAACIAINN0kd3+b87Zbmyp+gz8Ohv3mQr+AjvHeIagMSzdmEzgRxk5AAAAAAAWABSximIn3PYA1OH6B/cCwK+yIu8LAFKOHgABASughgEAAAAAACIAINN0kd3+b87Zbmyp+gz8Ohv3mQr+AjvHeIagMSzdmEzgAQVHUSEDELg0dGMOr13U7TYY21H1qqau+SG9gzPtgUOqbqcdjU0hAz8uRBD7XX0++TpuqGBjHSbo0olYV8KAZj3e9ovghmHxUq4iBgMQuDR0Yw6vXdTtNhjbUfWqpq75Ib2DM+2BQ6pupx2NTSwlU8S4MAAAgAEAAIAAAACAAgAAgJ2K93mFc/VzNmNZa01lm1MAAAAAAAAAACIGAz8uRBD7XX0++TpuqGBjHSbo0olYV8KAZj3e9ovghmHxHKqRfnUwAACAAQAAgAAAAIACAACAAAAAAAAAAAAAAA==
Transaction appears to be a testnet transaction. Display as testnet? [Y/n]: 
PSBT sends 99,877 sats to mkHS9ne12qx9pS9VojpwU5xtRd4T7X7ZUt with a fee of 123 sats (0.12% of spend)
In Depth Transaction View? [y/N]: 
Sign this transaction? [Y/n]: 
Enter your full BIP39 seed phrase: invest invest invest invest invest invest invest invest invest invest invest invest
Use a passphrase (advanced users only)? [y/N]: 

Signed PSBT to broadcast:

cHNidP8BAFUCAAAAATVN3DO8pS2XldfMpqzYjO0nKmsg7qM9SyGfY3py0O5nAAAAAAD9////ASWGAQAAAAAAGXapFDRKD0jKFQ7CuQOBdmC5tosTpnAmiKwAAAAAAAEAlAIAAAABuyYafpgmVz6R0nydIwQhLhK9wyq+MdzpZ2eYwfXFb0sAAAAAFxYAFNeBq/yMVx5pEh75uUCeQEenBts2/v///wKghgEAAAAAACIAINN0kd3+b87Zbmyp+gz8Ohv3mQr+AjvHeIagMSzdmEzgRxk5AAAAAAAWABSximIn3PYA1OH6B/cCwK+yIu8LAFKOHgAiAgM/LkQQ+119Pvk6bqhgYx0m6NKJWFfCgGY93vaL4IZh8UcwRAIgQkob2Lo6SWrnmhf6iZAw0PSvd8UnSPNGqqQWJqKg88cCIB+wsr3dwv5OByCHEkS2IHR7aC0aYHPMz3CgX5XHeyP9AQEFR1EhAxC4NHRjDq9d1O02GNtR9aqmrvkhvYMz7YFDqm6nHY1NIQM/LkQQ+119Pvk6bqhgYx0m6NKJWFfCgGY93vaL4IZh8VKuIgYDELg0dGMOr13U7TYY21H1qqau+SG9gzPtgUOqbqcdjU0sJVPEuDAAAIABAACAAAAAgAIAAICdivd5hXP1czZjWWtNZZtTAAAAAAAAAAAiBgM/LkQQ+119Pvk6bqhgYx0m6NKJWFfCgGY93vaL4IZh8RyqkX51MAAAgAEAAIAAAACAAgAAgAAAAAAAAAAAAAA=
</code></pre><h2 id=我们实现了什么><a href=#我们实现了什么 class=headerlink title=我们实现了什么></a>我们实现了什么</h2><p>从种子的生成一直到揭晓（使用秘密 BIP32 路径的）输出描述符，种子 B 的持有者都无法知晓自己的公钥保护了什么：</p><ul><li>交易历史（包括任何花费过的 UTXO）和余额</li><li>阈值信息（在这里是 <code>1-of-2</code> ）</li></ul><p>即使这个种子的持有者是恶意的（或者被执法机构扫荡了），也无法揭晓 <em>任何</em> 私人信息。而且，因为这是建立在现有的 BIP32 路径标准上的，所以 <em>已经</em> 兼容现有的许多硬件签名器和协调器软件（见 “兼容性” 一节）。</p><p>当然，这个方案需要盲化密钥的持有者在需要他们的钱包复原场景中知晓输出描述符。可以假设，透露这些私人信息对钱包主人来说也是值得的：</p><ul><li>如果钱包主人还活着，只是弄丢了 <code>m</code> 个种子，那么透露这个信息就可以复原资金，不然就什么也没有了。</li><li>如果钱包主人已经去世，那么隐私性也将不再是最重要的顾虑（他们只希望资金能真正传到继承人手上）。</li></ul><p>常见的应用场景可能是在下列条件下设立的 <code>2-of-3</code> 装置：</p><ul><li>种子 A 属于钱包主人，TA 把 A 放在家里或者办公室里（跟输出描述符的备份放在一起）</li><li>种子 B 也属于钱包主人，TA 先盲化 B 的 xpub，然后再把 B 放在保险柜里。这个保险柜在意外发生时会自动移交给 TA 的继承人。</li><li>种子 C 是由钱包主人的继承人生成并持有的，该人也拥有输出描述符的一个备份。</li></ul><p>在这种情形中，即使某个银行职员打开了保险箱，拿到了种子 B，也无法断定这个种子到达能访问哪笔资金（数额 以及&#x2F;或者 阈值 是不确定的）。</p><p>当然，这只是几乎无数种可能性中的一种。还有一些常见的情形比如：</p><ul><li>盲化继承人的密钥（这样他们就不知道自己可以继承哪些财产），然后把输出描述符交给一位律师（收到 律师-当事人 保密特权的约束，而且<strong>没有种子词</strong>）。</li><li>让一个理解如何使用硬件签名器的、可信任的家族朋友持有 <code>1</code> 个盲化密钥（也许钱包主人的孩子还太小，没法自己持有种子）。这个朋友不知道自己的密钥在保护什么，因为输出描述符必须在律师在场时才能揭晓，以及&#x2F;或者 放在了一个保险柜里。</li></ul><h2 id=兼容性><a href=#兼容性 class=headerlink title=兼容性></a>兼容性</h2><p>这套协议美妙的地方在于，因为它利于了已有的标准（BIP32 和输出描述符），现在的比特币网络上就已经可以使用它了！要添加对它的支持只需要消除对 BIP32 路径的限制，而不需要向比特币主网添加新的功能。</p><h3 id=签名器><a href=#签名器 class=headerlink title=签名器></a>签名器</h3><table><thead><tr><th>名称</th><th>类型</th><th>显示地址</th><th>Sign Standard Path</th><th>用盲化路径签名</th></tr></thead><tbody><tr><td>Specter-DIY</td><td>Hardware</td><td>✅</td><td>✅</td><td>✅</td></tr><tr><td>Sparrow</td><td>Software</td><td>✅</td><td>✅</td><td>✅</td></tr><tr><td>multiwallet.py</td><td>Software</td><td>✅</td><td>✅</td><td>✅</td></tr><tr><td>Keystone</td><td>Hardware</td><td>✅</td><td>✅</td><td>❌</td></tr><tr><td>BitBox02</td><td>Hardware</td><td>✅</td><td>✅</td><td>❌</td></tr><tr><td>Passport</td><td>Hardware</td><td>✅</td><td>✅</td><td>✅</td></tr><tr><td>Coldcard</td><td>Hardware</td><td>⚠️</td><td>⚠️</td><td>⚠️</td></tr><tr><td>Trezor</td><td>Hardware</td><td>❔</td><td>❔</td><td>❔</td></tr><tr><td>Fully Noded</td><td>Software</td><td>✅</td><td>❔</td><td>❔</td></tr></tbody></table><p>在常规用法中，Coldcard <a target=_blank rel=noopener href=https://github.com/mflaxman/blind-xpub/blob/main/coldcard_import_fail.jpg>无法导入强化隐私的的多签名钱包并获得地址</a>，也不能使用 常规&#x2F;非盲化 的路径来联合签名（除非你禁用基本的安全检查：<code>Settings &gt; Multisig Wallets &gt; Skip Checks</code>）。</p><h3 id=协调器软件><a href=#协调器软件 class=headerlink title=协调器软件></a>协调器软件</h3><table><thead><tr><th>名称</th><th>显示地址</th><th>生成 PSBT 以签名</th></tr></thead><tbody><tr><td>Specter-Desktop</td><td>✅</td><td>✅</td></tr><tr><td>Caravan</td><td>✅</td><td>✅</td></tr><tr><td>Sparrow</td><td>✅</td><td>✅</td></tr><tr><td>Fully Noded</td><td>✅</td><td>❔</td></tr></tbody></table><p>提醒：要使用 Caravan 来签名 PSBT，你必须将每一个签名器都指定为 “Coldcard”，因为从内核来说它就是 PSBT 标准。</p><h3 id=盲化多个种子><a href=#盲化多个种子 class=headerlink title=盲化多个种子></a>盲化多个种子</h3><p>在上面的案例中，我们成功盲化了 <code>1</code> 个 xpub，无需信任硬件签名器 以及&#x2F;或者 生成那个种子词的人。然而，相同的方案可以用在我们多签名装置的 <em>每一个</em> 种子词上。</p><p>这意味着，即使一个坏人在我们不知情时得到了一个种子词（可能是被因为一个安全位置被攻破了），他们也将 <em>无法</em> 知道该种子保护了什么、需要多少的阈值才能访问对应的资金。</p><p>注意，我们不需要在 “只盲化 1 个” 和 “盲化所有” 之间选择，我们可以挑选一个中间状态。只要用户理解了这个盲化方案，就有可能想要盲化 <em>所有</em> 的种子，但在硬件签名器支持较为有限的情况下（比如现在），会选择只盲化那些保存在不那么安全的地方的种子，或者更难保障隐私性的参与者的种子（例如，还未知晓你的输出描述符的联合保管服务商）。</p><h3 id=种子词的复用><a href=#种子词的复用 class=headerlink title=种子词的复用></a>种子词的复用</h3><p>值得指出的是，在使用一个信任最小化的第三方时，这个第三方可以在几乎无数个信任最小化的装置中复用相同的种子词。举个具体的例子，“爷叔” 老郑可能给了许多 朋友&#x2F;家庭成员 相同的 xpub，他们都想将老郑包含在多签名装置中，同时保持隐私性。</p><p>因为每一个盲化的 xpub 都有自己的 BIP32 路径，而且从设计上就是防碰撞（重合）的，所以理论上不会有隐私泄露。为了安全，最好的办法可能是老郑给每个人都提供一个不一样的 xpub。</p><p>甚至可以这样做（尽管不是必须），老郑也使用同一个种子词来保护自己的比特币，这意味着完全不需要新的创建仪式，也不需要额外的部分，直接就可以开始保护朋友的多签名钱包。更重度地依赖一个系统可能会进一步激励老郑提升自己的种子词安全性，也许是使用一个更好的熵源，也许是更可靠的金属板备份，也许是加入一个种子词，以及&#x2F;或者 使用 <a target=_blank rel=noopener href=https://github.com/satoshilabs/slips/blob/master/slip-0039.md>SLIP39</a> 这样的协议。</p><h3 id=紧急-复原-密钥><a href=#紧急-复原-密钥 class=headerlink title="紧急&#x2F;复原 密钥"></a>紧急&#x2F;复原 密钥</h3><p>多签名装置的杀手锏特性（冗余性和消除单点故障）在种子词都放在同一个空间的时候会大大削弱。比如说，一个 <code>2-of-3</code> 装置的 2 个种子都放在同一间屋子里，那就很有问题。<code>4-of-7</code> 装置在理论上很好，但有多少人拥有 7 个具备全天候安保的地点？如果你还希望用地理分散性来抵御自然灾害（比如火灾、洪水、足以导致疏散的龙卷风），那就更难了。</p><p>使用这个方案，你可以选择委托一些信任给明确的第三方、给他们只能用于紧急复原的密钥。在常规场景中，他们不能签名交易，甚至看不到你的输出描述符。而在紧急复原情形中（你弄丢了 1 个或更多的种子，或者被公交车撞到了），这些联合保管人可以一起签名，只要他们得到了输出描述符。在不然就只能失去比特币的情形中，通过牺牲一些隐私性来复原钱包，对许多比特币人来说都是一个有吸引力的提议。</p><h2 id=备份输出描述符><a href=#备份输出描述符 class=headerlink title=备份输出描述符></a>备份输出描述符</h2><p>备份输出描述符是多签名装置带来的一个新问题，无论是否要使用我们这里的隐私方案。绝大部分新用户没有意识到，要想花费多签名钱包中的资金，光有 <code>m-of-n</code> 个种子词还不够；你还必须知道静态的包含所有 <code>n</code> 给种子的输出描述符（拓展公钥信息）。这意味着，如果用户在 <code>3-of-5</code> 多签名钱包中存储资金，即使只弄丢了 1 个种子（意思是依然还有 4 个种子），为了花费相关的资金，依然必须拥有输出描述符的备份。</p><p>在当前的最佳习惯（常规的&#x2F;非盲化的种子）下，多签名输出描述符可以很容易从所有 n 个种子中重新生成出来，但如果只剩 <code>n-1</code> 个种子，那就已经无法重新生成了。因此，<strong>输出描述符的备份已经是极为关键的了</strong>！</p><p>这些备份有两个问题：</p><ol><li>它会向得到它的人暴露你所有的交易历史。</li><li>一般来说都很长，不可能蚀刻到金属上（也很难转录）。</li></ol><h3 id=确定性路径><a href=#确定性路径 class=headerlink title=确定性路径></a>确定性路径</h3><p>敏锐的读者会意识到本提议所带来的一个新问题：如果你盲化了 1 个乃至更多 xpub，又弄丢了你的输出描述符；即使你还持有所有的 <code>n</code> 个种子，也无法再重新生成跟你的资金对应的输出描述符。而在使用 常规&#x2F;非盲化 路径时就不是这样，只要你还有 <code>n</code> 给种子，就可以确定性地重新生成出你的输出描述符。</p><p>当前的最佳习惯是备份你的每一个种子，但假设某个囤币者没有这样做，或者随着时间流逝，电子媒介 以及&#x2F;或者 物理备份损坏了。<a target=_blank rel=noopener href=https://github.com/stepansnigirev>@stepansnigirev</a> 提出的一个独特想法是将来自公钥记录的数据喂进一个伪随机函数，然后使用结果来编码 BIP32 路径。因为算法是确定性的，所以使用所有 <code>n</code> 个种子来重新生成输出描述符是有可能的。</p><p>一个简单的、用在 2-of-3 装置中的确定性算法是这样的：</p><pre><code>hash_digest = sha256(&quot;2 xpub_A xpub_B xpub_C&quot;)
bip32_path = deterministic_path_from_entropy(hash_digest)
</code></pre><p><a target=_blank rel=noopener href=https://github.com/mflaxman/blind-xpub/blob/deterministic-paths/deterministic_paths.py>这里</a>有一个更复杂的可用版本，包含了更多高级的特性：</p><ol><li>xpub 的字典排序（不仅是子公钥层面的 <code>sortedmulti</code>，还排序了父 xpub，从而总是生成相同的伪随机函数输入）</li><li>可以轻松复原 BIP32 路径（从而整个输出描述符也可以复原），即使你忘记了门限数量 <code>m</code> 个种子 以及&#x2F;或者 哪些 xpub 你盲化过。</li><li>未每个盲化 xpub 生成确定性唯一而且不可关联的 BIP32 路径，所以某一个 xpub 的 BIP32 路径公开不会泄露其它 xpub 的任何信息。</li><li>一个可选的用户密语功能，可以给伪随机函数喂如额外的熵，创建无限诱饵的多签名钱包（<strong>仅限专家模式</strong>，默认禁止）。</li></ol><p>注意，就像今天常见的 常规&#x2F;非盲化 的多签名钱包，如果你弄丢了你的输出描述符，而且只有 <code>n-1</code> 个种子（比如在 <code>3-of-5</code> 多签名中，只剩下 4 个种子），那么依然<strong>不足以</strong>重新生成你的输出描述符。确定性的 BIP32 路径仅在你还拥有所有 <code>n</code> 个种子词，只是弄丢了输出描述符时才有用。</p><h3 id=输出描述符的-SSSS><a href=#输出描述符的-SSSS class=headerlink title="输出描述符的 SSSS"></a>输出描述符的 SSSS</h3><p>无论本盲化协议是否会被广泛实现（带不带有上述确定性路径），Shamir 的秘密值分割方案（Shamir’s Secret Sharing Scheme）对多签名标准的输出描述符来说，都是受欢迎的加法。</p><p>举个例子，假设：</p><ol><li>钱包主人加密了输出描述符，并使用 SSSS 将解密密钥分割成 <code>2-of-n</code> 个碎片（这里的 n 是任意的，只需有用就行）。</li><li>设置 <code>n</code> 个保管地点，每个地点都有：<code>1</code> 个唯一的种子词（可能蚀刻在金属熵），<code>1</code> 个唯一的 Shamir 碎片（就是在上一步中得到的），以及被加密的输出描述符载荷的复制品。</li></ol><p>注意，加密后的输出描述符可以超量保存在 <em>许多</em> 不那么安全的位置（甚至可以保存在云服务器），因为需要 <code>2</code> 个 Shamir 碎片才能解密输出描述符（而光凭这个描述符是无法花费资金的）。</p><p>然后，只要你还可以进入 <code>2</code> 个保管地点，你就可以复原出完整的输出描述符。因此，我们可以有 <code>3-of-5</code> 链上 <code>p2wsh</code> 多签名装置这样的东西：有 5 个 Shamir 碎片，需要至少 2 个才能复原出解密密钥，然后秘密输出描述符。</p><p>如果有这样的工具，对现有的多签名装置来说也是非常棒的，而且配合秘密 BIP32 路径也是完美的。</p><h2 id=与其它协议的比较><a href=#与其它协议的比较 class=headerlink title=与其它协议的比较></a>与其它协议的比较</h2><p>本协议与现有的其它选择相比如何？</p><h3 id=常规-传统-非盲化-的种子词><a href=#常规-传统-非盲化-的种子词 class=headerlink title="常规&#x2F;传统&#x2F;非盲化 的种子词"></a>常规&#x2F;传统&#x2F;非盲化 的种子词</h3><p>虽然本协议提供了更强的隐私性保证，这值得吗？常规（非盲化的）种子词也有一些好处：</p><ul><li>复杂性是安全的死敌。反对意见：备份输出描述符就是最大的复杂性，但对多签名来说已经是最佳习惯的，而且确实能解决问题。</li><li>更好的硬件签名器支持。反对意见：我希望所有的硬件签名器都可以在未来支持强化的安全性，但现在，也很容易只对支持的硬件签名器中的种子词添加强化的隐私性。</li><li>如果你没有备份输出描述符，但依然有所有 <code>n</code> 个种子，你依然可以复原资金。反对意见：你不会弄丢输出描述符的，因为它可以备份在许多地方。更新：上文的 “确定性路径” <strong>已经消除了这种顾虑</strong>。</li></ul><h3 id=秘密的-BIP39-密语><a href=#秘密的-BIP39-密语 class=headerlink title="秘密的 BIP39 密语"></a>秘密的 BIP39 密语</h3><p>另一个能够实现相同目标的办法是<a target=_blank rel=noopener href=https://github.com/BlockchainCommons/Airgapped-Wallet-Community/discussions/37>为每一个 BIP39 种子使用一个唯一的密语</a>，然后不要把密语跟 BIP39 种子词放在一起（只要分开存放就可以）。我认为，使用 BIP32 路径是 <em>严格更优的</em>。</p><ul><li>绝大多数硬件签名器的输入设备都很糟（不是键盘），所以在 启动&#x2F;使用 时输入一段很长的密语是很反人性的。“解锁” 硬件签名器时也需要密语；而相比之下，本协议只需使用现有的机制（输出描述符）向硬件签名器传入解锁数据。在基于 QR 码的钱包中，这种解锁在当前就已经无比流畅；你需要的只是扫描一次输出描述符，然后你的硬件签名器就准备好了。</li><li>唯一的密语必须保存在某个地方。当然，可以直接放在协调器里，但当前还没有 机制&#x2F;标准（不像 BIP32 路径）。</li><li>需要访问冷存储，才能复用。对于加入了许多朋友和家庭成员的多签名钱包的 “爷叔” 来说，他必须先访问冷存储，输入一个唯一的密语，才能得出一个新的 xpub 给别人。</li><li>如果你希望在盲化密语熵使用常规的 BIP39 密语，那就太复杂了。你可能会将常规密语附加到盲化密语后面，但这太混乱了（有没有分隔符呢？）。</li><li>人类在制作密语上很蠢。虽然总是可以用好的软件来生成密语，但这又令人困惑，因为口令（password）一般都是由用户自定的。</li><li>来自<a target=_blank rel=noopener href=https://github.com/BlockchainCommons/Airgapped-Wallet-Community/discussions/37#discussioncomment-627710>基于密语的提议的作者</a>：“我喜欢你的隐私提议（使用长而无法预测的 BIP32 路径），比我的更好（使用 BIP39 密语）。”</li></ul><h3 id=Taproot><a href=#Taproot class=headerlink title=Taproot></a>Taproot</h3><p><a target=_blank rel=noopener href=https://murchandamus.medium.com/2-of-3-multisig-inputs-using-pay-to-taproot-d5faf2312ba3>这篇文章</a>是一个很好的起点，可以学习多签名跟 taproot 在未来可以如何结合。</p><p>Taproot 提供了令人信服的隐私性、交易手续费、输入验证和复杂脚本模板的优势。但是，如果过往的升级给了我们什么教训，那就是供应商的采用将需要<strong>非常</strong>长的时间。甚至对多签名本身来说也是如此，在硬件签名器中的支持也依然有限（而且得到的 更新&#x2F;关注 也是最少的）。</p><p>因为 taproot 允许使用 <em>大得多</em> 的脚本（同时确保手续费是可负担的），我们可以看到脚本花费路径的 联合签名人&#x2F;保管位置 数量上一个大台阶。举个例子，你可以：</p><ul><li>实现逐步降级的多签名装置，从 <code>4-of-7</code> 降级到 <code>3-of-7</code>，再到 <code>2-of-7</code>，直至 <code>1-of-7</code>。每一次降级都需要 <code>5</code> 年时间。</li><li>实现不同种子词具有不同权重的组合：<code>2</code> 个你自己的种子就足以花费资金；不过，<code>3</code> 个你的家人的种子也可以，或者，<code>4</code> 个你的朋友的种子。</li></ul><p>Taproot 也使用描述符来描述地址，所以你会面临非常类似的隐私问题，如果你将描述符与每一个种子词一起保存（本身是推荐做法），而某一个保管地点被攻破了的话。因为 taproot 被设计成兼容 ECDSA 私钥（因此也兼容 BIP39），本协议也可以妥帖地用在未来的 taproot 多签名标准中。</p><p>Taproot 有一个很大的好处：脚本花费路径只会泄漏用来签名的密钥的信息（而其它安放不动的密钥不会泄露任何信息）。对于盲化的第三方种子词，Taproot 自身就足够强大了，因为一个信任最小化的复原密钥持有人必须得到输出描述符以联合签名（然后与他们相关的隐私就会暴露）。不过，taproot 对希望盲化自己的种子词（然后再放到保管位置）的钱包主人，并没有提供什么好处。</p><h3 id=Shamir-秘密值分割方案><a href=#Shamir-秘密值分割方案 class=headerlink title="Shamir 秘密值分割方案"></a>Shamir 秘密值分割方案</h3><p>虽然<a target=_blank rel=noopener href=https://btcguide.github.io/why-multisig-advanced#shamirs-secret-sharing-scheme>从安全角度看在单签名钱包中使用 SSSS 严格劣于多签名</a>，它也还是有些好处，如果某人只得到了不足 m 个 Shamir 碎片，就 <em>无法</em> 知道这些碎片是用来做什么的。</p><p>除了多签名本身的安全性好处之外，多签名所带来的潜在隐私风险在使用本协议之后就可以完全消除！</p><h2 id=参考><a href=#参考 class=headerlink title=参考></a>参考</h2><ul><li><a target=_blank rel=noopener href=https://github.com/BlockchainCommons/Airgapped-Wallet-Community/discussions/37>Blockchain commons thread on nosy signatories</a></li><li><a target=_blank rel=noopener href=https://twitter.com/mflaxman/status/1329535324607885324>勾勒本提议观念的最早长推特</a></li></ul><p>感谢 Stepan Snigirev、Clark Moody、Jimmy Song、Christopher Allen、Buck Perley、SeedSigner，以及其他给我反馈、帮助我多番迭代本提议的人。欢迎提出更多反馈。</p><p>（完）</p></article></div></div></main><script src="/js/post.js?v=1682773100887"></script><script src="/js/highlight.min.js?v=1682773100887"></script><script>var containerEl=document.querySelector(".post-container"),postFontSize=localStorage.getItem("post-font-size")||"16",inputEl=document.querySelector("#size-change-input"),inputEl2=document.querySelector("#size-change-input2");inputEl.value=postFontSize,inputEl2.value=postFontSize,containerEl.style.fontSize=postFontSize+"px",$(function(){function e(t){$(".post-container").css("font-size",t+"px"),localStorage.setItem("post-font-size",t),$("#size-change-input").val(t),$("#size-change-input2").val(t)}$("#size-change-input").on("input propertychange",function(t){e(t.target.value)}),$("#size-change-input2").on("input propertychange",function(t){e(t.target.value)})})</script><script>hljs.initHighlightingOnLoad()</script></main></div><footer class="is-flex is-flex-direction-column is-align-items-center is-flex-shrink-0"><section class=sns-container><a title=nostr target=_blank rel="noopener nofollow" href=https://iris.to/npub1g2qs0ca5kpwlrcfug2em4jelmh65clk3yccwjxrs6hvdpd9qj80q022j4m>Nostr</a><a title=rss target=_blank rel="noopener nofollow" href=/atom.xml>rss</a><a title=telegram target=_blank rel="noopener nofollow" href=//t.me/btcstudyorg>Telegram</a></section></footer><script async src="/js/buttons.js?v=1682773100887"></script><script async src="/js/index.js?v=1682773100887"></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-JVCJ9XXG1Z"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-JVCJ9XXG1Z")</script><script>var _hmt=_hmt||[];(()=>{var e=document.createElement("script"),t=(e.src="https://hm.baidu.com/hm.js?c92c073c85be5be8d9b1b76f62a7e306",e.async=!0,e.defer=!0,document.getElementsByTagName("script")[0]);t.parentNode.insertBefore(e,t)})()</script></body></html>