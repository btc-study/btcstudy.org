<!DOCTYPE html><html lang=zh-CN><head><meta charset=UTF-8><title>为富状态的比特币脚本探索 Lamport 和 Winternitz 签名</title><meta name=keywords content="比特币, 中本聪, 比特币区块链, 闪电网络, 比特币 layer 2, 健全货币, 密码货币, 密码朋克, 学习比特币, BTC, BTC Study, Bitcoin, bitcoin, proof of work"><meta name=description content=比特币思想的中文集结地><meta name=viewport content="width=device-width,minimum-scale=1,maximum-scale=1,initial-scale=1"><link rel=icon href=/favicon.ico><link rel=stylesheet href="/style/common/bulma.css?v=1682773100887"><link rel=preload as=style onload='this.onload=null,this.rel="stylesheet"' href="/style/common/iconfont.css?v=1682773100887"><link rel=stylesheet href="/style/base.css?v=1682773100887"><link rel=stylesheet href="/style/common/helper.css?v=1682773100887"><link rel=stylesheet href="/style/themes/animation.css?v=1682773100887"><script>function ready(){var e=document.querySelector(".body-container"),t=localStorage.getItem("theme")||"light";["light","dark"].includes(t)||(t="light",localStorage.setItem("theme","light")),e.classList.remove("appearance-auto"),e.classList.add("appearance-"+t),quickInitialTheme()}function quickInitialTheme(){var e=localStorage.getItem("theme")||"light",t=document.querySelector(".logo-light"),o=document.querySelector(".logo-dark"),d=document.querySelector("#mobile-header-logo > .logo-light"),l=document.querySelector("#mobile-header-logo > .logo-dark"),a=document.getElementById("theme-btn"),i=document.querySelector(".slide-theme-light"),c=document.querySelector(".slide-theme-dark");document.body.classList.add(e),("dark"===e?(t.classList.add("hidden"),o.classList.remove("hidden"),d.classList.add("hidden"),l.classList.remove("hidden"),a.classList.remove("icon-icon_dark"),a.classList.add("icon-icon_light"),i):c).classList.remove("hidden")}document.addEventListener("DOMContentLoaded",ready)</script><script src="/js/common.js?v=1682773100887"></script><script src=/js/libs/zepto.min.js></script><link rel=stylesheet href="/style/post.css?v=1682773100887"><link rel=stylesheet href="/style/themes/highlight.css?v=1682773100887"><meta name=generator content="Hexo 6.3.0"><link rel=alternate href=/atom.xml title="BTC Study" type=application/atom+xml></head><body class="is-flex is-flex-direction-column" onload=initialTheme()><div class=clip></div><div class="body-container appearance-auto"><header class="header-widget is-hidden-mobile is-flex is-flex-shrink-0 is-align-items-center is-justify-content-center" id=header><div class="is-flex header-widget-container is-flex-shrink-0 is-align-items-center"><section class="is-hidden-mobile is-flex-shrink-0"><h1><a href=/ ><svg class=logo-light width=125px height=23px viewBox="0 0 125 23" version=1.1 xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink><title>BTCStudy</title><g id=页面-1 stroke=none stroke-width=1 fill=none fill-rule=evenodd><g id=首页-响应式 transform="translate(-249.000000, -23.000000)" fill-rule=nonzero><g id=BTCStudy transform="translate(249.680000, 23.192000)"><path d="M9.072,17.808 C11.312,17.808 13.024,17.408 14.208,16.608 C15.392,15.808 15.984,14.672 15.984,13.2 C15.984,12.192 15.712,11.332 15.168,10.62 C14.624,9.908 13.872,9.384 12.912,9.048 C13.632,8.68 14.188,8.18 14.58,7.548 C14.972,6.916 15.168,6.2 15.168,5.4 C15.168,4.056 14.608,2.988 13.488,2.196 C12.368,1.404 10.736,1.008 8.592,1.008 L8.592,1.008 L-5.68434189e-14,1.008 L-5.68434189e-14,17.808 L9.072,17.808 Z M7.968,7.68 L4.704,7.68 L4.704,4.44 L7.968,4.44 C9.568,4.44 10.368,4.976 10.368,6.048 C10.368,7.136 9.568,7.68 7.968,7.68 L7.968,7.68 Z M8.688,14.376 L4.704,14.376 L4.704,10.968 L8.688,10.968 C10.352,10.968 11.184,11.536 11.184,12.672 C11.184,13.808 10.352,14.376 8.688,14.376 L8.688,14.376 Z M26.544,17.808 L26.544,4.776 L31.68,4.776 L31.68,1.008 L16.632,1.008 L16.632,4.776 L21.792,4.776 L21.792,17.808 L26.544,17.808 Z M41.592,18.144 C43.128,18.144 44.512,17.872 45.744,17.328 C46.976,16.784 48,16 48.816,14.976 L48.816,14.976 L45.792,12.24 C44.704,13.552 43.384,14.208 41.832,14.208 C40.92,14.208 40.108,14.008 39.396,13.608 C38.684,13.208 38.132,12.644 37.74,11.916 C37.348,11.188 37.152,10.352 37.152,9.408 C37.152,8.464 37.348,7.628 37.74,6.9 C38.132,6.172 38.684,5.608 39.396,5.208 C40.108,4.808 40.92,4.608 41.832,4.608 C43.384,4.608 44.704,5.264 45.792,6.576 L45.792,6.576 L48.816,3.84 C48,2.816 46.976,2.032 45.744,1.488 C44.512,0.944 43.128,0.672 41.592,0.672 C39.832,0.672 38.252,1.044 36.852,1.788 C35.452,2.532 34.352,3.568 33.552,4.896 C32.752,6.224 32.352,7.728 32.352,9.408 C32.352,11.088 32.752,12.592 33.552,13.92 C34.352,15.248 35.452,16.284 36.852,17.028 C38.252,17.772 39.832,18.144 41.592,18.144 Z" id=BTC fill=#F2A900></path><path d="M56.64,18.144 C58.24,18.144 59.6,17.9 60.72,17.412 C61.84,16.924 62.68,16.272 63.24,15.456 C63.8,14.64 64.08,13.728 64.08,12.72 C64.08,11.552 63.772,10.628 63.156,9.948 C62.54,9.268 61.812,8.772 60.972,8.46 C60.132,8.148 59.072,7.856 57.792,7.584 C56.656,7.344 55.832,7.112 55.32,6.888 C54.808,6.664 54.552,6.328 54.552,5.88 C54.552,5.432 54.768,5.068 55.2,4.788 C55.632,4.508 56.32,4.368 57.264,4.368 C58.768,4.368 60.32,4.8 61.92,5.664 L61.92,5.664 L63.384,2.136 C62.568,1.656 61.624,1.292 60.552,1.044 C59.48,0.796 58.392,0.672 57.288,0.672 C55.672,0.672 54.308,0.912 53.196,1.392 C52.084,1.872 51.248,2.524 50.688,3.348 C50.128,4.172 49.848,5.096 49.848,6.12 C49.848,7.288 50.152,8.216 50.76,8.904 C51.368,9.592 52.096,10.092 52.944,10.404 C53.792,10.716 54.848,11.008 56.112,11.28 C57.264,11.536 58.1,11.78 58.62,12.012 C59.14,12.244 59.4,12.6 59.4,13.08 C59.4,13.992 58.488,14.448 56.664,14.448 C55.704,14.448 54.728,14.296 53.736,13.992 C52.744,13.688 51.872,13.288 51.12,12.792 L51.12,12.792 L49.56,16.296 C50.36,16.856 51.4,17.304 52.68,17.64 C53.96,17.976 55.28,18.144 56.64,18.144 Z M71.856,18.024 C72.48,18.024 73.068,17.96 73.62,17.832 C74.172,17.704 74.64,17.52 75.024,17.28 L75.024,17.28 L73.896,14.088 C73.496,14.36 73.032,14.496 72.504,14.496 C72.088,14.496 71.756,14.364 71.508,14.1 C71.26,13.836 71.136,13.472 71.136,13.008 L71.136,13.008 L71.136,8.688 L74.112,8.688 L74.112,5.28 L71.136,5.28 L71.136,1.896 L66.576,1.896 L66.576,5.28 L64.68,5.28 L64.68,8.688 L66.576,8.688 L66.576,13.056 C66.576,14.704 67.032,15.944 67.944,16.776 C68.856,17.608 70.16,18.024 71.856,18.024 Z M82.248,18.024 C83,18.024 83.712,17.888 84.384,17.616 C85.056,17.344 85.632,16.944 86.112,16.416 L86.112,16.416 L86.112,17.808 L90.456,17.808 L90.456,4.8 L85.896,4.8 L85.896,11.064 C85.896,12.104 85.668,12.876 85.212,13.38 C84.756,13.884 84.168,14.136 83.448,14.136 C82.744,14.136 82.208,13.912 81.84,13.464 C81.472,13.016 81.288,12.304 81.288,11.328 L81.288,11.328 L81.288,4.8 L76.728,4.8 L76.728,12.072 C76.728,14.056 77.228,15.544 78.228,16.536 C79.228,17.528 80.568,18.024 82.248,18.024 Z M99.048,18.024 C100.744,18.024 102.016,17.52 102.864,16.512 L102.864,16.512 L102.864,17.808 L107.208,17.808 L107.208,0 L102.648,0 L102.648,5.928 C101.8,5.032 100.6,4.584 99.048,4.584 C97.864,4.584 96.784,4.856 95.808,5.4 C94.832,5.944 94.06,6.724 93.492,7.74 C92.924,8.756 92.64,9.936 92.64,11.28 C92.64,12.624 92.924,13.808 93.492,14.832 C94.06,15.856 94.832,16.644 95.808,17.196 C96.784,17.748 97.864,18.024 99.048,18.024 Z M100.008,14.4 C99.208,14.4 98.552,14.124 98.04,13.572 C97.528,13.02 97.272,12.256 97.272,11.28 C97.272,10.32 97.528,9.568 98.04,9.024 C98.552,8.48 99.208,8.208 100.008,8.208 C100.808,8.208 101.46,8.48 101.964,9.024 C102.468,9.568 102.72,10.32 102.72,11.28 C102.72,12.256 102.464,13.02 101.952,13.572 C101.44,14.124 100.792,14.4 100.008,14.4 Z M112.368,22.68 C113.728,22.68 114.88,22.356 115.824,21.708 C116.768,21.06 117.568,19.936 118.224,18.336 L118.224,18.336 L123.84,4.8 L119.496,4.8 L116.28,12.744 L113.088,4.8 L108.408,4.8 L113.976,17.976 C113.784,18.36 113.548,18.64 113.268,18.816 C112.988,18.992 112.632,19.08 112.2,19.08 C111.832,19.08 111.468,19.012 111.108,18.876 C110.748,18.74 110.44,18.552 110.184,18.312 L110.184,18.312 L108.6,21.504 C109.032,21.856 109.596,22.14 110.292,22.356 C110.988,22.572 111.68,22.68 112.368,22.68 Z" id=Study fill-opacity=0.85 fill=#000000></path></g></g></g></svg><svg class="logo-dark hidden" width=125px height=23px viewBox="0 0 125 23" version=1.1 xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink><title>BTCStudy</title><g id=页面-1 stroke=none stroke-width=1 fill=none fill-rule=evenodd><g id=首页-响应式 transform="translate(-249.000000, -23.000000)" fill-rule=nonzero><g id=BTCStudy transform="translate(249.680000, 23.192000)"><path d="M9.072,17.808 C11.312,17.808 13.024,17.408 14.208,16.608 C15.392,15.808 15.984,14.672 15.984,13.2 C15.984,12.192 15.712,11.332 15.168,10.62 C14.624,9.908 13.872,9.384 12.912,9.048 C13.632,8.68 14.188,8.18 14.58,7.548 C14.972,6.916 15.168,6.2 15.168,5.4 C15.168,4.056 14.608,2.988 13.488,2.196 C12.368,1.404 10.736,1.008 8.592,1.008 L8.592,1.008 L-5.68434189e-14,1.008 L-5.68434189e-14,17.808 L9.072,17.808 Z M7.968,7.68 L4.704,7.68 L4.704,4.44 L7.968,4.44 C9.568,4.44 10.368,4.976 10.368,6.048 C10.368,7.136 9.568,7.68 7.968,7.68 L7.968,7.68 Z M8.688,14.376 L4.704,14.376 L4.704,10.968 L8.688,10.968 C10.352,10.968 11.184,11.536 11.184,12.672 C11.184,13.808 10.352,14.376 8.688,14.376 L8.688,14.376 Z M26.544,17.808 L26.544,4.776 L31.68,4.776 L31.68,1.008 L16.632,1.008 L16.632,4.776 L21.792,4.776 L21.792,17.808 L26.544,17.808 Z M41.592,18.144 C43.128,18.144 44.512,17.872 45.744,17.328 C46.976,16.784 48,16 48.816,14.976 L48.816,14.976 L45.792,12.24 C44.704,13.552 43.384,14.208 41.832,14.208 C40.92,14.208 40.108,14.008 39.396,13.608 C38.684,13.208 38.132,12.644 37.74,11.916 C37.348,11.188 37.152,10.352 37.152,9.408 C37.152,8.464 37.348,7.628 37.74,6.9 C38.132,6.172 38.684,5.608 39.396,5.208 C40.108,4.808 40.92,4.608 41.832,4.608 C43.384,4.608 44.704,5.264 45.792,6.576 L45.792,6.576 L48.816,3.84 C48,2.816 46.976,2.032 45.744,1.488 C44.512,0.944 43.128,0.672 41.592,0.672 C39.832,0.672 38.252,1.044 36.852,1.788 C35.452,2.532 34.352,3.568 33.552,4.896 C32.752,6.224 32.352,7.728 32.352,9.408 C32.352,11.088 32.752,12.592 33.552,13.92 C34.352,15.248 35.452,16.284 36.852,17.028 C38.252,17.772 39.832,18.144 41.592,18.144 Z" id=BTC fill=#F2A900></path><path d="M56.64,18.144 C58.24,18.144 59.6,17.9 60.72,17.412 C61.84,16.924 62.68,16.272 63.24,15.456 C63.8,14.64 64.08,13.728 64.08,12.72 C64.08,11.552 63.772,10.628 63.156,9.948 C62.54,9.268 61.812,8.772 60.972,8.46 C60.132,8.148 59.072,7.856 57.792,7.584 C56.656,7.344 55.832,7.112 55.32,6.888 C54.808,6.664 54.552,6.328 54.552,5.88 C54.552,5.432 54.768,5.068 55.2,4.788 C55.632,4.508 56.32,4.368 57.264,4.368 C58.768,4.368 60.32,4.8 61.92,5.664 L61.92,5.664 L63.384,2.136 C62.568,1.656 61.624,1.292 60.552,1.044 C59.48,0.796 58.392,0.672 57.288,0.672 C55.672,0.672 54.308,0.912 53.196,1.392 C52.084,1.872 51.248,2.524 50.688,3.348 C50.128,4.172 49.848,5.096 49.848,6.12 C49.848,7.288 50.152,8.216 50.76,8.904 C51.368,9.592 52.096,10.092 52.944,10.404 C53.792,10.716 54.848,11.008 56.112,11.28 C57.264,11.536 58.1,11.78 58.62,12.012 C59.14,12.244 59.4,12.6 59.4,13.08 C59.4,13.992 58.488,14.448 56.664,14.448 C55.704,14.448 54.728,14.296 53.736,13.992 C52.744,13.688 51.872,13.288 51.12,12.792 L51.12,12.792 L49.56,16.296 C50.36,16.856 51.4,17.304 52.68,17.64 C53.96,17.976 55.28,18.144 56.64,18.144 Z M71.856,18.024 C72.48,18.024 73.068,17.96 73.62,17.832 C74.172,17.704 74.64,17.52 75.024,17.28 L75.024,17.28 L73.896,14.088 C73.496,14.36 73.032,14.496 72.504,14.496 C72.088,14.496 71.756,14.364 71.508,14.1 C71.26,13.836 71.136,13.472 71.136,13.008 L71.136,13.008 L71.136,8.688 L74.112,8.688 L74.112,5.28 L71.136,5.28 L71.136,1.896 L66.576,1.896 L66.576,5.28 L64.68,5.28 L64.68,8.688 L66.576,8.688 L66.576,13.056 C66.576,14.704 67.032,15.944 67.944,16.776 C68.856,17.608 70.16,18.024 71.856,18.024 Z M82.248,18.024 C83,18.024 83.712,17.888 84.384,17.616 C85.056,17.344 85.632,16.944 86.112,16.416 L86.112,16.416 L86.112,17.808 L90.456,17.808 L90.456,4.8 L85.896,4.8 L85.896,11.064 C85.896,12.104 85.668,12.876 85.212,13.38 C84.756,13.884 84.168,14.136 83.448,14.136 C82.744,14.136 82.208,13.912 81.84,13.464 C81.472,13.016 81.288,12.304 81.288,11.328 L81.288,11.328 L81.288,4.8 L76.728,4.8 L76.728,12.072 C76.728,14.056 77.228,15.544 78.228,16.536 C79.228,17.528 80.568,18.024 82.248,18.024 Z M99.048,18.024 C100.744,18.024 102.016,17.52 102.864,16.512 L102.864,16.512 L102.864,17.808 L107.208,17.808 L107.208,0 L102.648,0 L102.648,5.928 C101.8,5.032 100.6,4.584 99.048,4.584 C97.864,4.584 96.784,4.856 95.808,5.4 C94.832,5.944 94.06,6.724 93.492,7.74 C92.924,8.756 92.64,9.936 92.64,11.28 C92.64,12.624 92.924,13.808 93.492,14.832 C94.06,15.856 94.832,16.644 95.808,17.196 C96.784,17.748 97.864,18.024 99.048,18.024 Z M100.008,14.4 C99.208,14.4 98.552,14.124 98.04,13.572 C97.528,13.02 97.272,12.256 97.272,11.28 C97.272,10.32 97.528,9.568 98.04,9.024 C98.552,8.48 99.208,8.208 100.008,8.208 C100.808,8.208 101.46,8.48 101.964,9.024 C102.468,9.568 102.72,10.32 102.72,11.28 C102.72,12.256 102.464,13.02 101.952,13.572 C101.44,14.124 100.792,14.4 100.008,14.4 Z M112.368,22.68 C113.728,22.68 114.88,22.356 115.824,21.708 C116.768,21.06 117.568,19.936 118.224,18.336 L118.224,18.336 L123.84,4.8 L119.496,4.8 L116.28,12.744 L113.088,4.8 L108.408,4.8 L113.976,17.976 C113.784,18.36 113.548,18.64 113.268,18.816 C112.988,18.992 112.632,19.08 112.2,19.08 C111.832,19.08 111.468,19.012 111.108,18.876 C110.748,18.74 110.44,18.552 110.184,18.312 L110.184,18.312 L108.6,21.504 C109.032,21.856 109.596,22.14 110.292,22.356 C110.988,22.572 111.68,22.68 112.368,22.68 Z" id=Study fill-opacity=0.85 fill=#FFFFFF></path></g></g></g></svg></a></h1></section><div class="is-flex is-flex-direction-column header-menu-wrap"><aside class="is-flex-shrink-0 is-flex is-flex-direction-row is-align-items-center" id=header-menu><a class="is-inline-block header-activity mr-4" href=/ >首页</a><a class="is-inline-block mr-4" href=/archives>全站目录</a><a class="is-inline-block mr-4" href=/tags>标签</a><a class="is-inline-block mr-4" href=/maps>地图</a><a class="is-inline-block mr-4" href=/tools>工具</a><a class="is-inline-block mr-4" target=_blank rel=noopener href=https://123btc.org/ >123btc</a><div class="right-content is-flex is-flex-direction-row is-align-items-center"><div class="size-wrap mr-1"><i class="iconfont icon-a-bianzu5" id=change-size-btn></i><div class=size-input-wrap><div class=input-wrap><input id=size-change-input type=range min=12 max=32 step=2></div></div></div><i class="iconfont icon-icon_dark mr-1" id=theme-btn></i><div class=search-wrap><input class=pl-3 id=search-input placeholder=请输入搜索关键词><i class="iconfont icon-icon_search" id=search-input-btn></i></div></div></aside><div class="header-title is-hidden-mobile is-full-height is-flex is-align-items-center is-flex-shrink-0"><div class="is-full-height hidden" id=postTopic><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">为富状态的比特币脚本探索 Lamport 和 Winternitz 签名</p><div class="size-wrap mr-1"><i class="iconfont icon-a-bianzu5" id=change-size-btn2></i><div class=size-input-wrap><div class=input-wrap><input id=size-change-input2 type=range min=12 max=32 step=2></div></div></div></div></div></div></div></header><header class="is-flex header-widget is-flex-shrink-0 is-align-items-center is-justify-content-space-between is-hidden-tablet" id=mobile-header><div class="is-flex is-flex-direction-row is-align-items-center"><i class="iconfont icon-icon_bar mobile-header-menu"></i><div id=mobile-header-logo><svg class=logo-light width=125px height=23px viewBox="0 0 125 23" version=1.1 xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink><title>BTCStudy</title><g id=页面-1 stroke=none stroke-width=1 fill=none fill-rule=evenodd><g id=首页-响应式 transform="translate(-249.000000, -23.000000)" fill-rule=nonzero><g id=BTCStudy transform="translate(249.680000, 23.192000)"><path d="M9.072,17.808 C11.312,17.808 13.024,17.408 14.208,16.608 C15.392,15.808 15.984,14.672 15.984,13.2 C15.984,12.192 15.712,11.332 15.168,10.62 C14.624,9.908 13.872,9.384 12.912,9.048 C13.632,8.68 14.188,8.18 14.58,7.548 C14.972,6.916 15.168,6.2 15.168,5.4 C15.168,4.056 14.608,2.988 13.488,2.196 C12.368,1.404 10.736,1.008 8.592,1.008 L8.592,1.008 L-5.68434189e-14,1.008 L-5.68434189e-14,17.808 L9.072,17.808 Z M7.968,7.68 L4.704,7.68 L4.704,4.44 L7.968,4.44 C9.568,4.44 10.368,4.976 10.368,6.048 C10.368,7.136 9.568,7.68 7.968,7.68 L7.968,7.68 Z M8.688,14.376 L4.704,14.376 L4.704,10.968 L8.688,10.968 C10.352,10.968 11.184,11.536 11.184,12.672 C11.184,13.808 10.352,14.376 8.688,14.376 L8.688,14.376 Z M26.544,17.808 L26.544,4.776 L31.68,4.776 L31.68,1.008 L16.632,1.008 L16.632,4.776 L21.792,4.776 L21.792,17.808 L26.544,17.808 Z M41.592,18.144 C43.128,18.144 44.512,17.872 45.744,17.328 C46.976,16.784 48,16 48.816,14.976 L48.816,14.976 L45.792,12.24 C44.704,13.552 43.384,14.208 41.832,14.208 C40.92,14.208 40.108,14.008 39.396,13.608 C38.684,13.208 38.132,12.644 37.74,11.916 C37.348,11.188 37.152,10.352 37.152,9.408 C37.152,8.464 37.348,7.628 37.74,6.9 C38.132,6.172 38.684,5.608 39.396,5.208 C40.108,4.808 40.92,4.608 41.832,4.608 C43.384,4.608 44.704,5.264 45.792,6.576 L45.792,6.576 L48.816,3.84 C48,2.816 46.976,2.032 45.744,1.488 C44.512,0.944 43.128,0.672 41.592,0.672 C39.832,0.672 38.252,1.044 36.852,1.788 C35.452,2.532 34.352,3.568 33.552,4.896 C32.752,6.224 32.352,7.728 32.352,9.408 C32.352,11.088 32.752,12.592 33.552,13.92 C34.352,15.248 35.452,16.284 36.852,17.028 C38.252,17.772 39.832,18.144 41.592,18.144 Z" id=BTC fill=#F2A900></path><path d="M56.64,18.144 C58.24,18.144 59.6,17.9 60.72,17.412 C61.84,16.924 62.68,16.272 63.24,15.456 C63.8,14.64 64.08,13.728 64.08,12.72 C64.08,11.552 63.772,10.628 63.156,9.948 C62.54,9.268 61.812,8.772 60.972,8.46 C60.132,8.148 59.072,7.856 57.792,7.584 C56.656,7.344 55.832,7.112 55.32,6.888 C54.808,6.664 54.552,6.328 54.552,5.88 C54.552,5.432 54.768,5.068 55.2,4.788 C55.632,4.508 56.32,4.368 57.264,4.368 C58.768,4.368 60.32,4.8 61.92,5.664 L61.92,5.664 L63.384,2.136 C62.568,1.656 61.624,1.292 60.552,1.044 C59.48,0.796 58.392,0.672 57.288,0.672 C55.672,0.672 54.308,0.912 53.196,1.392 C52.084,1.872 51.248,2.524 50.688,3.348 C50.128,4.172 49.848,5.096 49.848,6.12 C49.848,7.288 50.152,8.216 50.76,8.904 C51.368,9.592 52.096,10.092 52.944,10.404 C53.792,10.716 54.848,11.008 56.112,11.28 C57.264,11.536 58.1,11.78 58.62,12.012 C59.14,12.244 59.4,12.6 59.4,13.08 C59.4,13.992 58.488,14.448 56.664,14.448 C55.704,14.448 54.728,14.296 53.736,13.992 C52.744,13.688 51.872,13.288 51.12,12.792 L51.12,12.792 L49.56,16.296 C50.36,16.856 51.4,17.304 52.68,17.64 C53.96,17.976 55.28,18.144 56.64,18.144 Z M71.856,18.024 C72.48,18.024 73.068,17.96 73.62,17.832 C74.172,17.704 74.64,17.52 75.024,17.28 L75.024,17.28 L73.896,14.088 C73.496,14.36 73.032,14.496 72.504,14.496 C72.088,14.496 71.756,14.364 71.508,14.1 C71.26,13.836 71.136,13.472 71.136,13.008 L71.136,13.008 L71.136,8.688 L74.112,8.688 L74.112,5.28 L71.136,5.28 L71.136,1.896 L66.576,1.896 L66.576,5.28 L64.68,5.28 L64.68,8.688 L66.576,8.688 L66.576,13.056 C66.576,14.704 67.032,15.944 67.944,16.776 C68.856,17.608 70.16,18.024 71.856,18.024 Z M82.248,18.024 C83,18.024 83.712,17.888 84.384,17.616 C85.056,17.344 85.632,16.944 86.112,16.416 L86.112,16.416 L86.112,17.808 L90.456,17.808 L90.456,4.8 L85.896,4.8 L85.896,11.064 C85.896,12.104 85.668,12.876 85.212,13.38 C84.756,13.884 84.168,14.136 83.448,14.136 C82.744,14.136 82.208,13.912 81.84,13.464 C81.472,13.016 81.288,12.304 81.288,11.328 L81.288,11.328 L81.288,4.8 L76.728,4.8 L76.728,12.072 C76.728,14.056 77.228,15.544 78.228,16.536 C79.228,17.528 80.568,18.024 82.248,18.024 Z M99.048,18.024 C100.744,18.024 102.016,17.52 102.864,16.512 L102.864,16.512 L102.864,17.808 L107.208,17.808 L107.208,0 L102.648,0 L102.648,5.928 C101.8,5.032 100.6,4.584 99.048,4.584 C97.864,4.584 96.784,4.856 95.808,5.4 C94.832,5.944 94.06,6.724 93.492,7.74 C92.924,8.756 92.64,9.936 92.64,11.28 C92.64,12.624 92.924,13.808 93.492,14.832 C94.06,15.856 94.832,16.644 95.808,17.196 C96.784,17.748 97.864,18.024 99.048,18.024 Z M100.008,14.4 C99.208,14.4 98.552,14.124 98.04,13.572 C97.528,13.02 97.272,12.256 97.272,11.28 C97.272,10.32 97.528,9.568 98.04,9.024 C98.552,8.48 99.208,8.208 100.008,8.208 C100.808,8.208 101.46,8.48 101.964,9.024 C102.468,9.568 102.72,10.32 102.72,11.28 C102.72,12.256 102.464,13.02 101.952,13.572 C101.44,14.124 100.792,14.4 100.008,14.4 Z M112.368,22.68 C113.728,22.68 114.88,22.356 115.824,21.708 C116.768,21.06 117.568,19.936 118.224,18.336 L118.224,18.336 L123.84,4.8 L119.496,4.8 L116.28,12.744 L113.088,4.8 L108.408,4.8 L113.976,17.976 C113.784,18.36 113.548,18.64 113.268,18.816 C112.988,18.992 112.632,19.08 112.2,19.08 C111.832,19.08 111.468,19.012 111.108,18.876 C110.748,18.74 110.44,18.552 110.184,18.312 L110.184,18.312 L108.6,21.504 C109.032,21.856 109.596,22.14 110.292,22.356 C110.988,22.572 111.68,22.68 112.368,22.68 Z" id=Study fill-opacity=0.85 fill=#000000></path></g></g></g></svg><svg class="logo-dark hidden" width=125px height=23px viewBox="0 0 125 23" version=1.1 xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink><title>BTCStudy</title><g id=页面-1 stroke=none stroke-width=1 fill=none fill-rule=evenodd><g id=首页-响应式 transform="translate(-249.000000, -23.000000)" fill-rule=nonzero><g id=BTCStudy transform="translate(249.680000, 23.192000)"><path d="M9.072,17.808 C11.312,17.808 13.024,17.408 14.208,16.608 C15.392,15.808 15.984,14.672 15.984,13.2 C15.984,12.192 15.712,11.332 15.168,10.62 C14.624,9.908 13.872,9.384 12.912,9.048 C13.632,8.68 14.188,8.18 14.58,7.548 C14.972,6.916 15.168,6.2 15.168,5.4 C15.168,4.056 14.608,2.988 13.488,2.196 C12.368,1.404 10.736,1.008 8.592,1.008 L8.592,1.008 L-5.68434189e-14,1.008 L-5.68434189e-14,17.808 L9.072,17.808 Z M7.968,7.68 L4.704,7.68 L4.704,4.44 L7.968,4.44 C9.568,4.44 10.368,4.976 10.368,6.048 C10.368,7.136 9.568,7.68 7.968,7.68 L7.968,7.68 Z M8.688,14.376 L4.704,14.376 L4.704,10.968 L8.688,10.968 C10.352,10.968 11.184,11.536 11.184,12.672 C11.184,13.808 10.352,14.376 8.688,14.376 L8.688,14.376 Z M26.544,17.808 L26.544,4.776 L31.68,4.776 L31.68,1.008 L16.632,1.008 L16.632,4.776 L21.792,4.776 L21.792,17.808 L26.544,17.808 Z M41.592,18.144 C43.128,18.144 44.512,17.872 45.744,17.328 C46.976,16.784 48,16 48.816,14.976 L48.816,14.976 L45.792,12.24 C44.704,13.552 43.384,14.208 41.832,14.208 C40.92,14.208 40.108,14.008 39.396,13.608 C38.684,13.208 38.132,12.644 37.74,11.916 C37.348,11.188 37.152,10.352 37.152,9.408 C37.152,8.464 37.348,7.628 37.74,6.9 C38.132,6.172 38.684,5.608 39.396,5.208 C40.108,4.808 40.92,4.608 41.832,4.608 C43.384,4.608 44.704,5.264 45.792,6.576 L45.792,6.576 L48.816,3.84 C48,2.816 46.976,2.032 45.744,1.488 C44.512,0.944 43.128,0.672 41.592,0.672 C39.832,0.672 38.252,1.044 36.852,1.788 C35.452,2.532 34.352,3.568 33.552,4.896 C32.752,6.224 32.352,7.728 32.352,9.408 C32.352,11.088 32.752,12.592 33.552,13.92 C34.352,15.248 35.452,16.284 36.852,17.028 C38.252,17.772 39.832,18.144 41.592,18.144 Z" id=BTC fill=#F2A900></path><path d="M56.64,18.144 C58.24,18.144 59.6,17.9 60.72,17.412 C61.84,16.924 62.68,16.272 63.24,15.456 C63.8,14.64 64.08,13.728 64.08,12.72 C64.08,11.552 63.772,10.628 63.156,9.948 C62.54,9.268 61.812,8.772 60.972,8.46 C60.132,8.148 59.072,7.856 57.792,7.584 C56.656,7.344 55.832,7.112 55.32,6.888 C54.808,6.664 54.552,6.328 54.552,5.88 C54.552,5.432 54.768,5.068 55.2,4.788 C55.632,4.508 56.32,4.368 57.264,4.368 C58.768,4.368 60.32,4.8 61.92,5.664 L61.92,5.664 L63.384,2.136 C62.568,1.656 61.624,1.292 60.552,1.044 C59.48,0.796 58.392,0.672 57.288,0.672 C55.672,0.672 54.308,0.912 53.196,1.392 C52.084,1.872 51.248,2.524 50.688,3.348 C50.128,4.172 49.848,5.096 49.848,6.12 C49.848,7.288 50.152,8.216 50.76,8.904 C51.368,9.592 52.096,10.092 52.944,10.404 C53.792,10.716 54.848,11.008 56.112,11.28 C57.264,11.536 58.1,11.78 58.62,12.012 C59.14,12.244 59.4,12.6 59.4,13.08 C59.4,13.992 58.488,14.448 56.664,14.448 C55.704,14.448 54.728,14.296 53.736,13.992 C52.744,13.688 51.872,13.288 51.12,12.792 L51.12,12.792 L49.56,16.296 C50.36,16.856 51.4,17.304 52.68,17.64 C53.96,17.976 55.28,18.144 56.64,18.144 Z M71.856,18.024 C72.48,18.024 73.068,17.96 73.62,17.832 C74.172,17.704 74.64,17.52 75.024,17.28 L75.024,17.28 L73.896,14.088 C73.496,14.36 73.032,14.496 72.504,14.496 C72.088,14.496 71.756,14.364 71.508,14.1 C71.26,13.836 71.136,13.472 71.136,13.008 L71.136,13.008 L71.136,8.688 L74.112,8.688 L74.112,5.28 L71.136,5.28 L71.136,1.896 L66.576,1.896 L66.576,5.28 L64.68,5.28 L64.68,8.688 L66.576,8.688 L66.576,13.056 C66.576,14.704 67.032,15.944 67.944,16.776 C68.856,17.608 70.16,18.024 71.856,18.024 Z M82.248,18.024 C83,18.024 83.712,17.888 84.384,17.616 C85.056,17.344 85.632,16.944 86.112,16.416 L86.112,16.416 L86.112,17.808 L90.456,17.808 L90.456,4.8 L85.896,4.8 L85.896,11.064 C85.896,12.104 85.668,12.876 85.212,13.38 C84.756,13.884 84.168,14.136 83.448,14.136 C82.744,14.136 82.208,13.912 81.84,13.464 C81.472,13.016 81.288,12.304 81.288,11.328 L81.288,11.328 L81.288,4.8 L76.728,4.8 L76.728,12.072 C76.728,14.056 77.228,15.544 78.228,16.536 C79.228,17.528 80.568,18.024 82.248,18.024 Z M99.048,18.024 C100.744,18.024 102.016,17.52 102.864,16.512 L102.864,16.512 L102.864,17.808 L107.208,17.808 L107.208,0 L102.648,0 L102.648,5.928 C101.8,5.032 100.6,4.584 99.048,4.584 C97.864,4.584 96.784,4.856 95.808,5.4 C94.832,5.944 94.06,6.724 93.492,7.74 C92.924,8.756 92.64,9.936 92.64,11.28 C92.64,12.624 92.924,13.808 93.492,14.832 C94.06,15.856 94.832,16.644 95.808,17.196 C96.784,17.748 97.864,18.024 99.048,18.024 Z M100.008,14.4 C99.208,14.4 98.552,14.124 98.04,13.572 C97.528,13.02 97.272,12.256 97.272,11.28 C97.272,10.32 97.528,9.568 98.04,9.024 C98.552,8.48 99.208,8.208 100.008,8.208 C100.808,8.208 101.46,8.48 101.964,9.024 C102.468,9.568 102.72,10.32 102.72,11.28 C102.72,12.256 102.464,13.02 101.952,13.572 C101.44,14.124 100.792,14.4 100.008,14.4 Z M112.368,22.68 C113.728,22.68 114.88,22.356 115.824,21.708 C116.768,21.06 117.568,19.936 118.224,18.336 L118.224,18.336 L123.84,4.8 L119.496,4.8 L116.28,12.744 L113.088,4.8 L108.408,4.8 L113.976,17.976 C113.784,18.36 113.548,18.64 113.268,18.816 C112.988,18.992 112.632,19.08 112.2,19.08 C111.832,19.08 111.468,19.012 111.108,18.876 C110.748,18.74 110.44,18.552 110.184,18.312 L110.184,18.312 L108.6,21.504 C109.032,21.856 109.596,22.14 110.292,22.356 C110.988,22.572 111.68,22.68 112.368,22.68 Z" id=Study fill-opacity=0.85 fill=#FFFFFF></path></g></g></g></svg></div><div class="mobile-header-title is-full-height is-flex is-align-items-center is-flex-shrink-0"><div class="is-full-height hidden" id=postTopicMobile><p class=is-full-height>为富状态的比特币脚本探索 Lamport 和 Winternitz 签名</p></div></div></div><i class="iconfont icon-icon_search mobile-header-searchIcon"></i><div class=mobile-search-wrap><div class=search-input><input class=pl-3 id=mobile-search-input placeholder=请输入搜索关键词><i class="iconfont icon-icon_search mobile-search-input-btn"></i><button class=mobile-search-input-btn>搜 索</button></div></div></header><div class=mobile-slide-menu><a class=header-activity href=/ >首页</a><a href=/archives>全站目录</a><a href=/tags>标签</a><a href=/maps>地图</a><a href=/tools>工具</a><a target=_blank rel=noopener href=https://123btc.org/ >123btc</a><div><p class="slide-menu-theme is-flex is-flex-direction-row is-justify-content-space-between is-align-items-center"><span>主题设置</span><span><i class="iconfont icon-icon_light slide-theme-light hidden"></i><i class="iconfont icon-icon_dark slide-theme-dark hidden"></i></span></p><p class=slide-menu-fontsize><span>字体设置</span><span><i class="iconfont icon-bianzubeifen"></i><i class="iconfont icon-bianzu"></i></span></p></div></div><div class="search-mask hidden"><script src="/js/header.js?v=1682773100887"></script></div><main><main class="container is-max-widescreen content section post-page pt-4"><div class="columns is-flex-desktop is-justify-content-center"><div class="column is-3 silde-bar is-hidden-mobile"><ol class=toc><li class="toc-item toc-level-2"><a class=toc-link href=#%E7%90%86%E8%A7%A3-Lamport-%E7%AD%BE%E5%90%8D%E5%92%8C-Winternitz-%E7%AD%BE%E5%90%8D><span class=toc-text>理解 Lamport 签名和 Winternitz 签名</span></a></li><li class="toc-item toc-level-2"><a class=toc-link href=#Lamport-%E7%AD%BE%E5%90%8D%EF%BC%9A%E5%BD%A2%E5%BC%8F%E5%8C%96%E8%A7%86%E8%A7%92><span class=toc-text>Lamport 签名：形式化视角</span></a><ol class=toc-child><li class="toc-item toc-level-3"><a class=toc-link href=#%E5%AF%86%E9%92%A5%E7%94%9F%E6%88%90><span class=toc-text>密钥生成</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E7%AD%BE%E5%90%8D%E6%B6%88%E6%81%AF><span class=toc-text>签名消息</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E9%AA%8C%E8%AF%81%E4%B8%80%E4%B8%AA%E7%AD%BE%E5%90%8D><span class=toc-text>验证一个签名</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E5%AE%89%E5%85%A8%E8%80%83%E8%99%91><span class=toc-text>安全考虑</span></a></li></ol></li><li class="toc-item toc-level-2"><a class=toc-link href=#%E4%B8%BA%E4%BB%80%E4%B9%88%E5%AE%83%E4%BB%AC%E5%8F%AB-%E2%80%9C%E4%B8%80%E6%AC%A1%E6%80%A7%E7%AD%BE%E5%90%8D%E2%80%9D%EF%BC%9F><span class=toc-text>为什么它们叫 “一次性签名”？</span></a></li><li class="toc-item toc-level-2"><a class=toc-link href=#%E5%9C%A8%E4%BD%BF%E7%94%A8%E8%B6%85%E8%BF%87%E4%B8%80%E6%AC%A1%E6%97%B6-Lamport-%E7%AD%BE%E5%90%8D%E7%9A%84%E6%BC%8F%E6%B4%9E><span class=toc-text>在使用超过一次时 Lamport 签名的漏洞</span></a></li><li class="toc-item toc-level-2"><a class=toc-link href=#Winternitz-%E7%AD%BE%E5%90%8D%EF%BC%9A%E7%90%86%E8%AE%BA%E8%A7%86%E8%A7%92><span class=toc-text>Winternitz 签名：理论视角</span></a><ol class=toc-child><li class="toc-item toc-level-3"><a class=toc-link href=#%E5%8F%82%E6%95%B0%E4%B8%8E%E5%90%AF%E5%8A%A8><span class=toc-text>参数与启动</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E5%AF%86%E9%92%A5%E7%94%9F%E6%88%90-1><span class=toc-text>密钥生成</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E7%AD%BE%E5%90%8D%E6%B6%88%E6%81%AF-1><span class=toc-text>签名消息</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E9%AA%8C%E8%AF%81%E7%AD%BE%E5%90%8D><span class=toc-text>验证签名</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E5%AE%89%E5%85%A8%E8%80%83%E8%99%91-1><span class=toc-text>安全考虑</span></a></li></ol></li><li class="toc-item toc-level-2"><a class=toc-link href=#%E4%B8%BA%E4%BB%80%E4%B9%88%E6%A0%A1%E9%AA%8C%E5%92%8C%E6%98%AF%E5%BF%85%E8%A6%81%E7%9A%84%EF%BC%9F><span class=toc-text>为什么校验和是必要的？</span></a></li><li class="toc-item toc-level-2"><a class=toc-link href=#BitVM-%E5%92%8C-BitVMX%EF%BC%9ALamport-%E7%AD%BE%E5%90%8D%E5%92%8C-Winternitz-%E7%AD%BE%E5%90%8D%E9%97%AA%E8%80%80%E7%9A%84%E5%9C%B0%E6%96%B9><span class=toc-text>BitVM 和 BitVMX：Lamport 签名和 Winternitz 签名闪耀的地方</span></a></li><li class="toc-item toc-level-2"><a class=toc-link href=#%E7%BB%93%E8%AE%BA><span class=toc-text>结论</span></a></li></ol></div><div class="column is-9 post-container"><h1 class="mt-0 mb-2" id=postTitle>为富状态的比特币脚本探索 Lamport 和 Winternitz 签名</h1><div class=page-author><div class="is-flex is-flex-direction-row page-data mr-6"><img class=mr-1 src=/images/default_avatar.png alt="Nicolas Vescovo"><div class=page-author-info><strong>Nicolas Vescovo</strong><time class=has-text-grey datetime=2026-01-27T11:18:44.000Z>2026-01-27</time></div></div><div class=is-flex><a href=/tags/%E5%93%88%E5%B8%8C%E7%AD%BE%E5%90%8D><i class="page-tag mr-1 px-1">哈希签名</i></a></div></div><article class="mt-4 post-content"><blockquote><p><em>作者：Nicolas Vescovo</em></p><p><em>来源：<a target=_blank rel=noopener href=https://www.rootstocklabs.com/blog/exploring-lamport-and-winternitz-signatures-for-stateful-bitcoin-scripts/ >https://www.rootstocklabs.com/blog/exploring-lamport-and-winternitz-signatures-for-stateful-bitcoin-scripts/</a></em></p></blockquote><p>“BitVM” 这一框架的设计目的是将任意链外计算的乐观主义验证（optimistic verification）带给比特币网络，从而允许更加复杂的操作，比如 “zk rollup” 和侧链桥。BitVM 通过引入支持乐观主义验证的机制，增强了比特币的灵活。“BitVMX” 则使用不同的技术，让部分操作能够更快、更高效地检查，取得了更好的成果。在这一语境下，“乐观主义验证” 表示基于一种假设的验证方法 —— 假设<strong>操作都是有效的，除非能证明不是</strong>。</p><p>为了保证这样的系统的安全性，BitVM 和 BitVMX 使用 Lamport 签名和 Winternitz 签名。这些密码学方法是确保整个过程具有 “富状态性（statefulness）” 的关键。通过使用这些签名方案，BitVM 和 BitVMX 提供了强大的安全性，可以抵御多种攻击并保证所有操作都得到了正确执行。</p><p>本文解释了 “Lamport 签名” 和 “Winternitz 签名” 分别是什么样的、后者如何延申了前者的概念，以及它们如何用在 BitVM 中。我们也将解释，这些签名如何在 BitVM 和 BitVMX 中带来富状态性、确保特定的变量一旦被设定，在后续的脚本中就无法再修改和复用。</p><h2 id=理解-Lamport-签名和-Winternitz-签名><a href=#理解-Lamport-签名和-Winternitz-签名 class=headerlink title="理解 Lamport 签名和 Winternitz 签名"></a>理解 Lamport 签名和 Winternitz 签名</h2><p>一种电子签名方案就是一种用来验证电子消息（或者说文档）的真实性和完整性的数学方案。简单来说：</p><ul><li>Lamport 签名使用了<strong>一次性的电子承诺</strong>（基本上基于哈希函数）来提供不可伪造的签名。</li><li>Winternitz 签名则利用<strong>一种单向函数的多轮迭代</strong>（通常会形成链条）来实现密码学安全性。</li></ul><p><strong>Lamport 签名</strong>：由 Leslie Lamport 在 1970 年代晚期提出，是一种基于哈希函数的电子签名方案。它利用密码学哈希函数的单向特性来获得安全性。Lamport 签名因其简洁性以及抵御量子计算攻击的能力而闻名。它的模式是预先生成大量的密钥对，然后用它来签名。不过，其巨大的签名体积，也可能会限制其应用。</p><p><strong>Winternitz 签名</strong>：由 Ralph Merkle 和 Robert Winternitz 分别独立提出，是另一种基于哈希函数的电子签名。它提供了跟 Lamport 签名相似的安全性，且更加高效。相比 Lamport 签名，Winternitz 签名利用了一种链条结构，降低了签名的大小，这使它更加实用。通过允许用户调整 Winternitz 参数，这些签名可以在计算速度和签名体积之间取得平衡，实质上，是将 Lamport 签名方案一般化了。</p><h2 id=Lamport-签名：形式化视角><a href=#Lamport-签名：形式化视角 class=headerlink title="Lamport 签名：形式化视角"></a>Lamport 签名：形式化视角</h2><p>在本章中，我们提供了对 Lamport 签名如何生成、使用和验证的分步骤解释。我们探索了密钥生成过程、消息签名和签名验证的技术方面。最后，我们讨论了与之有关的安全性考虑和弱点。</p><h3 id=密钥生成><a href=#密钥生成 class=headerlink title=密钥生成></a>密钥生成</h3><p>为需要签名的消息中的每一个比特 i 生成两串随机的字符串（比特序列），分别记为 $S_{i, 0}$ 和 $S_{i, 1}$ 。如果消息的长度是 n 比特，那么 i 的取值范围是从 0 到 $n-1$ 。</p><p>私钥就是由这些随机字符串对 $(S_{i, 0}, S_{i, 1})$ 组成的（其中 $i &#x3D; 0, 1, …, n-1$）。</p><p>对于私钥中的每一对字符串 $(S_{i, 0}, S_{i, 1})$ ，计算这些字符串的哈希值并保持配对：$(H(S_{i, 0}), H(S_{i, 1}))$ 。</p><p>公钥则是由这些哈希值对 $(H(S_{i, 0}), H(S_{i, 1}))$ 组成的（其中 $i &#x3D; 0, 1, …, n-1$）。</p><h3 id=签名消息><a href=#签名消息 class=headerlink title=签名消息></a>签名消息</h3><p>将待签名的消息 m 转化为二进制形式，即 $m &#x3D; m_0m_1…m_{n-1}$ ，每一个 $m_i$ 都是一个比特（其值为 0 或 1 ）。</p><p>对于消息的每一个比特 $m_i$ ，在签名中包含对应的私钥 $S_{i, m_i}$ 。</p><p>最终，签名就是一个有 n 个元素的序列：<code>(S_&#123;0, m_0&#125;, S_&#123;1, m_1&#125;,...,S_&#123;&#123;n-1&#125;, m_&#123;n-1&#125;&#125;)​</code>。</p><h3 id=验证一个签名><a href=#验证一个签名 class=headerlink title=验证一个签名></a>验证一个签名</h3><p>给定一条消息 m 及其签名 <code>(S_&#123;0, m_0&#125;, S_&#123;1, m_1&#125;,...,S_&#123;&#123;n-1&#125;, m_&#123;n-1&#125;&#125;)​</code> 。</p><p>将消息 m 转化为二进制形式：$m &#x3D; m_0m_1…m_{n-1}$ 。</p><p>对于每一个比特 $m_i$ ，计算签名中对应元素的哈希值：$H(S_{i, m_i})$ 。</p><p>验证计算出来的每一个哈希值 $H(S_{i, m_i})$ 都跟公钥中的对应元素（$H(S_{i,0})$ 或 $H(S_{i, 1})$）相匹配。</p><h3 id=安全考虑><a href=#安全考虑 class=headerlink title=安全考虑></a>安全考虑</h3><ul><li><strong>一次性使用</strong>：仅在每一对密钥只用来签名一条消息时，Lamport 签名方案才是安全的。使用同一对密钥来签名多条消息会揭晓部分私钥，从而牺牲安全性。</li><li><strong>哈希函数</strong>：Lamport 签名方案的安全性依赖于所用的密码学哈希函数的强度 —— 它应该能抵抗原像攻击、第二原像攻击以及碰撞攻击。</li></ul><h2 id=为什么它们叫-“一次性签名”？><a href=#为什么它们叫-“一次性签名”？ class=headerlink title="为什么它们叫 “一次性签名”？"></a>为什么它们叫 “一次性签名”？</h2><p>Lamport 签名方案被称作 “一次性签名”，因为在这种方案中，一旦同一把公钥用来签名多于一条消息，其安全性就会急剧下降。其中的道理在于，每多签名一条消息，就会多揭晓一些关于私钥的信息，从而让攻击者更容易伪造签名。</p><p>在观察到一个签名之后，攻击者就知道了公钥中的每一对哈希值中的一个的原像。然而，有了两个签名，攻击者就能知道其中一半哈希值对的两个原像，以及另一半哈希值对的一个原像。有了三个签名，攻击者就能知道其中四分之三的哈希值对的两个原像；以此类推。这种逐步的曝光，意味着同一个公钥每多签一个名，其安全性实质上都会减半。</p><p>（译者注：作者在上一段的推理中使用了消息的比特随机分布的假设。）</p><p>举个例子，如果一个公钥被设计成对第二原像攻击提供 256 比特的安全性以及对碰撞攻击提供 128 比特的安全性，在它签名三次之后，实用的攻击就有可能发动。在它签名四次之后，找出 消息-签名 的配对就变得非常简单了。因为攻击者可以使用已知的哈希值（及其原像）来为自己选定的消息构造新的有效签名，漏洞由此产生；在消息有一些灵活性的语境中尤其如此。</p><h2 id=在使用超过一次时-Lamport-签名的漏洞><a href=#在使用超过一次时-Lamport-签名的漏洞 class=headerlink title="在使用超过一次时 Lamport 签名的漏洞"></a>在使用超过一次时 Lamport 签名的漏洞</h2><p>Lamport 签名在同一公钥重复签名时的主要漏洞在于，攻击者能够利用从以往观察到的签名中获得的信息，为任意消息伪造签名。假设一个攻击者能够知晓使用同一个公钥为多条消息生成的签名。这时候，TA 就能将已知的签名拼凑在一起，构造出新的有效签名。</p><p>比如说，考虑一个消息长度为 16 比特的情形：</p><p>签过名的消息有：m<sub>1</sub> &#x3D; 0001111101110001 以及 m<sub>2</sub> &#x3D; 0111110000111111 。攻击者就能为一条新消息 m<sup>* </sup>&#x3D; 0101111000110101 伪造签名，只需要将对上述两条消息的签名中的对应部分拼凑起来。但凡是使用从 m<sub>1</sub> 和 m<sub>2</sub> 的对应位置的比特构造出的 m<sup>* </sup>，就都能伪造出有效的签名 —— 只需要对应于这些比特的值的哈希值的原像，就能构造出签名。</p><p>如果消息在签名之前哈希过（也即签名的不是消息本身，而是消息的哈希值），那么攻击就要变得更加复杂，但依然是可行的。攻击者必须找出一条消息 m<sup>* </sup>，其哈希值与以往签过名的消息的哈希值有足够多相同的部分。每多一条可以观察到的签名，都可以减少攻击所需的哈希函数求值的次数，也就是让伪造变得更加容易。</p><p>本质上，在使用 Lamport 签名方案时，为了保持安全性，每个公钥都只应使用一次。为多条消息的签名重复使用一个公钥，将允许攻击者获得足够多的信息来伪造新的签名，最终打破这种密码系统的完整性。</p><h2 id=Winternitz-签名：理论视角><a href=#Winternitz-签名：理论视角 class=headerlink title="Winternitz 签名：理论视角"></a>Winternitz 签名：理论视角</h2><p>如我们已经介绍过的，Winternitz 一次性签名（WOTS）是 Lamport 签名的一种强化，极大地缩小了签名和公钥的体积。但天下可没有免费的午餐。这种提升的代价是，生成和验证签名都要更花功夫。在本章中，我们会提供一种形式化的定义，并解释 Winternitz 签名是如何工作的。</p><h3 id=参数与启动><a href=#参数与启动 class=headerlink title=参数与启动></a>参数与启动</h3><ul><li>W：Winternitz 参数，一个正整数，决定一次能处理的比特数量。</li><li>n：哈希输出的长度（以比特计）。</li><li>l：消息摘要的分段数量，计算方式是 $l &#x3D; \lceil n&#x2F;W \rceil$ 。这里的 $\lceil \rceil$ 意味着取大于或等于给定数字的最小整数 。</li><li>l’：校验和的长度，计算方式是 $l’ &#x3D; \lceil (\log_2(l * (2^W - 1)))&#x2F;W \rceil$</li><li>L：签名的总长度，L &#x3D; l + l’ 。</li></ul><h3 id=密钥生成-1><a href=#密钥生成-1 class=headerlink title=密钥生成></a>密钥生成</h3><p>生成 L 个长度为 n 的随机比特串 $S_i$ ，其中 $i &#x3D; 0, 1, …, L-1$ 。</p><p>私钥就是由这些随机比特串组成的：$S &#x3D; (S_0, S_1, …, S_{L-1})$ 。</p><p>对于每一个私钥碎片 $S_i$ ，连续应用哈希函数 $2^W$ 次：$P_i &#x3D; H^{2^W}(S_i)$ 。</p><p>公钥就是用这些哈希结果组成的：$P &#x3D; (P_0, P_1, …, P_{L-1})$</p><h3 id=签名消息-1><a href=#签名消息-1 class=headerlink title=签名消息></a>签名消息</h3><p>将待签名的消息 m 分割为长为 W 比特的 l 个碎片：$m &#x3D; (m_0, m_1, …, m_{l-1})$ 。</p><p>计算校验和 C ：$C &#x3D; \sum_{i&#x3D;0}^{l-1}(2^W - 1 - m_i)$ 。</p><p>将校验和 C 转化为长为 W 比特的 l’ 个碎片：$C &#x3D; (c_0, c_1, …, c_{l’-1})$ 。一般来说，会把第一个元素当成校验和：$C &#x3D; (c_0)$ 。</p><p>对于摘要的每一个碎片 $m_i$ 以及校验和 $c_i$ ，通过哈希对应的私钥碎片 $m_i$ 次来生成签名 $\sigma_i$ ：$\sigma_i &#x3D; H^{m_i}(S_i)$ ，其中 $i &#x3D; 0, 1, …, l-1$ 。</p><p>类似的，对于校验和的部分：$\sigma_{l+j} &#x3D; H^{c_j}(S_{l+j})$ ，其中 $j &#x3D; 0, 1, …, l’-1$ 。</p><p>完整的签名就是这些碎片的拼接：$\sigma &#x3D; (\sigma_0, \sigma_1, …, \sigma_{L-1})$ 。</p><h3 id=验证签名><a href=#验证签名 class=headerlink title=验证签名></a>验证签名</h3><p>给定消息 m 及其签名$\sigma &#x3D; (\sigma_0, \sigma_1, …, \sigma_{L-1})$ 。</p><p>将消息 m 分割成 l 份：$m &#x3D; (m_0, m_1, …, m_{l-1})$ 。</p><p>计算校验和 C 并将它分割成 l’ 份：$C &#x3D; (c_0, c_1, …, c_{l’-1})$ 。</p><p>对于每一个签名碎片 $\sigma_i$ ，应用哈希函数 $2^W - 1 - m_i$ 次，期待它能推导出公钥碎片：<br>$$<br>P_i : \widehat{P_i} &#x3D; H^{2^W - 1 - m_i}(\sigma_1) , \qquad i &#x3D; 0, 1, …, l -1<br>$$<br>类似地，对于校验和的部分：<br>$$<br>\widehat{P_{l+j}} &#x3D; H^{2^W - 1 - c_{j}}(\sigma_{l+j}) , \qquad j &#x3D; 0, 1, …, l’ -1<br>$$<br>如果派生出来的公钥 $(\widehat{P_0}, \widehat{P_1},…, \widehat{P_{L-1}})$ 与公钥 $P &#x3D; (P_0, P_1, …, P_{L-1})$ 相匹配，则说明这是个有效的签名。</p><h3 id=安全考虑-1><a href=#安全考虑-1 class=headerlink title=安全考虑></a>安全考虑</h3><ul><li><strong>参数挑选</strong>：W 的选择会影响签名体积与计算效率的取舍。更大的 W 值会降低签名的体积，但会提高签名和验证的计算负担。</li><li><strong>一次性使用</strong>：与 Lamport 签名一样，Winternitz 签名也是一次性使用的。在多条消息的签名中重复使用同一对密钥，会因为揭晓关于私钥的信息而牺牲安全性。</li></ul><p>下图演示了当 W &#x3D; 2 ，l &#x3D; 5 时，Winternitz 链条的序列（从私钥派生公钥）。每一个箭头都表示一次哈希求职。（译者注：此处原文有误，已纠正。）</p><p><img src=/images/exploring-lamport-and-winternitz-signatures-for-stateful-bitcoin-scripts/image59.png alt=image59></p><h2 id=为什么校验和是必要的？><a href=#为什么校验和是必要的？ class=headerlink title=为什么校验和是必要的？></a>为什么校验和是必要的？</h2><p>从技术角度看，Winternitz 签名方案中的校验和，对于保持安全性和保证签名过程的完整性，都是必要的。</p><p>Winternitz 签名方案的模式是将消息分割成碎片，然后根据各碎片的值将对应的私钥碎片哈希一定的次数（译者注：此处原文有误，已纠正）。然而，这个过程就带来了一个漏洞：只要攻击者知道一个签名（它由各哈希链条上的某个值组成），就可以使用哈希链条上的后续元素来构造有效的签名。这是因为，只要揭晓了哈希链条上的一个成员，攻击者就可以计算出所有后续的哈希值（它们本身就是同一私钥碎片对某个值的签名），从而打破签名的完整性。</p><p>为了消除这种风险，检验和就是关键了。它保证了，对消息的任何改动，都会让校验和也发生对应的、一致的改动，而这种计算，在没有私钥的情况下是计算上不可行的。因为，想要使用一些哈希链条上的后续的值，将需要知道签名校验和的哈希链条上比较靠前的值（在没有私钥的情况下，这是不可能做到的）。校验和是一个额外的验证层，让没有原像攻击能力的攻击者无法在不知道私钥的情况下为另一条消息生成一个有效的签名。</p><p>（译者注：此处的推理是，由于哈希链条是单向的，所以，在不考虑校验和的情况下，知晓一条 WOTS 签名只允许攻击者为数值更大的各个 $m_i$ 伪造签名，也即使用哈希链条上更靠后的值。然而，在使用前述校验和 $C &#x3D; \sum_{i&#x3D;0}^{l-1}(2^W - 1 - m_i)$ 的情况下，更大的 $m_i$ 将带来更小的 C，签名这样的 C 将要求使用私钥哈希链条上更为靠前的值，想要从已知的签名中推导出它意味着逆转哈希运算，这是计算上不可行的。因此，如无私钥，就无法制作出签名。）</p><p>此外，校验和也保证了签名过程的完整性。它是一个最终的检查，验证在签名过程中没有遗漏或替换某个比特。这保证了整条消息都被考虑到了、在签名中有了正确的表示。</p><p>此外，校验和还验证了签名的整体完整性。也就是说，应用了正确的哈希迭代次数，从而保证签名既准确又安全。</p><p>没有校验和，这种方案是很容易被攻击的。攻击者可以很容易替换掉消息碎片，并在没有私钥的情况下创建出有效的签名。缺乏校验和也可能导致不完整验证，让替换或截短的消息也被当成是签过名的。</p><h2 id=BitVM-和-BitVMX：Lamport-签名和-Winternitz-签名闪耀的地方><a href=#BitVM-和-BitVMX：Lamport-签名和-Winternitz-签名闪耀的地方 class=headerlink title="BitVM 和 BitVMX：Lamport 签名和 Winternitz 签名闪耀的地方"></a>BitVM 和 BitVMX：Lamport 签名和 Winternitz 签名闪耀的地方</h2><p>我们已经提到，BitVM 和 BitVMX 是为了将任意链外计算的乐观验证带给比特币网络而设计的框架。两者都能使用 Lamport 签名或 Winternitz 签名来创建健壮的数据承诺。在这个语境下，一个承诺是特定的一段数据在某个时间点已经存在、被安全记录、且签过名的密码学保证。这些承诺可以在未来验证者的挑战中被引用。这些签名的使用，保证了每一个承诺都是可以验证并且抗篡改的。</p><p>如果验证者同意操作者，那就不需要做什么，操作就会正常处理；但如果验证者不同意操作者，因为双方都曾公开签名这些承诺，所以协议允许双方使用对方的信息来证明对方尝试欺诈或正在执行错误的操作。</p><p>BitVM 带来的一项关键创新是能够跨越多笔交易而保持和引用状态。这是通过使用一次性签名来承诺每一步骤时刻的状态来实现的。通过利用 Lamport 签名，BitVM 保证了每一次状态转换都得到了安全的承诺，并且可以在后续操作中可靠地引用。</p><h2 id=结论><a href=#结论 class=headerlink title=结论></a>结论</h2><p>Lamport 签名和 Winternitz 签名有一系列好的属性，使它们适合在 BitVM 和 BitVMX 中使用。它们集成到这些协议中，极大地加强了比特币的脚本编程能力，带来了高效且安全的富状态操作。它们在数据承诺中的用法，保证了网络可以处理更加复杂的交易但保持安全性和性能。这些密码学技术，是比特币未来的关键，因为它们为更加高级和安全的去中心化应用（比如信任最小化的侧链桥、乐观验证的零知识证据）铺平了道路。</p><p>（完）</p></article></div></div></main><script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.8/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><script>MathJax.Hub.Config({tex2jax:{inlineMath:[["$","$"],["\\(","\\)"]],processEscapes:!0,skipTags:["script","noscript","style","textarea","pre","code"]}}),MathJax.Hub.Queue(function(){for(var a=MathJax.Hub.getAllJax(),e=0;e<a.length;e+=1)a[e].SourceElement().parentNode.className+=" has-jax"})</script><script src="/js/post.js?v=1682773100887"></script><script src="/js/highlight.min.js?v=1682773100887"></script><script>var containerEl=document.querySelector(".post-container"),postFontSize=localStorage.getItem("post-font-size")||"16",inputEl=document.querySelector("#size-change-input"),inputEl2=document.querySelector("#size-change-input2");inputEl.value=postFontSize,inputEl2.value=postFontSize,containerEl.style.fontSize=postFontSize+"px",$(function(){function e(t){$(".post-container").css("font-size",t+"px"),localStorage.setItem("post-font-size",t),$("#size-change-input").val(t),$("#size-change-input2").val(t)}$("#size-change-input").on("input propertychange",function(t){e(t.target.value)}),$("#size-change-input2").on("input propertychange",function(t){e(t.target.value)})})</script><script>hljs.initHighlightingOnLoad()</script></main></div><footer class="is-flex is-flex-direction-column is-align-items-center is-flex-shrink-0"><section class=sns-container><a title=nostr target=_blank rel="noopener nofollow" href=https://iris.to/npub1g2qs0ca5kpwlrcfug2em4jelmh65clk3yccwjxrs6hvdpd9qj80q022j4m>Nostr</a><a title=rss target=_blank rel="noopener nofollow" href=/atom.xml>rss</a><a title=telegram target=_blank rel="noopener nofollow" href=//t.me/btcstudyorg>Telegram</a></section></footer><script async src="/js/buttons.js?v=1682773100887"></script><script async src="/js/index.js?v=1682773100887"></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-JVCJ9XXG1Z"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-JVCJ9XXG1Z")</script><script>var _hmt=_hmt||[];(()=>{var e=document.createElement("script"),t=(e.src="https://hm.baidu.com/hm.js?c92c073c85be5be8d9b1b76f62a7e306",e.async=!0,e.defer=!0,document.getElementsByTagName("script")[0]);t.parentNode.insertBefore(e,t)})()</script></body></html>